     case fsDataType.Array:
                    // special case for empty lists; we don't put an empty line
                    // between the brackets
                    if (data.AsList.Count == 0)
                    {
                        stream.Write("[]");
                    }
                    else
                    {
                        var comma = false;

                        stream.Write('[');
                        stream.WriteLine();
                        foreach (var entry in data.AsList)
                        {
                            if (comma)
                            {
                                stream.Write(',');
                                stream.WriteLine();
                            }
                            comma = true;
                            InsertSpacing(stream, depth + 1);
                            BuildPrettyString(entry, stream, depth + 1);
                        }
                        stream.WriteLine();
                        InsertSpacing(stream, depth);
                        stream.Write(']');
                    }
                    break;
            }
        }

        /// <summary>
        /// Writes the pretty JSON output data to the given stream.
        /// </summary>
        /// <param name="data">The data to print.</param>
        /// <param name="outputStream">Where to write the printed data.</param>
        public static void PrettyJson(fsData data, TextWriter outputStream)
        {
            BuildPrettyString(data, outputStream, 0);
        }

        /// <summary>
        /// Returns the data in a pretty printed JSON format.
        /// </summary>
        public static string PrettyJson(fsData data)
        {
            var sb = new StringBuilder();
            using (var writer = new StringWriter(sb))
            {
                BuildPrettyString(data, writer, 0);
                return sb.ToString();
            }
        }

        /// <summary>
        /// Writes the compressed JSON output data to the given stream.
        /// </summary>
        /// <param name="data">The data to print.</param>
        /// <param name="outputStream">Where to write the printed data.</param>
        public static void CompressedJson(fsData data, StreamWriter outputStream)
        {
            BuildCompressedString(data, outputStream);
        }

        /// <summary>
        /// Returns the data in a relatively compressed JSON format.
        /// </summary>
        public static string CompressedJson(fsData data)
        {
            var sb = new StringBuilder();
            using (var writer = new StringWriter(sb))
            {
                BuildCompressedString(data, writer);
                return sb.ToString();
            }
        }

        /// <summary>
        /// Utility method that converts a double to a string.
        /// </summary>
        private static string ConvertDoubleToString(double d)
        {
            