othenCurve(A)),Ti()&&(this.freeFormCompletionTime=this.commentsUtil.getCurrentTime(),i?this.addCommentToServer():this.resetToolTimeoutID=window.setTimeout((function(){a.addCommentToServer()}),2e3)),t.stopPropagation(),t.preventDefault()}}},{key:"_onMouseLeave",value:function _onMouseLeave(t){var i=this;if(this.state.ifDrawing){var a=this.state.inkListCurveIndex;this.setState({inkListCurveIndex:a+1}),window.clearTimeout(this.resetToolOnMouseLeaveTimeoutID),this.resetToolOnMouseLeaveTimeoutID=window.setTimeout((function(){i._onMouseUp(t,!0)}),2e3)}t.stopPropagation(),t.preventDefault()}},{key:"_onMouseEnter",value:function _onMouseEnter(t){window.clearTimeout(this.resetToolOnMouseLeaveTimeoutID),t.stopPropagation(),t.preventDefault()}},{key:"handleTouchStart",value:function handleTouchStart(t){var i=this;if(!t.isFirst){if(!Ti())if(this.resetStatesIfRequired())return;if(this.props.toolBarStore.isThisToolSelected(L.REDHAWK_COMMENT_HIGHLIGHT)){this.missedPts=[];var a=this.commentsUtil.getPointedCoordinatesWithoutFactorsForTouch(t);this.commentsUtil.doHitTest(a[0],a[1],this.props.pageIndex).then((function(t){t.contentType===L.IMAGE_CONTENT_TYPE&&(i.setState({ifDrawing:!0}),i.createNewCommentIfRequired(),i.missedPts.forEach((function(t){i.updateInkListAndBBWithNewPoint(t)}))),i.missedPts=[]}))}else this.setState({ifDrawing:!0}),this.createNewCommentIfRequired();return Ti()&&window.clearTimeout(this.resetToolTimeoutID),t.preventDefault(),!1}}},{key:"handleTouchMove",value:function handleTouchMove(t){if(!t.isFirst){var i=this.commentsUtil.getPointedCoordinatesWithoutFactorsForTouch(t);if(!this.state.ifDrawing)return this.missedPts.push(i),void(!Ti()&&this.resetStatesIfRequired());if(!this.commentUIModel){var a=this.getUpdatedInkList(i),A=this.getUpdatedBB(i);this.createNewCommentIfRequired(A,a)}return this.updateInkListAndBBWithNewPoint(i),t.preventDefault(),!1}}},{key:"handleTouchEnd",value:function handleTouchEnd(t){var i=this;if(!t.isFirst){!Ti()&&this.commentUIModel.setIsCommentUnderCreation(!1);var a=this.state.inkListCurveIndex;return this.state.ifDrawing&&(this.setState({ifDrawing:!1,inkListCurveIndex:a+1,lastUpdateTime:Math.floor(this.commentsUtil.getCurrentTime())}),ri.isCommentFreeHighlight(this.commentUIModel)&&this.smoothenCurve(a)),Ti()&&(this.freeFormCompletionTime=this.commentsUtil.getCurrentTime(),this.resetToolTimeoutID=window.setTimeout((function(){i.addCommentToServer()}),2e3)),t.preventDefault(),!1}}},{key:"createDummyFreehandComment",value:function createDummyFreehandComment(t,i){var a=this.props.toolBarStore.isThisToolSelected(L.REDHAWK_COMMENT_HIGHLIGHT),A=this.props.pageIndex,l=this.props.toolBarStore.getToolColor(this.props.toolBarStore.getSelectedTool()),u=this.props.toolBarStore.getCurrentOpacity(),d=a?this.props.toolBarStore.getFreeHighlightStrokeWidth():this.props.toolBarStore.getCurrentStrokeWidth(),c=this.props.userProfileStore.getUserProfile(),m=a?L.FREE_HIGHLIGHT_INTENT:null,h=a?L.FREE_HIGHLIGHT_SUBJECT:L.SHAPE_SUBJECT,p=this.commentsUtil.getCreatorDetailsForCommentFromUserProfile(c,L.PERSON),g=this.commentsUtil.createSelectorWithCommonAttributes(A,l,u,L.DEFAULT_REDHAWK_COMMENT_TYPE);return this.updateSelectorForFreehand(g,d,t,i,m,h),this.commentsUtil.createCommentModel("","",g,p)}},{key:"updateSelectorForFreehand",value:function updateSelectorForFreehand(t,i,a,A,l,u){var d=this.props.toolBarStore.isThisToolSelected(L.REDHAWK_COMMENT_HIGHLIGHT);t.strokeWidth=i,t.subtype=L.REDHAWK_COMMENT_SHAPE,t.inkList=A||[],t.boundingBox=a||[0,0,0,0],d&&(t.intent=l,t.subject=u)}},{key:"smoothenCurve",value:function smoothenCurve(t){var i=this.state.freehandInkList,a=this.commentUIModel.target.selector.selector.inkList,A=this.commentsUtil.smoothenInkList(i[t]);A&&(i[t]=A,a[t]=this.commentUIModel.target.selector.getCoordPointsWrtPdf(i[t]),this.commentUIModel.target.selector.updateSelectorInkList(b()(a)),this.commentUIModel.target.selector.setInkList(b()(i)))}},{key:"setInkListAndBBOnEvent",value:function setInkListAndBBOnEvent(t){var i=[];this.commentsUtil.getPointedCoordinatesWithoutFactors(i,t),this.updateInkListAndBBWithNewPoint(i)}},{key:"getUpdatedInkList",value:function getUpdatedInkList(t){var i=this.state.freehandInkList,a=this.state.inkListCurveIndex;return this.commentsUtil.calculateFreehandInkListForFreehand(i,a,t)}},{key:"getUpdatedBB",value:function getUpdatedBB(t){var i=this.props.pageStore.getPageCurHeight(this.props.pageIndex),a=this.props.pageStore.getPageCurWidth(this.props.pageIndex),A=this.state.freehandBoundingBox,l=this.commentUIModel?this.commentUIModel.target.selector.strokeWidth:3*L.MARKUP_BORDER_WIDTH;return this.commentsUtil.calculateBoundingBoxForFreehand(A,t,a,i,l)}},{key:"updateInkListAndBBWithNewPoint",value:function updateInkListAndBBWithNewPoint(t){for(var i=this.getUpdatedInkList(t),a=this.getUpdatedBB(t),A=[],l=0;void 0!==i&&l<i.length;l++)A[l]=this.commentUIModel.target.selector.getCoordPointsWrtPdf(i[l]);this.commentUIModel.target.selector.updateSelectorInkList(A),this.commentUIModel.target.selector.setInkList(i);var u=this.commentUIModel.target.selector.getCoordPointsWrtPdf(a);this.commentUIModel.target.selector.updateSelectorBoundingBox(u),this.commentUIModel.target.selector.setBoundingBox(a),this.setState({freehandInkList:i,freehandBoundingBox:a})}},{key:"isNewCommentGettingCreated",value:function isNewCommentGettingCreated(){return 0===this.state.inkListCurveIndex}},{key:"createNewCommentIfRequired",value:function createNewCommentIfRequired(t,i){var a=this;if(this.isNewCommentGettingCreated()){var A=this.createDummyFreehandComment(t,i);if(this.commentUIModel=this.props.commentsStore.addCommentsToPage(this.props.pageIndex,A,{isInProgress:!0}),Ti())this.props.commentsDropinStore.setHandlerForUnsavedDrawing((function(){return a.commitDrawing()})),this.props.commentsStore.addToUnsavedAnnotList(this.commentUIModel.id,L.MOTIVATION_COMMENTING);else{var l=_.getInstance().previewApis.commandManager,u=new mu(this.commentUIModel,this.props.pageIndex,this.props.commentsStore);l.executeCommand(u)}}}},{key:"resetStatesIfRequired",value:function resetStatesIfRequired(){var t=!1,i=Math.floor(this.commentsUtil.getCurrentTime()),a=this.state.lastUpdateTime;$o.setSelectedIndex(this.props.pageIndex);var A=Ti()?2e3:3e3;return null!==a&&i-a>A&&(this.setState({freehandInkList:[],inkListCurveIndex:0,freehandBoundingBox:[],lastUpdateTime:null,ifDrawing:!1}),this.props.shouldUseModernViewer||this.props.toolBarStore.resetSelectedTool(),t=!0),t}},{key:"commitDrawing",value:function commitDrawing(){Ti()&&this.freeFormCompletionTime&&this.commentsUtil.getCurrentTime()-this.freeFormCompletionTime<2e3&&(this.addCommentToServer(),this.freeFormCompletionTime=void 0,window.clearTimeout(this.resetToolTimeoutID))}},{key:"render",value:function render(){var t=this,i=Ti()?pu.a.freehandSketchViewPC:pu.a.freehandSketchView,a=this.props.pageStore.getPageCurHeight(this.props.pageIndex),A=this.props.pageStore.getPageCurWidth(this.props.pageIndex);return Qi.a.createElement("div",{ref:function ref(i){t.elementHandle=i},className:i,style:{height:"".concat(a,"px"),width:"".concat(A,"px")},onMouseMove:function onMouseMove(i){return t._onMouseMove(i)},onMouseDown:function onMouseDown(i){return t._onMouseDown(i)},onMouseUp:function onMouseUp(i){return t._onMouseUp(i)},onMouseEnter:function onMouseEnter(i){return t._onMouseEnter(i)},onMouseLeave:function onMouseLeave(i){return t._onMouseLeave(i)},__self:this,__source:{fileName:"/build/src/react/components/FreehandSketchView.jsx",lineNumber:435,columnNumber:7}})}}]),FreeHandSketchView}(Qi.a.Component))||su)||su,gu=a("SgSA"),Cu=a.n(gu),vu="/build/src/react/components/FreeTextCommentView.jsx",bu=2*L.FREETEXT_PADDING,yu=Object(ir.inject)("commentsStore","pageStore","userProfileStore","commentsPositionStore","CommentPositionStore","toolBarStore")(Au=Object(ir.observer)((lu=function(t){Z()(FreeTextCommentView,t);var i=Q()(FreeTextCommentView);function FreeTextCommentView(t){var a;d()(this,FreeTextCommentView),a=i.call(this,t),M()(a,"inEditMode",uu,Zi()(a)),a.getContentEditable=function(t){return!!t&&(!!we.isPlainTextNotSupported()||"plaintext-only")},a.isNewCommentGettingCreated=!a.props.data.bodyValue,a.wasDragged=!1,a.state={deltaPosition:{x:0,y:0},circlePosition:{x1:0,y1:0,x2:0,y2:0},isFreeformResizing:!1,showBoundary:!1,restrictBoundary:!a.isNewCommentGettingCreated},a.circleRadius=6,a.onDrag=a.onDrag.bind(Zi()(a));var A=a.props.data.target.selector,l=A.boundingBox;return a.minHeight=A.lineHeight*a.props.currPageZoomLevel,a.isNewCommentGettingCreated?A.setBoundingBox([l[0],l[1]-(a.minHeight+1),l[2],l[1]]):a.minHeight=Math.min(a.minHeight,Math.abs(l[1]-l[3])),a}return m()(FreeTextCommentView,[{key:"componentWillMount",value:function componentWillMount(){this.isNewCommentGettingCreated&&(this.props.commentsStore.setSelectedCommentId(this.props.data.id),this.props.commentsStore.addToUnsavedAnnotList(this.props.data.id,L.MOTIVATION_COMMENTING))}},{key:"componentDidMount",value:function componentDidMount(){var t=this;if(this.viewRef){var i=we.isPlainTextNotSupported();this.viewRef.addEventListener("keydown",(function(a){a.keyCode===L.ESC_KEY&&(t.isNewCommentGettingCreated||(t.setState({showBoundary:!1}),t.props.commentsStore.resetSelectedCommentId()),t.viewRef&&t.viewRef.blur()),a.stopPropagation(),a.keyCode===L.ENTER_KEY&&!a.shiftKey&&i&&(!function addNextLineInDiv(){var t=window.getSelection(),i=t.getRangeAt(0),a=document.createElement("br");i.deleteContents(),i.insertNode(a),i.setStartAfter(a),i.setEndAfter(a),i.collapse(!1),t.removeAllRanges(),t.addRange(i)}(),t.onInput(a),a.preventDefault())})),i&&this.viewRef.addEventListener("paste",(function(t){return t.preventDefault()}))}this.isInvalidAppearance(this.comment)&&this.comment.target.selector.fetchAppearanceFromServer(this.comment)}},{key:"componentWillUpdate",value:function componentWillUpdate(t){(this.props.currPageZoomLevel!==t.currPageZoomLevel||this.isInvalidAppearance(this.comment))&&this.comment.target.selector.fetchAppearanceFromServer(this.comment)}},{key:"componentDidUpdate",value:function componentDidUpdate(t){this.props.autoScrollOnSelection&&t.selectedCommentId!==this.props.selectedCommentId&&this.props.isCommentSelected&&!ut(this.viewRef,L.COMMENTS_OVERLAY_VIEWPORT_OFFSET_TOP)&&dt(this.viewRef),this.props.isCommentSelected&&!t.isCommentSelected&&this.viewRef&&(this.viewRef.focus(),ct(this.viewRef))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.handleEditInComment(!0)}},{key:"isInvalidAppearance",value:function isInvalidAppearance(t){return!(!t.target.selector.appearanceData||!0!==t.target.selector.appearanceData.needToRefetch)}},{key:"onMouseOver",value:function onMouseOver(t){this.setState({showBoundary:!0}),ao.triggerEvent(L.API_EVENTS.ANNOTATION_MOUSE_OVER,this.props.commentsStore.getCommentById(this.comment.id))}},{key:"onMouseOut",value:function onMouseOut(t){this.setState({showBoundary:!1}),ao.triggerEvent(L.API_EVENTS.ANNOTATION_MOUSE_OUT,this.props.commentsStore.getCommentById(this.comment.id))}},{key:"setInEditMode",value:function setInEditMode(t){this.inEditMode=t}},{key:"initializeValues",value:function initializeValues(){var t=this;this.comment=this.props.data,this.pageSize=this.props.pageStore.getPageSize(this.props.pageIndex),this.pageHeight=this.props.pageStore.getPageCurHeight(this.props.pageIndex),this.pageWidth=this.props.pageStore.getPageCurWidth(this.props.pageIndex),this.style=this.comment.target.selector.style,this.commentText&&this.commentText!==this.comment.bodyValue&&(this.setState({restrictBoundary:!1}),setTimeout((function(){return t.recomputeBBAndAppearance()}))),this.isNewCommentGettingCreated||(this.appearanceData=this.comment.target.selector.appearanceData,this.appearanceURL=this.appearanceData.fromServer?we.createURLFromBuffer(this.appearanceData.buffer,this.appearanceData.mimeType):void 0),this.lineHeight=this.comment.target.selector.lineHeight*this.props.currPageZoomLevel,this.fontSize=this.style.fontSize*this.props.currPageZoomLevel,this.fontColor=this.props.commentsStore.annotColor||this.style.color,this.fontFamily=this.style.fontName,this.textOffsetPoint=this.comment.target.selector.textOffsetPoint,this.letterSpacing=this.style.letterSpacing,this.commentText=this.comment.bodyValue,this.commentFontSize=this.style.fontSize,this.isNewCommentGettingCreated||this.setObservers(),this.comment.updatedFontColorSize&&(this.setInEditMode(!1),this.comment.setUpdatedStyle(!1))}},{key:"setObservers",value:function setObservers(){var t=this;this.styleDisposer&&(this.styleDisposer(),this.textDisposer()),this.styleDisposer=Object(x.reaction)((function(){return t.comment.target.selector.style}),(function(i){t.commentFontSize!==i.fontSize&&t.setInEditMode(!0),t.recomputeBBAndAppearance()})),this.textDisposer=Object(x.observe)(Il,"updatedText",(function(i){Il.selectedId===t.comment.id&&t.handleBodyChange(i.newValue)}))}},{key:"onClick",value:function onClick(t){var i=this;if(this.inEditMode||!Ei())return Ei()||this.props.commentsStore.setSelectedCommentId(this.comment.id),void t.stopPropagation();this.props.commentsStore.addToUnsavedAnnotList(this.props.data.id,L.MOTIVATION_COMMENTING),this.wasDragged||(this.props.commentsStore.setSelectedCommentId(this.comment.id),this.isNewCommentGettingCreated||(this.props.handleChildClick(t,!this.wasDragged),this.setState({restrictBoundary:!1}),setTimeout((function(){return i.recomputeBB()}))),this.setInEditMode(!0)),t.stopPropagation(),$o.setSelectedIndex(this.props.pageIndex),this.wasDragged=!1}},{key:"recomputeBBAndAppearance",value:function recomputeBBAndAppearance(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.viewRef&&(this.recomputeBB(),(t||0===this.comment.target.selector.appearanceData.textLines.length)&&this.comment.target.selector.updateAppearanceData(this.comment))}},{key:"recomputeBB",value:function recomputeBB(){if(this.viewRef){var t=this.viewRef.getBoundingClientRect(),i=this.comment.target.selector.boundingBox,a=Math.abs(Math.min(i[0],i[2])),A=Math.abs(Math.min(i[3],i[1])),l=[a,A+t.height,a+(t.width-4),A],u=this.comment.target.selector.getCoordPointsWrtPdf(l);this.comment.target.selector.updateSelectorBoundingBox(u),this.comment.target.selector.setBoundingBox(l),(ri.isHeightChanging(i,l)||ri.isWidthChanging(i,l))&&(this.bboxRecomputed=!0)}}},{key:"renderRectangularBoundary",value:function renderRectangularBoundary(){var t=this.state.circlePosition,i=t.x1,a=t.y1,A=t.x2,l=t.y2,u=this.xCoord+i,d=this.yCoord+a,c=Math.abs(this.width+bu+(A-i)),m=Math.abs(this.height+bu+(l-a)),h="".concat(u.toString()," ").concat(d.toString()," ").concat(c.toString()," ").concat(m.toString());return Qi.a.createElement("svg",{className:nu.a.freehandBoundary,viewBox:h,style:{top:"".concat(a,"px"),left:"".concat(i,"px"),width:"".concat(c,"px"),height:"".concat(m,"px"),zIndex:0},__self:this,__source:{fileName:vu,lineNumber:287,columnNumber:7}},Qi.a.createElement("rect",{className:nu.a.freehandBoundaryRect,width:c,height:m,x:u,y:d,style:{stroke:this.props.commentsStore.freeTextBorderColor,strokeWidth:3},__self:this,__source:{fileName:vu,lineNumber:298,columnNumber:9}}))}},{key:"onCircleDragStart",value:function onCircleDragStart(t){this.setState({isFreeformResizing:!0}),Ts.destroyCommentContextMenu(),t.stopPropagation()}},{key:"onCircleDragStop",value:function onCircleDragStop(t,i,a,A,l){var u={isRightX:i,isDownY:a,left:A,top:l},d=we.getTextContent(this.viewRef);d&&this.comment.setBodyValue(d);var c=new eu(this.comment,this.state,this.props.pageIndex,this.props.commentsStore,this.width,this.height,u);this.isNewCommentGettingCreated?c.executeOnUi():(_.getInstance().previewApis.commandManager.executeCommand(c),this.setInEditMode(!1));this.setState({circlePosition:{x1:0,x2:0,y1:0,y2:0},isFreeformResizing:!1,restrictBoundary:!0}),this.viewRef&&this.viewRef.focus(),t.stopPropagation()}},{key:"onCircleDrag",value:function onCircleDrag(t,i,a,A){var l=this.state.circlePosition,u=l.x1,d=l.y1,c=l.x2,m=l.y2,h=0,p=0,g=0,C=0;a&&A?(p=i.deltaX,C=i.deltaY):a||A?a&&!A?(p=i.deltaX,g=i.deltaY):(h=i.deltaX,C=i.deltaY):(h=i.deltaX,g=i.deltaY),this.setState({circlePosition:{x1:u+h,x2:c+p,y1:d+g,y2:m+C}}),t.stopPropagation()}},{key:"onDragStart",value:function onDragStart(t){this.props.commentsStore.resetSelectedCommentId(),this.setState({showBoundary:!1,restrictBoundary:!0}),t.stopPropagation()}},{key:"onDragStop",value:function onDragStop(t){var i=this.state.deltaPosition,a=i.x,A=i.y;if(0!==a||0!==A){this.viewRef.style.transform="translate(0px, 0px)",this.recomputeBBAndAppearance(!1);var l=_.getInstance().previewApis.commandManager,u=new $l(this.comment,a,A,this.props.pageIndex,this.props.commentsStore,this.props.commentsPositionStore,this.props.CommentPositionStore);l.executeCommand(u),this.setState({deltaPosition:{x:0,y:0},showBoundary:!1}),t.stopPropagation()}}},{key:"onDrag",value:function onDrag(t,i){this.wasDragged=!0;var a=this.state.deltaPosition,A=a.x,l=a.y;this.setState({deltaPosition:{x:A+i.deltaX,y:l+i.deltaY},showBoundary:!1}),t.stopPropagation()}},{key:"onKeyUp",value:function onKeyUp(t){ve()&&this.onInput(t)}},{key:"onInput",value:function onInput(t){var i=this;setTimeout((function(){return i.recomputeBB()}),this.state.restrictBoundary?50:0),this.setState({restrictBoundary:!1})}},{key:"handleEditInComment",value:function handleEditInComment(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if((this.inEditMode||this.isNewCommentGettingCreated)&&!this.state.isFreeformResizing){this.props.commentsStore.removeFromUnsavedAnnotList(this.props.data.id,L.MOTIVATION_COMMENTING);var a=we.getTextContent(this.viewRef);this.setInEditMode(!1),this.isNewCommentGettingCreated?(this.props.commentsStore.deleteCommentFromPageUIModel(this.comment.id,this.props.pageIndex),a&&(this.comment.setBodyValue(a),this.recomputeBBAndAppearance(),this.props.createNewComment(this.comment.getServerCommentData(this.comment),void 0,!0),this.isNewCommentGettingCreated=!1),this.props.commentsStore.resetSelectedCommentId()):(a!==this.comment.bodyValue||this.bboxRecomputed)&&(this.handleBodyChange(a),(this.bboxRecomputed||i)&&setTimeout((function(){t.comment.target.selector.updateAppearanceData(t.comment)}),100),setTimeout((function(){t.bboxRecomputed=!1}),200))}}},{key:"handleBodyChange",value:function handleBodyChange(t){if(t){var i=_.getInstance().previewApis.commandManager,a=new xs(this.comment,{content:t},this.props.commentsStore,this.props.pageIndex);i.executeCommand(a)}else{var A=_.getInstance().previewApis.commandManager,l=new no(this.comment,this.comment,!0,this.props.pageIndex,this.props.commentsStore);A.executeCommand(l)}}},{key:"evaluatePosition",value:function evaluatePosition(){var t=this.comment.target.selector;this.xCoord=we.evaluateXCoordForFreeText(t,this.props.viewRotation),this.xCoordMax=this.pageWidth-(this.xCoord+14),this.yCoord=Math.abs(this.pageSize.bottom+we.evaluateYCoordForFreeText(t,this.props.viewRotation)),this.yCoordMax=this.pageHeight-(this.yCoord+14),this.height=we.evaluateHeight(t,this.props.viewRotation),this.width=we.evaluateWidth(t,this.props.viewRotation)}},{key:"computeContainerStyle",value:function computeContainerStyle(){var t=this.xCoord,i=this.yCoord;return{left:"".concat(t,"px"),top:"".concat(i,"px"),transform:"rotate(".concat(this.props.viewRotation,"deg)"),transformOrigin:"top left"}}},{key:"computeEditModeStyle",value:function computeEditModeStyle(t){var i=this.width,a=this.height;return{fontSize:"".concat(this.fontSize,"px"),lineHeight:"".concat(this.lineHeight+1,"px"),color:this.fontColor,minWidth:"".concat(i,"px"),minHeight:"".concat(a,"px"),fontFamily:"Helvetica",fontWeight:"400",letterSpacing:this.letterSpacing,maxWidth:"".concat(this.state.restrictBoundary?i:this.xCoordMax,"px"),maxHeight:"".concat(this.state.restrictBoundary?a:this.yCoordMax,"px"),visibility:"".concat(t?"visible":"hidden")}}},{key:"computeAppearanceStyle",value:function computeAppearanceStyle(){return{position:"absolute",height:"".concat(this.height,"px"),width:"".concat(this.width,"px"),maxWidth:"".concat(this.state.restrictBoundary?this.width:this.xCoordMax,"px"),maxHeight:"".concat(this.state.restrictBoundary?this.height:this.yCoordMax,"px")}}},{key:"renderCircle",value:function renderCircle(t,i){var a,A,l,u,d=this,c=this.circleRadius,m=2*c,h=2*c,p=1-c,g=1-c,C=1,v=1;t?(p+=this.width+(bu-1.5-.5),C+=this.width+(bu-1.5-.5),a=-this.width+2*c+L.FREETEXT_DEFAULT_WIDTH,A=this.xCoordMax-this.width-2*c):(a=-this.xCoord+2*c,A=this.width-2*c-10),i?(g+=this.height+(bu-1.5-.5),v+=this.height+(bu-1.5-.5),l=-this.height+c+(this.minHeight-bu),u=this.yCoordMax-this.height-2*c):(l=-this.yCoord+2*c,u=this.height-(this.minHeight-c));var b,y="".concat(p.toString()," ").concat(g.toString()," ").concat(m.toString()," ").concat(h.toString());b=t&&i?{x:this.state.circlePosition.x2,y:this.state.circlePosition.y2}:t||i?t&&!i?{x:this.state.circlePosition.x2,y:this.state.circlePosition.y1}:{x:this.state.circlePosition.x1,y:this.state.circlePosition.y2}:{x:this.state.circlePosition.x1,y:this.state.circlePosition.y1};var _="nesw-resize";return(!t&&!i||i&&t)&&(_="nwse-resize"),Qi.a.createElement(Ql.a,{bounds:{top:l,left:a,right:A,bottom:u},onStop:function onStop(a){return d.onCircleDragStop(a,t,i,d.xCoord,d.yCoord)},onStart:function onStart(a){return d.onCircleDragStart(a,t,i)},onDrag:function onDrag(a,A){return d.onCircleDrag(a,A,t,i)},enableUserSelectHack:!1,position:b,__self:this,__source:{fileName:vu,lineNumber:585,columnNumber:7}},Qi.a.createElement("svg",{className:nu.a.freehandBoundary,viewBox:y,style:{top:"".concat(g,"px"),left:"".concat(p,"px"),width:"".concat(m,"px"),height:"".concat(h,"px"),cursor:_,zIndex:1},__self:this,__source:{fileName:vu,lineNumber:598,columnNumber:9}},Qi.a.createElement("circle",{className:nu.a.freehandCornerCircle,cx:C,cy:v,r:we.shouldHideCircleRadius()&&this.state.isFreeformResizing?0:c-1.5,style:{stroke:this.props.commentsStore.freeTextBorderColor,strokeWidth:1.5,fill:this.props.commentsStore.cornerCircleFillColor},__self:this,__source:{fileName:vu,lineNumber:610,columnNumber:11}})))}},{key:"renderAppearance",value:function renderAppearance(){var t=this,i=this.circleRadius,a=-this.xCoord+i,A=this.xCoordMax-this.width,l=-this.yCoord+i,u=this.yCoordMax-this.height-i;return Qi.a.createElement(Ql.a,{disabled:!Ei(),bounds:{top:l,left:a,right:A,bottom:u},onStop:function onStop(i){return t.onDragStop(i)},onStart:function onStart(i){return t.onDragStart(i)},onDrag:this.onDrag,enableUserSelectHack:!1,position:{x:0,y:0},__self:this,__source:{fileName:vu,lineNumber:633,columnNumber:7}},Qi.a.createElement("div",{style:this.computeAppearanceStyle(),className:Ra()([Cu.a.freetextAppearanceContainer,Ei()&&Cu.a.moveCursor]),onClick:function onClick(i){return t.onClick(i)},__self:this,__source:{fileName:vu,lineNumber:644,columnNumber:9}},Qi.a.createElement("img",{className:Cu.a.freetextAppearance,src:this.appearanceURL,__self:this,__source:{fileName:vu,lineNumber:652,columnNumber:11}})))}},{key:"render",value:function render(){var t=this;this.initializeValues();var i=this.evaluatePosition(),a=this.inEditMode||this.isNewCommentGettingCreated,A=this.state.showBoundary||a||this.props.isCommentSelected||this.state.isFreeformResizing;return Qi.a.createElement("div",{style:this.computeContainerStyle(i),className:Cu.a.freetextCont,onMouseEnter:function onMouseEnter(i){return t.onMouseOver(i)},onMouseLeave:function onMouseLeave(i){return t.onMouseOut(i)},onClick:function onClick(t){return t.stopPropagation()},__self:this,__source:{fileName:vu,lineNumber:668,columnNumber:7}},!a&&this.appearanceURL&&this.renderAppearance(),A&&Qi.a.createElement(Qi.a.Fragment,{__self:this,__source:{fileName:vu,lineNumber:680,columnNumber:13}},this.renderRectangularBoundary(),Ei()?Qi.a.createElement(Qi.a.Fragment,{__self:this,__source:{fileName:vu,lineNumber:684,columnNumber:19}},this.renderCircle(!1,!1),this.renderCircle(!1,!0),this.renderCircle(!0,!1),this.renderCircle(!0,!0)):null),Qi.a.createElement("div",{ref:function ref(i){t.viewRef=i},style:this.computeEditModeStyle(a,i),className:Cu.a.freetext,contentEditable:this.getContentEditable(a),onInput:function onInput(i){return t.onInput(i)},onKeyUp:function onKeyUp(i){return t.onKeyUp(i)},onClick:function onClick(i){return t.onClick(i)},onBlur:function onBlur(){return t.handleEditInComment()},__self:this,__source:{fileName:vu,lineNumber:693,columnNumber:9}},this.commentText||""))}}]),FreeTextCommentView}(Qi.a.Component),uu=T()(lu.prototype,"inEditMode",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return!1}}),T()(lu.prototype,"setInEditMode",[x.action],Object.getOwnPropertyDescriptor(lu.prototype,"setInEditMode"),lu.prototype),Au=lu))||Au)||Au;yu.propTypes={isCommentSelected:nr.a.bool,autoScrollOnSelection:nr.a.bool},yu.defaultProps={isCommentSelected:!1,autoScrollOnSelection:!1};var _u,Iu=a("m0p3"),wu=a.n(Iu),Mu="/build/src/react/components/MarkupCommentView.jsx",ku=Object(ir.inject)("commentsStore","pageStore","commentsDropinStore")(_u=Object(ir.observer)(_u=function(t){Z()(MarkupCommentView,t);var i=Q()(MarkupCommentView);function MarkupCommentView(){return d()(this,MarkupCommentView),i.apply(this,arguments)}return m()(MarkupCommentView,[{key:"initializeValues",value:function initializeValues(){this.commentColor=this.props.data.target.selector.strokeColor,this.opacity=this.props.data.target.selector.opacity,this.pageSize=this.props.pageStore.getPageSize(this.props.pageIndex),this.comment=this.props.data,this.zoomLevel=this.props.currPageZoomLevel,this.viewRotation=this.props.viewRotation,this.pageRotation=this.props.pageRotation}},{key:"getWidthOfLineOfComment",value:function getWidthOfLineOfComment(t){return Math.abs(t[2]-t[0])}},{key:"getStartingPoint",value:function getStartingPoint(t){var i=(this.viewRotation+this.pageRotation)%360,a=this.isMentionedCommentType(L.REDHAWK_COMMENT_UNDERLINE),A=Fi.getInstance().getStartingPointForRotatedComments(t,this.viewRotation),l=A[0],u=A[1];return a&&90===i&&(l-=this.getWidthOfLineOfComment(t)*(L.DEFAULT_COMMENT_SELECTION_FACTOR-1)),a&&180===i&&(u-=this.getHeightOfLineOfComment(t)*(L.DEFAULT_COMMENT_SELECTION_FACTOR-1)),"".concat(l,"px, ").concat(u,"px, 0px")}},{key:"getHeightOfLineOfComment",value:function getHeightOfLineOfComment(t){return Math.abs(t[1]-t[5])}},{key:"populateCommentLinesArray",value:function populateCommentLinesArray(){var t=this.props.data.target.selector.quadPoints,i=t.length;for(t=t.slice(0,i),this.commentLinesArray=[],this.left=t[0],this.top=t[1];t&&t.length>0;){var a=Fi.getInstance().reOrderQuadPointsForRotation(t.splice(0,8),this.viewRotation);this.commentLinesArray.push(a)}return this.commentLinesArray}},{key:"onClick",value:function onClick(t){this.props.commentsStore.setShowPageLevelWelcomeDialog(!1),this.props.commentsStore.setSelectedCommentId(this.comment.id),this.props.handleChildClick(t),$o.setSelectedIndex(this.props.pageIndex),t.stopPropagation()}},{key:"onMouseOver",value:function onMouseOver(t){ao.triggerEvent(L.API_EVENTS.ANNOTATION_MOUSE_OVER,this.props.commentsStore.getCommentById(this.comment.id))}},{key:"onMouseOut",value:function onMouseOut(t){ao.triggerEvent(L.API_EVENTS.ANNOTATION_MOUSE_OUT,this.props.commentsStore.getCommentById(this.comment.id))}},{key:"isMentionedCommentType",value:function isMentionedCommentType(t){return this.props.data.target.selector.subtype===t}},{key:"getOpacityForHighlight",value:function getOpacityForHighlight(){return Ti()&&this.opacity>.4?.4:this.opacity}},{key:"getSelectionFactorForHeight",value:function getSelectionFactorForHeight(){switch((this.viewRotation+this.pageRotation)%360){case 90:case 270:return 1;default:return L.DEFAULT_COMMENT_SELECTION_FACTOR}}},{key:"getSelectionFactorForWidth",value:function getSelectionFactorForWidth(){switch((this.viewRotation+this.pageRotation)%360){case 90:case 270:return L.DEFAULT_COMMENT_SELECTION_FACTOR;default:return 1}}},{key:"getLineCoordsForStrikeout",value:function getLineCoordsForStrikeout(t){var i,a,A,l;switch((this.viewRotation+this.pageRotation)%360){case 90:case 270:i=this.getWidthOfLineOfComment(t)/2,a="0",A=this.getWidthOfLineOfComment(t)/2,l=this.getHeightOfLineOfComment(t);break;default:i="0",a=this.getHeightOfLineOfComment(t)/2,A=this.getWidthOfLineOfComment(t),l=this.getHeightOfLineOfComment(t)/2}return[i,a,A,l]}},{key:"getLineCoordsForUnderline",value:function getLineCoordsForUnderline(t){var i,a,A,l,u=this.getWidthOfLineOfComment(t)*(L.DEFAULT_COMMENT_SELECTION_FACTOR-1),d=this.getHeightOfLineOfComment(t)*(L.DEFAULT_COMMENT_SELECTION_FACTOR-1),c=(this.viewRotation+this.pageRotation)%360;switch(c){case 90:case 270:i=90===c?u:this.getWidthOfLineOfComment(t),a=0+(this.props.isCommentSelected?4:0),A=90===c?u:this.getWidthOfLineOfComment(t),l=this.getHeightOfLineOfComment(t)-(this.props.isCommentSelected?4:0);break;default:i=0+(this.props.isCommentSelected?4:0),a=0===c?this.getHeightOfLineOfComment(t):d,A=this.getWidthOfLineOfComment(t)-(this.props.isCommentSelected?4:0),l=0===c?this.getHeightOfLineOfComment(t):d}return[i,a,A,l]}},{key:"componentDidUpdate",value:function componentDidUpdate(t){this.props.autoScrollOnSelection&&t.selectedCommentId!==this.props.selectedCommentId&&this.props.isCommentSelected&&!ut(this.elementHandle,L.COMMENTS_OVERLAY_VIEWPORT_OFFSET_TOP)&&dt(this.elementHandle)}},{key:"getHighlightStyle",value:function getHighlightStyle(t,i){return this.props.commentsStore.isHighContrastEnabled?{fill:"transparent",stroke:this.props.commentsStore.annotColor,strokeWidth:L.MARKUP_BORDER_WIDTH}:{fill:t,fillOpacity:i}}},{key:"getSelectedHighlightStyle",value:function getSelectedHighlightStyle(t,i){return this.props.commentsStore.isHighContrastEnabled?{fill:"transparent",stroke:this.props.commentsStore.selectedAnnotColor,strokeWidth:L.MARKUP_BORDER_WIDTH}:{fill:t,fillOpacity:i,stroke:L.MARKUP_BORDER_COLOR,strokeWidth:L.MARKUP_BORDER_WIDTH}}},{key:"renderHighlightComment",value:function renderHighlightComment(t){return this.props.isCommentSelected?Qi.a.createElement("rect",{className:wu.a.commentRect,width:this.getWidthOfLineOfComment(t),height:this.getHeightOfLineOfComment(t),style:this.getSelectedHighlightStyle(this.commentColor,this.getOpacityForHighlight()*L.DEFAULT_COMMENT_SELECTION_FACTOR),__self:this,__source:{fileName:Mu,lineNumber:217,columnNumber:8}}):Qi.a.createElement("rect",{className:wu.a.commentRect,width:this.getWidthOfLineOfComment(t),height:this.getHeightOfLineOfComment(t),style:this.getHighlightStyle(this.commentColor,this.getOpacityForHighlight()),__self:this,__source:{fileName:Mu,lineNumber:223,columnNumber:8}})}},{key:"getMarkupLineStyle",value:function getMarkupLineStyle(t,i,a){return{stroke:t,fillOpacity:i,strokeWidth:a}}},{key:"renderStrikeoutComment",value:function renderStrikeoutComment(t){var i=this.getLineCoordsForStrikeout(t),a=this.props.commentsStore.isHighContrastEnabled;return this.props.isCommentSelected?Qi.a.createElement("g",{__self:this,__source:{fileName:Mu,lineNumber:243,columnNumber:8}},!a&&Qi.a.createElement("rect",{className:wu.a.commentRect,width:this.getWidthOfLineOfComment(t),height:this.getHeightOfLineOfComment(t),style:{stroke:L.MARKUP_BORDER_COLOR,strokeWidth:L.MARKUP_BORDER_WIDTH,fill:"transparent"},__self:this,__source:{fileName:Mu,lineNumber:244,columnNumber:26}}),Qi.a.createElement("line",{className:wu.a.commentLine,x1:i[0],y1:i[1],x2:i[2],y2:i[3],style:a?this.getMarkupLineStyle(this.props.commentsStore.selectedAnnotColor,L.HC_OPACITY,2):this.getMarkupLineStyle(this.commentColor,this.opacity*L.DEFAULT_COMMENT_SELECTION_FACTOR,2),__self:this,__source:{fileName:Mu,lineNumber:254,columnNumber:9}})):Qi.a.createElement("line",{className:wu.a.commentLine,x1:i[0],y1:i[1],x2:i[2],y2:i[3],style:a?this.getMarkupLineStyle(this.props.commentsStore.annotColor,L.HC_OPACITY,2):this.getMarkupLineStyle(this.commentColor,this.opacity,2),__self:this,__source:{fileName:Mu,lineNumber:266,columnNumber:8}})}},{key:"renderUnderlineComment",value:function renderUnderlineComment(t){var i=this.getLineCoordsForUnderline(t),a=this.props.commentsStore.isHighContrastEnabled;return this.props.isCommentSelected?Qi.a.createElement("g",{__self:this,__source:{fileName:Mu,lineNumber:283,columnNumber:8}},!a&&Qi.a.createElement("rect",{className:wu.a.commentRect,width:this.getWidthOfLineOfComment(t)*this.getSelectionFactorForWidth(),height:this.getHeightOfLineOfComment(t)*this.getSelectionFactorForHeight(),style:{stroke:L.MARKUP_BORDER_COLOR,strokeWidth:L.MARKUP_BORDER_WIDTH,fill:"transparent"},__self:this,__source:{fileName:Mu,lineNumber:284,columnNumber:26}}),Qi.a.createElement("line",{className:wu.a.commentLine,x1:i[0],y1:i[1],x2:i[2],y2:i[3],style:a?this.getMarkupLineStyle(this.props.commentsStore.selectedAnnotColor,L.HC_OPACITY,2):this.getMarkupLineStyle(this.commentColor,this.opacity*L.DEFAULT_COMMENT_SELECTION_FACTOR,2),__self:this,__source:{fileName:Mu,lineNumber:294,columnNumber:9}})):Qi.a.createElement("line",{className:wu.a.commentLine,x1:i[0],y1:i[1],x2:i[2],y2:i[3],style:a?this.getMarkupLineStyle(this.props.commentsStore.annotColor,L.HC_OPACITY,2):this.getMarkupLineStyle(this.commentColor,this.opacity,2),__self:this,__source:{fileName:Mu,lineNumber:306,columnNumber:8}})}},{key:"render",value:function render(){var t=this;this.initializeValues();var i=0,a=this.isMentionedCommentType(L.REDHAWK_COMMENT_HIGHLIGHT),A=this.isMentionedCommentType(L.REDHAWK_COMMENT_STRIKEOUT),l=this.isMentionedCommentType(L.REDHAWK_COMMENT_UNDERLINE),u=this.populateCommentLinesArray(),d=!!this.props.data.bodyValue,c=this.props.commentsDropinStore.shouldUseModernViewer;return Qi.a.createElement("div",{ref:function ref(i){t.viewRef=i},onClick:function onClick(i){return t.onClick(i)},onMouseEnter:function onMouseEnter(i){return t.onMouseOver(i)},onMouseLeave:function onMouseLeave(i){return t.onMouseOut(i)},__self:this,__source:{fileName:Mu,lineNumber:330,columnNumber:7}},(c||Ti())&&d?Qi.a.createElement(iu,{top:this.top,left:this.left,fill:this.comment.target.selector.strokeColor,subtype:this.comment.target.selector.subtype,__self:this,__source:{fileName:Mu,lineNumber:337,columnNumber:11}}):null,u.map((function(u){return Qi.a.createElement("svg",{ref:function ref(i){t.elementHandle=i},style:{position:"absolute",transform:"translate3d(".concat(t.getStartingPoint(u),")")},key:i++,width:l?t.getWidthOfLineOfComment(u)*t.getSelectionFactorForWidth():t.getWidthOfLineOfComment(u),height:l?t.getHeightOfLineOfComment(u)*t.getSelectionFactorForHeight():t.getHeightOfLineOfComment(u),version:"1.2",__self:t,__source:{fileName:Mu,lineNumber:339,columnNumber:48}},a&&t.renderHighlightComment(u),A&&t.renderStrikeoutComment(u),l&&t.renderUnderlineComment(u))})))}}]),MarkupCommentView}(Qi.a.Component))||_u)||_u;ku.propTypes={isCommentSelected:nr.a.bool,autoScrollOnSelection:nr.a.bool,commentsDropinStore:nr.a.shape({shouldUseModernViewer:nr.a.bool}).isRequired},ku.defaultProps={isCommentSelected:!1,autoScrollOnSelection:!1};var Su,Tu,xu,Eu,Pu,Nu,Ru,Du=function(){function MoveStickyCommand(t,i,a,A,l,u,c){d()(this,MoveStickyCommand),this.pageIndex=t,this.deltaX=i,this.deltaY=a,this.comment=A,this.commentsStore=l,this.commentsPositionStore=u,this.CommentPositionStore=c}return m()(MoveStickyCommand,[{key:"getUpdatedParams",value:function getUpdatedParams(t,i){var a=this.comment.target.selector.noteX+t,A=this.comment.target.selector.noteY+i,l=[];return l[0]=this.comment.target.selector.boundingBox[0]+t,l[1]=this.comment.target.selector.boundingBox[1]+i,l[2]=this.comment.target.selector.boundingBox[2]+t,l[3]=this.comment.target.selector.boundingBox[3]+i,{boundingBox:l,noteX:a,noteY:A}}},{key:"updateStickyPopupPosition",value:function updateStickyPopupPosition(){var t=this.comment.id;this.commentsPositionStore.deleteCommentPosition(t);var i=new this.CommentPositionStore({commentId:t,nTop:this.comment.target.selector.boundingBox[3],rTop:this.comment.target.selector.boundingBox[3],pageIndex:this.pageIndex,bbLeft:this.comment.target.selector.boundingBox[0],bodyValue:this.comment.bodyValue});this.commentsPositionStore.addCommentPosition(i)}},{key:"serverUtil",value:function serverUtil(){this.comment.syncedWithServer&&this.commentsStore.updateComment(this.pageIndex,this.comment)}},{key:"uiUtil",value:function uiUtil(t,i,a){this.comment.target.selector.setBoundingBox(t),this.comment.setNoteXY(i,a),this.updateStickyPopupPosition()}},{key:"executeOnUi",value:function executeOnUi(){var t=this.getUpdatedParams(this.deltaX,this.deltaY),i=t.boundingBox,a=t.noteX,A=t.noteY;this.uiUtil(i,a,A)}},{key:"executeOnServer",value:function executeOnServer(){this.serverUtil()}},{key:"execute",value:function execute(){this.executeOnUi(),this.executeOnServer()}},{key:"undoOnUi",value:function undoOnUi(){var t=this.getUpdatedParams(-this.deltaX,-this.deltaY),i=t.boundingBox,a=t.noteX,A=t.noteY;this.uiUtil(i,a,A)}},{key:"undoOnServer",value:function undoOnServer(){this.serverUtil()}},{key:"undo",value:function undo(){this.undoOnUi(),this.undoOnServer()}},{key:"redoOnUi",value:function redoOnUi(){var t=this.getUpdatedParams(this.deltaX,this.deltaY),i=t.boundingBox,a=t.noteX,A=t.noteY;this.uiUtil(i,a,A)}},{key:"redoOnServer",value:function redoOnServer(){this.serverUtil()}},{key:"redo",value:function redo(){this.redoOnUi(),this.redoOnServer()}}]),MoveStickyCommand}(),Ou=a("6han"),Lu=a.n(Ou),Bu="/build/src/react/components/StickyNoteCommentView.jsx",Uu=Object(ir.inject)("commentsStore","pageStore","commentsPositionStore","CommentPositionStore","commentsDropinStore")(Su=Object(ir.observer)((Tu=function(t){Z()(StickyNoteCommentView,t);var i=Q()(StickyNoteCommentView);function StickyNoteCommentView(){var t;return d()(this,StickyNoteCommentView),t=i.call(this),M()(t,"dragDisabled",xu,Zi()(t)),t.wasDragged=!1,t.state={activeDrags:0,deltaPosition:{x:0,y:0}},t}return m()(StickyNoteCommentView,[{key:"setdragDisabled",value:function setdragDisabled(t){this.dragDisabled=t}},{key:"initializeValues",value:function initializeValues(){this.pageSize=this.props.pageStore.getPageSize(this.props.pageIndex),this.pageHeight=this.props.pageStore.getPageCurHeight(this.props.pageIndex),this.pageWidth=this.props.pageStore.getPageCurWidth(this.props.pageIndex),this.xFactor=this.pageWidth/(this.pageSize.right-this.pageSize.left),this.yFactor=this.pageHeight/(this.pageSize.top-this.pageSize.bottom),this.comment=this.props.data,this.commentsUtil=Fi.getInstance()}},{key:"evaluateXCoord",value:function evaluateXCoord(t){var i=this.evaluateWidth(),a=Math.abs(this.comment.target.selector.boundingBox[0]);(Ti()&&(a=Math.abs(Math.min(this.comment.target.selector.boundingBox[0],this.comment.target.selector.boundingBox[2]))),this.commentsUtil.isCommentUnsupported(this.comment))&&((a-=L.UNSUPPORTED_ANNOT_MARGIN)<0&&(a=0));return a<t-i?a:t-i}},{key:"evaluateYCoord",value:function evaluateYCoord(t,i){var a=this.evaluateHeight(),A=Math.abs(i.bottom+this.comment.target.selector.boundingBox[3]);return Ti()&&(A=Math.abs(i.bottom+Math.min(this.comment.target.selector.boundingBox[3],this.comment.target.selector.boundingBox[1]))),A<t-a?A:t-a}},{key:"evaluateWidth",value:function evaluateWidth(){return this.isCommentSelected()?24*1.6:24}},{key:"evaluateHeight",value:function evaluateHeight(){return this.isCommentSelected()?24*1.6:24}},{key:"onClick",value:function onClick(t){this.props.commentsStore.setShowPageLevelWelcomeDialog(!1),this.props.commentsStore.setSelectedCommentId(this.comment.id),this.props.handleChildClick(t,this.props.autoScrollOnSelection||!this.wasDragged),this.wasDragged=!1,$o.setSelectedIndex(this.props.pageIndex),t.stopPropagation()}},{key:"onMouseOver",value:function onMouseOver(t){ao.triggerEvent(L.API_EVENTS.ANNOTATION_MOUSE_OVER,this.props.commentsStore.getCommentById(this.comment.id))}},{key:"onMouseOut",value:function onMouseOut(t){ao.triggerEvent(L.API_EVENTS.ANNOTATION_MOUSE_OUT,this.props.commentsStore.getCommentById(this.comment.id))}},{key:"isCommentSelected",value:function isCommentSelected(){return this.props.commentsStore.selectedCommentId===this.comment.id}},{key:"onStop",value:function onStop(t){this.props.commentsStore.resetSelectedCommentId(),this.props.commentsStore.setSelectedCommentId(this.comment.id);var i=this.state.deltaPosition,a=i.x,A=i.y;if(0!==a||0!==A){this.viewRef.style.transform="translate(0px, 0px)";var l=_.getInstance().previewApis.commandManager,u=new Du(this.props.pageIndex,a,A,this.comment,this.props.commentsStore,this.props.commentsPositionStore,this.props.CommentPositionStore);l.executeCommand(u),this.state.deltaPosition={x:0,y:0}}}},{key:"handleDrag",value:function handleDrag(t,i){this.wasDragged=!0;var a=this.state.deltaPosition,A=a.x,l=a.y;this.setState({deltaPosition:{x:A+i.deltaX,y:l+i.deltaY}}),t.stopPropagation()}},{key:"isStickyDraggable",value:function isStickyDraggable(){return this.commentsUtil.isCommentEditable(this.props.data,this.props.userProfileStore.getUserProfile())&&(!this.comment.syncPending||!this.comment.syncedWithServer)}},{key:"componentDidUpdate",value:function componentDidUpdate(t){this.props.autoScrollOnSelection&&t.selectedCommentId!==this.props.selectedCommentId&&this.isCommentSelected()&&!ut(this.viewRef,L.COMMENTS_OVERLAY_VIEWPORT_OFFSET_TOP)&&dt(this.viewRef)}},{key:"render",value:function render(){var t=this;this.initializeValues();var i=this.pageHeight,a=this.pageWidth,A=this.pageSize,u=this.evaluateYCoord(i,A),d=this.evaluateXCoord(a),c=this.evaluateWidth(),m=this.evaluateHeight(),h=-d,p=-u,g=a-d-c,C=i-u-m,v=this.isCommentSelected(),b=(v&&L.SELECTED_STICKY_BORDER_WIDTH,m),y=c,_=this.comment.target.selector.strokeColor,I=P()({},this.props.commentsStore.getStickyNoteColor(_)),w=this.props.commentsStore.isHighContrastEnabled,M=this.props.commentsStore.stickyNoteOpacity;w&&v&&(I.outerBoundary=this.props.commentsStore.selectedAnnotColor),v&&(b-=2,y-=2);var k={};return(this.props.commentsDropinStore.shouldUseModernViewer||Ti())&&(k.enableUserSelectHack=!1),this.setdragDisabled(!this.isStickyDraggable()),Qi.a.createElement("div",{onMouseEnter:function onMouseEnter(i){return t.onMouseOver(i)},onMouseLeave:function onMouseLeave(i){return t.onMouseOut(i)},onClick:function onClick(i){return t.onClick(i)},__self:this,__source:{fileName:Bu,lineNumber:204,columnNumber:13}},Qi.a.createElement(Ql.a,Object.assign({disabled:this.dragDisabled,bounds:{top:p,left:h,right:g,bottom:C},onStop:function onStop(i){return t.onStop(i)},onDrag:this.handleDrag.bind(this)},k,{position:{x:0,y:0},__self:this,__source:{fileName:Bu,lineNumber:209,columnNumber:7}}),Qi.a.createElement("div",{ref:function ref(i){t.viewRef=i},style:{top:"".concat(u,"px"),left:"".concat(d,"px"),width:"".concat(c,"px"),height:"".concat(m,"px")},className:Ra()(Lu.a.stickyNote,l()({},Lu.a.stickyNoteSelected,this.isCommentSelected()&&!w)),__self:this,__source:{fileName:Bu,lineNumber:219,columnNumber:9}},Qi.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"".concat(y,"px"),height:"".concat(b,"px"),viewBox:"0 0 24 24",className:Lu.a.svgSticky,__self:this,__source:{fileName:Bu,lineNumber:226,columnNumber:11}},Qi.a.createElement("g",{fill:"none",fillRule:"evenodd",__self:this,__source:{fileName:Bu,lineNumber:227,columnNumber:13}},Qi.a.createElement("path",{fill:I.outerBoundary,fillRule:"nonzero",d:"M20.46,1 C22.0508,1 23,1.9492 23,3.54 L23,20.46 C23,22.0508 22.0508,23 20.46,23 L3.54,23 C1.9492,23 1,22.0508 1,20.46 L1,3.54 C1,1.9492 1.9492,1 3.54,1 L20.46,1 Z M20.46,0 L3.54,0 C1.3906,0 0,1.3896 0,3.54 L0,20.46 C0,22.6104 1.3906,24 3.54,24 L20.46,24 C22.6074,24 24,22.6104 24,20.46 L24,3.54 C24,1.3896 22.6074,0 20.46,0 Z",opacity:M,__self:this,__source:{fileName:Bu,lineNumber:228,columnNumber:15}}),Qi.a.createElement("path",{fill:I.innerBoundary,fillRule:"nonzero",d:"M18.3125,6.5996 C17.9131,6.1992 17.3125,6 16.8125,6 L7.2031,6 C6.6035,6 6.1035,6.1982 5.7031,6.5996 C5.3022,7 5.0034,7.5996 5.0034,8.1982 L5.0029,14.8008 C5.0029,15.3994 5.2031,15.8994 5.7031,16.3994 C6.104,16.8008 6.7031,17 7.2031,17 L9,17 L9,20.5869 C8.9839,20.8535 9.291,20.9961 9.5,20.7871 L14.0811,17.0078 L16.9219,17 C17.5215,17 18.0254,16.8252 18.4248,16.4238 C18.8252,16.0254 19.0068,15.376 19.0068,14.876 L19.0127,8.2988 C19.0127,7.5996 18.7139,7 18.3125,6.5996 Z M18,15 C18,15.5537 17.5518,16.001 17,16.001 L13.5322,16 L10,19 L9.9961,17 C9.999,16.4473 9.5518,16 9,16 L7,16 C6.4482,16 6,15.5537 6,15 L6,8 C6,7.4473 6.4482,7 7,7 L17,7 C17.5518,7 18,7.4473 18,8 L18,15 Z",opacity:M,__self:this,__source:{fileName:Bu,lineNumber:229,columnNumber:15}}),Qi.a.createElement("path",{fill:I.innerFill,fillRule:"nonzero",d:"M8,12.5 C8,12.2236 8.2241,12 8.5,12 L13.5,12 C13.7754,12 14,12.2236 14,12.5 C14,12.7764 13.7754,13 13.5,13 L8.5,13 C8.2241,13 8,12.7764 8,12.5 Z M8,10.5 C8,10.2236 8.2241,10 8.5,10 L15.5,10 C15.7754,10 16,10.2236 16,10.5 C16,10.7764 15.7754,11 15.5,11 L8.5,11 C8.2241,11 8,10.7764 8,10.5 Z M18,15 L18,8 C18,7.4473 17.5518,7 17,7 L7,7 C6.4482,7 6,7.4473 6,8 L6,15 C6,15.5537 6.4482,16 7,16 L9,16 C9.5518,16 9.999,16.4473 9.9961,17 L10,19 L13.5322,16 L17,16.001 C17.5518,16.001 18,15.5537 18,15 Z",__self:this,__source:{fileName:Bu,lineNumber:230,columnNumber:15}}),Qi.a.createElement("path",{fill:I.innerDash,fillRule:"nonzero",d:"M8,12.5 C8,12.2236 8.2241,12 8.5,12 L13.5,12 C13.7754,12 14,12.2236 14,12.5 C14,12.7764 13.7754,13 13.5,13 L8.5,13 C8.2241,13 8,12.7764 8,12.5 Z M8,10.5 C8,10.2236 8.2241,10 8.5,10 L15.5,10 C15.7754,10 16,10.2236 16,10.5 C16,10.7764 15.7754,11 15.5,11 L8.5,11 C8.2241,11 8,10.7764 8,10.5 Z",opacity:M,__self:this,__source:{fileName:Bu,lineNumber:231,columnNumber:15}}),Qi.a.createElement("path",{style:{fill:I.outerFill},fillRule:"nonzero",d:"M18.3125,6.5996 C18.7139,7 19.0127,7.5996 19.0127,8.2988 L19.0068,14.876 C19.0068,15.376 18.8252,16.0254 18.4248,16.4238 C18.0254,16.8252 17.5215,17 16.9219,17 L14.0811,17.0078 L9.5,20.7871 C9.291,20.9961 8.9839,20.8535 9,20.5869 L9,17 L7.2031,17 C6.7031,17 6.104,16.8008 5.7031,16.3994 C5.2031,15.8994 5.0029,15.3994 5.0029,14.8008 L5.0034,8.1982 C5.0034,7.5996 5.3022,7 5.7031,6.5996 C6.1035,6.1982 6.6035,6 7.2031,6 L16.8125,6 C17.3125,6 17.9131,6.1992 18.3125,6.5996 Z M20.46,1 L3.54,1 C1.9492,1 1,1.9492 1,3.54 L1,20.46 C1,22.0508 1.9492,23 3.54,23 L20.46,23 C22.0508,23 23,22.0508 23,20.46 L23,3.54 C23,1.9492 22.0508,1 20.46,1 Z",__self:this,__source:{fileName:Bu,lineNumber:232,columnNumber:15}}))))))}}]),StickyNoteCommentView}(Qi.a.Component),xu=T()(Tu.prototype,"dragDisabled",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return!1}}),T()(Tu.prototype,"setdragDisabled",[x.action],Object.getOwnPropertyDescriptor(Tu.prototype,"setdragDisabled"),Tu.prototype),Su=Tu))||Su)||Su,Fu=a("yRhj"),ju=a.n(Fu),Hu=function getProperties(t){var i={id:t.id,isRemoved:!1};if(t.motivation===L.MOTIVATION_COMMENTING&&t.target.selector){var a=Object(x.toJS)(t.target.selector);a.boundingBox&&(i.boundingBox=a.boundingBox),a.inkList&&(i.inkList=a.inkList,0===a.inkList.length&&(i.isRemoved=!0))}return i},zu=function(){function EraseInkAnnotationsCommand(t,i,a){d()(this,EraseInkAnnotationsCommand),this.annotations=t,this.oldProperties=i.map((function(t){return Hu(t)})),this.newProperties=t.map((function(t){return Hu(t)})),this.commentsStore=a}return m()(EraseInkAnnotationsCommand,[{key:"updateAnnotationInServer",value:function updateAnnotationInServer(t){var i=this.commentsStore.getUICommentFromId(t.id);if(i){var a=Object(x.toJS)(i.target.selector),A=a.inkList,l=a.node.index;i.syncedWithServer&&A.length>0&&this.commentsStore.updateComment(l,i),0===A.length&&this.commentsStore.deleteComment(i,l)}}},{key:"execute",value:function execute(){var t=this;this.annotations.forEach((function(i){t.updateAnnotationInServer(i)}))}},{key:"updateUiModels",value:function updateUiModels(t,i){var a=this;t.forEach((function(t){var A=a.annotations.filter((function(i){return i.id===t.id}))[0];if(A){if(t.boundingBox){var l=t.boundingBox;l=i?A.target.selector.getCoordPointsWrtImg(l):l,A.target.selector.setBoundingBox(l)}if(t.inkList){var u=t.inkList;u=i?A.target.selector.updateInkList(u):u,A.target.selector.setInkList(u)}a.annotations=[].concat(b()(a.annotations.filter((function(i){return i.id!==t.id}))),[A])}}))}},{key:"undoDeleteOnServer",value:function undoDeleteOnServer(t){this.commentsStore.saveCommentToServer(t.target.selector.node.index,t,!0),t.resetSyncPending(),t.setSyncWithServer(!0),t.resetUnsavedReplyBody(),t.setIsReplying(!1)}},{key:"undoOnServer",value:function undoOnServer(){var t=this;this.annotations.forEach((function(i){t.newProperties.filter((function(t){return t.id===i.id}))[0].isRemoved?t.undoDeleteOnServer(i):t.updateAnnotationInServer(i)}))}},{key:"redoOnServer",value:function redoOnServer(){var t=this;this.annotations.forEach((function(i){t.updateAnnotationInServer(i)}))}},{key:"undo",value:function undo(){this.updateUiModels(this.oldProperties,!0),this.undoOnServer()}},{key:"redo",value:function redo(){this.updateUiModels(this.newProperties,!1),this.redoOnServer()}}]),EraseInkAnnotationsCommand}(),Wu=function distXY(t,i,a,A){return Math.sqrt((a-t)*(a-t)+(A-i)*(A-i))},Vu=function isSegmentHit(t,i,a){var A=Ke()(t,4),l=A[0],u=A[1],d=A[2],c=A[3],m=i[0],h=i[1],p=Wu(l,u,m,h),g=Wu(d,c,m,h),C=Wu(l,u,d,c);return 0===C||void 0===d&&void 0===c?Wu(l,u,m,h)<=a:Math.abs((d-l)*(h-u)-(m-l)*(c-u))/C<=a&&p<=C+a&&g<=C+a},Yu=function updateInkListForEraserCoordinates(t,i,a){for(var A=!1,l=[],u=function updateInkArray(t){for(var l=[],u=0;u<t.length;u+=2)Vu(t.slice(u,u+4),i,a)&&(A=!0,l.push(u+2));return function removeSegmentsFromArray(t,i){var a=[Fi.getInstance().initiateRecursiveArray(t)];if(0!==i.length){for(var A=0;A<i.length;A+=1)a[A]=0===A?t.slice(0,i[0]):t.slice(i[A-1],i[A]),a[A+1]=t.slice(i[A],t.length);a=a.filter((function(t){return t.length>2}))}return a}(t,l)},d=0;d<t.length;d+=1){u(t[d]).forEach((function(t){return l.push(t)}))}return{isInkListUpdated:A,updatedInkList:l}},Ku=function recomputeBBoxesFromInkList(t,i,a){var A=t;if(void 0!==i&&0!==i.length){var l=function getMinMaxXYCoordsFromInkList(t){var i=Fi.getInstance().initiateRecursiveArray(t).reduce((function(t,i){return t.concat(i)}),[]),a=i.filter((function(t,i){return i%2==0})),A=i.filter((function(t,i){return i%2==1}));return[Math.min.apply(null,a),Math.min.apply(null,A),Math.max.apply(null,a),Math.max.apply(null,A)]}(i),u=Ke()(l,4),d=u[0],c=u[1],m=u[2],h=u[3];d-=a,c-=a,m+=a,h+=a,d=Math.max(d,t[0]),c=Math.max(c,t[3]),m=Math.min(m,t[2]),A=[d,h=Math.min(h,t[1]),m,c]}return A},qu=Object(ir.inject)("pageStore","commentsStore","userProfileStore")(Eu=Object(ir.observer)(Eu=function(t){Z()(FreeHandEraserView,t);var i=Q()(FreeHandEraserView);function FreeHandEraserView(t){var a;return d()(this,FreeHandEraserView),(a=i.call(this,t)).commentsUtil=Fi.getInstance(),a.state={ifErasing:!1},a.eraserUpdatedAnnotations=new Map,a}return m()(FreeHandEraserView,[{key:"componentDidMount",value:function componentDidMount(){var t=this,i=new cu.a.Manager(this.elementHandle,{inputClass:Hammer.TouchInput});i.add(new cu.a.Pan({threshold:5,pointers:0})),i.on("panstart",(function(i){t.handleTouchStart(i)})),i.on("panmove",(function(i){t.handleTouchMove(i)})),i.on("panend",(function(i){t.handleTouchEnd(i)})),be()&&window.document.addEventListener("selectstart",this.handleSelectionStart)}},{key:"componentWillUnmount",value:function componentWillUnmount(){window.document.removeEventListener("selectstart",this.handleSelectionStart)}},{key:"onMouseDown",value:function onMouseDown(t){this.setState({ifErasing:!0}),this.executeEraseAnnotationsInUI(t),t.stopPropagation(),t.preventDefault()}},{key:"onMouseMove",value:function onMouseMove(t){this.state.ifErasing&&(this.executeEraseAnnotationsInUI(t),t.stopPropagation(),t.preventDefault())}},{key:"onMouseUp",value:function onMouseUp(t){this.setState({ifErasing:!1}),this.updateBBoxesInUI(),this.updateErasedAnnotationsInServer(),t.stopPropagation(),t.preventDefault()}},{key:"getShapeAnnotationsAtEraserCoords",value:function getShapeAnnotationsAtEraserCoords(t){var i=this;return this.props.commentsStore.getAllComment().filter((function(t){return t.target.selector.node.index===i.props.pageIndex})).filter((function(a){return i.commentsUtil.isShapeComment(a)&&function isPointInsideBBox(t,i){var a=Ke()(t,2),A=a[0],l=a[1],u=Ke()(i,4),d=u[0],c=u[1],m=u[2],h=u[3],p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,g=[Math.min(d,m),Math.min(c,h),Math.max(d,m),Math.max(c,h)],C=g[0],v=g[1],b=g[2],y=g[3];return A>=C-p&&A<=b+p&&l>=v-p&&l<=y+p}(t,a.target.selector.boundingBox)&&i.isShapeCommentErasable(a)}))}},{key:"isShapeCommentErasable",value:function isShapeCommentErasable(t){var i=this.props.commentsStore.getUICommentFromId(t.id);return!!i&&(this.commentsUtil.isCommentEditable(i,this.props.userProfileStore.getUserProfile())&&(!i.syncPending||!i.syncedWithServer))}},{key:"handleSelectionStart",value:function handleSelectionStart(t){t.target===this.elementHandle&&t.preventDefault()}},{key:"handleTouchStart",value:function handleTouchStart(t){t.isFirst||(this.setState({ifErasing:!0}),t.preventDefault())}},{key:"handleTouchMove",value:function handleTouchMove(t){if(!t.isFirst&&this.state.ifErasing){var i=this.commentsUtil.getPointedCoordinatesForTouch(this.props.pageIndex,t);this.eraseInkListsInUI(i),t.preventDefault()}}},{key:"handleTouchEnd",value:function handleTouchEnd(t){t.isFirst||(this.setState({ifErasing:!1}),this.updateBBoxesInUI(),this.updateErasedAnnotationsInServer(),t.preventDefault())}},{key:"executeEraseAnnotationsInUI",value:function executeEraseAnnotationsInUI(t){var i=[];this.commentsUtil.getPointedCoordinates(i,this.props.pageIndex,{eventObj:t}),this.eraseInkListsInUI(i)}},{key:"eraseInkListsInUI",value:function eraseInkListsInUI(t){var i=this;this.getShapeAnnotationsAtEraserCoords(t).forEach((function(a){var A=i.props.commentsStore.getUICommentFromId(a.id);if(A){for(var l=Object(x.toJS)(A.target.selector),u=l.inkList,d=[],c=0;void 0!==u&&c<u.length;c+=1)d[c]=A.target.selector.getCoordPointsWrtPdf(u[c]);var m=l.strokeWidth+1,h=Yu(d,t,m),p=h.isInkListUpdated,g=h.updatedInkList;if(p){var C=A.target.selector.updateInkList(g);A.target.selector.updateSelectorInkList(g),A.target.selector.setInkList(C),i.eraserUpdatedAnnotations.set(a.id,{oldAnnotation:a,updatedAnnotation:A})}}}))}},{key:"updateBBoxesInUI",value:function updateBBoxesInUI(){var t=this;this.eraserUpdatedAnnotations.forEach((function(i){var a=i.oldAnnotation,A=i.updatedAnnotation,l=t.props.commentsStore.getUICommentFromId(A.id),u=Object(x.toJS)(l.target.selector),d=u.inkList,c=u.boundingBox,m=u.strokeWidth;if(d&&d.length>0){var h=Ku(c,d,m),p=l.target.selector.getCoordPointsWrtPdf(h);l.target.selector.updateSelectorBoundingBox(p),l.target.selector.setBoundingBox(h),t.eraserUpdatedAnnotations.set(A.id,{oldAnnotation:a,updatedAnnotation:l})}}))}},{key:"updateErasedAnnotationsInServer",value:function updateErasedAnnotationsInServer(){var t=[],i=[];if(this.eraserUpdatedAnnotations.forEach((function(a){var A=a.oldAnnotation,l=a.updatedAnnotation;t.push(l),i.push(A)})),t.length>0){var a=_.getInstance().previewApis.commandManager,A=new zu(t,i,this.props.commentsStore);a.executeCommand(A)}this.eraserUpdatedAnnotations.clear()}},{key:"render",value:function render(){var t=this,i=this.props.pageStore.getPageCurHeight(this.props.pageIndex),a=this.props.pageStore.getPageCurWidth(this.props.pageIndex);return Qi.a.createElement("div",{ref:function ref(i){t.elementHandle=i},className:ju.a.freeHandEraserView,style:{height:"".concat(i,"px"),width:"".concat(a,"px")},onMouseDown:function onMouseDown(i){return t.onMouseDown(i)},onMouseMove:function onMouseMove(i){return t.onMouseMove(i)},onMouseUp:function onMouseUp(i){return t.onMouseUp(i)},__self:this,__source:{fileName:"/build/src/react/components/FreeHandEraserView.js",lineNumber:260,columnNumber:7}})}}]),FreeHandEraserView}(Qi.a.Component))||Eu)||Eu,Gu=Object(ir.inject)("commentsStore")(Pu=Object(ir.observer)(Pu=function(t){Z()(UnsupportedCommentView,t);var i=Q()(UnsupportedCommentView);function UnsupportedCommentView(){var t;return d()(this,UnsupportedCommentView),(t=i.call(this)).onClick=t.onClick.bind(Zi()(t)),t}return m()(UnsupportedCommentView,[{key:"initializeValues",value:function initializeValues(){this.comment=this.props.data,this.commentsUtil=Fi.getInstance(),this.zoomLevel=this.props.currPageZoomLevel}},{key:"onClick",value:function onClick(t){this.props.commentsStore.setSelectedCommentId(this.comment.id),this.props.handleChildClick(t),$o.setSelectedIndex(this.props.pageIndex),t.stopPropagation()}},{key:"isCommentSelected",value:function isCommentSelected(){return this.props.commentsStore.selectedCommentId===this.comment.id}},{key:"render",value:function render(){this.initializeValues();var t=this.comment.target.selector.boundingBox[3],i=this.comment.target.selector.boundingBox[0],a=this.comment.target.selector.boundingBox[1]-this.comment.target.selector.boundingBox[3],A=this.comment.target.selector.boundingBox[2]-this.comment.target.selector.boundingBox[0],l=!!this.comment.bodyValue,u={position:"absolute",top:t,left:i,height:a,width:A,outline:this.isCommentSelected()?"1px solid blue":"1px solid transparent"};return Qi.a.createElement("div",{onClick:this.onClick,__self:this,__source:{fileName:"/build/src/react/components/UnsupportedCommentView.jsx",lineNumber:68,columnNumber:13}},l?Qi.a.createElement(iu,{fill:this.comment.target.selector.strokeColor,top:t,left:i,subtype:this.comment.target.selector.subtype,__self:this,__source:{fileName:"/build/src/react/components/UnsupportedCommentView.jsx",lineNumber:69,columnNumber:24}}):null,Qi.a.createElement("div",{tabIndex:"0",style:u,__self:this,__source:{fileName:"/build/src/react/components/UnsupportedCommentView.jsx",lineNumber:71,columnNumber:7}}))}}]),UnsupportedCommentView}(Qi.a.Component))||Pu)||Pu,Xu="/build/src/react/components/CommentsOverlay.jsx",Zu={};Zu=a("+lnk").auth;var Ju=Object(ir.inject)("commentsStore","userProfileStore","pageStore","toolBarStore","reviewParticipantsStore","CommentStore","commentsDropinStore","FiltersStore")(Nu=Object(ir.observer)((Ru=function(t){Z()(CommentsOverlay,t);var i=Q()(CommentsOverlay);function CommentsOverlay(t){var a;return d()(this,CommentsOverlay),(a=i.call(this,t)).selectedCoordsObj,a.selectedTextPageIndex,Object(x.reaction)((function(){return a.curHeight}),(function(){a.props.pageStore.setPageOffset(a.pageIndex,a.getPageOffset())})),Object(x.reaction)((function(){return a.curWidth}),(function(){a.props.pageStore.setPageOffset(a.pageIndex,a.getPageOffset())})),_.getInstance().previewApis.documentEvents.on("click",a.onClicked.bind(Zi()(a))),_.getInstance().previewApis.documentEvents.on("leftPaneWidthChange",a.onLeftPaneWidthChange.bind(Zi()(a))),_.getInstance().previewApis.documentEvents.on("pagesViewScrolled",a.onPagesViewScrolled.bind(Zi()(a))),a.onSelectionEnd=a.onSelectionEnd.bind(Zi()(a)),a.onDocumentClick=a.onDocumentClick.bind(Zi()(a)),a.onClicked=a.onClicked.bind(Zi()(a)),a.setupListeners(),a.state={showFilter:!1,renderComments:!1,shouldDisplayPopup:!1},(Ti()||a.props.commentsDropinStore.shouldUseModernViewer)&&_.addOverlay(a.pageIndex,Zi()(a)),a}return m()(CommentsOverlay,[{key:"componentWillUnmount",value:function componentWillUnmount(){_.getInstance().previewApis.documentEvents.unregister("pageclick",this.onClicked),_.getInstance().previewApis.documentEvents.unregister("selectionend",this.onSelectionEnd),_.getInstance().previewApis.documentEvents.unregister("documentclick",this.onDocumentClick)}},{key:"onPagesViewScrolled",value:function onPagesViewScrolled(){this.props.pageStore.setPageOffset(this.pageIndex,this.getPageOffset())}},{key:"onLeftPaneWidthChange",value:function onLeftPaneWidthChange(){var t=this;setTimeout((function(){t.props.pageStore.setPageOffset(t.pageIndex,t.getPageOffset())}))}},{key:"setupListeners",value:function setupListeners(){_.getInstance().previewApis.documentEvents.on("pageclick",this.onClicked),_.getInstance().previewApis.documentEvents.on("selectionend",this.onSelectionEnd),_.getInstance().previewApis.documentEvents.on("documentclick",this.onDocumentClick)}},{key:"pageIndex",get:function get(){return this.props.previewState.pageIndex}},{key:"curWidth",get:function get(){return this.props.pageStore.getPageCurWidth(this.pageIndex)}},{key:"curHeight",get:function get(){return this.props.pageStore.getPageCurHeight(this.pageIndex)}},{key:"currPageZoomLevel",get:function get(){return this.props.pageStore.getPageCurZoomLevel(this.pageIndex)}},{key:"viewRotation",get:function get(){return this.props.pageStore.getViewRotation()}},{key:"pageRotation",get:function get(){return this.props.pageStore.getPageRotation(this.pageIndex)}},{key:"handleChildClick",value:function handleChildClick(t,i){var a=this,A=this.props.commentsStore.selectedCommentModel;if(Ti()||deleteVariableValueFromSessionStorage(Fi.getAssetUri()),this.props.commentsDropinStore.shouldShowCommentsPanel||!1===i||(Ti()||Di.apis.eventEmitter.emit("adobe:comments:commentsPanelOpen"),setTimeout((function(){a.props.commentsDropinStore.setShouldShowCommentsPanel(!0),a.props.commentsDropinStore.shouldUseModernViewer&&it().then((function(t){if(!t){var i={};A.target.selector.subtype===L.REDHAWK_COMMENT_FREETEXT&&(i={autoFocus:!1}),ot(i)}}))}),0)),this.props.commentsStore.isTextSelected&&(this.props.toolBarStore.setShowBanner(!1),this.props.commentsStore.isTextSelected=!1,this.resetSelectedTextPageIndex()),(Ti()||this.props.commentsDropinStore.shouldUseModernViewer)&&A){ao.triggerEvent(L.API_EVENTS.ANNOTATION_CLICKED,this.props.commentsStore.selectedComment);var l=!0,u=!0;if(Si.isSharedCommentingMode()){if(!Zu.isSignedIn)return l=!1,void Zu.signIn();l=Fi.getInstance().isCommentEditable(A,this.props.userProfileStore.getUserProfile()),u=Fi.getInstance().isCommentDeletable(A,this.props.userProfileStore.getUserProfile())}if(Ei()){var d={pageIndex:A.target.selector.node.index,bbox:Ts.translateBbox(A.target.selector.boundingBox),commentNote:A.bodyValue,commentType:A.target.selector.subtype,showEdit:l,showDelete:u};if(this.props.commentsDropinStore.shouldUseModernViewer){var c=this.props.userProfileStore.getUserProfile();(Ti()||c&&c.userId===A.creator.id)&&it().then((function(t){setTimeout((function(){var t={};A.target.selector.subtype===L.REDHAWK_COMMENT_FREETEXT&&(t={trapFocus:!1}),_.getInstance().previewApis.contextMenu.triggerContextMenu(d,t,L.COMMENT_SELECTED)}),t?0:1e3)}))}else setTimeout((function(){_.getInstance().previewApis.contextMenu.triggerContextMenu(d,{},L.COMMENT_SELECTED)}),0)}}}},{key:"onDocumentClick",value:function onDocumentClick(t){this.props.toolBarStore.setShowBanner(!1),this.props.commentsStore.isSelectionInProgress=!1,this.props.commentsStore.isTextSelected=!1,this.resetSelectedTextPageIndex()}},{key:"resetSelectedTextPageIndex",value:function resetSelectedTextPageIndex(){this.selectedTextPageIndex=void 0}},{key:"onContextMenuClick",value:function onContextMenuClick(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.props.toolBarStore.setShowBanner(!1),this.props.commentsStore.isTextSelected=!1,_.getInstance().previewApis.documentActions.clearPageSelection(this.selectedTextPageIndex,this.selectedTextPageIndex),this.resetSelectedTextPageIndex(),this.createCommentOnSelectionEnd(t,i)}},{key:"onSelectionEnd",value:function onSelectionEnd(t){var i=this;if(this.props.toolBarStore.getSelectedTool()!==L.REDHAWK_COMMENT_NOTE){this.props.toolBarStore.setShowBanner(!1),this.resetSelectedTextPageIndex();var a=this.props.pageStore.getPageCurHeight(this.pageIndex),A=this.props.pageStore.getPageCurWidth(this.pageIndex),l=this.props.pageStore.getPageSize(this.pageIndex);if((null==t||t.endPage==this.pageIndex)&&t["page".concat(t.endPage)].bbox0.deviceLeft!=t["page".concat(t.endPage)].bbox0.deviceRight&&t["page".concat(t.endPage)].bbox0.deviceTop!=t["page".concat(t.endPage)].bbox0.deviceBottom){t.newSelection||this.props.commentsStore.deleteUnsavedCommentFromPageUIModel(this.pageIndex),this.props.commentsStore.isSelectionInProgress=!0;var u=[];this.selectedTextCoordinates=Fi.getInstance().getSelectedQuadCoordinates(u,A,a,l,t),this.quadPoints=[],this.quadPoints=u.slice(),this.selectedCoordsObj=t,this.props.toolBarStore.isToolSelected()&&this.props.toolBarStore.getSelectedTool()!==L.REDHAWK_COMMENT_FREETEXT?(_.getInstance().previewApis.documentActions.clearPageSelection(t.startPage,t.endPage,!1),this.createCommentOnSelectionEnd(this.props.toolBarStore.getSelectedTool())):setTimeout((function(){i.selectedTextPageIndex=t.startPage,i.props.toolBarStore.setSelectedTextPageNo(t.startPage,t.endPage),i.props.toolBarStore.setShowBanner(!0),i.props.commentsStore.isSelectionInProgress=!1}),100)}}else _.getInstance().previewApis.documentActions.clearPageSelection(t.startPage,t.endPage)}},{key:"createCommentOnSelectionEnd",value:function createCommentOnSelectionEnd(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={node:{index:this.pageIndex},subtype:t,quadPoints:this.quadPoints,boundingBox:this.selectedTextCoordinates,type:"AdobeAnnoSelector"},A={target:{selector:a}};this.createNewComment(A,this.selectedCoordsObj,i)}},{key:"createNewComment",value:function createNewComment(t,i){var a=this,A=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=_.getInstance().previewApis.commandManager,u={userProfileStore:this.props.userProfileStore,reviewParticipantsStore:this.props.reviewParticipantsStore,toolBarStore:this.props.toolBarStore,commentsStore:this.props.commentsStore,commentsDropinStore:this.props.commentsDropinStore},d=new $n(t,i,u,{autoCommit:!1===this.props.commentsDropinStore.forcedShouldShowCommentsPanel||A,timeoutPeriod:100});if(!1===this.props.commentsDropinStore.forcedShouldShowCommentsPanel)var c=Object(x.reaction)((function(){return a.props.commentsStore.comments.length}),(function(){a.props.commentsStore.setSelectedCommentId(a.props.commentsStore.comments[a.props.commentsStore.comments.length-1].id),c()}));l.executeCommand(d)}},{key:"hitTestForComment",value:function hitTestForComment(t,i){var a,A,l,u,d,c,m,h=this.filteredComments;for(a=0;a<h.length;a+=1)if(m=h[a].target.selector.quadPoints){for(A=0;A<m.length/8;A+=1)if(l=Math.min(m[8*A],m[8*A+2],m[8*A+4],m[8*A+6]),u=Math.max(m[8*A],m[8*A+2],m[8*A+4],m[8*A+6]),d=Math.min(m[8*A+1],m[8*A+3],m[8*A+5],m[8*A+7]),c=Math.max(m[8*A+1],m[8*A+3],m[8*A+5],m[8*A+7]),t>=l&&t<=u&&i>=d&&i<=c)return h[a]}else if(m=h[a].target.selector.boundingBox,l=Math.min(m[0],m[2]),u=Math.max(m[0],m[2]),d=Math.min(m[1],m[3]),c=Math.max(m[1],m[3]),t>=l&&t<=u&&i>=d&&i<=c)return h[a];return!1}},{key:"createStickyComment",value:function createStickyComment(t,i){var a,A,l,u,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=this.props.pageStore.getPageCurHeight(this.pageIndex),m=this.props.pageStore.getPageCurWidth(this.pageIndex),h=this.props.pageStore.getPageSize(this.pageIndex),p=[];Ti()||this.props.commentsDropinStore.shouldUseModernViewer?Fi.getInstance().getPointedCoordinatesWithoutFactors(p,t.eventObj,d):Fi.getInstance().getPointedCoordinates(p,this.pageIndex,t);var g=L.STICKY_SERVER_HEIGHT_WIDTH;if(a=p[0],A=p[1],l=p[0],u=p[1],Ti()||this.props.commentsDropinStore.shouldUseModernViewer){var C=m/(h.right-h.left),v=c/(h.top-h.bottom);a=Math.max(a-g*C/2,0),A=Math.max(A-g*v/2,0),l=Math.min(l+g*C/2,m),u=Math.min(u+g*v/2,c),this.selectedTextCoordinates=[a,u,l,A],Fi.getInstance().transformRectViewToPDF(this.selectedTextCoordinates,this.pageIndex,t)}else a=Math.max(a-g/2,0),A=Math.max(A-g/2,0),l=Math.min(l+g/2,h.right),u=Math.min(u+g/2,h.top),this.selectedTextCoordinates=[a,A,l,u];var b={node:{index:this.pageIndex},noteX:this.selectedTextCoordinates[0],noteY:this.selectedTextCoordinates[3],subtype:i||this.props.toolBarStore.getSelectedTool(),boundingBox:this.selectedTextCoordinates,type:"AdobeAnnoSelector"},y={target:{selector:b}};this.createNewComment(y)}},{key:"startFreeTextComment",value:function startFreeTextComment(t){var i=this.props.pageStore.getPageSize(this.pageIndex),a=L.FREETEXT_PADDING,A=[];Fi.getInstance().getPointedCoordinates(A,this.pageIndex,t);var l=1.2*this.props.toolBarStore.fontSize*this.currPageZoomLevel,u=L.FREETEXT_DEFAULT_WIDTH*this.currPageZoomLevel,d=Math.max(A[0]-a,0),c=Math.max(A[1]-a,0),m=Math.min(A[0]+u,i.right),h=Math.min(A[1]+l,i.top);this.selectedTextCoordinates=[d,c,m,h];var p={target:{selector:{node:{index:this.pageIndex},noteX:this.selectedTextCoordinates[0],noteY:this.selectedTextCoordinates[3],subtype:this.props.toolBarStore.getSelectedTool(),boundingBox:this.selectedTextCoordinates,type:"AdobeAnnoSelector",style:{fontSize:this.props.toolBarStore.fontSize,color:this.props.toolBarStore.getToolColor(L.REDHAWK_COMMENT_FREETEXT),fontName:"Helvetica",letterSpacing:0},lineHeight:1.2*this.props.toolBarStore.fontSize,textOffsetPoint:{x:0,y:1.2*this.props.toolBarStore.fontSize-4}}}};this.props.commentsStore.addCommentsToPage(this.pageIndex,p,{isInProgress:!0})}},{key:"onClicked",value:function onClicked(t){var i=this;if(!t.params||t.params.pageIndex===this.pageIndex){var a=this.props.toolBarStore.getSelectedTool();this.props.commentsStore.isSelectionInProgress||!Ti()&&this.props.userProfileStore.hasAuth&&!this.props.commentsDropinStore.shouldUseModernViewer&&this.props.commentsStore.unsavedAnnotList.length>0||(!this.props.commentsDropinStore.shouldUseModernViewer||this.props.commentsStore.haveCommentsLoaded?(!Ti()&&!this.props.userProfileStore.hasAuth&&this.props.commentsStore.unsavedAnnotList.length>0&&this.props.commentsStore.deleteCommentFromPageUIModel(this.props.commentsStore.selectedCommentId,this.pageIndex),this.props.commentsStore.isTextSelected&&(this.props.toolBarStore.setShowBanner(!1),this.props.commentsStore.isTextSelected=!1,this.resetSelectedTextPageIndex()),this.props.toolBarStore.getIsGradientPickerSelected()?this.props.toolBarStore.invertIsGradientPickerSelected():a===L.REDHAWK_COMMENT_NOTE?this.props.commentsDropinStore.shouldUseModernViewer?it().then((function(a){a||ot(),setTimeout((function(){i.createStickyComment(t)}),0)})):this.createStickyComment(t):a===L.REDHAWK_COMMENT_FREETEXT?this.startFreeTextComment(t):this.props.commentsStore.resetSelectedCommentId()):Uo.showWaitForCommentsMsg(this.props.intl.formatMessage({id:"waitForCommentsNotification"})))}}},{key:"getPageOffset",value:function getPageOffset(){var t=0,i=0;this.viewRef&&(i=At(this.viewRef).left);for(var a=this.pageIndex-1;a>=0;a--){var A=this.props.pageStore.getPageCurHeight(a);Ti()&&!A&&(A=_.getInstance().previewApis.documentState.getPageCurrHeight(a)),t+=A+L.REDHAWK_PREVIEW_MARGIN_BOTTOM}return{top:t,left:i}}},{key:"findPageOverflowDueToPopups",value:function findPageOverflowDueToPopups(){var t=this,i=At(this.viewRef),a=this.props.pageStore.getPageCurHeight(this.pageIndex)+i.top,A=Ct.commentsPosition.filter((function(i){return i.pageIndex===t.pageIndex})),l=A[A.length-1];if(l&&l.viewRef){var u=At(l.viewRef);a<u.bottom&&!this.props.commentsDropinStore.shouldUseModernViewer&&_.getInstance().previewApis.documentActions.notifyPageOverflownByOverlay(this.pageIndex,u.bottom-a)}}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.props.pageStore.setPageOffset(this.pageIndex,this.getPageOffset()),Ti()&&this.findPageOverflowDueToPopups()}},{key:"componentWillMount",value:function componentWillMount(){this.props.pageStore.setPageOffset(this.pageIndex,this.getPageOffset())}},{key:"componentDidMount",value:function componentDidMount(){if(this.props.pageStore.setPageOffset(this.pageIndex,this.getPageOffset()),this.props.commentsStore.expandQueryParamComment(),this.props.userProfileStore.isAnnonymous()){var t,i=(t={},l()(t,L.REDHAWK_COMMENT_FREETEXT,L.REDHAWK_TENN_COLOR),l()(t,L.REDHAWK_COMMENT_NOTE,L.REDHAWK_TENN_COLOR),l()(t,L.REDHAWK_COMMENT_SHAPE,L.REDHAWK_TENN_COLOR),l()(t,L.REDHAWK_COMMENT_HIGHLIGHT,L.REDHAWK_TENN_COLOR),l()(t,L.REDHAWK_COMMENT_UNDERLINE,L.REDHAWK_TENN_COLOR),l()(t,L.REDHAWK_COMMENT_STRIKEOUT,L.REDHAWK_TENN_COLOR),t);this.props.toolBarStore.setToolsColorMap(i),this.props.toolBarStore.setCurrentColor(L.REDHAWK_TENN_COLOR)}}},{key:"isCommentSelected",value:function isCommentSelected(t){return t.id===this.props.commentsStore.selectedCommentId}},{key:"filteredComments",get:function get(){return this.props.commentsStore.getFilteredComments(this.pageIndex)}},{key:"componentWillUpdate",value:function componentWillUpdate(){Ti()||this.props.FiltersStore.recalculateAppliedFilterComments()}},{key:"onMouseMove",value:function onMouseMove(t){var i=this.props.toolBarStore,a=i.getSelectedTool();if(i.isToolSelected()&&i.shouldShowTooltip(a)&&this.tooltipRef){i.tooltipTimeout[a]||(i.tooltipTimeout[a]=setTimeout((function(){a===i.getSelectedTool()&&i.setTooltipShownForTool(a),i.tooltipTimeout[a]=void 0}),L.REDHAWK_TOOLTIP_TIMEOUT));var A=this.viewRef.getBoundingClientRect(),l=this.tooltipRef.getBoundingClientRect(),u=-1!==[L.REDHAWK_COMMENT_NOTE,L.REDHAWK_COMMENT_SHAPE].indexOf(a)?-2:4,d=-1===[L.REDHAWK_COMMENT_NOTE,L.REDHAWK_COMMENT_SHAPE].indexOf(a)?10:8;u=ve()?u-22:u,this.tooltipRef.style.left="".concat(t.pageX-A.left-(l.width/2+u),"px"),this.tooltipRef.style.top="".concat(t.pageY-A.top-l.height-d,"px")}}},{key:"onMouseDown",value:function onMouseDown(t){var i=this.props,a=i.commentsDropinStore,A=i.commentsStore;a.shouldUseModernViewer&&!A.haveCommentsLoaded&&Uo.showWaitForCommentsMsg(this.props.intl.formatMessage({id:"waitForCommentsNotification"})),this.props.toolBarStore.setShowTooltip()}},{key:"render",value:function render(){var t=this,i=this.props.toolBarStore,a=i.getSelectedTool()===L.REDHAWK_COMMENT_SHAPE,A=this.filteredComments,l={},u=Ti()&&!function isMobileOrTablet(){var t=me();return Boolean(t.type&&(t.type.toLowerCase()===ue||t.type.toLowerCase()===de))}();u&&(l.onMouseMove=function(i){return t.onMouseMove(i)},l.onMouseDown=function(i){return t.onMouseDown(i)});var d=this.props.commentsDropinStore.shouldShowCommentsPanel?A.map((function(i){return Di.reviewLoaded&&!i.isCommentUnderCreation?Qi.a.createElement(zl,{key:i.id,data:i,pageIndex:t.pageIndex,previewState:t.props.previewState,isCommentSelected:t.isCommentSelected(i),__self:t,__source:{fileName:Xu,lineNumber:675,columnNumber:21}}):null})):null,c=this.filteredComments.filter((function(t){return t.target.selector.subtype!==L.REDHAWK_COMMENT_SHAPE&&t.target.selector.subtype!==L.REDHAWK_COMMENT_NOTE&&t.target.selector.subtype!==L.REDHAWK_COMMENT_FREETEXT&&t.target.selector.subtype!==L.REDHAWK_COMMENT_UNSUPPORTED})).map((function(i){return Qi.a.createElement(ku,{key:i.id,currPageZoomLevel:t.currPageZoomLevel,viewRotation:t.viewRotation,pageRotation:t.pageRotation,pageIndex:t.pageIndex,data:i,isCommentSelected:t.isCommentSelected(i),handleChildClick:t.handleChildClick.bind(t),autoScrollOnSelection:t.props.commentsDropinStore.shouldUseModernViewer,selectedCommentId:t.props.commentsStore.selectedCommentId,__self:t,__source:{fileName:Xu,lineNumber:692,columnNumber:26}})})),m=this.filteredComments.filter((function(t){return t.target.selector.subtype===L.REDHAWK_COMMENT_SHAPE})).map((function(i){return Qi.a.createElement(au,{key:i.id,pageIndex:t.pageIndex,data:i,currPageZoomLevel:t.currPageZoomLevel,isCommentSelected:t.isCommentSelected(i),handleChildClick:t.handleChildClick.bind(t),autoScrollOnSelection:t.props.commentsDropinStore.shouldUseModernViewer,selectedCommentId:t.props.commentsStore.selectedCommentId,__self:t,__source:{fileName:Xu,lineNumber:705,columnNumber:157}})})),h=this.filteredComments.filter((function(t){return we.isFreeText(t)})).map((function(i){return Qi.a.createElement(yu,{key:i.id,pageIndex:t.pageIndex,data:i,viewRotation:t.viewRotation,currPageZoomLevel:t.currPageZoomLevel,pageData:t.props.previewState.page,isCommentSelected:t.isCommentSelected(i),handleChildClick:t.handleChildClick.bind(t),createNewComment:t.createNewComment.bind(t),autoScrollOnSelection:t.props.commentsDropinStore.shouldUseModernViewer,selectedCommentId:t.props.commentsStore.selectedCommentId,__self:t,__source:{fileName:Xu,lineNumber:716,columnNumber:122}})})),p=this.filteredComments.filter((function(t){return t.target.selector.subtype===L.REDHAWK_COMMENT_NOTE})).map((function(i){return Qi.a.createElement(Uu,{key:i.id,id:t.props.commentsStore.selectedCommentId,pageIndex:t.pageIndex,data:i,isCommentSelected:t.isCommentSelected(i),userProfileStore:t.props.userProfileStore,handleChildClick:t.handleChildClick.bind(t),autoScrollOnSelection:t.props.commentsDropinStore.shouldUseModernViewer,selectedCommentId:t.props.commentsStore.selectedCommentId,__self:t,__source:{fileName:Xu,lineNumber:730,columnNumber:158}})})),g=this.filteredComments.filter((function(t){return t.target.selector.subtype===L.REDHAWK_COMMENT_UNSUPPORTED})).map((function(i){return Qi.a.createElement(Gu,{key:i.id,pageIndex:t.pageIndex,data:i,currPageZoomLevel:t.currPageZoomLevel,isCommentSelected:t.isCommentSelected(i),userProfileStore:t.props.userProfileStore,handleChildClick:t.handleChildClick.bind(t),__self:t,__source:{fileName:Xu,lineNumber:742,columnNumber:166}})})),C=Ti()&&i.isThisToolSelected(L.REDHAWK_COMMENT_HIGHLIGHT)&&(ia()||this.props.pageStore.contentTypeUnderMouse===L.IMAGE_CONTENT_TYPE),v=a||C?Qi.a.createElement(fu,{pageIndex:this.pageIndex,shouldUseModernViewer:this.props.commentsDropinStore.shouldUseModernViewer,__self:this,__source:{fileName:Xu,lineNumber:755,columnNumber:10}}):"",b=(this.props.commentsDropinStore.shouldUseModernViewer?i.isEraserSelected:i.getSelectedTool()===L.REDHAWK_ERASER)&&Qi.a.createElement(qu,{pageIndex:this.pageIndex,__self:this,__source:{fileName:Xu,lineNumber:762,columnNumber:10}});return Qi.a.createElement("div",Object.assign({className:"commentsOverlay",cursor:"text",ref:function ref(i){t.viewRef=i}},l,{__self:this,__source:{fileName:Xu,lineNumber:767,columnNumber:9}}),Qi.a.createElement("div",{className:aa.a.commentsHighlight,style:{height:"".concat(this.curHeight,"px"),width:"".concat(this.curWidth,"px")},__self:this,__source:{fileName:Xu,lineNumber:773,columnNumber:11}},u&&i.isToolSelected()&&i.shouldShowTooltip(i.selectedTool)&&Qi.a.createElement("div",{className:aa.a.cursorTooltip,ref:function ref(i){t.tooltipRef=i},__self:this,__source:{fileName:Xu,lineNumber:783,columnNumber:19}},Qi.a.createElement(Qr.a,{variant:"info",placement:"top",__self:this,__source:{fileName:Xu,lineNumber:787,columnNumber:21}},this.props.intl.formatMessage({id:"".concat(i.selectedTool,"CursorTooltip")}))),c,m,h,p,g,v,b),this.props.commentsDropinStore.shouldUseModernViewer?null:Qi.a.createElement(Qi.a.Fragment,null,Qi.a.createElement("div",{__self:this,__source:{fileName:Xu,lineNumber:802,columnNumber:19}},d),this.props.toolBarStore.showBanner&&this.selectedTextPageIndex===this.pageIndex&&Ei()&&!Ti()?Qi.a.createElement(Zl,{pageIndex:this.pageIndex,quadPoints:this.quadPoints,selectedTextCoordinates:this.selectedTextCoordinates,pageHeight:this.curHeight,pageWidth:this.curWidth,pageSize:this.props.pageStore.getPageSize(this.pageIndex),onClickEvent:this.onContextMenuClick.bind(this),__self:this,__source:{fileName:Xu,lineNumber:804,columnNumber:15}}):"",this.props.commentsDropinStore.shouldShowCommentsPanel?Qi.a.createElement(Wl,Object.assign({pageIndex:this.props.previewState.pageIndex},this.props,{__self:this,__source:{fileName:Xu,lineNumber:817,columnNumber:17}})):null))}}]),CommentsOverlay}(Qi.a.Component),T()(Ru.prototype,"curWidth",[x.computed],Object.getOwnPropertyDescriptor(Ru.prototype,"curWidth"),Ru.prototype),T()(Ru.prototype,"curHeight",[x.computed],Object.getOwnPropertyDescriptor(Ru.prototype,"curHeight"),Ru.prototype),T()(Ru.prototype,"currPageZoomLevel",[x.computed],Object.getOwnPropertyDescriptor(Ru.prototype,"currPageZoomLevel"),Ru.prototype),T()(Ru.prototype,"viewRotation",[x.computed],Object.getOwnPropertyDescriptor(Ru.prototype,"viewRotation"),Ru.prototype),T()(Ru.prototype,"pageRotation",[x.computed],Object.getOwnPropertyDescriptor(Ru.prototype,"pageRotation"),Ru.prototype),T()(Ru.prototype,"filteredComments",[x.computed],Object.getOwnPropertyDescriptor(Ru.prototype,"filteredComments"),Ru.prototype),Nu=Ru))||Nu)||Nu,Qu=Object(Zr.injectIntl)(Ju),$u={commentsStore:$o,CommentStore:ho,CommentPositionStore:Wr,commentsPositionStore:Ct,pageStore:pt,AssetStore:Ve,userProfileStore:vi,toolBarStore:lo,commentSyncStore:fo,reviewParticipantsStore:Li,commentsDropinStore:ei,FiltersStore:Bo};Object(x.useStrict)(!0);var ed,td,nd=Xr(function(t){Z()(CommentsOverlayContainer,t);var i=Q()(CommentsOverlayContainer);function CommentsOverlayContainer(){return d()(this,CommentsOverlayContainer),i.apply(this,arguments)}return m()(CommentsOverlayContainer,[{key:"render",value:function render(){var t=this;return Qi.a.createElement("div",{ref:function ref(i){t.viewRef=i},__self:this,__source:{fileName:"/build/src/react/components/CommentsOverlayContainer.jsx",lineNumber:55,columnNumber:7}},Qi.a.createElement(ir.Provider,Object.assign({},$u,{__self:this,__source:{fileName:"/build/src/react/components/CommentsOverlayContainer.jsx",lineNumber:56,columnNumber:9}}),Qi.a.createElement(Qu,{previewState:this.props,__self:this,__source:{fileName:"/build/src/react/components/CommentsOverlayContainer.jsx",lineNumber:57,columnNumber:11}})))}}]),CommentsOverlayContainer}(Qi.a.Component)),od=ya(nd),id=Object(ir.observer)(ed=function(t){Z()(CommentView,t);var i=Q()(CommentView);function CommentView(t){var a;return d()(this,CommentView),a=i.call(this,t),Ve.isUnSharedReview||a.setPageProperties(),a}return m()(CommentView,[{key:"setPageProperties",value:function setPageProperties(){var t=this;pt.setPageWidthHeight(this.props.page.pageIndex,this.props.page.origWidth,this.props.page.origHeight),pt.setPageCurWidth(this.props.page.pageIndex,this.props.page.curWidth),pt.setPageCurHeight(this.props.page.pageIndex,this.props.page.curHeight),pt.setPageCurZoomLevel(this.props.page.pageIndex,this.props.page.curZoom),pt.setViewRotation(this.props.page.viewRotation),pt.setPageRotation(this.props.page.pageIndex,this.props.page.rotation),Object(x.reaction)((function(){return t.props.page.curWidth}),(function(i){pt.setPageCurWidth(t.props.page.pageIndex,i)})),Object(x.reaction)((function(){return t.props.page.curHeight}),(function(i){pt.setPageCurHeight(t.props.page.pageIndex,i)})),Object(x.reaction)((function(){return t.props.page.curZoom}),(function(i){pt.setPageCurZoomLevel(t.props.page.pageIndex,i)})),Object(x.reaction)((function(){return t.props.page.viewRotation}),(function(t){pt.setViewRotation(t)})),Object(x.reaction)((function(){return t.props.page.rotation}),(function(i){pt.setPageRotation(t.props.page.pageIndex,i)}))}},{key:"componentWillUpdate",value:function componentWillUpdate(){var t=this;Object(x.reaction)((function(){return t.props.page.isAJSRenditionLoded}),(function(i){(Ti()?i:i&&Ve.isUnSharedReview)&&t.setPageProperties()}))}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(t){pt.setPageCurWidth(t.page.pageIndex,t.page.curWidth),pt.setPageCurHeight(t.page.pageIndex,t.page.curHeight),pt.setPageCurZoomLevel(this.props.page.pageIndex,this.props.page.curZoom),pt.setViewRotation(t.page.viewRotation),pt.setPageRotation(t.page.pageIndex,t.page.rotation)}},{key:"render",value:function render(){return Ve.isUnSharedReview&&!this.props.page.isAJSRenditionLoded?null:Qi.a.createElement("div",{__self:this,__source:{fileName:"/build/src/view/CommentsView.jsx",lineNumber:83,columnNumber:7}},Qi.a.createElement(od,{page:this.props.page,pageIndex:this.props.page.pageIndex,api:this.props.api,__self:this,__source:{fileName:"/build/src/view/CommentsView.jsx",lineNumber:84,columnNumber:9}}))}}]),CommentView}(Qi.a.Component))||ed,rd=a("mlPE"),ad=a.n(rd),sd=a("OLJx"),Ad=a.n(sd),ld=a("STrM"),ud=a.n(ld),dd=a("XAIH"),cd=a.n(dd),md=a("QPy5"),hd=a.n(md),pd=a("0umz"),fd=a.n(pd),gd=a("3pQy"),Cd=a.n(gd),vd=a("p1WK"),bd=a.n(vd),yd=a("OMTR"),_d=a.n(yd),Id=a("O7G/"),wd=a.n(Id),Md=a("wnsG"),kd=a.n(Md),Sd=a("UBaW"),Td=a.n(Sd),xd=a("TM95"),Ed=a("ASzY"),Pd=a.n(Ed),Nd=Object(Pa.CustomPicker)((function GradientPicker(t){t.hex;var i=t.hsl,a=t.rgb,A=t.onChange;return Qi.a.createElement("div",{className:Pd.a.gradientpicker,__self:void 0,__source:{fileName:"/build/src/react/components/GradientPicker.jsx",lineNumber:25,columnNumber:8}},Qi.a.createElement("div",{className:Pd.a.alpha,__self:void 0,__source:{fileName:"/build/src/react/components/GradientPicker.jsx",lineNumber:26,columnNumber:3}},Qi.a.createElement(xd.Alpha,{rgb:a,hsl:i,onChange:A,__self:void 0,__source:{fileName:"/build/src/react/components/GradientPicker.jsx",lineNumber:27,columnNumber:5}})))})),Rd=a("/R7o"),Dd=a.n(Rd),Od=a("1ot/"),Ld=a.n(Od),Bd="/build/src/react/components/ColorPickerOverlay.js",Ud=function getColorPickerIconStyle(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{background:t,opacity:i,height:"20px",minWidth:"20px",width:"20px",borderRadius:"50%"}},Fd=Object(ir.inject)("toolBarStore")(td=Object(ir.observer)(td=function(t){Z()(ColorPickerOverlay,t);var i=Q()(ColorPickerOverlay);function ColorPickerOverlay(t){var a;return d()(this,ColorPickerOverlay),(a=i.call(this,t)).handleChangeColor=a.handleChangeColor.bind(Zi()(a)),a}return m()(ColorPickerOverlay,[{key:"handleChangeColor",value:function handleChangeColor(t){var i=this.props,a=i.toolBarStore,A=i.shouldUseModernViewer;a.selectedTool&&a.setToolColor(a.selectedTool,t.hex),A&&a.getEraserSelectionStatus()&&a.setEraserSelection(!1)}},{key:"render",value:function render(){var t,i,a=this,A=this.props,l=A.toolBarStore,u=A.intl,d=A.shouldUseModernViewer,c=l.selectedTool,m=l.getToolColor(c),h=l.getCurrentOpacity(),p=d?u.formatMessage({id:"modernViewerColorpickerTooltip"},{tool:"shape"===c?u.formatMessage({id:"modernViewerColorpickerDrawTooltip"}):c}):u.formatMessage({id:"colorpickerTooltip"});Ti()&&(h=1),m&&(i=Fi.hexToRGB(m,h));var g=d?"right top":"bottom left";return Qi.a.createElement(da.a,{trigger:"click",placement:g,ref:function ref(i){t=i},__self:this,__source:{fileName:Bd,lineNumber:87,columnNumber:7}},Qi.a.createElement(da.a,{trigger:Zn.TOOLTIP_HOVER,placement:Zn.TOOLTIP_RIGHT_PLACEMENT,delayShow:Zn.TOOLTIP_DELAY,__self:this,__source:{fileName:Bd,lineNumber:94,columnNumber:9}},Qi.a.createElement(la.a,{variant:"action",className:cd.a[L.REDHAWK_COMMENT_COLORPICKER],quiet:!0,"aria-label":p,id:L.REDHAWK_COMMENT_COLORPICKER,icon:Qi.a.createElement("div",{style:Ud(m),__self:this,__source:{fileName:Bd,lineNumber:105,columnNumber:19}}),__self:this,__source:{fileName:Bd,lineNumber:99,columnNumber:11}}),Qi.a.createElement(Qr.a,{placement:Zn.TOOLTIP_RIGHT_PLACEMENT,__self:this,__source:{fileName:Bd,lineNumber:107,columnNumber:11}},p)),Qi.a.createElement(Ld.a,{variant:"default",className:cd.a.popover,__self:this,__source:{fileName:Bd,lineNumber:111,columnNumber:9}},Qi.a.createElement(Fa,{onChange:function onChange(i){t.hide(),a.handleChangeColor(i)},color:i,fromTopbar:!0,__self:this,__source:{fileName:Bd,lineNumber:115,columnNumber:11}})))}}]),ColorPickerOverlay}(Ji.Component))||td)||td;Fd.propTypes={toolBarStore:nr.a.objectOf(nr.a.any).isRequired,intl:nr.a.objectOf(nr.a.any).isRequired,shouldUseModernViewer:nr.a.bool},Fd.defaultProps={shouldUseModernViewer:!1};var jd,Hd=Object(Zr.injectIntl)(ya(Fd)),zd=a("xlbI"),Wd=a.n(zd),Vd=a("lmNV"),Yd=a.n(Vd),Kd="/build/src/react/components/ScaleAnnotationSliderOverlay.js",qd=function getHighlightThickessIconStyle(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Qi.a.createElement("div",{style:{backgroundColor:t,backgroundClip:"content-box",opacity:i,height:"8px",width:"8px",borderRadius:"50%",border:"0.5px solid #CECECE",padding:"6px"},__self:void 0,__source:{fileName:Kd,lineNumber:37,columnNumber:3}})},Gd=Object(ir.inject)("toolBarStore")(jd=Object(ir.observer)(jd=function(t){Z()(ScaleAnnotationSliderOverlay,t);var i=Q()(ScaleAnnotationSliderOverlay);function ScaleAnnotationSliderOverlay(t){var a,A;return d()(this,ScaleAnnotationSliderOverlay),(A=i.call(this,t)).getToobarIcon=function(){var t=A.props,i=t.scaleToolName,a=t.toolBarStore,l=A.scaleToolMap[i],u=l.Icon,d=l.isDisabled;if(i===L.REDHAWK_HIGHLIGHT_THICKNESS_SCALE_TOOLNAME){var c=d(a)?"#D3D3D3":a.getToolColor(L.REDHAWK_COMMENT_HIGHLIGHT);return qd(c)}return Qi.a.createElement(u,{__self:Zi()(A),__source:{fileName:Kd,lineNumber:91,columnNumber:12}})},A.scaleToolMap=(a={},l()(a,L.REDHAWK_FONTSIZE_SCALE_TOOLNAME,{toolTip:"fontSizeTooltip",Icon:rs.a,getOldScale:function getOldScale(t){return t.fontSize},handleChange:function handleChange(t,i){return i.setFontSize(t)},maxValue:L.FREETEXT_MAX_FONT_SIZE,labelId:"fontSize"}),l()(a,L.REDHAWK_STROKEWIDTH_SCALE_TOOLNAME,{toolTip:"strokeWidthTooltip",Icon:A.props.shouldUseModernViewer?Yd.a:Wd.a,getOldScale:function getOldScale(t){return t.currentStrokeWidth},handleChange:function handleChange(t,i){return i.setCurrentStrokeWidth(t)},maxValue:L.SHAPE_MAX_STROKE_WIDTH,labelId:"strokeWidth"}),l()(a,L.REDHAWK_HIGHLIGHT_THICKNESS_SCALE_TOOLNAME,{toolTip:"highlightThicknessTooltip",getOldScale:function getOldScale(t){return t.freeHighlightStrokeWidth},handleChange:function handleChange(t,i){return i.setFreeHighlightStrokeWidth(t)},maxValue:L.HIGHLIGHT_MAX_STROKE_WIDTH,labelId:"highlightThickness",isDisabled:function isDisabled(t){return t.isEraserSelected}}),a),A}return m()(ScaleAnnotationSliderOverlay,[{key:"render",value:function render(){var t=this.props,i=t.scaleToolName,a=t.toolBarStore,A=t.intl,l=this.scaleToolMap[i],u=l.toolTip,d=l.getOldScale,c=l.handleChange,m=l.maxValue,h=l.labelId,p=l.isDisabled,g=this.props.shouldUseModernViewer?"right top":"bottom";return Qi.a.createElement(da.a,{trigger:Zn.TOOLTIP_HOVER,placement:Zn.TOOLTIP_RIGHT_PLACEMENT,delayShow:Zn.TOOLTIP_DELAY,__self:this,__source:{fileName:Kd,lineNumber:102,columnNumber:7}},Qi.a.createElement(da.a,{trigger:"click",placement:g,__self:this,__source:{fileName:Kd,lineNumber:107,columnNumber:9}},Qi.a.createElement(la.a,{variant:"action",className:cd.a[L.REDHAWK_COMMENT_SCALE],quiet:!0,"aria-label":A.formatMessage({id:u}),icon:this.getToobarIcon(),disabled:p&&p(a),__self:this,__source:{fileName:Kd,lineNumber:111,columnNumber:11}}),Qi.a.createElement(Ld.a,{variant:"default",className:cd.a.popover,__self:this,__source:{fileName:Kd,lineNumber:119,columnNumber:11}},Qi.a.createElement(_s,{forFontSize:i===L.REDHAWK_FONTSIZE_SCALE_TOOLNAME,oldScale:d(a),onChange:function onChange(t){return c(t,a)},fromTopbar:!0,maxValue:m,labelId:h,__self:this,__source:{fileName:Kd,lineNumber:123,columnNumber:13}}))),Qi.a.createElement(Qr.a,{placement:Zn.TOOLTIP_RIGHT_PLACEMENT,__self:this,__source:{fileName:Kd,lineNumber:133,columnNumber:9}},A.formatMessage({id:u})))}}]),ScaleAnnotationSliderOverlay}(Ji.Component))||jd)||jd;Gd.propTypes={scaleToolName:nr.a.oneOfType([L.REDHAWK_FONTSIZE_SCALE_TOOLNAME,L.REDHAWK_STROKEWIDTH_SCALE_TOOLNAME]).isRequired,toolBarStore:nr.a.objectOf(nr.a.any).isRequired,intl:nr.a.objectOf(nr.a.any).isRequired};var Xd,Zd,Jd,Qd,$d,ec,tc,nc,oc,ic,rc,ac,sc,Ac=Object(Zr.injectIntl)(ya(Gd)),lc=function FontSizeScaleSlider(t){return Qi.a.createElement(Ac,Object.assign({scaleToolName:L.REDHAWK_FONTSIZE_SCALE_TOOLNAME},t,{__self:void 0,__source:{fileName:Kd,lineNumber:153,columnNumber:4}}))},uc=function StrokeWidthScaleSlider(t){return Qi.a.createElement(Ac,Object.assign({scaleToolName:L.REDHAWK_STROKEWIDTH_SCALE_TOOLNAME},t,{__self:void 0,__source:{fileName:Kd,lineNumber:159,columnNumber:4}}))},dc=function HighlightThicknessScaleSlider(t){return Qi.a.createElement(Ac,Object.assign({scaleToolName:L.REDHAWK_HIGHLIGHT_THICKNESS_SCALE_TOOLNAME},t,{__self:void 0,__source:{fileName:Kd,lineNumber:165,columnNumber:4}}))},cc=Ac,mc="/build/src/react/components/CommentsToolBar.jsx",hc=g.logging.getLogger("CommentsToolBar"),pc=Object(ir.inject)("toolBarStore","commentsStore","userProfileStore","commentsDropinStore")(Xd=Object(ir.observer)(Xd=function(t){Z()(CommentsToolBar,t);var i=Q()(CommentsToolBar);function CommentsToolBar(){return d()(this,CommentsToolBar),i.apply(this,arguments)}return m()(CommentsToolBar,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Ti()&&(this.interval=setInterval((function(){return t.setState({time:Date.now()})}),500))}},{key:"componentWillUnmount",value:function componentWillUnmount(){Ti()&&clearInterval(this.interval)}},{key:"getSelectedToolClassName",value:function getSelectedToolClassName(t){return"".concat(t,"Clicked")}},{key:"handleLeftPaneClick",value:function handleLeftPaneClick(){this.props.commentsStore.resetSelectedCommentId()}},{key:"handleClick",value:function handleClick(t){var i=this;if(hc.info("Checking the state of logged in user ".concat(g.auth.isSignedIn)),!this.props.userProfileStore.hasAuth&&!Ti())return oi("Participate","Use","Commenting tool selected",{"adb.event.context.dcweb.clickcontext":"Not signed in"}),deleteVariableValueFromSessionStorage(Fi.getAssetUri()),window.dispatchEvent(new CustomEvent("adobe:comments:hideCoachMark",{bubbles:!0})),this.props.commentsStore.setGuestLoginDownload(!1),Di.apis.eventEmitter.emit("adobe:comments:commentsPanelOpen"),setTimeout((function(){i.props.commentsDropinStore.setShouldShowCommentsPanel(!0)}),0),this.props.commentsStore.setShowPageLevelWelcomeDialog(!0),void this.props.commentsStore.setTriggerAnimationForGuestLogin();var a=t.currentTarget.getAttribute("id");this.isToolSeparatorLine(a)||(this.isToolGradient(a)?this.handleGradientPickerClick(t):this.isUndo(a)?_.getInstance().previewApis.commandManager.undo():this.isRedo(a)?_.getInstance().previewApis.commandManager.redo():(this.props.toolBarStore.showBanner&&(this.props.toolBarStore.setShowBanner(!1),_.getInstance().previewApis.documentActions.clearPageSelection(this.props.toolBarStore.selectedTextPageNo.startPage,this.props.toolBarStore.selectedTextPageNo.endPage),this.props.toolBarStore.resetSelectedTextPageNo()),this.props.toolBarStore.isThisToolSelected(a)?this.props.toolBarStore.resetSelectedTool():(Ti()||Di.apis.eventEmitter.emit("adobe:comments:commentsPanelOpen"),setTimeout((function(){i.props.commentsDropinStore.setShouldShowCommentsPanel(!0)}),0),this.props.toolBarStore.setSelectedTool(a))))}},{key:"handleEraserToolClick",value:function handleEraserToolClick(){this.props.toolBarStore.isThisToolSelected(L.REDHAWK_ERASER)?this.props.toolBarStore.resetSelectedTool():this.props.toolBarStore.setSelectedTool(L.REDHAWK_ERASER)}},{key:"handleGradientPickerClick",value:function handleGradientPickerClick(t){this.props.toolBarStore.invertIsGradientPickerSelected(),t.stopPropagation()}},{key:"handleChangeGradient",value:function handleChangeGradient(t){this.props.toolBarStore.setCurrentOpacity(t.hsl.a)}},{key:"isUndo",value:function isUndo(t){return t===L.REDHAWK_UNDO}},{key:"isRedo",value:function isRedo(t){return t===L.REDHAWK_REDO}},{key:"isToolGradient",value:function isToolGradient(t){return t===L.REDHAWK_COMMENT_GRADIENT}},{key:"isToolSeparatorLine",value:function isToolSeparatorLine(t){return t===L.SEPARATOR_LINE}},{key:"render",value:function render(){var t,i=this,a=_.getInstance().previewApis.commandManager,A=this.props.toolBarStore.getIsGradientPickerSelected(),l=this.props.toolBarStore.getToolColor(this.props.toolBarStore.selectedTool),u=this.props.toolBarStore.getCurrentOpacity();Ti()&&(l=this.props.toolBarStore.getToolColor(this.props.toolBarStore.selectedTool),u=1),l&&(t=Fi.hexToRGB(l,u));var d=this.props.commentsStore.haveCommentsLoaded&&Ei(),c=!d,m=this.props.toolBarStore.selectedTool;return Qi.a.createElement("div",{className:cd.a.toolsBar,onClick:this.handleLeftPaneClick.bind(this),__self:this,__source:{fileName:mc,lineNumber:183,columnNumber:7}},Qi.a.createElement(la.a,{variant:"action",className:Ra()([cd.a[L.REDHAWK_COMMENT_NOTE],m===L.REDHAWK_COMMENT_NOTE&&cd.a.selectedIcon,c&&cd.a.disabledIcon]),onClick:function onClick(t){return i.handleClick(t)},quiet:!0,disabled:!d,id:L.REDHAWK_COMMENT_NOTE,title:this.props.intl.formatMessage({id:"sticyTooltip"}),"aria-label":this.props.intl.formatMessage({id:"sticyTooltip"}),icon:Qi.a.createElement(fd.a,{__self:this,__source:{fileName:mc,lineNumber:202,columnNumber:17}}),__self:this,__source:{fileName:mc,lineNumber:187,columnNumber:9}}),Qi.a.createElement(la.a,{variant:"action",className:Ra()([cd.a[L.REDHAWK_COMMENT_HIGHLIGHT],m===L.REDHAWK_COMMENT_HIGHLIGHT&&cd.a.selectedIcon,c&&cd.a.disabledIcon]),onClick:function onClick(t){return i.handleClick(t)},quiet:!0,disabled:!d,id:L.REDHAWK_COMMENT_HIGHLIGHT,title:this.props.intl.formatMessage({id:"highlightTooltip"}),"aria-label":this.props.intl.formatMessage({id:"highlightTooltip"}),icon:Qi.a.createElement(hd.a,{__self:this,__source:{fileName:mc,lineNumber:219,columnNumber:17}}),__self:this,__source:{fileName:mc,lineNumber:204,columnNumber:9}}),Qi.a.createElement(la.a,{variant:"action",className:Ra()([cd.a[L.REDHAWK_COMMENT_UNDERLINE],m===L.REDHAWK_COMMENT_UNDERLINE&&cd.a.selectedIcon,c&&cd.a.disabledIcon]),onClick:function onClick(t){return i.handleClick(t)},quiet:!0,disabled:!d,id:L.REDHAWK_COMMENT_UNDERLINE,title:this.props.intl.formatMessage({id:"underlineTooltip"}),"aria-label":this.props.intl.formatMessage({id:"underlineTooltip"}),icon:Qi.a.createElement(bd.a,{__self:this,__source:{fileName:mc,lineNumber:236,columnNumber:17}}),__self:this,__source:{fileName:mc,lineNumber:221,columnNumber:9}}),Qi.a.createElement(la.a,{variant:"action",className:Ra()([cd.a[L.REDHAWK_COMMENT_STRIKEOUT],m===L.REDHAWK_COMMENT_STRIKEOUT&&cd.a.selectedIcon,c&&cd.a.disabledIcon]),onClick:function onClick(t){return i.handleClick(t)},quiet:!0,disabled:!d,id:L.REDHAWK_COMMENT_STRIKEOUT,title:this.props.intl.formatMessage({id:"strikethroughTooltip"}),"aria-label":this.props.intl.formatMessage({id:"strikethroughTooltip"}),icon:Qi.a.createElement(Cd.a,{__self:this,__source:{fileName:mc,lineNumber:253,columnNumber:17}}),__self:this,__source:{fileName:mc,lineNumber:238,columnNumber:9}}),this.props.toolBarStore.isFreetextEnabled&&Qi.a.createElement(la.a,{variant:"action",className:Ra()([cd.a[L.REDHAWK_COMMENT_FREETEXT],m===L.REDHAWK_COMMENT_FREETEXT&&cd.a.selectedIcon,c&&cd.a.disabledIcon]),onClick:function onClick(t){return i.handleClick(t)},quiet:!0,disabled:!d,id:L.REDHAWK_COMMENT_FREETEXT,title:this.props.intl.formatMessage({id:"freetextTooltip"}),"aria-label":this.props.intl.formatMessage({id:"freetextTooltip"}),icon:Qi.a.createElement(wd.a,{__self:this,__source:{fileName:mc,lineNumber:273,columnNumber:21}}),__self:this,__source:{fileName:mc,lineNumber:258,columnNumber:13}}),Qi.a.createElement(la.a,{variant:"action",className:Ra()([cd.a[L.REDHAWK_COMMENT_SHAPE],m===L.REDHAWK_COMMENT_SHAPE&&cd.a.selectedIcon,c&&cd.a.disabledIcon]),onClick:function onClick(t){return i.handleClick(t)},quiet:!0,disabled:!d,id:L.REDHAWK_COMMENT_SHAPE,title:this.props.intl.formatMessage({id:"shapeTooltip"}),"aria-label":this.props.intl.formatMessage({id:"shapeTooltip"}),icon:Qi.a.createElement(_d.a,{__self:this,__source:{fileName:mc,lineNumber:291,columnNumber:17}}),__self:this,__source:{fileName:mc,lineNumber:276,columnNumber:9}}),this.props.toolBarStore.isEraserToolEnabled&&Qi.a.createElement(la.a,{variant:"action",className:Ra()([cd.a[L.REDHAWK_ERASER],m===L.REDHAWK_ERASER&&cd.a.selectedIcon,c&&cd.a.disabledIcon]),onClick:function onClick(){return i.handleEraserToolClick()},quiet:!0,disabled:!d,id:L.REDHAWK_ERASER,title:this.props.intl.formatMessage({id:"eraserTooltip"}),"aria-label":this.props.intl.formatMessage({id:"eraserTooltip"}),icon:Qi.a.createElement(Dd.a,{__self:this,__source:{fileName:mc,lineNumber:311,columnNumber:19}}),__self:this,__source:{fileName:mc,lineNumber:296,columnNumber:11}}),this.props.toolBarStore.isToolSelected()&&!this.props.toolBarStore.isThisToolSelected(L.REDHAWK_ERASER)&&Qi.a.createElement(Qi.a.Fragment,{__self:this,__source:{fileName:mc,lineNumber:317,columnNumber:13}},Qi.a.createElement("div",{className:cd.a[L.SEPARATOR_LINE],__self:this,__source:{fileName:mc,lineNumber:318,columnNumber:15}}),Qi.a.createElement(Hd,Object.assign({},this.props,{__self:this,__source:{fileName:mc,lineNumber:319,columnNumber:15}})),A&&Qi.a.createElement(Nd,{onChangeComplete:this.handleChangeGradient.bind(this),color:t,__self:this,__source:{fileName:mc,lineNumber:322,columnNumber:17}}),Ti()&&(this.props.toolBarStore.isThisToolSelected(L.REDHAWK_COMMENT_FREETEXT)||this.props.toolBarStore.isThisToolSelected(L.REDHAWK_COMMENT_SHAPE)||this.props.toolBarStore.isThisToolSelected(L.REDHAWK_COMMENT_HIGHLIGHT))&&Qi.a.createElement(cc,Object.assign({scaleToolName:this.props.toolBarStore.isThisToolSelected(L.REDHAWK_COMMENT_FREETEXT)?L.REDHAWK_FONTSIZE_SCALE_TOOLNAME:L.REDHAWK_STROKEWIDTH_SCALE_TOOLNAME},this.props,{__self:this,__source:{fileName:mc,lineNumber:330,columnNumber:17}}))),Ti()&&Qi.a.createElement(Qi.a.Fragment,{__self:this,__source:{fileName:mc,lineNumber:343,columnNumber:13}},Qi.a.createElement("div",{className:cd.a[L.SEPARATOR_LINE],__self:this,__source:{fileName:mc,lineNumber:344,columnNumber:15}}),Qi.a.createElement(la.a,{variant:"action",className:Ra()([cd.a[L.REDHAWK_UNDO],!a.hasUndoCommand()&&cd.a.disabledIcon]),onClick:function onClick(t){return i.handleClick(t)},quiet:!0,disabled:!a.hasUndoCommand(),id:L.REDHAWK_UNDO,title:this.props.intl.formatMessage({id:"undoTooltip"}),"aria-label":this.props.intl.formatMessage({id:"undoTooltip"}),icon:Qi.a.createElement(Td.a,{__self:this,__source:{fileName:mc,lineNumber:359,columnNumber:23}}),__self:this,__source:{fileName:mc,lineNumber:345,columnNumber:15}}),Qi.a.createElement(la.a,{variant:"action",className:Ra()([cd.a[L.REDHAWK_REDO],!a.hasRedoCommand()&&cd.a.disabledIcon]),onClick:function onClick(t){return i.handleClick(t)},quiet:!0,disabled:!a.hasRedoCommand(),id:L.REDHAWK_REDO,title:this.props.intl.formatMessage({id:"redoTooltip"}),"aria-label":this.props.intl.formatMessage({id:"redoTooltip"}),icon:Qi.a.createElement(kd.a,{__self:this,__source:{fileName:mc,lineNumber:375,columnNumber:23}}),__self:this,__source:{fileName:mc,lineNumber:361,columnNumber:15}})))}}]),CommentsToolBar}(Qi.a.Component))||Xd)||Xd,fc=Object(Zr.injectIntl)(pc),gc="/build/src/react/components/CommentsHeaderBar.jsx",Cc=Object(ir.inject)("ReviewStore","pageStore","commentsDropinStore")(Zd=Object(ir.observer)((Jd=function(t){Z()(CommentsHeaderBar,t);var i=Q()(CommentsHeaderBar);function CommentsHeaderBar(){return d()(this,CommentsHeaderBar),i.apply(this,arguments)}return m()(CommentsHeaderBar,[{key:"windowInnerWidth",get:function get(){return this.props.pageStore.windowInnerWidth}},{key:"render",value:function render(){var t,i;this.props.ReviewStore.reviewExist&&(Di.reviewParticipantsComponent,t=Di.reviewFinishedComponent,i=Di.reviewOpenInAcrobatView);var a={};return a={top:"64px"},Qi.a.createElement("div",{className:cd.a.toolsBarContainer,style:a,__self:this,__source:{fileName:gc,lineNumber:49,columnNumber:15}},Qi.a.createElement("div",{className:cd.a.CommentsHeaderBarGrid,__self:this,__source:{fileName:gc,lineNumber:50,columnNumber:9}},Qi.a.createElement("div",{className:cd.a.commentSection,__self:this,__source:{fileName:gc,lineNumber:51,columnNumber:11}},Qi.a.createElement(fc,{__self:this,__source:{fileName:gc,lineNumber:52,columnNumber:13}})),Qi.a.createElement("div",{className:cd.a.rightSection,__self:this,__source:{fileName:gc,lineNumber:54,columnNumber:11}},i,t)))}}]),CommentsHeaderBar}(Qi.a.Component),T()(Jd.prototype,"windowInnerWidth",[x.computed],Object.getOwnPropertyDescriptor(Jd.prototype,"windowInnerWidth"),Jd.prototype),Zd=Jd))||Zd)||Zd,vc=a("p/6q"),bc=a.n(vc),yc=a("6QqN"),_c=a.n(yc),Ic=a("ENCa"),wc=a.n(Ic),Mc=a("WBIv"),kc=a.n(Mc),Sc="/build/src/react/components/FTEView.jsx",Tc=Object(ir.inject)("pageStore","commentsStore","FiltersStore","commentsDropinStore")(Qd=Object(ir.observer)(Qd=function(t){Z()(CommentEllipsisPanel,t);var i=Q()(CommentEllipsisPanel);function CommentEllipsisPanel(){return d()(this,CommentEllipsisPanel),i.apply(this,arguments)}return m()(CommentEllipsisPanel,[{key:"handleMouseUp",value:function handleMouseUp(t){t.stopPropagation()}},{key:"showFTE",value:function showFTE(){return this.props.commentsStore.haveCommentsLoaded&&0===this.props.commentsStore.comments.length&&0===this.props.commentsStore.unsavedAnnotList.length}},{key:"render",value:function render(){var t=this,i=st(window.innerHeight)/2-L.HEIGHT_OF_TOP_BAR;this.props.commentsDropinStore.frictionlessPanelVisible&&(i-=75),Ti()&&(i=i<120?120:i),this.props.commentsDropinStore.showCommentSuggestions&&(i+=20);var a=0===this.props.FiltersStore.noOfFilteredCommentComputed&&this.props.FiltersStore.appliedFilterCount>0;return Qi.a.createElement(Qi.a.Fragment,{__self:this,__source:{fileName:Sc,lineNumber:56,columnNumber:7}},Ti()?Qi.a.createElement("div",{className:kc.a.rootDiv,onMouseUp:function onMouseUp(i){return t.handleMouseUp(i)},style:{top:"".concat(i,"px")},__self:this,__source:{fileName:Sc,lineNumber:59,columnNumber:13}},this.showFTE()&&Qi.a.createElement(Qi.a.Fragment,{__self:this,__source:{fileName:Sc,lineNumber:65,columnNumber:17}},Qi.a.createElement("div",{className:kc.a.FTEImagePC,__self:this,__source:{fileName:Sc,lineNumber:66,columnNumber:19}},Qi.a.createElement(_c.a,{__self:this,__source:{fileName:Sc,lineNumber:67,columnNumber:21}})),Qi.a.createElement("div",{className:kc.a.textDivPC,__self:this,__source:{fileName:Sc,lineNumber:69,columnNumber:19}},Qi.a.createElement("p",{className:kc.a.firstPara,__self:this,__source:{fileName:Sc,lineNumber:70,columnNumber:21}}," ",this.props.intl.formatMessage({id:"FTEView.firstLine"})," "),Qi.a.createElement("p",{__self:this,__source:{fileName:Sc,lineNumber:71,columnNumber:21}},this.props.intl.formatMessage({id:"FTEView.pc.secondLine"})))),!this.props.commentsStore.haveCommentsLoaded&&Qi.a.createElement(bc.a,{size:"L",className:kc.a.spinner,__self:this,__source:{fileName:Sc,lineNumber:80,columnNumber:65}})):Qi.a.createElement(Qi.a.Fragment,{__self:this,__source:{fileName:Sc,lineNumber:83,columnNumber:13}},this.showFTE()?Qi.a.createElement("div",{className:kc.a.rootDiv,onMouseUp:function onMouseUp(i){return t.handleMouseUp(i)},style:{top:"".concat(i,"px")},__self:this,__source:{fileName:Sc,lineNumber:86,columnNumber:19}},Qi.a.createElement("div",{className:kc.a.FTEImage,__self:this,__source:{fileName:Sc,lineNumber:91,columnNumber:21}},Qi.a.createElement(_c.a,{__self:this,__source:{fileName:Sc,lineNumber:92,columnNumber:23}})),Qi.a.createElement("div",{className:kc.a.textDiv,__self:this,__source:{fileName:Sc,lineNumber:94,columnNumber:21}},Qi.a.createElement("p",{className:kc.a.firstPara,__self:this,__source:{fileName:Sc,lineNumber:95,columnNumber:23}}," ",this.props.intl.formatMessage({id:"FTEView.firstLine"})," "),Qi.a.createElement("p",{__self:this,__source:{fileName:Sc,lineNumber:96,columnNumber:23}},this.props.intl.formatMessage({id:"FTEView.secondLine"})))):a?Qi.a.createElement("div",{className:kc.a.rootDiv,onMouseUp:function onMouseUp(i){return t.handleMouseUp(i)},style:{top:"".concat(i,"px")},__self:this,__source:{fileName:Sc,lineNumber:104,columnNumber:21}},Qi.a.createElement("div",{className:kc.a.NoFilterResultImage,__self:this,__source:{fileName:Sc,lineNumber:109,columnNumber:23}},Qi.a.createElement(wc.a,{__self:this,__source:{fileName:Sc,lineNumber:110,columnNumber:25}})),Qi.a.createElement("div",{className:kc.a.textDiv,__self:this,__source:{fileName:Sc,lineNumber:112,columnNumber:23}},Qi.a.createElement("p",{__self:this,__source:{fileName:Sc,lineNumber:113,columnNumber:25}}," ",this.props.intl.formatMessage({id:"filters.noResult"})," "))):""))}}]),CommentEllipsisPanel}(Qi.a.Component))||Qd)||Qd,xc=Object(Zr.injectIntl)(Tc),Ec=a("O8d1"),Pc=a.n(Ec),Nc=Object(ir.inject)("FiltersStore","commentSyncStore","commentsDropinStore")($d=function(t){Z()(NotificationMessageView,t);var i=Q()(NotificationMessageView);function NotificationMessageView(){return d()(this,NotificationMessageView),i.apply(this,arguments)}return m()(NotificationMessageView,[{key:"onClick",value:function onClick(t){var i=this.props,a=i.commentsDropinStore,A=i.commentSyncStore,l=i.FiltersStore;a.setShouldShowCommentsPanel(!0),A.setIsNotificationAvailable(!1),l.resetFilterCache(),l.updateLastFilterChangeTime((new Date).getTime()),l.setunAppliedunreadCommentsButtonGroup(["unreadComments"]),l.setApplyFilters()}},{key:"render",value:function render(){var t=this,i=this.props.commentSyncStore.getUnreadCommentsCount(),a=1===i?this.props.intl.formatMessage({id:"unreadNotification"},{num:i}):this.props.intl.formatMessage({id:"unreadNotifications"},{num:i});return Qi.a.createElement("div",{onClick:function onClick(i){return t.onClick(i)},__self:this,__source:{fileName:"/build/src/react/components/NotificationMessageView.jsx",lineNumber:43,columnNumber:7}},a)}}]),NotificationMessageView}(Qi.a.Component))||$d,Rc=Object(Zr.injectIntl)(Nc),Dc=Object(ir.inject)("FiltersStore","commentsStore")(ec=function(t){Z()(UnsavedNotificationMessageView,t);var i=Q()(UnsavedNotificationMessageView);function UnsavedNotificationMessageView(t){return d()(this,UnsavedNotificationMessageView),i.call(this,t)}return m()(UnsavedNotificationMessageView,[{key:"onClick",value:function onClick(t){this.props.commentsStore.setShowAuthFailedNotification(!1),window.location.reload(!0)}},{key:"render",value:function render(){var t=this,i=this.props.intl.formatMessage({id:"unsavedNotifications"});return Qi.a.createElement("div",{onClick:function onClick(i){return t.onClick(i)},__self:this,__source:{fileName:"/build/src/react/components/UnsavedNotificationMessageView.jsx",lineNumber:36,columnNumber:7}},i)}}]),UnsavedNotificationMessageView}(Qi.a.Component))||ec,Oc=Object(Zr.injectIntl)(Dc),Lc="/build/src/react/components/InAppNotificationView.jsx",Bc=Object(ir.inject)("FiltersStore","commentSyncStore","commentsStore")(tc=Object(ir.observer)(tc=function(t){Z()(InAppNotificationView,t);var i=Q()(InAppNotificationView);function InAppNotificationView(t){return d()(this,InAppNotificationView),i.call(this,t)}return m()(InAppNotificationView,[{key:"componentDidUpdate",value:function componentDidUpdate(){var t=this;this.props.commentSyncStore.isNotificationAvailable&&setTimeout((function(){t.props.commentSyncStore.setIsNotificationAvailable(!1)}),1e4)}},{key:"onUnreadToastClose",value:function onUnreadToastClose(){this.props.commentSyncStore.setIsNotificationAvailable(!1)}},{key:"onUnsavedToastClose",value:function onUnsavedToastClose(){this.props.commentsStore.setShowAuthFailedNotification(!1)}},{key:"render",value:function render(){var t=this,i=this.props.commentSyncStore.isNotificationAvailable&&this.props.commentSyncStore.getUnreadCommentsCount(),a=this.props.commentsStore.showAuthFailedNotification;return Qi.a.createElement("div",{className:Pc.a.toast,__self:this,__source:{fileName:Lc,lineNumber:55,columnNumber:13}},a?Qi.a.createElement(y.Toast,{closable:!0,variant:"warning",onClose:function onClose(i){return t.onUnsavedToastClose(i)},__self:this,__source:{fileName:Lc,lineNumber:59,columnNumber:13}},Qi.a.createElement(Oc,{__self:this,__source:{fileName:Lc,lineNumber:60,columnNumber:15}})):i?Qi.a.createElement(y.Toast,{closable:!0,variant:"info",onClose:function onClose(i){return t.onUnreadToastClose(i)},__self:this,__source:{fileName:Lc,lineNumber:67,columnNumber:17}},Qi.a.createElement(Rc,{__self:this,__source:{fileName:Lc,lineNumber:68,columnNumber:19}})):"")}}]),InAppNotificationView}(Qi.a.Component))||tc)||tc,Uc=new(nc=function(){function MoreCommentsStore(){var t=this;d()(this,MoreCommentsStore),M()(this,"firstCommentInView",oc,this),M()(this,"lastCommentInView",ic,this),M()(this,"moreUpCommentsCount",rc,this),M()(this,"moreDownCommentsCount",ac,this),Object(x.reaction)((function(){return Ct.commentPopupAnimatedCount}),(function(){t.findCommentsInViews()}))}return m()(MoreCommentsStore,[{key:"updateFirstCommentInView",value:function updateFirstCommentInView(t){this.firstCommentInView!==t&&(this.firstCommentInView=t)}},{key:"updateLastCommentInView",value:function updateLastCommentInView(t){this.lastCommentInView!==t&&(this.lastCommentInView=t)}},{key:"setMoreUpCommentsCount",value:function setMoreUpCommentsCount(t){this.moreUpCommentsCount=t}},{key:"setMoreDownCommentsCount",value:function setMoreDownCommentsCount(t){this.moreDownCommentsCount=t}},{key:"findCommentsInViews",value:function findCommentsInViews(t){this.setFirstCommentInOrAboveView(),this.setLastCommentInOrBelowView(t)}},{key:"setFirstCommentInOrAboveView",value:function setFirstCommentInOrAboveView(){var t,i=Ct.commentsPosition,a=i.length,A=0;if(A=0,0===a)return this.setMoreUpCommentsCount(0),void this.updateFirstCommentInView(void 0);if(!i[A].viewRef||Fi.isElementAboveBottomViewport(i[A].viewRef.getBoundingClientRect().top)){for(;A<a&&i[A].viewRef&&i[A].viewRef.getBoundingClientRect().top<0;)A++;this.setMoreUpCommentsCount(A),A===a&&(A-=1),t=i[A],this.updateFirstCommentInView(t)}else this.updateFirstCommentInView(void 0)}},{key:"countUnmountedComments",value:function countUnmountedComments(){for(var t=Ve.totalPageCount,i=0,a=0;a<t&&!_.getInstance().previewApis.documentState.isPageMounted(a);a++){var A=$o.commentUIModels.get(a);i+=A?A.length:0}return i}},{key:"setLastCommentInOrBelowView",value:function setLastCommentInOrBelowView(){var t,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,A=ei.shouldUseModernViewer,l=Ct.commentsPosition;if(0===(t=A?l.length:Ti()?$o.allCommentsCount:l.length))return this.updateFirstCommentInView(void 0),void this.setMoreDownCommentsCount(0);i=A?0:Ti()?this.countUnmountedComments():0;var u=this.firstCommentInView;!u&&l.length&&l[0]&&(u=l[0]);var d=-1;u&&(d=l.findIndex((function(t){return t.commentId===u.commentId})));var c,m,h,p=0;for(m=A||Ti()?0:d,h=A||Ti()?t:0;m>-1&&m<l.length&&l[m].viewRef&&(p=l[m].viewRef.getBoundingClientRect().top,Fi.isElementAboveBottomViewport(p));)m++;0===m&&l.length&&l[m]&&l[m].viewRef&&!Fi.isElementAboveBottomViewport(l[m].viewRef.getBoundingClientRect().top)?h=t:m>0&&(h=t-(m-=1)-1),this.setMoreDownCommentsCount(h-i+a),c=m>=0&&m<l.length?l[m]:void 0,this.updateLastCommentInView(c)}}]),MoreCommentsStore}(),oc=T()(nc.prototype,"firstCommentInView",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ic=T()(nc.prototype,"lastCommentInView",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rc=T()(nc.prototype,"moreUpCommentsCount",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return 0}}),ac=T()(nc.prototype,"moreDownCommentsCount",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return 0}}),T()(nc.prototype,"updateFirstCommentInView",[x.action],Object.getOwnPropertyDescriptor(nc.prototype,"updateFirstCommentInView"),nc.prototype),T()(nc.prototype,"updateLastCommentInView",[x.action],Object.getOwnPropertyDescriptor(nc.prototype,"updateLastCommentInView"),nc.prototype),T()(nc.prototype,"setMoreUpCommentsCount",[x.action],Object.getOwnPropertyDescriptor(nc.prototype,"setMoreUpCommentsCount"),nc.prototype),T()(nc.prototype,"setMoreDownCommentsCount",[x.action],Object.getOwnPropertyDescriptor(nc.prototype,"setMoreDownCommentsCount"),nc.prototype),nc),Fc=a("Es2Q"),jc=a.n(Fc),Hc=a("EXcf"),zc=a.n(Hc),Wc="/build/src/react/components/MoreDownCommentsView.jsx",Vc=Object(ir.observer)(sc=function(t){Z()(MoreDownCommentsView,t);var i=Q()(MoreDownCommentsView);function MoreDownCommentsView(){var t;return d()(this,MoreDownCommentsView),(t=i.call(this)).handleDownClick=Ti()?t.handleClickPersonalCommenting.bind(Zi()(t)):t.handleClickEureka.bind(Zi()(t)),t}return m()(MoreDownCommentsView,[{key:"handleClickEureka",value:function handleClickEureka(){var t=Uc.lastCommentInView,i=Ct.commentsPosition.findIndex((function(i){return i.commentId===t.commentId})),a=i;i<Ct.commentsPosition.length-1&&Fi.isElementAboveBottomViewport(Ct.commentsPosition[a].viewRef.getBoundingClientRect().top)&&(a=i+1);var A=Ct.commentsPosition[a].commentId;deleteVariableValueFromSessionStorage(Fi.getAssetUri()),$o.setShowPageLevelWelcomeDialog(!1),$o.resetSelectedCommentId(),$o.setSelectedCommentId(A),Ct.commentsPosition[a].viewRef.dispatchEvent(new CustomEvent("bringCommentPopupInView"))}},{key:"findNearestPageBelowWithComment",value:function findNearestPageBelowWithComment(t){return new Promise((function(i,a){var A;(t?Promise.resolve(t.pageIndex+1):_.getInstance().previewApis.documentState.getCurrentPage()).then((function(t){A=t;for(var a=Ve.totalPageCount;A<a;){var l=$o.commentUIModels.get(A);if(l&&l.length){i(A);break}A++}A===a&&i(-1)}))}))}},{key:"handleClickPersonalCommenting",value:function handleClickPersonalCommenting(){var t,i,a,A=Uc.lastCommentInView,l=!1;if(A){var u=Ct.commentsPosition.findIndex((function(t){return t.commentId===A.commentId}));i=u,a=Ct.commentsPosition[i].viewRef,u<Ct.commentsPosition.length-1&&a&&Fi.isElementAboveBottomViewport(a.getBoundingClientRect().top)&&(i=u+1),(t=Ct.commentsPosition[i].commentId)&&(a=Ct.commentsPosition[i].viewRef,t===A.commentId&&a&&Fi.isElementAboveBottomViewport(a.getBoundingClientRect().top)||(l=!0))}l?($o.resetSelectedCommentId(),$o.setSelectedCommentId(t),(a=Ct.commentsPosition[i].viewRef)&&a.dispatchEvent(new CustomEvent("bringCommentPopupInView"))):this.findNearestPageBelowWithComment(A).then((function(t){t>=0&&t<Ve.totalPageCount&&(_.getInstance().previewApis.documentActions.goToLocation({pageIndex:t,left:0,top:0}),setTimeout((function(){var i,A,l=Ct.commentsPosition;for(A=0;A<l.length;A++){var u=l[A];if(u&&u.pageIndex===t){i=u;break}}if(i){var d=i.commentId,c=A;$o.resetSelectedCommentId(),$o.setSelectedCommentId(d),(a=Ct.commentsPosition[c].viewRef)&&a.dispatchEvent(new CustomEvent("bringCommentPopupInView"))}}),0))}))}},{key:"render",value:function render(){if(Uc.moreDownCommentsCount<=0)return null;var t,i=Uc.moreDownCommentsCount;return t=i>1?"moreComments":"moreComment",Qi.a.createElement("div",{className:ei.shouldUseModernViewer?zc.a.moreDownCommentsModern:zc.a.moreDownCommentsContainer,onClick:this.handleClick,"data-testid":"NMoreComments",__self:this,__source:{fileName:Wc,lineNumber:168,columnNumber:7}},Qi.a.createElement(da.a,{placement:"bottom",trigger:"hover",__self:this,__source:{fileName:Wc,lineNumber:169,columnNumber:9}},Qi.a.createElement(la.a,{variant:"action",className:zc.a.downArrow,quiet:!0,style:{width:"100%"},icon:Qi.a.createElement(jc.a,{className:zc.a.downArrowIcon,__self:this,__source:{fileName:Wc,lineNumber:175,columnNumber:19}}),onClick:this.handleDownClick,__self:this,__source:{fileName:Wc,lineNumber:170,columnNumber:11}},Qi.a.createElement("div",{className:zc.a.moreDownCommentsCount,__self:this,__source:{fileName:Wc,lineNumber:178,columnNumber:13}},this.props.intl.formatMessage({id:t},{num:i}))),Qi.a.createElement(Qr.a,{className:zc.a.tooltip,__self:this,__source:{fileName:Wc,lineNumber:182,columnNumber:11}},this.props.intl.formatMessage({id:"moreDownCommentsTooltip"}))))}}]),MoreDownCommentsView}(Qi.a.Component))||sc,Yc=Object(Zr.injectIntl)(Vc),Kc=function(t){Z()(MoreCommentsView,t);var i=Q()(MoreCommentsView);function MoreCommentsView(t){var a;return d()(this,MoreCommentsView),a=i.call(this),!ei.shouldUseModernViewer&&Je.apis.documentEvents.on("pagesViewScrolled",a.pagesViewScrolled.bind(Zi()(a))),a}return m()(MoreCommentsView,[{key:"pagesViewScrolled",value:function pagesViewScrolled(){Uc.findCommentsInViews()}},{key:"render",value:function render(){return Qi.a.createElement("div",{__self:this,__source:{fileName:"/build/src/react/components/MoreCommentsView.jsx",lineNumber:39,columnNumber:7}},Qi.a.createElement(Yc,{shouldUseModernViewer:ei.shouldUseModernViewer,__self:this,__source:{fileName:"/build/src/react/components/MoreCommentsView.jsx",lineNumber:40,columnNumber:9}}))}}]),MoreCommentsView}(Qi.a.Component),qc=a("eCkp"),Gc=a.n(qc),Xc=function(){function CreatePageLevelCommentCommand(t,i,a,A,l,u,c){d()(this,CreatePageLevelCommentCommand),this.content=t,this.mentions=i,this.userProfileStore=a,this.toolBarStore=A,this.commentsStore=l,this.pageIndex=c,this.pageStore=u,this.commentShift=Ti()?0:5*u.commentNumber,this.comment=void 0,this.commentsUtil=Fi.getInstance()}return m()(CreatePageLevelCommentCommand,[{key:"executeOnUi",value:function executeOnUi(){var t=this.pageStore.getPageSize(this.pageIndex),i=this.toolBarStore.getCurrentColor(),a=this.toolBarStore.getCurrentOpacity(),A=this.userProfileStore.getUserProfile(),l=this.commentsUtil.getCreatorDetailsForCommentFromUserProfile(A,L.PERSON),u=this.commentsUtil.createSelectorWithCommonAttributes(this.pageIndex,i,a,L.DEFAULT_REDHAWK_COMMENT_TYPE),d=L.STICKY_SERVER_HEIGHT_WIDTH,c=[t.right-d-this.commentShift,t.top-d,t.right-this.commentShift,t.top];u.subtype=L.REDHAWK_COMMENT_NOTE,u.boundingBox=c,u.noteX=c[0],u.noteY=c[3];var m=this.commentsUtil.createCommentModel(this.content,this.mentions,u,l);m.isPageLevelAnnot=!0;var h=this.commentsStore.addCommentsToPage(this.pageIndex,m);this.commentsStore.addToUnsavedAnnotList(h.id,h.motivation),this.comment=h}},{key:"executeOnServer",value:function executeOnServer(){this.commentsStore.saveCommentToServer(this.pageIndex,this.comment),this.comment.resetSyncPending(),this.comment.setSyncWithServer(!0),this.commentsStore.setSelectedCommentId(this.comment.id)}},{key:"execute",value:function execute(){this.executeOnUi(),this.executeOnServer()}},{key:"undoOnUi",value:function undoOnUi(){this.commentsStore.deleteComment(this.comment,this.pageIndex)}},{key:"undoOnServer",value:function undoOnServer(){this.commentsStore.deleteCommentFromPageUIModel(this.comment.cid,this.pageIndex),this.commentsStore.removeFromUnsavedAnnotList(this.comment.id,this.comment.motivation)}},{key:"undo",value:function undo(){this.undoOnUi(),this.undoOnServer()}},{key:"redoOnUi",value:function redoOnUi(){var t=this.commentsUtil.getCurrentTimeStamp();this.comment.setModified(t),this.comment.setCreated(t),this.commentsStore.readdCommentsToPage(this.pageIndex,this.comment)}},{key:"redoOnServer",value:function redoOnServer(){this.commentsStore.saveCommentToServer(this.pageIndex,this.comment,!0),this.comment.resetSyncPending(),this.comment.setSyncWithServer(!0),this.comment.resetUnsavedReplyBody(),this.comment.setIsReplying(!1)}},{key:"redo",value:function redo(){this.redoOnUi(),this.redoOnServer()}}]),CreatePageLevelCommentCommand}();function _getUserPrefs(){return(_getUserPrefs=W()(H.a.mark((function _callee(t,i){var a,A,l,u=arguments;return H.a.wrap((function _callee$(d){for(;;)switch(d.prev=d.next){case 0:if(a=u.length>2&&void 0!==u[2]?u[2]:"comments",!g.auth.isSignedIn){d.next=14;break}return d.prev=2,d.next=5,g.providers["dcweb-prefs"]();case 5:l=d.sent,A=l.getPref(a,t,i),d.next=12;break;case 9:d.prev=9,d.t0=d.catch(2),A=i;case 12:d.next=16;break;case 14:A=(A=getVariableValueFromStorage("".concat(a,".").concat(t)))?JSON.parse(A):i;case 16:return d.abrupt("return",A);case 17:case"end":return d.stop()}}),_callee,null,[[2,9]])})))).apply(this,arguments)}function _setUserPrefs(){return(_setUserPrefs=W()(H.a.mark((function _callee2(t,i){var a,A=arguments;return H.a.wrap((function _callee2$(l){for(;;)switch(l.prev=l.next){case 0:if(a=A.length>2&&void 0!==A[2]?A[2]:"comments",!g.auth.isSignedIn){l.next=13;break}return l.prev=2,l.next=5,g.providers["dcweb-prefs"]();case 5:l.sent.setPref(a,t,i),l.next=11;break;case 9:l.prev=9,l.t0=l.catch(2);case 11:l.next=14;break;case 13:storeVariableValueIntoStorage("".concat(a,".").concat(t),JSON.stringify(i));case 14:case"end":return l.stop()}}),_callee2,null,[[2,9]])})))).apply(this,arguments)}var Zc=a("foFY"),Jc=a.n(Zc),Qc=function MentionsTool(t){var i=t.useModernView,a=t.onMentionsClick,A=t.intl.formatMessage;return Qi.a.createElement("td",{"aria-labelledby":A({id:"mentionsTooltip"}),title:A({id:"mentionsTooltip"}),className:i?Jc.a.ModernMentionsTool:Jc.a.MentionsTool,__self:void 0,__source:{fileName:"/build/src/comments/ModernEditableTextComponent/Tools/MentionsTool.jsx",lineNumber:9,columnNumber:3}},Qi.a.createElement(la.a,{"aria-label":A({id:"mentionsTooltip"}),label:"@",onClick:a,quiet:!0,variant:"action",__self:void 0,__source:{fileName:"/build/src/comments/ModernEditableTextComponent/Tools/MentionsTool.jsx",lineNumber:14,columnNumber:5}}))};Qc.propTypes={intl:Zr.intlShape,useModernView:nr.a.bool,onMentionsClick:nr.a.func.isRequired},Qc.defaultProps={intl:Zr.intlShape,useModernView:!1};var $c=Object(Zr.injectIntl)(Qc),em="/build/src/comments/ModernEditableTextComponent/Tools/CancelTool.jsx",tm=function CancelTool(t){var i=t.useModernView,a=t.motivation,A=t.commentSubtype,l=t.onCancelClick,u=t.intl.formatMessage,d=a===L.MOTIVATION_COMMENTING?L.REPLY:L.NOTE,c=i?Jc.a.ModernCancelTool:Jc.a.CancelTool;return Qi.a.createElement("td",{className:c,__self:void 0,__source:{fileName:em,lineNumber:41,columnNumber:5}},Qi.a.createElement(la.a,{label:u({id:"editableTextCompnent.cancel"}),onClick:function handleClick(t){l(t),oi("Commenting","CommentingList","ClickCancelButton",{"adb.event.context.dc.parentAnnot":A,"adb.event.context.dc.posttype":d})},"data-test-id":"cancel_tool_button",quiet:!0,variant:"action",__self:void 0,__source:{fileName:em,lineNumber:42,columnNumber:7}}))};tm.propTypes={intl:Zr.intlShape,useModernView:nr.a.bool,motivation:nr.a.string,commentSubtype:nr.a.string,onCancelClick:nr.a.func.isRequired},tm.defaultProps={intl:Zr.intlShape,useModernView:!1,motivation:"",commentSubtype:""};var nm=Object(Zr.injectIntl)(tm),om="/build/src/comments/ModernEditableTextComponent/Tools/PostTool.jsx",im=function PostTool(t){var i=t.useModernView,a=t.motivation,A=t.onPostClick,l=t.commentSubtype,u=t.intl.formatMessage,d=t.isPostDisabled,c=t.replyCount,m=i?Jc.a.ModernPostTool:"";return Qi.a.createElement("td",{title:u({id:"postTooltip"}),className:m,__self:void 0,__source:{fileName:om,lineNumber:34,columnNumber:5}},Qi.a.createElement(la.a,{"aria-label":u({id:"postTooltip"}),label:u({id:"post"}),onClick:function handleClick(t){var i=a===L.MOTIVATION_COMMENTING?L.REPLY:L.NOTE;A(t),Ti()&&oi("Commenting","CommentingList","ClickPostButton",{"adb.event.context.dc.parentAnnot":l,"adb.event.context.dc.posttype":i}),i===L.REPLY&&oi("Commenting","CommentingList","ClickPostButton",{"adb.event.context.dc.replyCount":c+1})},"data-test-id":"post_tool_button",quiet:!0,variant:"action",className:Jc.a.PostToolText,disabled:d,__self:void 0,__source:{fileName:om,lineNumber:35,columnNumber:7}}))};im.propTypes={intl:Zr.intlShape,useModernView:nr.a.bool,motivation:nr.a.string,commentSubtype:nr.a.string,onPostClick:nr.a.func.isRequired,isPostDisabled:nr.a.bool,replyCount:nr.a.number},im.defaultProps={intl:Zr.intlShape,useModernView:!1,motivation:"",commentSubtype:"",isPostDisabled:!1,replyCount:0};var rm=Object(Zr.injectIntl)(im),am="/build/src/comments/ModernEditableTextComponent/Tools/RetryTool.js",sm=function RetryTool(t){var i=t.onRetryClick,a=t.intl.formatMessage;return Qi.a.createElement("td",{title:a({id:"retry"}),className:Jc.a.RetryTool,__self:void 0,__source:{fileName:am,lineNumber:11,columnNumber:3}},Qi.a.createElement(la.a,{"aria-label":a({id:"retry"}),label:a({id:"retry"}),onClick:i,"data-test-id":"retry_tool_button",quiet:!0,variant:"action",className:Jc.a.RetryToolText,__self:void 0,__source:{fileName:am,lineNumber:12,columnNumber:5}}))};sm.propTypes={intl:Zr.intlShape,onRetryClick:nr.a.func.isRequired},sm.defaultProps={intl:Zr.intlShape};var Am=Object(Zr.injectIntl)(sm),lm="/build/src/comments/ModernEditableTextComponent/Tools/ToolBar.jsx",um=function ToolBar(t){var i=t.setMenuContainerRef,a=t.motivation,A=t.commentSubtype,l=t.onToolMenuClick,u=t.showCancelTool,d=t.onCancelClick,c=t.showPostTool,m=t.onPostClick,h=t.showMentionsTool,p=t.onMentionsClick,g=t.showRetryTool,C=t.onRetryClick,v=t.isPostDisabled,b=t.replyCount;return Qi.a.createElement("table",{ref:function ref(t){i(t)},className:Jc.a.ModernToolsContainer,onClick:l,__self:void 0,__source:{fileName:lm,lineNumber:28,columnNumber:3}},Qi.a.createElement("tbody",{__self:void 0,__source:{fileName:lm,lineNumber:33,columnNumber:5}},Qi.a.createElement("tr",{className:Jc.a.ModernDisplayButtons,__self:void 0,__source:{fileName:lm,lineNumber:34,columnNumber:7}},h&&Qi.a.createElement($c,{useModernView:!0,onMentionsClick:p,__self:void 0,__source:{fileName:lm,lineNumber:37,columnNumber:11}}),c&&Qi.a.createElement(rm,{useModernView:!0,onPostClick:m,motivation:a,commentSubtype:A,isPostDisabled:v,replyCount:b,__self:void 0,__source:{fileName:lm,lineNumber:44,columnNumber:11}}),g&&Qi.a.createElement(Am,{onRetryClick:C,__self:void 0,__source:{fileName:lm,lineNumber:55,columnNumber:11}}),u&&Qi.a.createElement(nm,{useModernView:!0,onCancelClick:d,motivation:a,commentSubtype:A,__self:void 0,__source:{fileName:lm,lineNumber:59,columnNumber:11}}))))};um.propTypes={setMenuContainerRef:nr.a.func.isRequired,motivation:nr.a.string,commentSubtype:nr.a.string,onToolMenuClick:nr.a.func.isRequired,showCancelTool:nr.a.bool.isRequired,onCancelClick:nr.a.func.isRequired,showPostTool:nr.a.bool.isRequired,onPostClick:nr.a.func.isRequired,showMentionsTool:nr.a.bool.isRequired,onMentionsClick:nr.a.func.isRequired,showRetryTool:nr.a.bool.isRequired,onRetryClick:nr.a.func.isRequired,isPostDisabled:nr.a.bool,replyCount:nr.a.number},um.defaultProps={motivation:"",commentSubtype:"",isPostDisabled:!1,replyCount:0};var dm=Object(Zr.injectIntl)(um),cm="/build/src/comments/ModernEditableTextComponent/Views/ErrorView.jsx",mm={};mm=a("+lnk").locale;var hm=function ErrorView(t){return mm.isCCJKLocale?Qi.a.createElement("div",{className:Jc.a.errorViewNonItalic,__self:void 0,__source:{fileName:cm,lineNumber:16,columnNumber:5}},t.errorString):Qi.a.createElement("div",{className:Jc.a.errorView,__self:void 0,__source:{fileName:cm,lineNumber:23,columnNumber:5}},t.errorString)};hm.propTypes={errorString:nr.a.string},hm.defaultProps={errorString:""};var pm=Object(Zr.injectIntl)(hm),fm=a("JNmG"),gm=a.n(fm),Cm="/build/src/comments/ModernEditableTextComponent/Views/InviteWarnView.jsx",vm={};vm=a("+lnk").locale;var bm=function InviteWarnView(t){return Qi.a.createElement("div",{className:Jc.a.inviteWarnView,__self:void 0,__source:{fileName:Cm,lineNumber:17,columnNumber:3}},Qi.a.createElement(gm.a,{style:{verticalAlign:"middle",width:"35px"},__self:void 0,__source:{fileName:Cm,lineNumber:18,columnNumber:5}}),Qi.a.createElement("div",{className:vm.isCCJKLocale?Jc.a.modernInfoMessageNonItalic:Jc.a.modernInfoMessageItalic,__self:void 0,__source:{fileName:Cm,lineNumber:19,columnNumber:5}},t.intl.formatMessage({id:"inviteWarnMsg"})))};bm.propTypes={intl:Zr.intlShape},bm.defaultProps={intl:Zr.intlShape};var ym,_m=Object(Zr.injectIntl)(bm),Im="/build/src/comments/ModernEditableTextComponent/index.jsx",wm=g.logging.getLogger("CommentsToolBar"),Mm={},km={};Mm=a("+lnk").locale,km=a("+lnk").auth;var Sm=new el,Tm=Object(ir.inject)("commentsStore","FiltersStore")(ym=function(t){Z()(ModernEditableTextComponent,t);var i=Q()(ModernEditableTextComponent);function ModernEditableTextComponent(t){var a;return d()(this,ModernEditableTextComponent),(a=i.call(this,t)).searchAutocompletions=function(){var t=W()(H.a.mark((function _callee(t){var i,A,l,u,d=arguments;return H.a.wrap((function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(i=d.length>1&&void 0!==d[1]&&d[1],A={peopleType:"PERSON",relationship:"INVITE",searchText:t,resourceType:"application/pdf"},l=2,!(t.length<l)){c.next=5;break}return c.abrupt("return",Promise.resolve([]));case 5:return c.next=7,g.providers["comments-provider"]();case 7:return u=c.sent,c.abrupt("return",u.peopleGraphClient.getSuggestions(A).then((function(A){var l=Zi()(a);if(A&&!A.error){var u=a.suggestionsList.filter((function(i){return-1!==i.email.toLowerCase().indexOf(t.toLowerCase())})).map((function(t){return{email:t.email}})),d=A.map((function(t){var a=t;return t.email||(a.email=t.caption||t.title),t.name||(a.name=t.title?t.title:t.caption),i&&(a.type="AddToReviewerAction"),a})),c=[].concat(b()(d),b()(u)),m=new Map,h=c.filter((function(t){return!m.has(t.email)&&(m.set(t.email,!0),!0)}));h&&h.length>0&&(a.updateTributeList(a.suggestionsList,h),l.tribute.isActive=!1,l.tribute.showMenuFor(l.editableDivRef))}})));case 9:case"end":return c.stop()}}),_callee)})));return function(i){return t.apply(this,arguments)}}(),a.isMentionShown=!1,a.mentionedList=Fi.convertMobxListToStandardMentionedList(a.props.mentionedList,a.props.bodyValue),a.onBlurTextColor="#4B4B4B",a.onBlurPlaceholderColor="#B6B6B6",a.fontStyleNormal="normal",a.fontStyleItalics="italic",a.bodyValue=a.props.bodyValue,a.emitChange=a.emitChange.bind(Zi()(a)),a.suggestionsList=[],a.mentionedRecipientsForReviewList=[],a.mentionedObj=[],a.state={showErrorView:!1,errorString:"",showInviteWarnView:!1,mentionsLimitReached:!1,isTextBoxEmpty:!a.props.bodyValue},a.onToolMenuClick=a.onToolMenuClick.bind(Zi()(a)),a.onCancelClick=a.onCancelClick.bind(Zi()(a)),a.onPostClick=a.onPostClick.bind(Zi()(a)),a.onMentionsClick=a.onMentionsClick.bind(Zi()(a)),a.onTextInput=a.onTextInput.bind(Zi()(a)),a}return m()(ModernEditableTextComponent,[{key:"componentDidMount",value:function componentDidMount(){this.props.shouldInitialize&&this.intitalizeMentionsAndEventListenersForTextBox(),this.props.isPageAnnot&&this.menubarRef.setAttribute("page-annot",!0),this.props.autoFocus&&this.editableDivRef&&this.editableDivRef.focus()}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(t,i){return Fi.isListUpdated(this.props.mentionsList,t.mentionsList)?(this.tribute&&this.editableDivRef&&this.tribute.detach(this.editableDivRef),this.tribute=void 0,!0):!!this.isToolsStateChanged(t)||(!this.props.isEditing||(this.bodyValue!==t.bodyValue||(this.state.showInviteWarnView!==i.showInviteWarnView||(this.state.showErrorView!==i.showErrorView||this.state.isTextBoxEmpty!==i.isTextBoxEmpty))))}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.intitalizeMentionsAndEventListenersForTextBox()}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.root&&this.root.removeEventListener("textboxClick",this.focusTextBox),Ti()&&this.props.onUnMount&&this.props.onUnMount(this.editableDivRef.innerText,Fi.getMentionedListInStandardFormat(this.mentionedList)),this.tribute&&this.editableDivRef&&this.tribute.detach(this.editableDivRef),this.cancelStickyNoteCommentIfEmpty()}},{key:"onPaste",value:function onPaste(t){var i=this;setTimeout((function(){i.isTextLengthMoreThanLimit()&&(t.preventDefault(),i.showMaxCharLimitReachedView())}))}},{key:"onEnterKey",value:function onEnterKey(t){this.onPostClick(t)}},{key:"onPostClick",value:function onPostClick(t){t.stopPropagation(),ei.setShowCommentSuggestions(!1),this.dispatchPostEvent()}},{key:"onCancelClick",value:function onCancelClick(t){t.stopPropagation(),this.props.commentsStore.resetSelectedCommentId(),this.editableDivRef&&this.editableDivRef.dispatchEvent(new CustomEvent(L.CUSTOM_EVENT_TEXTBOX_CANCEL,{bubbles:!0,cancelable:!0}))}},{key:"onTextInput",value:function onTextInput(t){t.stopPropagation();var i=!1;this.editableDivRef.innerText&&(i=!!this.editableDivRef.innerText.trim()),this.setState({isTextBoxEmpty:!i}),this.emitChange(t);var a=Fi.dispatchEventPolyfill("input",!0,!0);this.root.dispatchEvent(a),Ti()&&this.props.onContentUpdate(this.editableDivRef.innerText,Fi.getMentionedListInStandardFormat(this.mentionedList))}},{key:"onToolMenuClick",value:function onToolMenuClick(t){var i=Fi.dispatchEventPolyfill("textboxClick",!0,!0);this.menuContainerRef.dispatchEvent(i)}},{key:"onTextFocus",value:function onTextFocus(t){if(Si.isSharedCommentingMode()&&!km.isSignedIn)return this.editableDivRef.blur(),void km.signIn();this.editableDivRef.removeAttribute("data-placeholder"),this.editableDivRef.style.color=this.onBlurTextColor,this.editableDivRef.style.fontStyle=this.fontStyleNormal;var i=Fi.dispatchEventPolyfill("textboxFocus",!0,!0);this.root.dispatchEvent(i)}},{key:"onEditableClick",value:function onEditableClick(t){var i=Fi.dispatchEventPolyfill("textboxClick",!0,!0);this.root.dispatchEvent(i),this.props.onTextBoxClick&&this.props.onTextBoxClick(i)}},{key:"onTextBlur",value:function onTextBlur(t){if(!Ea.a.findDOMNode(this).contains(t&&t.relatedTarget?t.relatedTarget:document.activeElement)&&this.editableDivRef){var i=!1;if(Ti()||""===this.editableDivRef.textContent&&(!0!==this.props.isEditing||this.props.replyBox)?""===this.editableDivRef.innerText&&(this.editableDivRef.setAttribute("data-placeholder",this.props.placeholder),this.editableDivRef.style.color=this.onBlurPlaceholderColor,Mm.isCCJKLocale||(this.editableDivRef.style.fontStyle=this.fontStyleItalics)):(ei.setShowCommentSuggestions(!1),i=!0,this.dispatchPostEvent()),!i){this.bodyValue=Ti()?this.editableDivRef.innerText:this.editableDivRef.textContent;var a=Fi.createTextboxContentDispatchEvent(this.bodyValue,Fi.getMentionedListInStandardFormat(this.mentionedList),L.CUSTOM_EVENT_TEXTBOX_BLUR);this.editableDivRef.dispatchEvent(a)}Ti()&&(this.dispatchPostEvent(),oi("Commenting","CommentingList","NoteAutoAdded",{"adb.event.context.dc.parentAnnot":this.props.commentSubtype,"adb.event.context.dc.isEmpty":""===this.bodyValue}))}}},{key:"onKeyUp",value:function onKeyUp(t){var i=this;t.stopPropagation(),t.keyCode===L.AT_THE_RATE?this.props.updateCommentHeight&&this.props.updateCommentHeight(this.menubarRef.offsetHeight):t.keyCode===L.TAB_KEY&&this.editableDivRef.dispatchEvent(new CustomEvent("tabKeyFocus",{bubbles:!0})),setTimeout((function(){i.state.showErrorView&&!i.isTextLengthMoreThanLimit()&&i.hideMaxCharLimitErrorView()}),0);var a=Fi.createTextboxContentDispatchEvent(this.editableDivRef.innerText,Fi.getMentionedListInStandardFormat(this.mentionedList),"textboxKeyUp");this.editableDivRef.dispatchEvent(a)}},{key:"onKeyDown",value:function onKeyDown(t){(this.limitCharacters(t),t.stopPropagation(),this.props.isPageAnnot&&""===this.editableDivRef.innerText||!(!t.shiftKey&&t.keyCode===L.ENTER_KEY||t.keyCode===L.ESC_KEY&&""===this.editableDivRef.innerText)||this.tribute&&this.tribute.isActive)?t.keyCode!==L.ESC_KEY?(Ti()?_e()&&t.keyCode===L.DEL_KEY_MAC||Ie()&&t.keyCode===L.DEL_KEY_WINDOWS:t.keyCode===L.DEL_KEY_MAC)&&this.handleDelete(t):this.onCancelClick(t):this.onEnterKey(t)}},{key:"onMentionsClick",value:function onMentionsClick(t){t.preventDefault(),this.tribute||this.addMentionsSupport(),this.tribute&&this.tribute.isActive?this.tribute.hideMenu():(this.tribute&&this.tribute.showMenuForCollection(this.editableDivRef),this.props.updateCommentHeight&&this.props.updateCommentHeight(this.menubarRef.offsetHeight),this.props.onTextBoxClick&&this.props.onTextBoxClick(t))}},{key:"getContent",value:function getContent(){if(this.props.isEditing){var t=null;return this.props.bodyValue&&(t=Qi.a.createElement(PA,{bodyValue:this.props.bodyValue,mentions:this.props.mentionedList?this.props.mentionedList:[],__self:this,__source:{fileName:Im,lineNumber:342,columnNumber:27}})),t}return Qi.a.createElement("span",{__self:this,__source:{fileName:Im,lineNumber:349,columnNumber:12}})}},{key:"isRecipientInDoc",value:function isRecipientInDoc(t){return t.type?"AddToReviewerAction"!==t.type&&"PERSON"!==t.type:!this.mentionedList[t]||"AddToReviewerAction"!==this.mentionedList[t].type&&"PERSON"!==this.mentionedList[t].type}},{key:"updateMentionedAndRecipientsList",value:function updateMentionedAndRecipientsList(t,i){if(i?(this.isRecipientInDoc(t)||this.addToMentionedRecipientsList(t),this.addToMentionedList(t)):(this.isRecipientInDoc(t)||this.removeFromMentionedRecipientsList(t),this.removeFromMentionedList(t)),this.editableDivRef.innerText){var a=!!this.editableDivRef.innerText.trim();this.setState({isTextBoxEmpty:!a})}Ti()&&this.props.onContentUpdate(this.editableDivRef.innerText,Fi.getMentionedListInStandardFormat(this.mentionedList))}},{key:"updateTributeList",value:function updateTributeList(t,i){var a=this;t&&i&&this.tribute&&i.forEach((function(i){var A=t.findIndex((function(t){return t.email.toLowerCase()===i.email.toLowerCase()}));if(-1===A)a.tribute.append(0,i),t.push(i);else if(!(t[A].name===i.name)&&i.name!=i.email&&t[A].name!=t[A].email){var l=a.tribute.collection&&a.tribute.collection[0].values,u=l.findIndex((function(t){return t.email.toLowerCase()===i.email.toLowerCase()}));l.splice(u,1),l.splice(u,0,i),a.tribute.append(0,l,!0),t[A].name=i.name}}))}},{key:"isToolsStateChanged",value:function isToolsStateChanged(t){return this.props.showMentions!==t.showMentions||this.props.showPostTool!==t.showPostTool||this.props.showToolBar!==t.showToolBar||this.props.showCancelTool!==t.showCancelTool}},{key:"addToMentionedList",value:function addToMentionedList(t){var i=Fi.getMentionDisplayName(t);Object.prototype.hasOwnProperty.call(this.mentionedList,i)?this.mentionedList[i].count=this.mentionedList[i].count+1:(this.mentionedList[i]=t,this.mentionedList[i].count=1,this.mentionedObj.push(t)),Object.keys(this.mentionedList).length>L.REDHAWK_COMMENT_MENTION_LIMIT&&(this.setState({mentionsLimitReached:!0}),this.state.showErrorView||this.showMentionsLimitReachedView())}},{key:"removeFromMentionedList",value:function removeFromMentionedList(t){Object.prototype.hasOwnProperty.call(this.mentionedList,t)&&(1===this.mentionedList[t].count?(delete this.mentionedList[t],this.mentionedObj=this.mentionedObj.filter((function(i){return i.email!==t.email}))):this.mentionedList[t].count=this.mentionedList[t].count-1),Object.keys(this.mentionedList).length<=L.REDHAWK_COMMENT_MENTION_LIMIT&&(this.setState({mentionsLimitReached:!1}),this.state.errorString===this.props.intl.formatMessage({id:"mentionsLimitReached"})&&this.hideErrorView())}},{key:"addToMentionedRecipientsList",value:function addToMentionedRecipientsList(t){var i=Fi.getMentionDisplayName(t);Object.prototype.hasOwnProperty.call(this.mentionedRecipientsForReviewList,i)?this.mentionedRecipientsForReviewList[i].count=this.mentionedRecipientsForReviewList[i].count+1:(this.mentionedRecipientsForReviewList[i]=t,this.mentionedRecipientsForReviewList[i].count=1),Fi.isEmpty(this.mentionedRecipientsForReviewList)||this.setState({showInviteWarnView:!0})}},{key:"removeFromMentionedRecipientsList",value:function removeFromMentionedRecipientsList(t){Object.prototype.hasOwnProperty.call(this.mentionedRecipientsForReviewList,t)&&(1===this.mentionedRecipientsForReviewList[t].count?delete this.mentionedRecipientsForReviewList[t]:this.mentionedRecipientsForReviewList[t].count=this.mentionedRecipientsForReviewList[t].count-1),Fi.isEmpty(this.mentionedRecipientsForReviewList)&&this.setState({showInviteWarnView:!1})}},{key:"initializeSuggestionsList",value:function initializeSuggestionsList(t){var i=this;this.suggestionsList=[],t&&t.forEach((function(t){var a={};(a=Object(x.toJS)(t)).name||(a.name=a.displayName||a.title||a.email),a.email||(a.type=void 0),i.suggestionsList.push(a)}))}},{key:"intitalizeMentionsAndEventListenersForTextBox",value:function intitalizeMentionsAndEventListenersForTextBox(){var t=this.props.showMentions,i=this.props.showMentionsCommentBox;(t||i)&&(Ti()||this.addMentionsSupport()),this.root.addEventListener("textboxClick",this.focusTextBox.bind(this)),!this.props.isFocused||document.activeElement===this.editableDivRef||Ti()&&!this.props.shouldTextTakeFocus||ct(this.editableDivRef);var a=Fi.dispatchEventPolyfill("textboxFocus",!0,!0);this.root.dispatchEvent(a)}},{key:"focusTextBox",value:function focusTextBox(){this.editableDivRef&&this.editableDivRef.focus()}},{key:"addSuggestionSupport",value:function addSuggestionSupport(){var t=this;return Sm.getEmailList().then((function(i){var a=el.addNameToRecipients(i),A=el.addReviewTypeToRecipients(a);t.updateTributeList(t.suggestionsList,A)}))}},{key:"addMentionsSupport",value:function addMentionsSupport(){var t=this,i=this;if(!this.tribute){this.props.mentionsList&&this.props.mentionsList.length&&!this.suggestionsList.length&&this.initializeSuggestionsList(this.props.mentionsList);var a=new GA.a({trigger:"@",lookup:function lookup(t,i){return t.displayName?t.displayName+t.email:t.name+t.email},values:this.suggestionsList,menuContainer:this.menubarRef,allowSpaces:!0,positionMenu:!1,menuItemTemplate:function menuItemTemplate(t){var a=document.createElement("div");a.setAttribute("class","tribute-menu-element");var A=document.createElement("img"),l=document.createElement("div"),u=document.createElement("div"),d=document.createElement("div"),c=document.createElement("div"),m=document.createElement("div");if(c.setAttribute("class","user-info"),"AddToReviewerAction"===t.original.type||"PERSON"===t.original.type){var h=document.createElement("span"),p=document.createElement("span");p.style.padding="0 5px",p.innerHTML="&#8226;",h.setAttribute("class","not-in-doc"),h.textContent=i.props.intl.formatMessage({id:"notInDoc"});var g=document.createElement("span");g.setAttribute("class","email-content"),g.textContent=t.original.email,h.appendChild(p),d.appendChild(h),d.appendChild(g)}else d.textContent=t.original.email;return d.setAttribute("class","display-email"),t.original.img?(A.setAttribute("src",t.original.img),a.appendChild(A)):(m.setAttribute("class","tribute-author-initials-string"),m.textContent=Fi.getInstance().getAuthorInitials(t.original),l.appendChild(m),l.setAttribute("class","tribute-author-initials"),a.appendChild(l)),u.setAttribute("class","display-name"),u.textContent=t.original.displayName?t.original.displayName:t.original.title?t.original.title:t.original.email,c.appendChild(u),c.appendChild(d),a.appendChild(c),a.outerHTML},selectTemplate:function selectTemplate(t){if(i.props.isAnnonymous&&!t&&(oi("Access","Use","Click to sign in to mention",{"adb.event.context.eureka.mention":"Clicked to sign in"}),km.signIn()),!t)return null;i.props&&i.props.commentSubtype&&oi("Participate","Use","Add @ mention",{"adb.event.context.eureka.participate.use.commenttype":i.props.commentSubtype});var a=document.createElement("span");return a.setAttribute("class",Jc.a.mentionedElement),t&&(a.setAttribute("data-id",t.original.email?t.original.email:""),a.textContent=Fi.getMentionDisplayName(t.original)),a.setAttribute("contenteditable",!1),a.outerHTML},noMatchTemplate:function noMatchTemplate(){i.props.isAnnonymous&&oi("Access","Use","Show prompt to sign in to mention",{"adb.event.context.eureka.comment.mention":"Sign in after @mention"});var t=i.props.isAnnonymous?i.props.intl.formatMessage({id:"mentions.signInMessage"}):i.props.intl.formatMessage({id:"mentions.noMatchMessage"}),a=document.createElement("li");if(a.setAttribute("class",Jc.a.noMatchTemplateLI),a.setAttribute("data-index","0"),a.appendChild(document.createTextNode(t)),i.suggestionsList.length&&Fi.getInstance().isUserInitiator()){var A=document.getElementsByClassName("tribute-container");return A&&A[0]&&(A[0].style.display="none")," "}return a.outerHTML}}),A=new MutationObserver((function(t){t.forEach((function(t){t&&t.removedNodes&&t.removedNodes.forEach((function(t){t&&"SPAN"===t.nodeName&&t.className===Jc.a.mentionedElement&&i.updateMentionedAndRecipientsList(t.innerText,!1)}))}))}));this.tribute=a,Fi.getInstance().isUserInitiator()&&this.addSuggestionSupport(),this.tribute.attach(this.editableDivRef),this.editableDivRef.addEventListener("tribute-replaced",(function(t){t.stopPropagation(),!i.props.isAnnonymous&&t.detail.item&&(i.updateMentionedAndRecipientsList(Fi.getMentionedListObject(t.detail.item.original),!0),t.detail&&t.detail.event&&("mousedown"===t.detail.event.type||"pointerdown"===t.detail.event.type)&&i.props.commentsStore.setTributeReplaced(!0))})),this.editableDivRef.addEventListener("tribute-no-match",function(){var a=W()(H.a.mark((function _callee2(a){var A,l;return H.a.wrap((function _callee2$(u){for(;;)switch(u.prev=u.next){case 0:if(a.stopPropagation(),i.props.isAnnonymous&&((A=a.detail).style.display="block",A.setAttribute("annonymous",!0),A.parentElement.setAttribute("annonymous",!0)),l=t.tribute.current,!Fi.getInstance().isUserInitiator()){u.next=7;break}if(!l||!el.isEmailValid(l.mentionText)||t.isInSuggestion(l.mentionText)){u.next=7;break}return u.next=7,t.searchAutocompletions(l.mentionText,!0);case 7:case"end":return u.stop()}}),_callee2)})));return function(t){return a.apply(this,arguments)}}()),this.editableDivRef.addEventListener("input",(function(i){ut(t.menubarRef)||(t.menubarRef.style.top="auto",t.menubarRef.style.bottom="100%");var a=t.tribute.current;Fi.getInstance().isUserInitiator()&&a&&a.mentionText&&t.searchAutocompletions(a.mentionText,el.isEmailValid(a.mentionText)&&!t.isInSuggestion(a.mentionText))})),A.observe(this.editableDivRef,{childList:!0,subtree:!0})}}},{key:"addNewEmailInSuggestionsList",value:function addNewEmailInSuggestionsList(t){var i={};i.email=t.toLowerCase(),i.name=t.toLowerCase(),i.type="AddToReviewerAction";var a=[i];this.updateTributeList(this.suggestionsList,a),this.tribute.isActive=!1,this.tribute.showMenuFor(this.editableDivRef)}},{key:"isInSuggestion",value:function isInSuggestion(t){return-1!==this.suggestionsList.findIndex((function(i){return i.email.toLowerCase()===t.toLowerCase()}))}},{key:"addRecipientsToReviewers",value:function addRecipientsToReviewers(){Di.reviewExist||Di.initializeReviewData();var t=Di.apis;if(t){var i=t.getAssetUri(),a=t.getReview(i),A=t.authorizeUser({imsAuthInfo:km},!1).getTokenId();0===A.indexOf("Bearer ")&&(A=A.substr(7));var l=Fi.getMentionedListInStandardFormat(this.mentionedRecipientsForReviewList).map((function(t){return t.email}));a.getSendBootstrapData().then((function(t){var i=t;a.addReviewer(i.parcel_data.id,l,A).then((function(){Li.fetchReviewParticipants();var t=new CustomEvent("adobe:comments:newReviewersAdded",{detail:{isSuccessful:!0},bubbles:!0});window.dispatchEvent(t),l.forEach((function(){oi("Access","Use","Add @ mention",{"adb.event.context.eureka.comment.mention":"New Recipient Added"})}))})).catch((function(){wm.warn("Failed to invite recipients.");var t=new CustomEvent("adobe:comments:newReviewersAdded",{detail:{isSuccessful:!1},bubbles:!0});window.dispatchEvent(t)}))})).catch((function(t){wm.warn("Failed to fetch sendBootstrapData.",JSON.stringify(t))}))}else wm.warn("Failed to fetch reviewProvider.")}},{key:"cancelStickyNoteCommentIfEmpty",value:function cancelStickyNoteCommentIfEmpty(){if(!this.props.isPageAnnot&&this.props.commentSubtype===Fi.NOTE_COMMENT&&this.state.isTextBoxEmpty)return this.onCancelClick({stopPropagation:function stopPropagation(){}}),!0}},{key:"dispatchPostEvent",value:function dispatchPostEvent(){if(!this.cancelStickyNoteCommentIfEmpty())if(this.isTextLengthMoreThanLimit())this.showMaxCharLimitReachedView();else if(this.state.mentionsLimitReached)this.showMentionsLimitReachedView();else{var t=this;setTimeout((function(){t.editableDivRef&&t.editableDivRef.blur()}));var i=Fi.createTextboxContentDispatchEvent(this.editableDivRef.innerText,Fi.getMentionedListInStandardFormat(this.mentionedList),L.CUSTOM_EVENT_TEXTBOX_POST);if(this.root.dispatchEvent(i),rl({mentionedObj:this.mentionedObj}),!Fi.isEmpty(this.mentionedRecipientsForReviewList))if(Fi.getInstance().isUserInitiator()){var a=Fi.getMentionedListInStandardFormat(this.mentionedRecipientsForReviewList);window.dispatchEvent(new CustomEvent("adobe:comments:newReviewersInProgress",{detail:a,bubbles:!0})),this.addRecipientsToReviewers()}else wm.warn("This user is not an initiator. Only an initiator can add new reviewers.")}}},{key:"handleDelete",value:function handleDelete(t){var i=this.editableDivRef;if(window.getSelection){var a=window.getSelection();if(!a.isCollapsed||!a.rangeCount)return;var A=a.getRangeAt(a.rangeCount-1);if(3===A.commonAncestorContainer.nodeType&&A.startOffset>0)return;var l=document.createRange();if(a.anchorNode!==i)l.selectNodeContents(i),l.setEndBefore(a.anchorNode);else{if(!(a.anchorOffset>0))return;l.setEnd(i,a.anchorOffset)}l.setStart(i,l.endOffset-1);var u=l.cloneContents().firstChild;u&&"false"===u.contentEditable&&(l.deleteContents(),t.preventDefault())}}},{key:"emitChange",value:function emitChange(t){if(this.editableDivRef){var i=this.editableDivRef.innerHTML;i!==this.lastHtml&&(t.target={value:i}),this.lastHtml=i}}},{key:"limitCharacters",value:function limitCharacters(t){var i=XA.isEventPrintable(t);this.isTextLengthMoreThanLimit()?(this.showMaxCharLimitReachedView(),i&&t.preventDefault()):this.hideMaxCharLimitErrorView()}},{key:"isTextLengthMoreThanLimit",value:function isTextLengthMoreThanLimit(){var t=!1;return this.editableDivRef.innerText.length>L.REDHAWK_COMMENT_MAX_CHAR_LENGTH&&(t=!0),t}},{key:"hideErrorView",value:function hideErrorView(){this.setState({showErrorView:!1,errorString:""})}},{key:"hideMaxCharLimitErrorView",value:function hideMaxCharLimitErrorView(){this.state.mentionsLimitReached?this.showMentionsLimitReachedView():this.hideErrorView()}},{key:"showMaxCharLimitReachedView",value:function showMaxCharLimitReachedView(){this.setState({showErrorView:!0,errorString:this.props.intl.formatMessage({id:"charLimitReached"})}),oi("Commenting","Use","char limit exceeded")}},{key:"showMentionsLimitReachedView",value:function showMentionsLimitReachedView(){this.setState({showErrorView:!0,errorString:this.props.intl.formatMessage({id:"mentionsLimitReached"})}),oi("Commenting","Use","@mention limit exceeded")}},{key:"render",value:function render(){var t=this,i=!Ti()&&this.props.showMentions,a=!Ti()&&this.props.showMentionsCommentBox,A=Jc.a.textEditor;A="".concat(A," ").concat(Jc.a.commentBoxHt);var l=[Jc.a.EditableTextContainer];return this.props.replyBox?l.push(Jc.a.modernCommentReplyBoxPosition):l.push(Jc.a.modernCommentEditReplyBoxPosition),!Ti()||Ei()&&this.props.commentsStore.haveCommentsLoaded||l.push(HA.a.disabledContainer),Qi.a.createElement("div",{id:this.props.id,ref:function ref(i){t.root=i},className:Ra()(l),__self:this,__source:{fileName:Im,lineNumber:1046,columnNumber:7}},Qi.a.createElement("div",{ref:function ref(i){t.editableDivRef=i},title:this.props.intl.formatMessage({id:"addCommentTooltip"}),"data-test-id":"editableDivRef",tabIndex:"0",role:"textbox","aria-multiline":"true","aria-labelledby":this.props.intl.formatMessage({id:"addCommentTooltip"}),"aria-describedby":this.props.intl.formatMessage({id:"addCommentTooltip"}),className:"".concat(A," ").concat(Mm.isCCJKLocale?Jc.a.textEditorPHNonItalic:Jc.a.textEditorPHItalic),onClick:function onClick(i){return t.onEditableClick(i)},onInput:function onInput(i){return t.onTextInput(i)},onFocus:function onFocus(i){return t.onTextFocus(i)},onKeyUp:function onKeyUp(i){return t.onKeyUp(i)},onKeyDown:function onKeyDown(i){return t.onKeyDown(i)},onBlur:function onBlur(i){return t.onTextBlur(i)},onPaste:function onPaste(i){return t.onPaste(i)},"data-placeholder":this.props.placeholder,contentEditable:!0,__self:this,__source:{fileName:Im,lineNumber:1051,columnNumber:9}},this.getContent()),this.state.showInviteWarnView?Qi.a.createElement(_m,{useModernView:!0,__self:this,__source:{fileName:Im,lineNumber:1077,columnNumber:43}}):"",this.props.showToolBar&&Qi.a.createElement(dm,{setMenuContainerRef:function setMenuContainerRef(i){t.menuContainerRef=i},motivation:this.props.motivation,commentSubtype:this.props.commentSubtype,onToolMenuClick:this.onToolMenuClick,showCancelTool:this.props.showCancelTool,onCancelClick:this.onCancelClick,showPostTool:this.props.showPostTool,onPostClick:this.onPostClick,showMentionsTool:i,onMentionsClick:this.onMentionsClick,showRetryTool:this.props.showRetryTool,onRetryClick:this.props.onRetryClick,isPostDisabled:this.props.commentSubtype===Fi.NOTE_COMMENT&&this.state.isTextBoxEmpty,replyCount:this.props.replyCount,__self:this,__source:{fileName:Im,lineNumber:1081,columnNumber:11}}),!this.props.showToolBar&&a&&Qi.a.createElement("div",{className:Jc.a.PageLevelMentionsToolContainer,__self:this,__source:{fileName:Im,lineNumber:1101,columnNumber:11}},Qi.a.createElement($c,{useModernView:!0,onMentionsClick:this.onMentionsClick,__self:this,__source:{fileName:Im,lineNumber:1102,columnNumber:13}})),Qi.a.createElement("div",{ref:function ref(i){t.menubarRef=i},className:Jc.a.MenubarContainer,__self:this,__source:{fileName:Im,lineNumber:1109,columnNumber:9}}),this.state.showErrorView&&Qi.a.createElement(pm,{errorString:this.state.errorString,__self:this,__source:{fileName:Im,lineNumber:1114,columnNumber:39}}))}}]),ModernEditableTextComponent}(Qi.a.Component))||ym;Tm.propTypes={intl:Zr.intlShape,id:nr.a.string,motivation:nr.a.string,commentSubtype:nr.a.string,placeholder:nr.a.string,replyBox:nr.a.bool,showToolBar:nr.a.bool,showCancelTool:nr.a.bool,showPostTool:nr.a.bool,showMentions:nr.a.bool,showRetryTool:nr.a.bool,onRetryClick:nr.a.func.isRequired,onTextBoxClick:nr.a.func.isRequired,showMentionsCommentBox:nr.a.bool,replyCount:nr.a.number},Tm.defaultProps={intl:Zr.intlShape,id:"defaultTextBox",motivation:"",commentSubtype:"",placeholder:"",replyBox:!1,showToolBar:!1,showCancelTool:!1,showPostTool:!1,showMentions:!1,showRetryTool:!1,showMentionsCommentBox:!1,replyCount:0};var xm,Em,Pm,Nm,Rm,Dm=Object(Zr.injectIntl)(Tm),Om=a("Uz1L"),Lm=a.n(Om),Bm=(a("d+3G"),a("YlwY")),Um=a.n(Bm),Fm="/build/src/react/components/CommentSuggestions.jsx",jm=g.logging.getLogger("CommentSuggestions"),Hm=Object(ir.inject)("commentsStore","userProfileStore","toolBarStore","pageStore")(xm=Object(ir.observer)(xm=function(t){Z()(CommentSuggestions,t);var i=Q()(CommentSuggestions);function CommentSuggestions(t){var a;return d()(this,CommentSuggestions),(a=i.call(this,t)).handleClick=function(t){a.props.userProfileStore.hasAuth?(ei.setShowCommentSuggestions(!1),window.dispatchEvent(new CustomEvent("adobe:comments:postClicked",{bubbles:!0})),_.getInstance().previewApis.documentState.getCurrentPage().then((function(i){a.pageIndex=i-1,a.props.pageStore.setCommentNumber(),a.createPageLevelComment(t.content,[]),a.props.commentsStore.resetUnsavedPageLevelAnnotId(),oi("Participate","Use","IMS user pre-suggested comment posted - ".concat(t.id))})).catch((function(t){jm.warn("No Page Index came from preview",JSON.stringify(t))}))):(_.getInstance().previewApis.documentState.getCurrentPage().then((function(i){!function storeVariableValueIntoSessionStorage(t,i){null!=t&&window.sessionStorage&&(window.sessionStorage[t]=i)}(Fi.getAssetUri(),JSON.stringify({comment:t,pgNo:i}))})),window.dispatchEvent(new CustomEvent("adobe:comments:hideCoachMark",{bubbles:!0})),a.props.commentsStore.setGuestLoginDownload(!1),a.props.commentsStore.setShowPageLevelWelcomeDialog(!0),a.props.commentsStore.setTriggerAnimationForGuestLogin(),a.props.commentsStore.resetSelectedCommentId(),oi("Participate","Use","Anonymous clicked canned comment - ".concat(t.id)))},a.pageIndex=void 0,a.state={showSuggestions:!0},a}return m()(CommentSuggestions,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(x.reaction)((function(){return ei.showCommentSuggestions}),(function(i){i?t.setState({showSuggestions:!0}):t.ref&&(t.ref.classList.add("animated"),t.ref.classList.add("fadeOut"))}))}},{key:"createPageLevelComment",value:function createPageLevelComment(t,i){var a=_.getInstance().previewApis.commandManager,A=new Xc(t,i,this.props.userProfileStore,this.props.toolBarStore,this.props.commentsStore,this.props.pageStore,this.pageIndex);a.executeCommand(A)}},{key:"handleAnimationEnd",value:function handleAnimationEnd(){this.ref.classList.contains("fadeOut")?(this.ref.classList.remove("animated"),this.ref.classList.remove("fadeOut"),this.setState({showSuggestions:!1})):(this.ref.classList.remove("animated"),this.ref.classList.remove("fadeIn"))}},{key:"render",value:function render(){var t=this,i=[{id:"Looks Great",content:this.props.intl.formatMessage({id:"suggestions.looksGreat"})},{id:"Needs Work",content:this.props.intl.formatMessage({id:"suggestions.needsWork"})}],a=-1!==["pt-BR","pl-PL","cs-CZ","de-DE","es-ES","fr-FR","ja-JP","nl-NL","ru-RU","tr-TR","sv-SE","fi-FI","it-IT"].indexOf(g.locale.getLocale()),A=this.props.useModernView?Um.a.modernButtonGroup:Um.a.buttonGroup;return this.state.showSuggestions&&Qi.a.createElement("div",{onAnimationEnd:this.handleAnimationEnd.bind(this),ref:function ref(i){t.ref=i},className:ei.showCommentSuggestions?Ra()([A,"animated","fadeIn"]):Ra()([A,"animated","fadeOut"]),id:this.props.id,__self:this,__source:{fileName:Fm,lineNumber:124,columnNumber:7}},Qi.a.createElement(Lm.a,{onChange:this.handleClick,"aria-label":this.props.intl.formatMessage({id:"suggestions.preSuggestedComments"}),__self:this,__source:{fileName:Fm,lineNumber:132,columnNumber:9}},i.map((function(i){return Qi.a.createElement(la.a,{variant:"action",value:i,title:i.content,label:i.content,"aria-label":i.content,__self:t,__source:{fileName:Fm,lineNumber:137,columnNumber:13}})})),!a&&Qi.a.createElement(la.a,{variant:"action",value:{id:"Will Review",content:this.props.intl.formatMessage({id:"suggestions.willReview"})},title:this.props.intl.formatMessage({id:"suggestions.willReview"}),label:this.props.intl.formatMessage({id:"suggestions.willReview"}),"aria-label":this.props.intl.formatMessage({id:"suggestions.willReview"}),__self:this,__source:{fileName:Fm,lineNumber:146,columnNumber:11}})))}}]),CommentSuggestions}(Qi.a.Component))||xm)||xm,zm=Object(Zr.injectIntl)(Hm),Wm="/build/src/react/components/PageLevelCommentContainer.jsx",Vm=g.logging.getLogger({context:"PageLeveleCommentContainer",dropinId:"comments"}),Ym=Object(ir.inject)("reviewParticipantsStore","userProfileStore","toolBarStore","commentsStore","pageStore","FiltersStore")(Em=Object(ir.observer)((Pm=function(t){Z()(PageLevelCommentContainer,t);var i=Q()(PageLevelCommentContainer);function PageLevelCommentContainer(t){var a;return d()(this,PageLevelCommentContainer),a=i.call(this,t),M()(a,"pageIndex",Nm,Zi()(a)),M()(a,"dismissCoachMark",Rm,Zi()(a)),a.onCoachMarkHideEvent=function(t){t.stopPropagation(),a.onCoachMarkHide()},a.onCoachMarkHide=function(){(function setUserPrefs(t,i){return _setUserPrefs.apply(this,arguments)})("add_comment_coachmark",a.coachMarkCount+1).catch((function(t){Vm.warn("Error saving coachmark count")})),a.setDismissCoachMark(!0)},a.onCoachMarkRef=function(){rt()&&setTimeout((function(){var t=document.querySelector(".spectrum-CoachMarkIndicator");t&&(t.style.top="100px");var i=document.querySelector(".spectrum-CoachMarkPopover");i&&(i.style.top="160px")}),10)},a.componentDidMount=function(){Ti()||a.props.userProfileStore.isUserAuthorized()||(oi("Access","Discover","Arrive review without entry dialog",{"adb.event.context.dcweb.clickcontext":"Not signed in"}),oi("Access","Discover","Review funnel start",{"adb.event.context.dcweb.clickcontext":"Not signed in"})),Ti()||(g.discovery.loadDropinClass("frictionless-verb-panel").then((function(t){a.setState({FrictionlessVerbPanel:t})})).catch((function(t){Vm.error(t.message)})),a.state.showFrictionlessPanel&&g.providers.floodgate({useAnonymousUUID:!0}).then((function(t){var i=t.hasFlag("dc-share-frictionless-show"),A=t.hasFlag("dc-share-frictionless-review")||!1;i=i&&A,a.setState({showFrictionlessPanel:i})})).catch((function(t){Vm.info("Failed to get floodgate flags to show panel")})),function getUserPrefs(t,i){return _getUserPrefs.apply(this,arguments)}("add_comment_coachmark",0).then((function(t){var i=g.router.getQueryParams();t<L.MAX_ADD_COMMENT_COACHMARK_VIEWS&&"shared_recipient"!==i.x_api_client_id&&(a.setDismissCoachMark(!1),a.coachMarkCount=t)})),g.providers["review-handler"]().then((function(t){a.reviewApi=t,a.reviewApi.consentRequired===L.CONSENT_DONE?a.setState({consentDone:!0}):Object(x.reaction)((function(){return a.reviewApi.consentRequired}),(function(){a.reviewApi.consentRequired===L.CONSENT_DONE&&a.setState({consentDone:!0})}))}))),window.addEventListener("adobe:comments:postClicked",a.onPostClickedEvent),window.addEventListener(L.CUSTOM_EVENT_ELLIPSIS_DELETE,a.deleteClickedEvent),window.addEventListener("adobe:comments:hideCoachMark",a.onCoachMarkHideEvent)},a.onClose=function(){a.setState({showFrictionlessPanel:!1})},a.onPostClickedEvent=function(t){a.setState({showFrictionlessPanel:!1})},a.deleteClickedEvent=function(t){t.stopPropagation(),a.setState({showSuggestions:!1})},a.unsavedBodyValue="",a.unsavedMentions=[],a.isEditing=!1,a.coachMarkCount=0,a.state={showToolBar:!1,showMentions:!0,showMentionsCommentBox:!0,showPostTool:!1,showCancelTool:!1,focusTextBox:!1,key:!0,showFrictionlessPanel:!g.auth.isSignedIn,FrictionlessVerbPanel:null,showSuggestions:!1},a.commentsUtil=Fi.getInstance(),Object(x.reaction)((function(){return a.props.userProfileStore.hasAuth||a.props.commentsStore.guestLoginDownload}),(function(){Ti()||(a.props.commentsStore.setShowPageLevelWelcomeDialog(!1),setTimeout((function(){a.automaticNoteAdded()}),0))})),_.getInstance().previewApis&&_.getInstance().previewApis.documentState.initialPageLoaded().then((function(){a.setState({showSuggestions:!0}),a.automaticNoteAdded()})).catch((function(t){Vm.warn("Initial page load status not detected",JSON.stringify(t))})),Ti()&&(a.tempContent="",a.tempMentions=[],a.onContentUpdate=a.onContentUpdate.bind(Zi()(a))),a}return m()(PageLevelCommentContainer,[{key:"setPageIndex",value:function setPageIndex(t){this.pageIndex=t}},{key:"setDismissCoachMark",value:function setDismissCoachMark(t){this.dismissCoachMark=t,oi("Access","Discover",t?"CommentCoachMarkDismissed":"CommentCoachMarkDisplayed")}},{key:"automaticNoteAdded",value:function automaticNoteAdded(){var t=function getVariableValueFromSessionStorage(t){var i;return window.sessionStorage&&(i=window.sessionStorage[t]),null===i&&(i=void 0),i}(Fi.getAssetUri());if(t&&this.props.userProfileStore.hasAuth){window.dispatchEvent(new CustomEvent("adobe:comments:postClicked",{bubbles:!0})),this.setState({showSuggestions:!1}),deleteVariableValueFromSessionStorage(Fi.getAssetUri()),t=JSON.parse(t),oi("Participate","Use","Pre-suggested comment posted - ".concat(t.comment.id));try{this.postPageLevelComment(t.comment.content,[],t.pgNo)}catch(t){Vm.warn("error posting automatic canned comment")}}}},{key:"onContentUpdate",value:function onContentUpdate(t,i){(t||i.length)&&(this.props.commentsStore.unsavedPageLevelAnnotId||this.props.commentsStore.setUnsavedPageLevelAnnotId(this.commentsUtil.getGuid()),this.tempContent=t,this.tempMentions=i)}},{key:"getPlaceHolder",value:function getPlaceHolder(){return this.isEditing?"":ei.shouldUseModernViewer?this.props.intl.formatMessage({id:"modernViewer.editableTextCompnent.pageLevelCommentPlaceholder"}):this.props.intl.formatMessage({id:"editableTextCompnent.pageLevelCommentPlaceholder"})}},{key:"getBodyValue",value:function getBodyValue(){return this.isEditing?this.unsavedBodyValue:""}},{key:"getMentions",value:function getMentions(){return this.isEditing?this.unsavedMentions:""}},{key:"showTextBoxTool",value:function showTextBoxTool(){this.state.showToolBar||this.setState({showToolBar:!0,showMentions:!0,showMentionsCommentBox:!1,showPostTool:!0,showCancelTool:!0})}},{key:"hideTextBoxTool",value:function hideTextBoxTool(){this.state.showToolBar&&this.setState({showToolBar:!1,showMentions:!1,showMentionsCommentBox:!0,showPostTool:!1,showCancelTool:!1,consentDone:!1})}},{key:"onTextareaInput",value:function onTextareaInput(){this.props.userProfileStore.hasAuth&&this.showTextBoxTool()}},{key:"commentCount",get:function get(){return this.props.FiltersStore.getResolvedCommentsCount()+this.props.FiltersStore.getUnresolvedCommentsCount()}},{key:"componentDidUpdate",value:function componentDidUpdate(){var t=this;this.textbox&&!this.textbox.getAttribute("listeners")&&(this.textbox.addEventListener("post",(function(i){return t.onPostClicked(i)})),this.textbox.addEventListener("input",this.onTextareaInput.bind(this)),this.textbox.addEventListener("textboxClick",(function(i){return t.onTextboxClicked(i)})),this.textbox.addEventListener("textBoxCancelClick",(function(i){return t.handleTextBoxCancelClick(i)})),this.textbox.setAttribute("listeners",!0),this.textbox.addEventListener("tabKeyFocus",this.onTabKeyFocus.bind(this))),this.viewRef&&this.viewRef.addEventListener("textboxBlur",(function(i){return t.handleTextBoxFocusOut(i)}))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.textbox&&(this.textbox.removeEventListener("post",this.onPostClicked),this.textbox.removeEventListener("input",this.onTextareaInput),this.textbox.removeEventListener("textboxClick",this.onTextboxClicked),this.textbox.removeEventListener("textBoxCancelClick",this.handleTextBoxCancelClick),this.textbox.removeEventListener("tabKeyFocus",this.onTabKeyFocus.bind(this))),Ti()&&(this.tempContent||this.tempMentions.length)&&this.props.data&&(this.props.data.setUnsavedCommentText(this.tempContent),this.props.data.setUnsavedMentions(this.tempMentions)),window.removeEventListener("adobe:comments:postClicked",this.onPostClickedEvent),window.removeEventListener(L.CUSTOM_EVENT_ELLIPSIS_DELETE,this.deleteClickedEvent),window.removeEventListener("adobe:comments:hideCoachMark",this.onCoachMarkHideEvent)}},{key:"handleTextBoxCancelClick",value:function handleTextBoxCancelClick(t){var i=this;t.stopPropagation(),this.isEditing=!1,this.props.commentsStore.resetUnsavedPageLevelAnnotId(),this.hideTextBoxTool(),this.unsavedMentions=[],this.unsavedBodyValue="",this.props.useModernView?this.setState({key:!this.state.key,showSuggestions:!1}):this.setState({key:!this.state.key,showSuggestions:!0}),setTimeout((function(){i.suggestionRef&&i.suggestionRef.focus()}),0)}},{key:"getShowToolBar",value:function getShowToolBar(){return this.isEditing&&(this.unsavedBodyValue||this.unsavedMentions)&&this.showTextBoxTool(),this.state.showToolBar}},{key:"handleTextBoxFocusOut",value:function handleTextBoxFocusOut(t){this.unsavedBodyValue=t.detail.content,this.unsavedMentions=t.detail.mentions,this.props.useModernView?this.setState({focusTextBox:!1,key:!this.state.key,showSuggestions:!1}):this.setState({focusTextBox:!1,key:!this.state.key,showSuggestions:!0}),t.detail.content||this.hideTextBoxTool(),t.stopPropagation()}},{key:"textBoxContainerClicked",value:function textBoxContainerClicked(t){Ei()&&this.props.commentsStore.haveCommentsLoaded||Fi.showToast(!1,this.props.intl.formatMessage({id:"modernviewer.commentPlaceholderToast"}),0,HA.a.ToastDisabledCommentingTools,"info")}},{key:"onTextboxClicked",value:function onTextboxClicked(t){Ti()&&this.props.commentsStore.resetSelectedCommentId(),Ti()||this.props.userProfileStore.isUserAuthorized()?(this.showTextBoxTool(),this.setState({showSuggestions:!1})):(oi("Participate","Use","comment box clicked",{"adb.event.context.dcweb.clickcontext":"Not signed in"}),this.props.commentsStore.setGuestLoginDownload(!1),this.props.commentsStore.isCommentExpanded&&this.props.commentsStore.resetSelectedCommentId(),window.dispatchEvent(new CustomEvent("adobe:comments:hideCoachMark",{bubbles:!0})),deleteVariableValueFromSessionStorage(Fi.getAssetUri()),this.props.commentsStore.setShowPageLevelWelcomeDialog(!0),this.props.useModernView&&this.setState({focusTextBox:!0})),t.stopPropagation()}},{key:"onTabKeyFocus",value:function onTabKeyFocus(t){Ti()&&!this.props.useModernView||this.onTextboxClicked(t),t.stopPropagation()}},{key:"onPostClicked",value:function onPostClicked(t){var i=this;if(!t.cancelBubble){this.setState({showSuggestions:!1}),window.dispatchEvent(new CustomEvent("adobe:comments:postClicked",{bubbles:!0})),this.isEditing=!1;var a=t.detail.content,A=t.detail.mentions;_.getInstance().previewApis.documentState.getCurrentPage().then((function(t){i.postPageLevelComment(a,A,t)})).catch((function(t){Vm.warn("No Page Index came from preview")})),this.hideTextBoxTool(),this.unsavedBodyValue="",this.setState({key:!this.state.key}),t.stopPropagation()}}},{key:"postPageLevelComment",value:function postPageLevelComment(t,i,a){var A=a-1;this.setPageIndex(A),this.props.pageStore.setCommentNumber(),this.props.commentsStore.resetUnsavedPageLevelAnnotId(),Ti()&&!t||this.createPageLevelComment(t,i)}},{key:"createPageLevelComment",value:function createPageLevelComment(t,i){var a=_.getInstance().previewApis.commandManager,A=new Xc(t,i,this.props.userProfileStore,this.props.toolBarStore,this.props.commentsStore,this.props.pageStore,this.pageIndex);a.executeCommand(A)}},{key:"updateSelectorForSticky",value:function updateSelectorForSticky(t,i){var a=L.STICKY_SERVER_HEIGHT_WIDTH,A=[i.right-a,i.top-a,i.right,i.top];t.subtype=L.REDHAWK_COMMENT_NOTE,t.boundingBox=A,t.noteX=A[0],t.noteY=A[3]}},{key:"render",value:function render(){var t=this,i=this.state,a=i.FrictionlessVerbPanel,A=i.showFrictionlessPanel,l="zh-CN"===g.locale.getLocale(),u=a&&this.props.commentsStore.haveCommentsLoaded&&A&&this.commentCount<=0&&!l,d=!Ti()&&this.state.showSuggestions&&this.props.commentsStore.haveCommentsLoaded&&!this.props.commentsStore.hasUserCommented&&ei.shouldShowCommentsPanel&&!Fi.getInstance().isUserInitiator()&&!Ve.isUnSharedReview;ei.setShowCommentSuggestions(d),ei.setFrictionlessPanelVisible(u);var c=L.COMMENTS_BACKGROUND_DIV_WIDTH,m=ei.scrollbarWidth,h="",p={},C={};this.props.hideBackground||(h=Ti()?HA.a.textComponentContainerPC:HA.a.textComponentContainer,!Ti()||Ei()&&this.props.commentsStore.haveCommentsLoaded||(h="".concat(h," ").concat(HA.a.disabledContainer)),p={backgroundColor:et(),width:"".concat(c,"px"),right:"".concat(m,"px")},C={width:"".concat(c-10,"px")});var v=this.props.useModernView?HA.a.modernTextboxContainer:HA.a.textboxContainer;this.props.useModernView&&!this.props.userProfileStore.hasAuth&&(v="".concat(v," ").concat(HA.a.anonUserTextMargin));var b=this.props.useModernView?HA.a.modernCommentSuggestionsContainer:"";return Qi.a.createElement("div",{ref:function ref(i){t.viewRef=i},__self:this,__source:{fileName:Wm,lineNumber:524,columnNumber:15}},ei.shouldShowCommentsPanel||this.props.useModernView?Qi.a.createElement("div",{ref:function ref(i){t.textbox=i},style:p,className:h,key:this.state.key,__self:this,__source:{fileName:Wm,lineNumber:527,columnNumber:13}},!Ti()&&this.props.commentsStore.showPageLevelWelcomeDialog?Qi.a.createElement(dA,{isCommentFlow:!0,useModernViewer:this.props.useModernView,__self:this,__source:{fileName:Wm,lineNumber:534,columnNumber:20}}):Qi.a.createElement("div",{className:v,style:C,onClick:this.textBoxContainerClicked.bind(this),__self:this,__source:{fileName:Wm,lineNumber:535,columnNumber:20}},!this.props.useModernView&&Qi.a.createElement(Cl,{mentionsList:Fi.getMentionsList(this.props.reviewParticipantsStore.reviewParticipants,this.props.userProfileStore.isAnnonymous()),isPageAnnot:!0,showToolBar:this.getShowToolBar(),onTextBoxClick:this.onTextboxClicked.bind(this),isEditing:this.isEditing,isAnnonymous:this.props.userProfileStore.isAnnonymous(),bodyValue:this.getBodyValue(),mentionedList:this.getMentions(),isFocused:this.state.focusTextBox,onContentUpdate:this.onContentUpdate,showPostTool:this.state.showPostTool,showCancelTool:this.state.showCancelTool,placeholder:this.getPlaceHolder(),showMentions:this.state.showMentions,commentSubtype:L.SUBTYPE_NOTE,id:"defaultTextBox",__self:this,__source:{fileName:Wm,lineNumber:542,columnNumber:21}}),this.props.useModernView&&Qi.a.createElement(Dm,{mentionsList:Fi.getMentionsList(this.props.reviewParticipantsStore.reviewParticipants,this.props.userProfileStore.isAnnonymous()),isPageAnnot:!0,showToolBar:this.getShowToolBar(),onTextBoxClick:this.onTextboxClicked.bind(this),isEditing:this.isEditing,isAnnonymous:this.props.userProfileStore.isAnnonymous(),bodyValue:this.getBodyValue(),mentionedList:this.getMentions(),isFocused:this.state.focusTextBox,onContentUpdate:this.onContentUpdate,showPostTool:this.state.showPostTool,showCancelTool:this.state.showCancelTool,placeholder:this.getPlaceHolder(),showMentions:this.state.showMentions,showMentionsCommentBox:this.state.showMentionsCommentBox,commentSubtype:L.SUBTYPE_NOTE,id:"defaultTextBox",__self:this,__source:{fileName:Wm,lineNumber:566,columnNumber:21}}),d&&Qi.a.createElement("div",{tabIndex:"0",ref:function ref(i){t.suggestionRef=i},className:b,__self:this,__source:{fileName:Wm,lineNumber:589,columnNumber:47}},Qi.a.createElement(zm,{id:"commentSuggestions",useModernView:this.props.useModernView,__self:this,__source:{fileName:Wm,lineNumber:590,columnNumber:21}}),!this.dismissCoachMark&&this.state.consentDone&&Qi.a.createElement(Gc.a,{id:"commentsTour",ref:this.onCoachMarkRef,confirmLabel:this.props.intl.formatMessage({id:"tour.okay"}),flip:!0,placement:"bottom",dismissible:!1,selector:"#commentSuggestions",onHide:this.onCoachMarkHide,title:this.props.intl.formatMessage({id:"tour.addComments.title"}),trapFocus:!0,onConfirm:this.onCoachMarkHide,__self:this,__source:{fileName:Wm,lineNumber:593,columnNumber:23}},this.props.intl.formatMessage({id:"tour.addComments.desc"})))),u&&Qi.a.createElement(a,{context:"review",className:HA.a.frictionlessPanel,onClose:this.onClose,__self:this,__source:{fileName:Wm,lineNumber:612,columnNumber:19}})):null)}}]),PageLevelCommentContainer}(Qi.a.Component),Nm=T()(Pm.prototype,"pageIndex",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){}}),Rm=T()(Pm.prototype,"dismissCoachMark",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return!0}}),T()(Pm.prototype,"setPageIndex",[x.action],Object.getOwnPropertyDescriptor(Pm.prototype,"setPageIndex"),Pm.prototype),T()(Pm.prototype,"setDismissCoachMark",[x.action],Object.getOwnPropertyDescriptor(Pm.prototype,"setDismissCoachMark"),Pm.prototype),T()(Pm.prototype,"commentCount",[x.computed],Object.getOwnPropertyDescriptor(Pm.prototype,"commentCount"),Pm.prototype),Em=Pm))||Em)||Em;Ym.propTypes={intl:Zr.intlShape,useModernView:nr.a.bool},Ym.defaultProps={intl:Zr.intlShape,useModernView:!1};var Km,qm,Gm=Object(Zr.injectIntl)(Ym),Xm=function(t){Z()(TopbarHelper,t);var i=Q()(TopbarHelper);function TopbarHelper(){return d()(this,TopbarHelper),i.apply(this,arguments)}return m()(TopbarHelper,[{key:"componentDidUpdate",value:function componentDidUpdate(){_.getInstance().previewApis.topBar&&_.getInstance().previewApis.topBar.updateTopbar()}},{key:"componentDidMount",value:function componentDidMount(){_.getInstance().previewApis.topBar&&_.getInstance().previewApis.topBar.updateTopbar()}},{key:"render",value:function render(){return null}}]),TopbarHelper}(Qi.a.Component),Zm=Object(Zr.injectIntl)(Xm),Jm=a("TtnL"),Qm=a.n(Jm),$m=a("bxbE"),eh=a.n($m),th=a("ucBj"),nh=a.n(th),oh=a("Qcb2"),ih=a.n(oh),rh=a("PAic"),ah=a.n(rh),sh="/build/src/react/components/FilterComponent.jsx",Ah=g.logging.getLogger("FilterComponent");var lh=Object(ir.inject)("FiltersStore")(Km=Object(ir.observer)((qm=function(t){Z()(FilterComponent,t);var i=Q()(FilterComponent);function FilterComponent(t){var a;return d()(this,FilterComponent),(a=i.call(this,t)).onKeyDown=function(t){switch(t.keyCode){case 27:a.applyFilter(),t.stopPropagation()}},a.commentsStatusChange=function(t){Ah.info("Selected state of comments status is ".concat(t)),a.props.FiltersStore.setunAppliedCommentsStatusButtonGroup(t)},a.unreadCommentsChange=function(t){Ah.info("Selected state of comments status is ".concat(t)),a.props.FiltersStore.setunAppliedunreadCommentsButtonGroup(t)},a.removeCountFromObject=function(t){var i=Object.assign({},t);return delete i.count,i},a.mentionsRef=Qi.a.createRef(),a.commentsRef=Qi.a.createRef(),a.timeSeriesRef=Qi.a.createRef(),a.filterPanelRef=a.props.forwardedRef?a.props.forwardedRef:Qi.a.createRef(),a.state={mentionsMore:-1,commentsMore:-1,showMentionsMore:!0,showCommentsMore:!0,showTimeSeriesNextRow:!0},a}return m()(FilterComponent,[{key:"componentWillMount",value:function componentWillMount(){oi("Participate","Use","Open comment filter list")}},{key:"componentDidMount",value:function componentDidMount(){Ah.info(" Component mounted ");var t=[this.commentsRef,this.mentionsRef,this.timeSeriesRef].map((function(t){if(!t.current)return-1;var i=Ea.a.findDOMNode(t.current),a=i.getClientRects()[0],A=i.getElementsByClassName(ah.a.buttonStyle),l=-1;if(function isOverflown(t){return t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth}(i))for(var u=0;u<A.length;u++){if(A[u].getClientRects()[0].top>a.bottom){l=u;break}}return-1!==l?A.length-l:l}));this.setState({commentsMore:t[0],mentionsMore:t[1],showCommentsMore:-1!==t[0],showMentionsMore:-1!==t[1],showTimeSeriesNextRow:-1!==t[2]}),window.addEventListener(L.CUSTOM_EVENT_ELLIPSIS_DELETE,this.applyFilter.bind(this)),document.addEventListener("click",this.handleOutsideClick.bind(this),!0)}},{key:"componentWillUnmount",value:function componentWillUnmount(){Ah.info(" Component unmounted "),window.removeEventListener(L.CUSTOM_EVENT_ELLIPSIS_DELETE,this.applyFilter.bind(this))}},{key:"mentionComponents",get:function get(){var t=this.props.FiltersStore.visibleMentionsList;return this.props.FiltersStore.mentionsButtonGroup.forEach((function(i){var a=JSON.parse(i);if(!t.find((function(t){return t.email?a.email===t.email:a.name===t.name}))){var A=Object.assign({},a);A.count=0,t.push(A)}})),t}},{key:"commentByComponents",get:function get(){var t=this.props.FiltersStore.visibleCommentsByList;return this.props.FiltersStore.commentAuthorButtonGroup.forEach((function(i){var a=JSON.parse(i);if(!t.find((function(t){return t.id===a.id&&t.name===a.name}))){var A=Object.assign({},a);A.count=0,t.push(A)}})),t}},{key:"isApplyButtonDisabled",get:function get(){return!(ih()(this.props.FiltersStore.unAppliedCommentsButtonGroup,this.props.FiltersStore.commentAuthorButtonGroup).length>0||ih()(this.props.FiltersStore.unAppliedMentionsButtonGroup,this.props.FiltersStore.mentionsButtonGroup).length>0||ih()(this.props.FiltersStore.unAppliedTimeSeriesButtonGroup,this.props.FiltersStore.timeSeriesButtonGroup).length>0||ih()(this.props.FiltersStore.unAppliedCommentsStatusButtonGroup,this.props.FiltersStore.commentsStatusButtonGroup).length>0||ih()(this.props.FiltersStore.unAppliedUnreadCommentsButtonGroup,this.props.FiltersStore.unreadCommentsButtonGroup).length>0)}},{key:"isClearAllEnabled",get:function get(){return this.props.FiltersStore.unAppliedCommentsButtonGroup.length>0||this.props.FiltersStore.unAppliedMentionsButtonGroup.length>0||this.props.FiltersStore.unAppliedTimeSeriesButtonGroup.length>0||this.props.FiltersStore.unAppliedCommentsStatusButtonGroup.length>0||this.props.FiltersStore.unAppliedUnreadCommentsButtonGroup.length>0||this.props.FiltersStore.unAppliedSelectedUnreadFilter}},{key:"mentionsChange",value:function mentionsChange(t){Ah.info("Selected state of mentions is ".concat(t)),this.props.FiltersStore.setunAppliedMentionsButtonGroup(t)}},{key:"commentAuthorChange",value:function commentAuthorChange(t){Ah.info("Selected state of mentions is ".concat(t)),this.props.FiltersStore.setunAppliedCommentsButtonGroup(t)}},{key:"timeSeriesChange",value:function timeSeriesChange(t){Ah.info("Selected state of time series is ".concat(t)),this.props.FiltersStore.setunAppliedTimeSeriesButtonGroup(t)}},{key:"applyFilter",value:function applyFilter(){this.props.FiltersStore.updateLastFilterChangeTime((new Date).getTime()),this.props.FiltersStore.setApplyFilters(),this.props.closeFilterPanel(),oi("Participate","Use","Filters Applied")}},{key:"handleOutsideClick",value:function handleOutsideClick(t){this.filterPanelRef&&this.filterPanelRef.current&&!this.filterPanelRef.current.contains(t.target)&&this.applyFilter()}},{key:"clearAllFilters",value:function clearAllFilters(){this.props.FiltersStore.resetButtonGroups(),this.props.FiltersStore.noOfFilteredComments=0,this.props.collapseOnClear&&this.props.closeFilterPanel(),oi("Participate","Use","Filters Cleared")}},{key:"render",value:function render(){var t=this,i=[ah.a.buttonGroupStyle,ah.a.doubleRow],a=[ah.a.buttonGroupStyle,ah.a.doubleRow],A=[ah.a.buttonGroupStyle,ah.a.doubleRow];return this.state.showMentionsMore||(i=ah.a.buttonGroupStyle),this.state.showCommentsMore||(a=ah.a.buttonGroupStyle),this.state.showTimeSeriesNextRow||(A=ah.a.buttonGroupStyle),Qi.a.createElement("div",{ref:this.filterPanelRef,className:ah.a.filter,tabIndex:-1,role:"presentation",onKeyDown:function onKeyDown(i){t.onKeyDown(i)},__self:this,__source:{fileName:sh,lineNumber:272,columnNumber:7}},Qi.a.createElement("div",{className:ah.a.filterComponentContainer,__self:this,__source:{fileName:sh,lineNumber:280,columnNumber:11}},Qi.a.createElement("div",{__self:this,__source:{fileName:sh,lineNumber:281,columnNumber:13}},this.props.intl.formatMessage({id:"filter.status"})),Qi.a.createElement(Lm.a,{onChange:this.commentsStatusChange,value:this.props.FiltersStore.unAppliedCommentsStatusButtonGroup,className:Ra()([ah.a.buttonGroupStyle,ah.a.singleRow]),multiple:!0,manageTabIndex:!1,"aria-label":this.props.intl.formatMessage({id:"filter.status"}),role:"group",__self:this,__source:{fileName:sh,lineNumber:284,columnNumber:13}},this.props.FiltersStore.commentsStatusList.map((function(i){return Qi.a.createElement(la.a,{variant:"action",className:ah.a.buttonStyle,data:JSON.stringify(i),value:JSON.stringify(t.removeCountFromObject(i)),label:"".concat(t.props.intl.formatMessage({id:i.name})),__self:t,__source:{fileName:sh,lineNumber:294,columnNumber:17}})})))),this.props.FiltersStore.isIMSUser()&&Qi.a.createElement("div",{className:ah.a.filterComponentContainer,__self:this,__source:{fileName:sh,lineNumber:307,columnNumber:15}},Qi.a.createElement("div",{__self:this,__source:{fileName:sh,lineNumber:308,columnNumber:15}},this.props.intl.formatMessage({id:"filter.unreadComments"})),Qi.a.createElement(Lm.a,{onChange:this.unreadCommentsChange,value:this.props.FiltersStore.unAppliedUnreadCommentsButtonGroup,className:Ra()([ah.a.buttonGroupStyle,ah.a.singleRow]),multiple:!0,manageTabIndex:!1,"aria-label":this.props.intl.formatMessage({id:"filter.unreadComments"}),role:"group",__self:this,__source:{fileName:sh,lineNumber:311,columnNumber:15}},Qi.a.createElement(la.a,{variant:"action",className:ah.a.buttonStyle,value:"unreadComments",data:"unreadComments",label:"".concat(this.props.intl.formatMessage({id:"filter.unread"})),__self:this,__source:{fileName:sh,lineNumber:320,columnNumber:17}}))),Qi.a.createElement("div",{className:ah.a.filterComponentContainer,__self:this,__source:{fileName:sh,lineNumber:331,columnNumber:11}},Qi.a.createElement("div",{className:ah.a.mentionsText,__self:this,__source:{fileName:sh,lineNumber:332,columnNumber:13}},this.props.intl.formatMessage({id:"filter.timePosted"})),Qi.a.createElement(Lm.a,{onChange:this.timeSeriesChange.bind(this),value:this.props.FiltersStore.unAppliedTimeSeriesButtonGroup,className:Ra()(A),multiple:!0,manageTabIndex:!1,"aria-label":this.props.intl.formatMessage({id:"filter.timePosted"}),role:"group",__self:this,__source:{fileName:sh,lineNumber:335,columnNumber:13}},this.props.FiltersStore.timeSeriesList.map((function(i){return Qi.a.createElement(la.a,{variant:"action",className:ah.a.buttonStyle,disabled:0===i.count,data:JSON.stringify(i),value:JSON.stringify(t.removeCountFromObject(i)),label:"".concat(t.props.intl.formatMessage({id:i.name})),__self:t,__source:{fileName:sh,lineNumber:345,columnNumber:17}})})))),this.commentByComponents.length>0&&Qi.a.createElement("div",{className:ah.a.filterComponentContainer,__self:this,__source:{fileName:sh,lineNumber:358,columnNumber:11}},Qi.a.createElement("div",{className:ah.a.commentsByText,__self:this,__source:{fileName:sh,lineNumber:359,columnNumber:13}},this.props.intl.formatMessage({id:"filter.author"})),Qi.a.createElement(Lm.a,{ref:this.commentsRef,onChange:this.commentAuthorChange.bind(this),value:this.props.FiltersStore.unAppliedCommentsButtonGroup,className:Ra()(a),multiple:!0,manageTabIndex:!1,"aria-label":this.props.intl.formatMessage({id:"filter.author"}),role:"group",__self:this,__source:{fileName:sh,lineNumber:362,columnNumber:13}},this.commentByComponents.map((function(i){return i.name&&Qi.a.createElement(la.a,{variant:"action",className:ah.a.buttonStyle,data:JSON.stringify(i),value:JSON.stringify(t.removeCountFromObject(i)),label:"".concat(i.name),__self:t,__source:{fileName:sh,lineNumber:374,columnNumber:17}})}))),this.state.showCommentsMore&&-1!==this.state.commentsMore&&Qi.a.createElement(nh.a,{className:ah.a.link,onClick:function onClick(){return t.setState({showCommentsMore:!1})},__self:this,__source:{fileName:sh,lineNumber:385,columnNumber:17}},this.props.intl.formatMessage({id:"filter.moreButtons"},{noOfButtons:this.state.commentsMore}))),this.mentionComponents.length>0&&Qi.a.createElement("div",{className:ah.a.filterComponentContainer,__self:this,__source:{fileName:sh,lineNumber:396,columnNumber:11}},Qi.a.createElement("div",{className:ah.a.mentionsText,__self:this,__source:{fileName:sh,lineNumber:397,columnNumber:13}},this.props.intl.formatMessage({id:"filter.mentions"})),Qi.a.createElement(Lm.a,{ref:this.mentionsRef,onChange:this.mentionsChange.bind(this),value:this.props.FiltersStore.unAppliedMentionsButtonGroup,className:Ra()(i),multiple:!0,manageTabIndex:!1,"aria-label":this.props.intl.formatMessage({id:"filter.mentions"}),role:"group",__self:this,__source:{fileName:sh,lineNumber:400,columnNumber:13}},this.mentionComponents.map((function(i){return Qi.a.createElement(la.a,{variant:"action",className:ah.a.buttonStyle,data:JSON.stringify(i),value:JSON.stringify(t.removeCountFromObject(i)),label:"".concat(Fi.getMentionDisplayName(i)),__self:t,__source:{fileName:sh,lineNumber:411,columnNumber:17}})}))),this.state.showMentionsMore&&-1!==this.state.mentionsMore&&Qi.a.createElement(nh.a,{className:ah.a.link,onClick:function onClick(){return t.setState({showMentionsMore:!1})},__self:this,__source:{fileName:sh,lineNumber:422,columnNumber:17}},this.props.intl.formatMessage({id:"filter.moreButtons"},{noOfButtons:this.state.mentionsMore}))),Qi.a.createElement("hr",{__self:this,__source:{fileName:sh,lineNumber:432,columnNumber:9}}),Qi.a.createElement("div",{className:ah.a.actionButtons,__self:this,__source:{fileName:sh,lineNumber:433,columnNumber:9}},Qi.a.createElement(la.a,{label:this.props.intl.formatMessage({id:"filter.clearAll"}),quiet:!0,variant:"primary",onClick:this.clearAllFilters.bind(this),disabled:!this.isClearAllEnabled,__self:this,__source:{fileName:sh,lineNumber:434,columnNumber:11}}),Qi.a.createElement(la.a,{label:this.props.intl.formatMessage({id:"filter.apply"}),onClick:this.applyFilter.bind(this),"data-test-id":"apply_filter_button",quiet:!0,variant:"primary",disabled:this.isApplyButtonDisabled,__self:this,__source:{fileName:sh,lineNumber:441,columnNumber:11}})))}}]),FilterComponent}(Qi.a.Component),T()(qm.prototype,"mentionComponents",[x.computed],Object.getOwnPropertyDescriptor(qm.prototype,"mentionComponents"),qm.prototype),T()(qm.prototype,"commentByComponents",[x.computed],Object.getOwnPropertyDescriptor(qm.prototype,"commentByComponents"),qm.prototype),T()(qm.prototype,"isApplyButtonDisabled",[x.computed],Object.getOwnPropertyDescriptor(qm.prototype,"isApplyButtonDisabled"),qm.prototype),T()(qm.prototype,"isClearAllEnabled",[x.computed],Object.getOwnPropertyDescriptor(qm.prototype,"isClearAllEnabled"),qm.prototype),Km=qm))||Km)||Km;lh.propTypes={intl:Zr.intlShape,forwardedRef:nr.a.oneOfType([nr.a.func,nr.a.shape({current:nr.a.instanceOf(Element)})]),collapseOnClear:nr.a.bool,closeFilterPanel:nr.a.func.isRequired},lh.defaultProps={intl:Zr.intlShape,forwardedRef:null,collapseOnClear:!1};var uh,dh,mh,hh=Object(Zr.injectIntl)(lh),ph="/build/src/react/components/FilterContainer.jsx",fh=(g.logging.getLogger("FilterContainer"),Object(ir.inject)("FiltersStore")(uh=Object(ir.observer)((dh=function(t){Z()(FilterContainer,t);var i=Q()(FilterContainer);function FilterContainer(t){var a;return d()(this,FilterContainer),(a=i.call(this,t)).showResolvedComments=function(t){a.props.FiltersStore.setResolvedFilterValue(t)},a.state={showFilter:!1},a.setupEventListeners(),a}return m()(FilterContainer,[{key:"setupEventListeners",value:function setupEventListeners(){_.getInstance().previewApis.documentEvents.on("pageclick",this.focusOutFilterOnPageClick.bind(this)),_.getInstance().previewApis.documentEvents.on("documentclick",this.focusOutFilterOnPageClick.bind(this))}},{key:"commentCount",get:function get(){var t=this.props.FiltersStore.getResolvedCommentsCount()+this.props.FiltersStore.getUnresolvedCommentsCount();return fi()().then((function(i){i.eventEmitter.emit("adobe:comments:areCommentsPresent",{noOfComments:t})})),t}},{key:"focusOutFilterOnPageClick",value:function focusOutFilterOnPageClick(t){this.props.FiltersStore.resetUnappliedFiltersButtons(),this.setState({showFilter:!1})}},{key:"closeFilterOnApply",value:function closeFilterOnApply(t){this.setState({showFilter:!1})}},{key:"handleFilterClick",value:function handleFilterClick(t){this.setState({showFilter:!this.state.showFilter})}},{key:"render",value:function render(){var t=this;return Qi.a.createElement("div",{className:eh.a.filtersToolbox,__self:this,__source:{fileName:ph,lineNumber:92,columnNumber:7}},Qi.a.createElement("div",{"aria-label":this.props.intl.formatMessage({id:"filterTooltip"}),title:this.props.intl.formatMessage({id:"filterTooltip"}),className:eh.a.filterContainer,__self:this,__source:{fileName:ph,lineNumber:93,columnNumber:9}},Qi.a.createElement("div",{"aria-label":this.props.intl.formatMessage({id:"filterTooltip"}),className:eh.a.filterIconContainer,__self:this,__source:{fileName:ph,lineNumber:98,columnNumber:11}},Qi.a.createElement(la.a,{"aria-label":this.props.intl.formatMessage({id:"filterTooltip"}),"aria-expanded":this.state.showFilter,variant:"action",className:eh.a.filterIcon,onClick:function onClick(i){return t.handleFilterClick(i)},quiet:!0,selected:this.state.showFilter,style:{width:"25px",height:"27px",padding:"0px"},icon:Qi.a.createElement(Qm.a,{__self:this,__source:{fileName:ph,lineNumber:115,columnNumber:21}}),__self:this,__source:{fileName:ph,lineNumber:102,columnNumber:13}}),this.props.FiltersStore.appliedFilterCount>0&&Qi.a.createElement("div",{className:eh.a.filterAppliedCountCircle,onClick:function onClick(i){return t.handleFilterClick(i)},__self:this,__source:{fileName:ph,lineNumber:119,columnNumber:17}})),this.state.showFilter&&Qi.a.createElement(hh,{closeFilterPanel:this.closeFilterOnApply.bind(this),__self:this,__source:{fileName:ph,lineNumber:127,columnNumber:13}})),Qi.a.createElement("div",{className:eh.a.filterSeparator,__self:this,__source:{fileName:ph,lineNumber:130,columnNumber:9}}),this.props.FiltersStore.appliedFilterCount>0?Qi.a.createElement("span",{className:eh.a.totalCount,__self:this,__source:{fileName:ph,lineNumber:133,columnNumber:15}},this.props.intl.formatMessage({id:"filter.noOfComments"},{noOfFilteredComments:this.props.FiltersStore.noOfFilteredCommentComputed})):Qi.a.createElement("span",{className:eh.a.totalCount,__self:this,__source:{fileName:ph,lineNumber:134,columnNumber:15}},this.props.intl.formatMessage({id:"filter.unfilteredComments"},{noOfComments:this.commentCount})))}}]),FilterContainer}(Qi.a.Component),T()(dh.prototype,"commentCount",[x.computed],Object.getOwnPropertyDescriptor(dh.prototype,"commentCount"),dh.prototype),uh=dh))||uh)||uh),gh=Object(Zr.injectIntl)(fh),vh="/build/src/react/components/DocumentLevelComponentContainer.jsx";Object(x.useStrict)(!0);var bh,yh,_h=Xr(Object(ir.inject)("commentsStore","toolBarStore","FiltersStore","commentSyncStore","reviewParticipantsStore","pageStore","commentsDropinStore")(mh=Object(ir.observer)(mh=function(t){Z()(DocumentLevelComponentContainer,t);var i=Q()(DocumentLevelComponentContainer);function DocumentLevelComponentContainer(){var t;d()(this,DocumentLevelComponentContainer);for(var a=arguments.length,A=new Array(a),l=0;l<a;l++)A[l]=arguments[l];return(t=i.call.apply(i,[this].concat(A))).onToggleClick=function(){t.props.commentsDropinStore.setShouldShowCommentsPanel(!t.props.commentsDropinStore.shouldShowCommentsPanel),oi("Participate","Use",t.props.commentsDropinStore.shouldShowCommentsPanel?"PanelOpened":"PanelClosed")},t}return m()(DocumentLevelComponentContainer,[{key:"render",value:function render(){var t=!0,i=this.props,a=i.commentsDropinStore,A=i.commentsStore,l=i.intl;return Ti()&&(t=a.shouldShowCommentsPanel),Qi.a.createElement("div",{className:ud.a.documentLevelComponent,__self:this,__source:{fileName:vh,lineNumber:70,columnNumber:7}},!Ti()&&Qi.a.createElement(Cc,{__self:this,__source:{fileName:vh,lineNumber:71,columnNumber:37}}),!Ti()&&a.shouldShowCommentsPanel&&a.shouldShowToggleButton&&Qi.a.createElement(la.a,{"aria-label":l.formatMessage({id:"commentPanel.toggle"}),className:ud.a.commentsPanelOpen,icon:Qi.a.createElement(ad.a,{__self:this,__source:{fileName:vh,lineNumber:76,columnNumber:17}}),title:l.formatMessage({id:"commentPanel.toggle"}),onClick:this.onToggleClick,quiet:!0,variant:"action",__self:this,__source:{fileName:vh,lineNumber:73,columnNumber:12}}),!Ti()&&!a.shouldShowCommentsPanel&&a.shouldShowToggleButton&&Qi.a.createElement(la.a,{"aria-label":l.formatMessage({id:"commentPanel.toggle"}),className:ud.a.commentsPanelClose,icon:Qi.a.createElement(Ad.a,{__self:this,__source:{fileName:vh,lineNumber:87,columnNumber:17}}),title:l.formatMessage({id:"commentPanel.toggle"}),onClick:this.onToggleClick,quiet:!0,variant:"action",__self:this,__source:{fileName:vh,lineNumber:84,columnNumber:12}}),!Ti()&&a.shouldShowCommentsPanel&&Qi.a.createElement(gh,{__self:this,__source:{fileName:vh,lineNumber:96,columnNumber:14}}),Qi.a.createElement(Bc,{__self:this,__source:{fileName:vh,lineNumber:98,columnNumber:9}}),t&&Qi.a.createElement(Kc,{__self:this,__source:{fileName:vh,lineNumber:99,columnNumber:41}}),Qi.a.createElement(Gm,{__self:this,__source:{fileName:vh,lineNumber:100,columnNumber:9}}),Ti()&&!1!==a.forcedShouldShowCommentsPanel&&A.haveCommentsLoaded&&Qi.a.createElement(la.a,{"aria-label":l.formatMessage({id:"commentPanel.toggle"}),className:a.shouldShowCommentsPanel?ud.a.commentsPanelOpen:ud.a.commentsPanelClose,icon:a.shouldShowCommentsPanel?Qi.a.createElement(ad.a,{__self:this,__source:{fileName:vh,lineNumber:108,columnNumber:65}}):Qi.a.createElement(Ad.a,{__self:this,__source:{fileName:vh,lineNumber:108,columnNumber:86}}),title:l.formatMessage({id:"commentPanel.toggle"}),onClick:this.onToggleClick,quiet:!0,variant:"action",__self:this,__source:{fileName:vh,lineNumber:104,columnNumber:11}}),Ti()&&a.shouldShowCommentsPanel&&Qi.a.createElement(Qi.a.Fragment,{__self:this,__source:{fileName:vh,lineNumber:117,columnNumber:13}},Qi.a.createElement("div",{id:"pcShadowDiv",className:ud.a.pcShadowDiv,__self:this,__source:{fileName:vh,lineNumber:118,columnNumber:15}},Qi.a.createElement("div",{className:ud.a.pcShadowDivWrap,__self:this,__source:{fileName:vh,lineNumber:119,columnNumber:17}}))),a.shouldShowCommentsPanel?Qi.a.createElement(xc,{__self:this,__source:{fileName:vh,lineNumber:123,columnNumber:56}}):"",Ti()?Qi.a.createElement(Zm,{__self:this,__source:{fileName:vh,lineNumber:124,columnNumber:35}}):null)}}]),DocumentLevelComponentContainer}(Qi.a.Component))||mh)||mh),Ih=a("jat1"),wh=a.n(Ih),Mh=function(t){Z()(TopBarButton,t);var i=Q()(TopBarButton);function TopBarButton(t){return d()(this,TopBarButton),i.call(this,t)}return m()(TopBarButton,[{key:"getIconClassName",value:function getIconClassName(){return this.props.isDisabled?wh.a.iconDisabled:this.props.isSelected?wh.a.iconSelected:wh.a.iconEnabled}},{key:"render",value:function render(){var t=this,i=this.getIconClassName();return Qi.a.createElement("div",{className:i,__self:this,__source:{fileName:"/build/src/react/components/TopBarButton.jsx",lineNumber:44,columnNumber:7}},Qi.a.createElement(la.a,{variant:"action",quiet:!0,icon:function iconWithStyle(i){return Qi.a.createElement(i,{style:t.props.style,__self:t,__source:{fileName:"/build/src/react/components/TopBarButton.jsx",lineNumber:41,columnNumber:7}})}(this.props.icon),id:this.props.id,title:ba({id:this.props.tooltip}),disabled:this.props.isDisabled,"aria-labelledby":ba({id:this.props.tooltip}),onClick:this.props.handleClick,__self:this,__source:{fileName:"/build/src/react/components/TopBarButton.jsx",lineNumber:45,columnNumber:9}}))}}]),TopBarButton}(Qi.a.Component),kh=Object(Zr.injectIntl)(Mh),Sh={};Sh=a("+lnk").auth;var Th=(bh={},l()(bh,L.REDHAWK_COMMENT_HIGHLIGHT,{id:L.REDHAWK_COMMENT_HIGHLIGHT,name:L.TOPBAR_HIGHLIGHT_TOOLNAME,getIcon:function getIcon(){return hd.a},toolTip:"highlightTooltip",clickEvent:"ClickHighLight"}),l()(bh,L.REDHAWK_COMMENT_STRIKEOUT,{id:L.REDHAWK_COMMENT_STRIKEOUT,name:L.TOPBAR_STRIKEOUT_TOOLNAME,getIcon:function getIcon(){return Cd.a},toolTip:"strikethroughTooltip",clickEvent:"ClickStrikeout"}),l()(bh,L.REDHAWK_COMMENT_UNDERLINE,{id:L.REDHAWK_COMMENT_UNDERLINE,name:L.TOPBAR_UNDERLINE_TOOLNAME,getIcon:function getIcon(){return bd.a},toolTip:"underlineTooltip",clickEvent:"ClickUnderline"}),l()(bh,L.REDHAWK_COMMENT_NOTE,{id:L.REDHAWK_COMMENT_NOTE,name:L.TOPBAR_STICKYNOTE_TOOLNAME,getIcon:function getIcon(){return fd.a},toolTip:"sticyTooltip",clickEvent:"ClickStickyNote"}),l()(bh,L.REDHAWK_COMMENT_SHAPE,{id:L.REDHAWK_COMMENT_SHAPE,name:L.TOPBAR_FREEHAND_TOOLNAME,getIcon:function getIcon(){return _d.a},toolTip:"shapeTooltip",clickEvent:"ClickDrawingTool"}),l()(bh,L.REDHAWK_COMMENT_FREETEXT,{id:L.REDHAWK_COMMENT_FREETEXT,name:L.TOPBAR_FREETEXT_TOOLNAME,getIcon:function getIcon(){return wd.a},toolTip:"freetextTooltip",clickEvent:"ClickFreeText"}),l()(bh,L.REDHAWK_ERASER,{id:L.REDHAWK_ERASER,name:L.TOPBAR_ERASER_TOOLNAME,getIcon:function getIcon(){return Dd.a},toolTip:"eraserTooltip",clickEvent:"ClickEraserTool"}),l()(bh,L.REDHAWK_COMMENT_COLORPICKER,{id:L.REDHAWK_COMMENT_COLORPICKER,name:L.REDHAWK_COMMENT_COLORPICKER_TOOLNAME,wrappedComponent:sa(ya(Hd))}),l()(bh,L.REDHAWK_FONTSIZE_SCALE_TOOLNAME,{id:L.REDHAWK_FONTSIZE_SCALE_TOOLNAME,name:L.REDHAWK_FONTSIZE_SCALE_TOOLNAME,wrappedComponent:sa(ya(lc))}),l()(bh,L.REDHAWK_STROKEWIDTH_SCALE_TOOLNAME,{id:L.REDHAWK_STROKEWIDTH_SCALE_TOOLNAME,name:L.REDHAWK_STROKEWIDTH_SCALE_TOOLNAME,wrappedComponent:sa(ya(uc))}),l()(bh,L.REDHAWK_HIGHLIGHT_THICKNESS_SCALE_TOOLNAME,{id:L.REDHAWK_HIGHLIGHT_THICKNESS_SCALE_TOOLNAME,name:L.REDHAWK_STROKEWIDTH_SCALE_TOOLNAME,wrappedComponent:sa(ya(dc))}),bh),xh=function isSelected(t,i){return t.toolBarStore.selectedTool===Th[i].id},Eh=function shouldEnableCommenting(t){return t.commentsStore.haveCommentsLoaded&&Ei()&&!t.commentsDropinStore.disableCommenting},Ph=function isToolDisabled(t){return!Eh(t)},Nh=Object(ir.observer)(yh=function(t){Z()(CssAwareIcon,t);var i=Q()(CssAwareIcon);function CssAwareIcon(){return d()(this,CssAwareIcon),i.apply(this,arguments)}return m()(CssAwareIcon,[{key:"render",value:function render(){var t=this.props,i=t.toolId,a=t.stores,A=Th[i].getIcon(a),l=function getIconClassName(t,i){return Ph(t)?wh.a.iconDisabledDiv:xh(t,i)?wh.a.iconSelectedDiv:wh.a.iconEnabledDiv}(a,i);return Qi.a.createElement("div",{className:l,__self:this,__source:{fileName:"/build/src/react/components/CommentsTopbarButtonContainer.jsx",lineNumber:159,columnNumber:12}},Qi.a.createElement(A,{__self:this,__source:{fileName:"/build/src/react/components/CommentsTopbarButtonContainer.jsx",lineNumber:159,columnNumber:43}}))}}]),CssAwareIcon}(Qi.a.Component))||yh;Nh.propTypes={stores:nr.a.objectOf(nr.a.any).isRequired,toolId:nr.a.objectOf(nr.a.string).isRequired};var Rh=function getTopBarAction(t,i){var a=Th[i],A=a.name,l=a.toolTip;return{id:A,label:ba({id:l}),onClick:function onClick(){return function handleOnClick(t,i){if(!Ph(t)){if(Si.isSharedCommentingMode()&&!Sh.isSignedIn)return void Sh.signIn();t.toolBarStore.isThisToolSelected(i)?oi("Commenting","CommentToolBar","".concat(Th[i].clickEvent),{"adb.event.context.dc.ButtonState":"Disable"}):oi("Commenting","CommentToolBar","".concat(Th[i].clickEvent),{"adb.event.context.dc.ButtonState":"Enable"}),t.toolBarStore.toggleSelectedTool(i)}}(t,i)},disabled:Ph(t),selected:xh(t,i),Icon:Qi.a.createElement(Nh,{stores:t,toolId:i,__self:void 0,__source:{fileName:"/build/src/react/components/CommentsTopbarButtonContainer.jsx",lineNumber:197,columnNumber:11}})}},Dh=function getTopBarCustomAction(t){return{id:Th[t].name,action:Th[t].wrappedComponent}},Oh=sa(Object(ir.inject)((function mapStoresToProps(t,i){return{id:Th[i.options.type].id,icon:Th[i.options.type].getIcon(t),title:i.options.type,isDisabled:!Eh(t),tooltip:Th[i.options.type].toolTip,isSelected:xh(t,i.options.type),handleClick:function handleClick(i){!function handleButtonClick(t,i){var a=t.currentTarget.getAttribute("id");i.toolBarStore.showBanner&&(i.toolBarStore.setShowBanner(!1),_.getInstance().previewApis.documentActions.clearPageSelection(i.toolBarStore.selectedTextPageNo.startPage,i.toolBarStore.selectedTextPageNo.endPage),i.toolBarStore.resetSelectedTextPageNo()),i.toolBarStore.isThisToolSelected(a)?i.toolBarStore.resetSelectedTool():i.toolBarStore.setSelectedTool(a)}(i,t)}}}))(kh)),Lh=function navigateDownCommentsListOnDownArrowKey(t){var i=!1;if("menuitem"!==t.target.getAttribute("role")&&40===t.which){var a=$o.selectedCommentId;if(a){var A=Ct.getCommentIndex(a);if(A<Ct.commentsPosition.length-1){i=!0;var l=Ct.commentsPosition[A+1];$o.setSelectedCommentId(l.commentId),l.viewRef.focus()}}}return i},Bh=function navigateUpCommentsListOnUpArrowKey(t){var i=!1;if("menuitem"!==t.target.getAttribute("role")&&38===t.which){var a=$o.selectedCommentId;if(a){var A=Ct.getCommentIndex(a);if(A>0){i=!0;var l=Ct.commentsPosition[A-1];$o.setSelectedCommentId(l.commentId),l.viewRef.focus()}}}return i},Uh=function navigateCommentsListOnArrowKey(t){var i=!1;if("menuitem"!==t.target.getAttribute("role")&&(38===t.keyCode||40===t.keyCode)){var a=Ct.commentsPosition.length,A=t.target.id,l=38===t.keyCode?-1:1;if(A){i=!0;var u=Ct.getCommentIndex(A)+l,d=u<0?a-1:u%a;Ct.commentsPosition[d].viewRef.focus()}}return i},Fh=function isValidRGBArr(t){return!(!t||!Array.isArray(t)||3!==t.length)},jh=function validateColorPalette(t){return!!t&&("rgb"===t.colorSpace&&Fh(t.background)&&Fh(t.text)&&Fh(t.buttonFace)&&Fh(t.buttonText)&&Fh(t.highlight)&&Fh(t.highlightText))},Hh=function getRGBColorStr(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgb";return"".concat(i,"(").concat(t[0],", ").concat(t[1],", ").concat(t[2],")")},zh=function parseColorPalette(t){if(!t)return null;var i=P()({},t);return i.text=Hh(i.text),i.background=Hh(i.background),i.buttonFace=Hh(i.buttonFace),i.buttonText=Hh(i.buttonText),i.highlight=Hh(i.highlight),i.highlightText=Hh(i.highlightText),i},Wh="/build/src/RHComments.jsx",Vh={FiltersStore:Bo,commentsStore:$o,toolBarStore:lo,commentSyncStore:fo,reviewParticipantsStore:Li,commentsPositionStore:Ct,userProfileStore:vi,pageStore:pt,assetStore:Ve,ReviewStore:Di,commentsDropinStore:ei},Yh=ya(dA),qh=ya(fc),Gh={};Gh=a("+lnk").providers;var Xh=ya(_h),Zh=function(t){Z()(CommentManager,t);var i=Q()(CommentManager);function CommentManager(t){var a;d()(this,CommentManager),(a=i.call(this,t)).triggerLogin=function(t){window.dispatchEvent(new CustomEvent("adobe:comments:hideCoachMark",{bubbles:!0})),$o.isCommentExpanded&&$o.resetSelectedCommentId(),deleteVariableValueFromSessionStorage(Fi.getAssetUri()),$o.setGuestLoginDownload(t.isDownloadFlow),a.dialogKey=ar.a.show(Qi.a.createElement(Yh,{commentsStore:$o,commentsDropinStore:ei,userProfileStore:vi,hideDialog:a.hideDialog.bind(Zi()(a)),__self:Zi()(a),__source:{fileName:Wh,lineNumber:296,columnNumber:42}}))},a.apis=t.apis,a.shouldUseModernViewerComment(t.config.useModernViewer),Je.setPreviewApis(a.apis);var A=_.getInstance(a.apis,!0);return vi.initialize(),vi.getUserProfile(),a.isMobileDevice=!1,!Ti()&&Fi.detectMobile()?(a.isMobileDevice=!0,er()(a)):(a.apis.hud.setPrintVisibility(!1),a.apis.modifyBgColor.setBgColor(L.REDHAWK_MAIN_BG_COLOR),a.documentEvents=a.apis.documentEvents,Di.setReviewApis(),lo.setIsFreetextEnabled(!1),lo.setIsEraserToolEnabled(!1),$o.setHaveCommentsLoaded(!1),Ti()?($o.resetSelectedCommentId(),A.previewApis.commandManager.registerPreUndoHandler((function(){return $o.handleUnsavedChanges()})),A.previewApis.commandManager.registerPreRedoHandler((function(){return $o.handleUnsavedChanges()})),A.previewApis.documentActions.setFixedWidthMode(!1),ei.setShouldShowCommentsPanel(!1)):(A.previewApis.documentActions.setFixedWidthMode(!1),ei.setShouldShowCommentsPanel(!0,!0)),Ti()||Di.commentsApiUrl?($o.fetchReadCommentsList(),$o.fetchComments()):Object(x.reaction)((function(){return Di.commentsApiUrl}),(function(t){t&&($o.fetchReadCommentsList(),$o.fetchComments())})),ao.initialize({stores:{userProfileStore:vi,reviewParticipantsStore:Li,toolBarStore:lo,commentsStore:$o,commentsDropinStore:ei,assetStore:Ve}}),a.initializeColorPalette(A),Si.getIntegrationProvider().then((function(t){if(t){if(Ti()){var i=!!t&&t.apis.comments.isFreetextEnabled(),A=!(!t||!t.apis.comments.isEraserToolEnabled)&&t.apis.comments.isEraserToolEnabled();t.apis.comments.registerRestrictedApis&&t.apis.comments.registerRestrictedApis({setConfig:function setConfig(t){return ao.setConfig(t)}}),lo.setIsFreetextEnabled(i),lo.setIsEraserToolEnabled(A),he()||(!function showTopBarEmbedded(){var t=_.getInstance();return!!(t&&t.previewApis&&t.previewApis.topBarEmbedded)&&t.previewApis.topBarEmbedded.showTopBarEmbedded()}()?t.apis.comments.registerTools({getTopBarTools:function getTopBarTools(){return function getTopBarActions(t,i,a){return Ei()?[L.REDHAWK_COMMENT_NOTE,L.REDHAWK_COMMENT_SHAPE,L.REDHAWK_COMMENT_HIGHLIGHT,L.REDHAWK_COMMENT_UNDERLINE,L.REDHAWK_COMMENT_STRIKEOUT].concat(b()(i?[L.REDHAWK_COMMENT_FREETEXT]:[]),b()(a?[L.REDHAWK_ERASER]:[])).map((function(i){return Rh(t,i)})):[]}(Vh,i,A)},getCustomTopBarTools:function getCustomTopBarTools(){return function getTopBarCustomActions(t){if(!Ei())return[];var i=[];return t.toolBarStore.isToolSelected()&&!t.toolBarStore.isThisToolSelected(L.REDHAWK_ERASER)&&i.push(Dh(L.REDHAWK_COMMENT_COLORPICKER)),t.toolBarStore.isThisToolSelected(L.REDHAWK_COMMENT_FREETEXT)&&i.push(Dh(L.REDHAWK_FONTSIZE_SCALE_TOOLNAME)),t.toolBarStore.isThisToolSelected(L.REDHAWK_COMMENT_SHAPE)&&i.push(Dh(L.REDHAWK_STROKEWIDTH_SCALE_TOOLNAME)),t.toolBarStore.isThisToolSelected(L.REDHAWK_COMMENT_HIGHLIGHT)&&i.push(Dh(L.REDHAWK_HIGHLIGHT_THICKNESS_SCALE_TOOLNAME)),i}(Vh)},getToolbar:function getToolbar(){return Qi.a.createElement(qh,Object.assign({},Vh,{__source:{fileName:Wh,lineNumber:200,columnNumber:35}}))}}):a.registerToolsOnTopbar())}Object(x.reaction)((function(){return $o.haveCommentsLoaded}),(function(i,A){A.dispose(),i&&a.componentMounted&&(t.apis.comments.registerCommentsApis(ao),(Ti()||Vh.commentsDropinStore.shouldUseModernViewer)&&(setTimeout((function(){ao.triggerEvent(L.API_EVENTS.ANNOTATION_COUNT,$o.getFlattenComments().length)})),a.apis.contextMenu.subscribe({name:"CommentsDropin",contextMenuHandler:Ts.getInstance().textSelectionHandler,type:L.TEXT_SELECTION}),a.apis.contextMenu.subscribe({name:"CommentsDropin",contextMenuHandler:Ts.getInstance().commentSelectionHandler,type:L.COMMENT_SELECTED}),a.apis.contextMenu.subscribe({name:"CommentsDropin",contextMenuHandler:Ts.getInstance().colorPickerHandler,type:L.COLOR_PICKER}),a.apis.contextMenu.subscribe({name:"CommentsDropin",contextMenuHandler:Ts.getInstance().scaleAnnotHandler,type:L.SCALE_ANNOT}),a.apis.contextMenu.subscribe({name:"CommentsDropin",contextMenuHandler:Ts.getInstance().rightClickContextMenuHandler,type:L.RIGHT_CLICK})))}))}})),a.apis.previewPublicApis.rhp.subscribe((function(t){var i=t.currentActiveDropin,a=t.previousActiveDropin;"comments"===i?ei.setShouldShowCommentsPanel(!0,!0):"comments"===a&&ei.setShouldShowCommentsPanel(!1,!1)})),a.apis.documentEvents.on("documentclick",a.onDocumentClick.bind(Zi()(a))),a.apis.documentEvents.on("pagesViewScrolled",a.onPagesViewScrolled.bind(Zi()(a))),a.apis.documentEvents.on(L.HC_THEME_CHANGE_EVT,a.onHCThemeChange.bind(Zi()(a))),Ti()&&a.apis.documentEvents.on("contenttypeundermousechanged",a.onContentTypeChange.bind(Zi()(a))),Li.fetchReviewParticipants(),a.apis.registerPageOverlay(id),a.registerKeyboardEvents(),window.addEventListener("resize",a.updateDimensions.bind(Zi()(a))),!Ti()&&!Vh.commentsDropinStore.shouldUseModernViewer&&a.apis.hud.setFitWidthModeVisibility(!1),!Ti()&&a.apis.hud.setFitPageModeVisibility(!1),!Ti()&&!Vh.commentsDropinStore.shouldUseModernViewer&&a.apis.hud.setFixedWidthVisibility(!0),a.apis.disableContextMenu&&a.apis.disableContextMenu.registerClassNamesToDisableContextMenuOn(new Array(Ps.a.commentPopupContainer,HA.a.textComponentContainer)),window.addEventListener("beforeunload",a.beforeUnload.bind(Zi()(a))),a.handleQueryParams(),Ti()||Gh["review-handler"]().then((function(t){a.reviewApi=t,t.subscribe("comments:triggerUserLogin",a.triggerLogin.bind(Zi()(a)))})),pt.updateInnerWidth(window.innerWidth),a)}return m()(CommentManager,[{key:"initializeColorPalette",value:function initializeColorPalette(t){var i=t.previewApis.previewPublicApis;if(i&&i.app&&i.app.getColorPalette&&i.app.getColorPalette instanceof Function){var a=i.app.getColorPalette();if(a&&!jh(a))return;var A=zh(a);$o.setHCColorPalette(A)}}},{key:"shouldUseModernViewerComment",value:function shouldUseModernViewerComment(t){Vh.commentsDropinStore.setModernViewer(t),Vh.commentsStore.setShowCommentFailureNotifier(t),Vh.commentsStore.setDeleteFailedReply(t)}},{key:"hideDialog",value:function hideDialog(){this.dialogKey&&ar.a.hide(this.dialogKey)}},{key:"registerToolsOnTopbar",value:function registerToolsOnTopbar(){this.apis.topBarEmbedded.registerComponent("right",Oh,{type:"note"}),this.apis.topBarEmbedded.registerComponent("right",Oh,{type:"highlight"}),this.apis.topBarEmbedded.registerComponent("right",Oh,{type:"shape"})}},{key:"handleQueryParams",value:function handleQueryParams(){h.URLParamsUtil.getQueryParam(L.URI_FILTER_MY_COMMENTS)&&Bo.setFilterMyMentionedComments()}},{key:"beforeUnload",value:function beforeUnload(t){if($o.unsavedAnnotList.length>0||$o.unsavedPageLevelAnnotId){return t.returnValue="",""}}},{key:"componentWillUnmount",value:function componentWillUnmount(){window.removeEventListener("beforeunload",this.beforeUnload),Ve.stopCheckingForUpdates(),Ve.resetAssetCache(),$o.resetCommentsCache(),XA.clearSubscribers(),function unsubscribeFromState(){Fo.forEach((function(t){t&&t()})),Fo=[]}(),this.componentMounted=!1,this.reviewApi.unsubscribe("comments:triggerUserLogin",this.triggerLogin.bind(this))}},{key:"componentDidMount",value:function componentDidMount(){this.componentMounted=!0,ei.setIsDropinLoaded(!0),Di.initializeReviewData()}},{key:"onPagesViewScrolled",value:function onPagesViewScrolled(t){0===t.target.scrollTop&&vt.getInstance().bringTopCommentPopupsIntoView();var i=t.target.scrollLeft;pt.updateScrollLeft(i);var a=t.target.scrollTop;pt.updateScrollTop(a)}},{key:"updateDimensions",value:function updateDimensions(t){pt.updateInnerWidth(t.target.innerWidth)}},{key:"onContentTypeChange",value:function onContentTypeChange(t){t.contentType!==pt.contentTypeUnderMouse&&(pt.setContentTypeUnderMouse(t.contentType),lo.isThisToolSelected(L.REDHAWK_COMMENT_HIGHLIGHT)&&lo.setCursor())}},{key:"registerKeyboardEvents",value:function registerKeyboardEvents(){(Ti()||Vh.commentsDropinStore.shouldUseModernViewer)&&XA.subscribe("keydown",this.deleteCommentOnDelKey.bind(this)),XA.subscribe("keydown",this.deselectToolOnEscKey),Vh.commentsDropinStore.shouldUseModernViewer?XA.subscribe("keydown",Uh):(XA.subscribe("keydown",Lh),XA.subscribe("keydown",Bh))}},{key:"deselectToolOnEscKey",value:function deselectToolOnEscKey(t){if(!Fi.getInstance().isTargetEditable(t)&&t.which===L.ESC_KEY){if(lo.getIsGradientPickerSelected())return void lo.invertIsGradientPickerSelected();Ti()&&oi("Commenting","CommentToolBar","DisableWithEscapeKey",{"adb.event.context.dc.parentAnnot":lo.getSelectedTool()}),Vh.commentsDropinStore.shouldUseModernViewer?Je.quickToolsApis&&Je.quickToolsApis.reset():lo.resetSelectedTool()}}},{key:"onHCThemeChange",value:function onHCThemeChange(t){if(!t||jh(t)){for(var i=Ve.totalPageCount,a=0;a<i;a+=1)$o.getCommentsOfPage(a).forEach((function(t){we.isFreeText(t)&&t.target.selector.updateAppearanceRefetchStatus(!0)}));var A=zh(t);$o.setHCColorPalette(A)}}},{key:"shouldExecuteDeleteCommand",value:function shouldExecuteDeleteCommand(t){return Ti()?Ei()&&(_e()&&t.which===L.DEL_KEY_MAC||Ie()&&t.which===L.DEL_KEY_WINDOWS):t.which===L.DEL_KEY_MAC}},{key:"deleteCommentOnDelKey",value:function deleteCommentOnDelKey(t){if(!Fi.getInstance().isTargetEditable(t)&&this.shouldExecuteDeleteCommand(t)){var i=$o.selectedCommentId,a=$o.getUICommentFromId(i);if(a){var A=a.target.selector.node.index,l=_.getInstance().previewApis.commandManager,u=new no(a,a,!0,A,$o);l.executeCommand(u)}Vh.commentsDropinStore.shouldUseModernViewer&&_.getInstance().previewApis.contextMenu.destroyContextMenu()}}},{key:"onDocumentClick",value:function onDocumentClick(t){$o.resetSelectedCommentId()}},{key:"render",value:function render(){var t,i,a,A;Vh.commentsDropinStore.shouldUseModernViewer?Ce()||pe()||be()?(t="-webkit-image-set(url(".concat(wr.a,") 1x, url(").concat(kr.a,") 2x)"),i="-webkit-image-set(url(".concat(Tr.a,") 1x, url(").concat(Er.a,") 2x)"),a="-webkit-image-set(url(".concat(Nr.a,") 1x, url(").concat(Dr.a,") 2x)"),A="-webkit-image-set(url(".concat(Lr.a,") 1x, url(").concat(Ur.a,") 2x)")):ge()?(t="image-set(url(".concat(wr.a,") 1x, url(").concat(kr.a,") 2x)"),i="image-set(url(".concat(Tr.a,") 1x, url(").concat(Er.a,") 2x)"),a="image-set(url(".concat(Nr.a,") 1x, url(").concat(Dr.a,") 2x)"),A="image-set(url(".concat(Lr.a,") 1x, url(").concat(Ur.a,") 2x)")):(t="url(".concat(wr.a,")"),i="url(".concat(Tr.a,")"),a="url(".concat(Nr.a,")"),A="url(".concat(Lr.a,")")):(t=Ce()||fe()?"-webkit-image-set(url(".concat(Ar.a,") 1x, url(").concat(ur.a,") 2x)"):"url(".concat(Ar.a,")"),i=Ce()||fe()?"-webkit-image-set(url(".concat(cr.a,") 1x, url(").concat(hr.a,") 2x)"):"url(".concat(cr.a,")"),a=Ce()||fe()?"-webkit-image-set(url(".concat(br.a,") 1x, url(").concat(_r.a,") 2x)"):"url(".concat(br.a,")"));var l=Ce()||fe()?"-webkit-image-set(url(".concat(fr.a,") 1x, url(").concat(Cr.a,") 2x)"):"url(".concat(fr.a,")"),u=Ce()||fe()?"-webkit-image-set(url(".concat(jr.a,") 1x, url(").concat(zr.a,") 2x)"):"url(".concat(jr.a,")");return!this.isMobileDevice&&Qi.a.createElement("div",{__self:this,__source:{fileName:Wh,lineNumber:515,columnNumber:5}},!Vh.commentsDropinStore.shouldUseModernViewer&&Qi.a.createElement(ir.Provider,Object.assign({},Vh,{__self:this,__source:{fileName:Wh,lineNumber:518,columnNumber:9}}),Qi.a.createElement(Xh,{__self:this,__source:{fileName:Wh,lineNumber:519,columnNumber:11}})),Qi.a.createElement("div",{style:{backgroundImage:t},className:cd.a.cursor,id:"addtextcur",__self:this,__source:{fileName:Wh,lineNumber:522,columnNumber:7}}),Qi.a.createElement("div",{style:{backgroundImage:i},className:cd.a.cursor,id:"highlightcur",__self:this,__source:{fileName:Wh,lineNumber:527,columnNumber:7}}),Qi.a.createElement("div",{style:{backgroundImage:a},className:cd.a.cursor,id:"stickycur",__self:this,__source:{fileName:Wh,lineNumber:532,columnNumber:7}}),Qi.a.createElement("div",{style:{backgroundImage:Vh.commentsDropinStore.shouldUseModernViewer?A:a},className:cd.a.cursor,id:"drawingcur",__self:this,__source:{fileName:Wh,lineNumber:537,columnNumber:7}}),Qi.a.createElement("div",{style:{backgroundImage:u},className:cd.a.cursor,id:"erasercur",__self:this,__source:{fileName:Wh,lineNumber:542,columnNumber:7}}),Qi.a.createElement("div",{style:{backgroundImage:l},className:cd.a.cursor,id:"freeHighlightCur",__self:this,__source:{fileName:Wh,lineNumber:547,columnNumber:7}}),(Ti()||Vh.commentsDropinStore.shouldUseModernViewer)&&Qi.a.createElement("style",{__self:this,__source:{fileName:Wh,lineNumber:553,columnNumber:9}},"\n                .ReactVirtualized__Grid__innerScrollContainer {\n                    overflow: unset !important;\n                }\n          "))}}]),CommentManager}(Qi.a.Component);Zh.propTypes={config:nr.a.objectOf(nr.a.oneOfType([nr.a.number,nr.a.string,nr.a.bool]))},Zh.defaultProps={config:{useModernViewer:!1}};var Jh=function getAppliedFilterCount(t){return t.appliedFilterCount},Qh=function getResolvedCommentsCount(t){return t.getResolvedCommentsCount()},$h=function getUnresolvedCommentsCount(t){return t.getUnresolvedCommentsCount()},ep=function setResolvedFilterValue(t){return function(i){t.setResolvedFilterValue(i)}},tp=function resetUnappliedFiltersButtons(t){return function(){t.resetUnappliedFiltersButtons()}},np=function applyDefaultFilters(t){return function(){t.applyDefaultFilters()}},op=a("09nl"),rp=a.n(op),ap=a("T7PK"),sp=a.n(ap),Ap=function CommentsRHPIcon(t){var i=t.getUnReadCommentsCount,a=t.applyDefaultFilters,A=t.resolvedCommentsCount,l=t.resetUnappliedFiltersButtons,u=t.haveCommentsLoaded;return Object(Ji.useEffect)((function(){Ti()||(0===A?l():A>0&&a())}),[u]),Qi.a.createElement(Ji.Fragment,{__self:void 0,__source:{fileName:"/build/src/comments/CommentsRHPIcon.js",lineNumber:46,columnNumber:5}},Qi.a.createElement("div",{className:i>0?sp.a.commentIconCountWrapper:"",__self:void 0,__source:{fileName:"/build/src/comments/CommentsRHPIcon.js",lineNumber:47,columnNumber:7}},i>0?i:null),Qi.a.createElement(yA,{url:rp.a,__self:void 0,__source:{fileName:"/build/src/comments/CommentsRHPIcon.js",lineNumber:52,columnNumber:7}}))};Ap.propTypes={getUnReadCommentsCount:nr.a.number,resolvedCommentsCount:nr.a.number,applyDefaultFilters:nr.a.func.isRequired,resetUnappliedFiltersButtons:nr.a.func.isRequired,haveCommentsLoaded:nr.a.bool},Ap.defaultProps={getUnReadCommentsCount:0,haveCommentsLoaded:!1,resolvedCommentsCount:0};var lp=Object(Zr.injectIntl)(Ap),dp=Object(ir.inject)((function mapStoreToProps(){return{getUnReadCommentsCount:Bo.getUnReadCommentsCount,applyDefaultFilters:np(Bo),resolvedCommentsCount:Qh(Bo),resetUnappliedFiltersButtons:tp(Bo),haveCommentsLoaded:$o.haveCommentsLoaded}}))(lp),cp=function CustomIcon(t){var i=t.url;return Qi.a.createElement(mA.a,{size:"S",__self:void 0,__source:{fileName:"/build/node_modules/dc-preview-utils/src/components/CustomIcon.js",lineNumber:22,columnNumber:5}},Qi.a.createElement(i,{size:"S",__self:void 0,__source:{fileName:"/build/node_modules/dc-preview-utils/src/components/CustomIcon.js",lineNumber:23,columnNumber:7}}))},mp=cp;cp.propTypes={url:nr.a.element.isRequired};var hp=a("bkIL"),pp=a.n(hp),fp="/build/node_modules/dc-preview-utils/src/components/Button/ButtonWrapper.js",gp=function(t){Z()(ButtonWrapper,t);var i=Q()(ButtonWrapper);function ButtonWrapper(t){var a;return d()(this,ButtonWrapper),(a=i.call(this,t)).onMouseUp=function(){a.isActive=!1,a.overrideDefaultStyle(a.overridingStyle)},a.onMouseDown=function(){a.isActive=!0,a.overrideDefaultStyle(a.overridingStyle)},a.onMouseEnter=a.onMouseEnter.bind(Zi()(a)),a.onMouseLeave=a.onMouseLeave.bind(Zi()(a)),a.isHoverActive=!1,a}return m()(ButtonWrapper,[{key:"componentDidMount",value:function componentDidMount(){this.overrideDefaultStyle(this.overridingStyle),this.props.shouldActivate&&window.addEventListener("mouseup",this.onMouseUp)}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.props.shouldDisable&&(this.isHoverActive=!1),this.overrideDefaultStyle(this.overridingStyle)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.shouldActivate&&window.removeEventListener("mouseup",this.onMouseUp)}},{key:"onMouseEnter",value:function onMouseEnter(){this.isHoverActive=!0,this.overrideDefaultStyle(this.overridingStyle)}},{key:"onMouseLeave",value:function onMouseLeave(){this.isHoverActive=!1,this.overrideDefaultStyle(this.overridingStyle)}},{key:"overridingStyle",get:function get(){return this.props.isSelected?this.props.selectedStyle:this.isActive?this.props.activeStyle:this.isHoverActive?this.props.hoverStyle:this.props.defaultStyle}},{key:"overrideDefaultStyle",value:function overrideDefaultStyle(t){this.props.icon&&(this.setIconStyle(t),this.setButtonStyle(t)),this.setContainerStyle(this.props.containerStyle)}},{key:"setContainerStyle",value:function setContainerStyle(t){if(this.props.shouldDisable){var i=t.opacity;i&&(this.containerRef.style.opacity=i)}}},{key:"setIconStyle",value:function setIconStyle(t){var i=this,a=t.color;if(a){var A=this.containerRef.getElementsByTagName("svg");A.length&&(A[0].style.fill=a);["audio","canvas","circle","ellipse","foreignObject","iframe","image","line","path","polygon","polyline","rect","text","textPath","tspan","video"].forEach((function(t){var A=i.containerRef.getElementsByTagName(t);Array.from(A).forEach((function(t){t.style.fill=a}))}))}}},{key:"setButtonStyle",value:function setButtonStyle(t){var i=t.background;i&&(this.button.buttonRef.style.background=i)}},{key:"getButton",value:function getButton(t){var i=this;return Qi.a.createElement(la.a,{id:this.props.id,ref:function ref(t){i.button=t},disabled:this.props.shouldDisable,"aria-disabled":this.props.shouldDisable?"true":"false",onMouseEnter:this.props.shouldEnableHover?this.onMouseEnter:null,onMouseLeave:this.props.shouldEnableHover?this.onMouseLeave:null,"aria-label":t,tabIndex:this.props.tabIndex,onClick:this.props.clickHandler,onMouseDown:this.props.shouldActivate?this.onMouseDown:null,quiet:this.props.quiet,label:this.props.label,variant:this.props.variant,icon:this.props.icon?Qi.a.createElement(mp,{url:this.props.icon,__self:this,__source:{fileName:fp,lineNumber:162,columnNumber:33}}):null,holdAffordance:this.props.holdAffordance,__self:this,__source:{fileName:fp,lineNumber:146,columnNumber:7}})}},{key:"getSimpleButton",value:function getSimpleButton(){var t=this;return function(i){return Qi.a.createElement(da.a,{trigger:"hover",placement:t.props.tooltipPlacement,delayShow:t.props.tooltipDelay,__self:t,__source:{fileName:fp,lineNumber:175,columnNumber:7}},Qi.a.createElement("div",{__self:t,__source:{fileName:fp,lineNumber:180,columnNumber:9}},t.getButton(i)),Qi.a.createElement(Qr.a,{className:pp.a.HiddenTooltip,__self:t,__source:{fileName:fp,lineNumber:181,columnNumber:9}},Qi.a.createElement(Zr.FormattedMessage,{id:t.props.tooltipString,__self:t,__source:{fileName:fp,lineNumber:182,columnNumber:11}})))}}},{key:"getTooltipButton",value:function getTooltipButton(){var t=this;return function(i){return Qi.a.createElement(da.a,{trigger:"hover",placement:t.props.tooltipPlacement,delayShow:t.props.tooltipDelay,__self:t,__source:{fileName:fp,lineNumber:190,columnNumber:7}},Qi.a.createElement("div",{__self:t,__source:{fileName:fp,lineNumber:195,columnNumber:9}},t.getButton(i)),Qi.a.createElement(Qr.a,{__self:t,__source:{fileName:fp,lineNumber:196,columnNumber:9}},Qi.a.createElement(Zr.FormattedMessage,{id:t.props.tooltipString,__self:t,__source:{fileName:fp,lineNumber:197,columnNumber:11}})))}}},{key:"render",value:function render(){var t=this,i=Ra()(pp.a.Button,l()({},pp.a.ButtonDisabled,this.props.shouldDisable),l()({},pp.a.ButtonHoverEnabled,this.props.shouldEnableHover),l()({},pp.a.ButtonSelected,this.props.isSelected),this.props.className),a=ia()||!this.props.tooltipString||this.props.shouldDisableTooltip?this.getSimpleButton():this.getTooltipButton();return Qi.a.createElement("div",{className:i,ref:function ref(i){t.containerRef=i},style:this.props.containerStyle,"data-testid":this.props.ariaLabel,__self:this,__source:{fileName:fp,lineNumber:224,columnNumber:7}},Qi.a.createElement(Zr.FormattedMessage,{id:this.props.ariaLabel,__self:this,__source:{fileName:fp,lineNumber:232,columnNumber:9}},a))}}]),ButtonWrapper}(Ji.Component);gp.propTypes={id:nr.a.string,label:nr.a.string,icon:nr.a.element,shouldDisableTooltip:nr.a.bool,tooltipString:nr.a.string,tooltipPlacement:nr.a.string,tooltipDelay:nr.a.number,ariaLabel:nr.a.string,tabIndex:nr.a.number,clickHandler:nr.a.func,className:nr.a.string,defaultStyle:nr.a.objectOf(nr.a.string),shouldEnableHover:nr.a.bool,hoverStyle:nr.a.objectOf(nr.a.string),shouldActivate:nr.a.bool,activeStyle:nr.a.objectOf(nr.a.string),isSelected:nr.a.bool,selectedStyle:nr.a.objectOf(nr.a.string),shouldDisable:nr.a.bool,containerStyle:nr.a.objectOf(nr.a.oneOfType([nr.a.number,nr.a.string,nr.a.bool])),quiet:nr.a.bool,variant:nr.a.string,holdAffordance:nr.a.bool},gp.defaultProps={id:"default-btn-id",label:null,icon:null,shouldDisableTooltip:!1,tooltipString:"",tooltipPlacement:"top",tooltipDelay:1e3,ariaLabel:"default",tabIndex:0,clickHandler:function clickHandler(){},className:"",defaultStyle:{color:null,background:null},shouldEnableHover:!1,hoverStyle:{color:null,background:null},shouldActivate:!1,activeStyle:{color:null,background:null},isSelected:!1,selectedStyle:{color:null,background:null},shouldDisable:!1,containerStyle:{opacity:""},quiet:!0,variant:"action",holdAffordance:!1};var Cp=gp,vp=a("3pG8"),bp=a.n(vp),yp=function getChildren(t,i){if(t){var a=t.querySelectorAll(i);return Object.keys(a).map((function(t){return a[t]}))}return[]},_p=Qi.a.forwardRef((function(t,i){return Qi.a.Children.map(t.children,(function(a){return Qi.a.cloneElement(a,P()(P()({},t),{},{forwardedRef:i}))}))})),Ip=function FocusTrap(t){var i,a=t.children,A=t.roles,l=Qi.a.createRef();return Object(Ji.useEffect)((function(){i=document.activeElement.id;var t=l.current;return t&&(!function focusFirstChild(t,i){var a=yp(t,i);a.length&&a[0].focus()}(t,A),t.onkeydown=function(i){switch(i.keyCode){case 9:!function trapFocus(t,i,a){var A=document.activeElement,l=t.querySelectorAll(i),u=l[0],d=l[l.length-1];a.shiftKey?A===u&&(d.focus(),a.preventDefault()):A===d&&(u.focus(),a.preventDefault())}(t,A,i)}}),function(){i&&function focusElement(t){var i=document.getElementById(t);i&&i.focus()}(i)}}),[]),Qi.a.createElement(_p,{ref:l,__self:void 0,__source:{fileName:"/build/node_modules/dc-preview-utils/src/Utils/FocusUtils.js",lineNumber:181,columnNumber:7}},a)},wp={FiltersStore:Bo},Mp=ya((function component(t){return Qi.a.createElement(ir.Provider,Object.assign({},wp,{__self:void 0,__source:{fileName:"/build/src/react/containers/commentsHeader/CommentsFilterPopupContainer.jsx",lineNumber:31,columnNumber:3}}),Qi.a.createElement(Ip,{roles:"button:not([disabled])",__self:void 0,__source:{fileName:"/build/src/react/containers/commentsHeader/CommentsFilterPopupContainer.jsx",lineNumber:32,columnNumber:5}},Qi.a.createElement(hh,Object.assign({},t,{__self:void 0,__source:{fileName:"/build/src/react/containers/commentsHeader/CommentsFilterPopupContainer.jsx",lineNumber:33,columnNumber:7}}))))})),kp=a("et4Z"),Sp=a.n(kp),Tp="/build/src/react/components/commentsHeader/CommentsFilter.js",xp=function CommentsFilter(t){var i=t.intl.formatMessage,a=t.isAnyFilterApplied,A=Object(Ji.useState)(!1),l=Ke()(A,2),u=l[0],d=l[1];return Qi.a.createElement("div",{__self:void 0,__source:{fileName:Tp,lineNumber:32,columnNumber:5}},Qi.a.createElement("div",{className:Sp.a.filterButtonContainer,__self:void 0,__source:{fileName:Tp,lineNumber:33,columnNumber:7}},Qi.a.createElement(Cp,{id:"filter-comments-button",icon:bp.a,clickHandler:function clickHandler(){return d(!u)},selected:u,ariaLabel:i({id:"filterTooltip"}),"aria-expanded":u,__self:void 0,__source:{fileName:Tp,lineNumber:34,columnNumber:9}}),a&&Qi.a.createElement("div",{className:Sp.a.filterAppliedCircle,__self:void 0,__source:{fileName:Tp,lineNumber:42,columnNumber:33}})),u&&Qi.a.createElement(Mp,{closeFilterPanel:function closeFilterPanel(){return d(!1)},shouldTrapFocus:!0,collapseOnClear:!0,__self:void 0,__source:{fileName:Tp,lineNumber:46,columnNumber:11}}))},Ep=Object(Zr.injectIntl)(ya(xp));xp.propTypes={intl:Zr.intlShape,isAnyFilterApplied:nr.a.bool},xp.defaultProps={intl:Zr.intlShape,isAnyFilterApplied:!1};var Pp=a("V14s"),Np=a.n(Pp),Rp="/build/src/react/components/CommentsHeader.js",Dp=function(t){Z()(CommentsHeader,t);var i=Q()(CommentsHeader);function CommentsHeader(){return d()(this,CommentsHeader),i.apply(this,arguments)}return m()(CommentsHeader,[{key:"commentCount",get:function get(){var t=this.props,i=t.resolvedCommentsCount+t.unresolvedCommentsCount,a=fi();return oi("Commenting","CommentHeader","CommentCount",{"adb.event.context.pdfviewer.num_annotations":i}),a().then((function(t){var a=t.eventEmitter;a&&a.emit("adobe:comments:areCommentsPresent",{noOfComments:i})})),i}},{key:"render",value:function render(){var t=this.props,i=t.appliedFilterCount,a=t.noOfFilteredCommentComputed,A=t.intl.formatMessage;return Qi.a.createElement(Qi.a.Fragment,null,Qi.a.createElement("div",{className:Np.a.container,__self:this,__source:{fileName:Rp,lineNumber:53,columnNumber:9}},Ti()?Qi.a.createElement("div",{className:Np.a.title,__self:this,__source:{fileName:Rp,lineNumber:79,columnNumber:15}},A({id:"header.comments"}),Qi.a.createElement("span",{className:Np.a.filteredCount,__self:this,__source:{fileName:Rp,lineNumber:81,columnNumber:17}},this.commentCount>0?this.commentCount:"")):Qi.a.createElement(Qi.a.Fragment,{__self:this,__source:{fileName:Rp,lineNumber:56,columnNumber:13}},i>0&&this.commentCount>0?Qi.a.createElement("div",{className:Np.a.title,__self:this,__source:{fileName:Rp,lineNumber:59,columnNumber:19}},A({id:"header.comments"}),Qi.a.createElement("div",{className:Np.a.filteredCount,__self:this,__source:{fileName:Rp,lineNumber:61,columnNumber:21}},a,Qi.a.createElement("span",{className:Np.a.filteredCountSeparator,__self:this,__source:{fileName:Rp,lineNumber:63,columnNumber:25}},A({id:"filters.of"})),this.commentCount)):Qi.a.createElement("div",{className:Np.a.title,__self:this,__source:{fileName:Rp,lineNumber:69,columnNumber:19}},A({id:"header.comments"}),Qi.a.createElement("span",{className:Np.a.filteredCount,__self:this,__source:{fileName:Rp,lineNumber:71,columnNumber:21}},this.commentCount>0?this.commentCount:"")),Qi.a.createElement(Ep,Object.assign({},this.props,{isAnyFilterApplied:i>0,__self:this,__source:{fileName:Rp,lineNumber:76,columnNumber:15}})))))}}]),CommentsHeader}(Qi.a.Component);Dp.propTypes={intl:Zr.intlShape,appliedFilterCount:nr.a.number,noOfFilteredCommentComputed:nr.a.number,resolvedCommentsCount:nr.a.number,unresolvedCommentsCount:nr.a.number,setResolvedFilterValue:nr.a.func.isRequired,resetUnappliedFiltersButtons:nr.a.func.isRequired},Dp.defaultProps={intl:Zr.intlShape,appliedFilterCount:0,noOfFilteredCommentComputed:0,resolvedCommentsCount:0,unresolvedCommentsCount:0};var Op=Object(Zr.injectIntl)(ya(Dp)),Lp=function getPageCommentsCount(t){var i=0;return t.forEach((function(t){i+=t.length})),i},Bp=Object(ir.inject)((function mapStoreToProps(){var t=function getPageCommentsArray(t){return Array.from(t,(function(t,i){return Bo.appliedFilterCount>0?b()($o.getFilteredComments(i)):b()($o.getCommentsOfPage(i))}))}(function getTotalCommentArray(){var t=Ho({AssetStore:Ve});return b()(Array(t).keys())}());return{appliedFilterCount:Jh(Bo),noOfFilteredCommentComputed:Lp(t),resolvedCommentsCount:Qh(Bo),unresolvedCommentsCount:$h(Bo),setResolvedFilterValue:ep(Bo),resetUnappliedFiltersButtons:tp(Bo)}}))(Op),Up=function getGuestLoginDownload(t){return t.commentsStore.guestLoginDownload},Fp=function getShowPageLevelWelcomeDialog(t){return t.commentsStore.showPageLevelWelcomeDialog},jp=function setShowPageLevelWelcomeDialog(t){return function(i){t.commentsStore.setShowPageLevelWelcomeDialog(i)}},Hp=function getIsReadListLoaded(t){return t.commentsStore.isReadListLoaded},zp=function getCommentsOfPage(t){return function(i){t.commentsStore.getCommentsOfPage(i)}},Wp=function getSelectedCommentId(t){return t.commentsStore.selectedCommentId},Vp=function getSelectedCommentSource(t){return t.commentsStore.selectedCommentSource},Yp=function setSelectedCommentId(t){return function(i,a){t.commentsStore.setSelectedCommentId(i,a)}},Kp=function resetSelectedCommentId(t){return function(){t.commentsStore.resetSelectedCommentId()}},qp=function addToUnsavedAnnotList(t){return function(i,a){t.commentsStore.addToUnsavedAnnotList(i,a)}},Gp=function removeFromUnsavedAnnotList(t){return function(i,a){t.commentsStore.removeFromUnsavedAnnotList(i,a)}},Xp=function getReplyUIModel(t){return function(i,a){return t.commentsStore.getReplyUIModel(i,a)}},Zp=function saveCommentToServer(t){return function(i,a){var A=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.commentsStore.saveCommentToServer(i,a,A)}},Jp=function getLastCommentTransitionedToView(t){return t.commentsStore.lastCommentTransitionedToView},Qp=function resolveComment(t){return function(i,a){t.commentsStore.resolveComment(i,a)}},$p=function unresolveComment(t){return function(i,a){t.commentsStore.unresolveComment(i,a)}},ef=function haveCommentsLoaded(t){return t.commentsStore.haveCommentsLoaded},tf=a("mogb"),nf=function getHasAuth(t){return t.userProfileStore.hasAuth},rf=function getIsAnnonymous(t){return function(){return t.userProfileStore.isAnnonymous()}},af=function getUserProfile(t){return function(){return t.userProfileStore.getUserProfile()}},sf=function addCommentPosition(t){return function(i){t.commentsPositionStore.addCommentPosition(i)}},Af=function deleteCommentPosition(t){return function(i){t.commentsPositionStore.deleteCommentPosition(i)}},lf=function updateCommentPositionHeight(t){return function(i,a){t.commentsPositionStore.updateCommentPositionHeight(i,a)}},uf=function updateCommentPositionNTop(t){return function(i,a){t.commentsPositionStore.updateCommentPositionNTop(i,a)}},df=function addViewrefToCommentPosition(t){return function(i,a){t.commentsPositionStore.addViewrefToCommentPosition(i,a)}},cf=function updateViewrefToCommentPosition(t){return function(i,a){t.commentsPositionStore.updateViewrefToCommentPosition(i,a)}},mf=function updateCommentPopupAnimatedCount(t){return function(i,a){t.commentsPositionStore.updateCommentPopupAnimatedCount()}},hf=a("eayF"),pf=a.n(hf),ff=function CommentorProfileCell(t){var i=t.data,a=t.markResolved,A=t.isCollapsed,l=t.useModernView;return Qi.a.createElement("td",{className:pf.a.profileImageCell,role:"presentation",__self:void 0,__source:{fileName:"/build/src/react/components/commentPopup/CommentPopupHeader/CommentorProfileCell.js",lineNumber:27,columnNumber:3}},Qi.a.createElement(SA,{data:i,markResolved:a,isCollapsed:A,useModernView:l,__self:void 0,__source:{fileName:"/build/src/react/components/commentPopup/CommentPopupHeader/CommentorProfileCell.js",lineNumber:28,columnNumber:5}}))};ff.propTypes={data:nr.a.objectOf(nr.a.any).isRequired,markResolved:nr.a.bool,isCollapsed:nr.a.bool,useModernView:nr.a.bool},ff.defaultProps={markResolved:!1,isCollapsed:!1,useModernView:!0};var gf=ff,Cf="/build/src/react/components/commentPopup/CommentPopupHeader/CommentDetailsCell.js",vf=function CommentDetailsCell(t){var i=t.intl,a=t.userName,A=t.userLabel,l=t.displayTime;return Qi.a.createElement("td",{className:pf.a.commentorDetailsCell,role:"presentation",__self:void 0,__source:{fileName:Cf,lineNumber:26,columnNumber:3}},Qi.a.createElement("span",{className:pf.a.commentorName,title:a,__self:void 0,__source:{fileName:Cf,lineNumber:27,columnNumber:5}},a),A.length>0&&Qi.a.createElement("span",{className:pf.a.commentorLabel,title:A,__self:void 0,__source:{fileName:Cf,lineNumber:32,columnNumber:7}},i.formatMessage({id:A})),Qi.a.createElement("span",{className:pf.a.commentTimestamp,title:i.formatMessage({id:l.toolTipId},{time:l.time}),__self:void 0,__source:{fileName:Cf,lineNumber:36,columnNumber:5}},i.formatMessage({id:l.templateId},{time:l.time})))};vf.propTypes={intl:Zr.intlShape,userName:nr.a.string,userLabel:nr.a.string,displayTime:nr.a.objectOf(nr.a.any).isR