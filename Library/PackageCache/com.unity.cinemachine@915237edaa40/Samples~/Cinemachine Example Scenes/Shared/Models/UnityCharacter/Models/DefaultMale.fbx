,a=o("WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup").parseNewsletterTextOrMediaMixinGroup(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,{wAMOSubMixin:r.success?r.value:null,newsletterTextOrMediaMixinGroup:a.value})):a}l.parseNewsletterQuestionMixin=e}),98);
__d("WASmaxInMessageDeliverQuestionTypeResponseMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"questiontype","response");return r.success?o("WAResultOrError").makeResult({metaQuestiontype:r.value}):r}l.parseQuestionTypeResponseMixin=e}),98);
__d("WASmaxInMessageDeliverResponseServerIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"response_server_id");return r.success?o("WAResultOrError").makeResult({metaResponseServerId:r.value}):r}l.parseResponseServerIDMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterQuestionResponseMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxInMessageDeliverQuestionTypeResponseMixin","WASmaxInMessageDeliverResponseServerIDMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(n.value);if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(e);if(!a.success)return a;var i=o("WASmaxInMessageDeliverQuestionTypeResponseMixin").parseQuestionTypeResponseMixin(e);if(!i.success)return i;var l=o("WASmaxInMessageDeliverResponseServerIDMixin").parseResponseServerIDMixin(e);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({plaintextPayloadMixin:r.value},a.value,i.value,l.value)):l}l.parseNewsletterQuestionResponseMixin=e}),98);
__d("WASmaxInMessageDeliverContentTypeQuizCreationMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","poll");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"polltype","quiz_creation");if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,n.value,"contenttype");return i.success?o("WAResultOrError").makeResult({type:r.value,metaPolltype:a.value,metaContenttype:i.value}):i}l.parseContentTypeQuizCreationMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterQuizCreationMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeQuizCreationMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(n.value);if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypeQuizCreationMixin").parseContentTypeQuizCreationMixin(e);if(!a.success)return a;var i=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({plaintextPayloadMixin:r.value},a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterQuizCreationMixin=e}),98);
__d("WASmaxInMessageDeliverContentTypeReactionMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","reaction");return n.success?o("WAResultOrError").makeResult({type:n.value}):n}l.parseContentTypeReactionMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterReactionMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"reaction");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"code");if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({reactionCode:r.value},a.value)):a}l.parseNewsletterReactionMixin=e}),98);
__d("WASmaxInMessageDeliverRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","7");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseRevokeMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterReactionRevokeMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"reaction");if(!n.success)return n;var r=o("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(e);if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({},r.value,a.value)):a}l.parseNewsletterReactionRevokeMixin=e}),98);
__d("WASmaxInMessageDeliverAdminRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","8");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseAdminRevokeMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterRevokeMixin",["WAResultOrError","WASmaxInMessageDeliverAdminRevokeMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInMessageDeliverAdminRevokeMixin").parseAdminRevokeMixin(e);if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(e);if(!a.success)return a;var i=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({},r.value,a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterRevokeMixin=e}),98);
__d("WASmaxInMessageDeliverContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverContentTypeQuizCreationMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"ContentTypeText",value:t.value});var n=o("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"ContentTypeMedia",value:n.value});var r=o("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:r.value});var a=o("WASmaxInMessageDeliverContentTypeQuizCreationMixin").parseContentTypeQuizCreationMixin(e);return a.success?o("WAResultOrError").makeResult({name:"ContentTypeQuizCreation",value:a.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["ContentTypeText","ContentTypeMedia","ContentTypePollCreation","ContentTypeQuizCreation"],[t,n,r,a])}l.parseContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup=e}),98);
__d("WASmaxInMessageDeliverNewsletterWAMOEmptyMixin",["WAResultOrError","WASmaxInMessageDeliverAdminEditMixin","WASmaxInMessageDeliverAdminRevokeMixin","WASmaxInMessageDeliverContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e);if(!r.success)return r;var a=o("WASmaxInMessageDeliverAdminRevokeMixin").parseAdminRevokeMixin(e),i=o("WASmaxInMessageDeliverAdminEditMixin").parseAdminEditMixin(e),l=o("WASmaxInMessageDeliverContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup").parseContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup(e);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({},r.value,{adminRevokeMixin:a.success?a.value:null,adminEditMixin:i.success?i.value:null,contentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup:l.value})):l}l.parseNewsletterWAMOEmptyMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterMessageFanoutContent",["WAResultOrError","WASmaxInMessageDeliverNewsletterEditMixin","WASmaxInMessageDeliverNewsletterMediaMixin","WASmaxInMessageDeliverNewsletterPollCreationMixin","WASmaxInMessageDeliverNewsletterPollResultSnapshotMixin","WASmaxInMessageDeliverNewsletterPollVoteMixin","WASmaxInMessageDeliverNewsletterQuestionMixin","WASmaxInMessageDeliverNewsletterQuestionReplyMixin","WASmaxInMessageDeliverNewsletterQuestionResponseMixin","WASmaxInMessageDeliverNewsletterQuizCreationMixin","WASmaxInMessageDeliverNewsletterReactionMixin","WASmaxInMessageDeliverNewsletterReactionRevokeMixin","WASmaxInMessageDeliverNewsletterRevokeMixin","WASmaxInMessageDeliverNewsletterTextMixin","WASmaxInMessageDeliverNewsletterWAMOEmptyMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMessageDeliverNewsletterQuestionMixin").parseNewsletterQuestionMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"NewsletterQuestion",value:t.value});var n=o("WASmaxInMessageDeliverNewsletterQuestionResponseMixin").parseNewsletterQuestionResponseMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"NewsletterQuestionResponse",value:n.value});var r=o("WASmaxInMessageDeliverNewsletterEditMixin").parseNewsletterEditMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"NewsletterEdit",value:r.value});var a=o("WASmaxInMessageDeliverNewsletterQuestionReplyMixin").parseNewsletterQuestionReplyMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"NewsletterQuestionReply",value:a.value});var i=o("WASmaxInMessageDeliverNewsletterRevokeMixin").parseNewsletterRevokeMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"NewsletterRevoke",value:i.value});var l=o("WASmaxInMessageDeliverNewsletterTextMixin").parseNewsletterTextMixin(e);if(l.success)return o("WAResultOrError").makeResult({name:"NewsletterText",value:l.value});var s=o("WASmaxInMessageDeliverNewsletterMediaMixin").parseNewsletterMediaMixin(e);if(s.success)return o("WAResultOrError").makeResult({name:"NewsletterMedia",value:s.value});var u=o("WASmaxInMessageDeliverNewsletterReactionMixin").parseNewsletterReactionMixin(e);if(u.success)return o("WAResultOrError").makeResult({name:"NewsletterReaction",value:u.value});var c=o("WASmaxInMessageDeliverNewsletterReactionRevokeMixin").parseNewsletterReactionRevokeMixin(e);if(c.success)return o("WAResultOrError").makeResult({name:"NewsletterReactionRevoke",value:c.value});var d=o("WASmaxInMessageDeliverNewsletterPollCreationMixin").parseNewsletterPollCreationMixin(e);if(d.success)return o("WAResultOrError").makeResult({name:"NewsletterPollCreation",value:d.value});var m=o("WASmaxInMessageDeliverNewsletterQuizCreationMixin").parseNewsletterQuizCreationMixin(e);if(m.success)return o("WAResultOrError").makeResult({name:"NewsletterQuizCreation",value:m.value});var p=o("WASmaxInMessageDeliverNewsletterPollVoteMixin").parseNewsletterPollVoteMixin(e);if(p.success)return o("WAResultOrError").makeResult({name:"NewsletterPollVote",value:p.value});var _=o("WASmaxInMessageDeliverNewsletterPollResultSnapshotMixin").parseNewsletterPollResultSnapshotMixin(e);if(_.success)return o("WAResultOrError").makeResult({name:"NewsletterPollResultSnapshot",value:_.value});var f=o("WASmaxInMessageDeliverNewsletterWAMOEmptyMixin").parseNewsletterWAMOEmptyMixin(e);return f.success?o("WAResultOrError").makeResult({name:"NewsletterWAMOEmpty",value:f.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["NewsletterQuestion","NewsletterQuestionResponse","NewsletterEdit","NewsletterQuestionReply","NewsletterRevoke","NewsletterText","NewsletterMedia","NewsletterReaction","NewsletterReactionRevoke","NewsletterPollCreation","NewsletterQuizCreation","NewsletterPollVote","NewsletterPollResultSnapshot","NewsletterWAMOEmpty"],[t,n,r,a,i,l,s,u,c,d,m,p,_,f])}l.parseNewsletterMessageFanoutContent=e}),98);
__d("WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(n.value,"msg_edit_t",15778656e5,41024736e5);return r.success?o("WAResultOrError").makeResult({metaMsgEditT:r.value}):r}l.parseNewsletterMessageLastEditTimestampMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(n.value,"original_msg_t",1577865600,4102473600);return r.success?o("WAResultOrError").makeResult({metaOriginalMsgT:r.value}):r}l.parseNewsletterMessageOriginalTimestampMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterMessageFanoutMixin",["WAResultOrError","WASmaxInMessageDeliverNewsletterMessageFanoutContent","WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin","WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").attrStanzaId(e,"id");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(e,"server_id",99,2147476647);if(!r.success)return r;var a=o("WASmaxParseUtils").attrIntRange(e,"t",0,void 0);if(!a.success)return a;var i=o("WASmaxParseUtils").optionalLiteral(o("WASmaxParseUtils").attrString,e,"is_sender","true");if(!i.success)return i;var l=o("WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin").parseNewsletterMessageOriginalTimestampMixin(e),s=o("WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin").parseNewsletterMessageLastEditTimestampMixin(e),u=o("WASmaxInMessageDeliverNewsletterMessageFanoutContent").parseNewsletterMessageFanoutContent(e);return u.success?o("WAResultOrError").makeResult({id:n.value,serverId:r.value,t:a.value,isSender:i.value,newsletterMessageOriginalTimestampMixin:l.success?l.value:null,newsletterMessageLastEditTimestampMixin:s.success?s.value:null,newsletterMessageFanoutContent:u.value}):u}l.parseNewsletterMessageFanoutMixin=e}),98);
__d("WASmaxInMessageDeliverOfflineMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").attrIntRange(e,"offline",0,12);return t.success?o("WAResultOrError").makeResult({offline:t.value}):t}l.parseOfflineMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterMessageWithJIDMixin",["WAResultOrError","WASmaxInMessageDeliverNewsletterMessageFanoutMixin","WASmaxInMessageDeliverOfflineMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseJid").attrNewsletterJid(e,"from");if(!n.success)return n;var r=o("WASmaxInMessageDeliverNewsletterMessageFanoutMixin").parseNewsletterMessageFanoutMixin(e);if(!r.success)return r;var a=o("WASmaxInMessageDeliverOfflineMixin").parseOfflineMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({from:n.value},r.value,{offlineMixin:a.success?a.value:null}))}l.parseNewsletterMessageWithJIDMixin=e}),98);
__d("WASmaxInMessageDeliverReceiverContentTypeMediaRCATMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"rcat");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"mediatype","url");if(!a.success)return a;var i=o("WASmaxParseUtils").contentBytes(r.value);if(!i.success)return i;var l=o("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(e);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({plaintextMediatype:a.value,rcatElementValue:i.value},l.value)):l}l.parseReceiverContentTypeMediaRCATMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterRequest",["WAResultOrError","WASmaxInMessageDeliverNewsletterMessageWithJIDMixin","WASmaxInMessageDeliverReceiverContentTypeMediaRCATMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxInMessageDeliverNewsletterMessageWithJIDMixin").parseNewsletterMessageWithJIDMixin(e);if(!n.success)return n;var r=o("WASmaxInMessageDeliverReceiverContentTypeMediaRCATMixin").parseReceiverContentTypeMediaRCATMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,{receiverContentTypeMediaRCATMixin:r.success?r.value:null}))}l.parseNewsletterRequest=e}),98);
__d("WASmaxOutMessageDeliverCommonAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseReference").attrFromReference(o("WASmaxParseJid").attrNewsletterJid,e,["from"]);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(t.error);var n=o("WASmaxParseReference").attrFromReference(o("WASmaxParseUtils").attrStanzaId,e,["id"]);if(!n.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(n.error);var r=o("WASmaxParseReference").attrFromReference(o("WASmaxParseUtils").attrString,e,["type"]);if(!r.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(r.error);var a=o("WASmaxJsx").smax("ack",{to:o("WAWap").JID(t.value),class:"message",id:o("WAWap").STANZA_ID(n.value),type:o("WAWap").CUSTOM_STRING(r.value)});return a}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeCommonAckMixin=s}),98);
__d("WASmaxOutMessageDeliverNewsletterResponseError",["WASmaxJsx","WASmaxOutMessageDeliverCommonAckMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutMessageDeliverCommonAckMixin").mergeCommonAckMixin(o("WASmaxJsx").smax("ack",{error:"406"}),e);return t}l.makeNewsletterResponseError=e}),98);
__d("WASmaxOutMessageDeliverNewsletterResponseSuccess",["WASmaxJsx","WASmaxOutMessageDeliverCommonAckMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutMessageDeliverCommonAckMixin").mergeCommonAckMixin(o("WASmaxJsx").smax("ack",null),e);return t}l.makeNewsletterResponseSuccess=e}),98);
__d("WASmaxMessageDeliverNewsletterRPC",["WASmaxInMessageDeliverNewsletterRequest","WASmaxOutMessageDeliverNewsletterResponseError","WASmaxOutMessageDeliverNewsletterResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMessageDeliverNewsletterRequest").parseNewsletterRequest(e);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("Newsletter",{Request:t}));return{parsedRequest:t.value,makeNewsletterResponseError:function(){return o("WASmaxOutMessageDeliverNewsletterResponseError").makeNewsletterResponseError(e)},makeNewsletterResponseSuccess:function(){return o("WASmaxOutMessageDeliverNewsletterResponseSuccess").makeNewsletterResponseSuccess(e)}}}l.receiveNewsletterRPC=e}),98);
__d("WAWebHandleNewsletterMsgLogger",["WASmaxMessageDeliverNewsletterRPC","WAWebHandleMsgError","WAWebIncomingMessageDropWamEvent","WAWebWamEnumE2eDestination","WAWebWamEnumMediaType","WAWebWamEnumMessageDropReasonType","WAWebWamEnumRevokeType"],(function(t,n,r,o,a,i,l){function e(e){try{return o("WASmaxMessageDeliverNewsletterRPC").receiveNewsletterRPC(e)}catch(e){return null}}function s(t,n){var r=e(n.stanza);t instanceof o("WAWebHandleMsgError").MessageValidationError&&u(r,t)}function u(e,t){var n,r=new(o("WAWebIncomingMessageDropWamEvent")).IncomingMessageDropWamEvent({messageDropReason:o("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INVALID_PROTOBUF,e2eDestination:o("WAWebWamEnumE2eDestination").E2E_DESTINATION.CHANNEL,offline:(e==null||(n=e.parsedRequest)==null||(n=n.offlineMixin)==null?void 0:n.offline)!=null,e2eFailureReason:t==null?void 0:t.e2eFailureReason,messageMediaType:c(e),revokeType:(e==null?void 0:e.parsedRequest.newsletterMessageFanoutContent.name)==="NewsletterRevoke"?o("WAWebWamEnumRevokeType").REVOKE_TYPE.ADMIN:void 0});r.commit()}function c(e){var t=e==null?void 0:e.parsedRequest.newsletterMessageFanoutContent;if(t==null)return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;switch(t.name){case"NewsletterReaction":return o("WAWebWamEnumMediaType").MEDIA_TYPE.REACTION;case"NewsletterMedia":return d(t.value.plaintextMediatype);case"NewsletterEdit":{var n,r=t.value.newsletterQuestionReplyOrTextOrMediaMixinGroup;return((n=r.value.newsletterTextOrMediaMixinGroup)==null?void 0:n.value.type)==="media"?d(r.value.newsletterTextOrMediaMixinGroup.value.plaintextMediatype):o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE}case"NewsletterText":return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"NewsletterRevoke":case"NewsletterReactionRevoke":case"NewsletterWAMOEmpty":return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"NewsletterPollCreation":return o("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_CREATE;case"NewsletterPollVote":return o("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_VOTE;case"NewsletterPollResultSnapshot":return o("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_RESULT_SNAPSHOT;case"NewsletterQuestion":case"NewsletterQuestionReply":return t.value.newsletterTextOrMediaMixinGroup.value.type==="media"?d(t.value.newsletterTextOrMediaMixinGroup.value.plaintextMediatype):o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"NewsletterQuestionResponse":return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"NewsletterQuizCreation":return o("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_CREATE;default:return t.name,o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE}}function d(e){switch(e){case"video":return o("WAWebWamEnumMediaType").MEDIA_TYPE.VIDEO;case"vcard":return o("WAWebWamEnumMediaType").MEDIA_TYPE.CONTACT;case"url":return o("WAWebWamEnumMediaType").MEDIA_TYPE.URL;case"sticker":case"genai_sticker":case"1p_sticker":case"avatar_sticker":case"user_created_sticker":return o("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER;case"ptt":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PTT;case"ptv":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PUSH_TO_VIDEO;case"productlink":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_LINK;case"image":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PHOTO;case"gif":return o("WAWebWamEnumMediaType").MEDIA_TYPE.GIF;case"document":return o("WAWebWamEnumMediaType").MEDIA_TYPE.DOCUMENT;case"cataloglink":return o("WAWebWamEnumMediaType").MEDIA_TYPE.CATALOG_LINK;case"sticker_pack":return o("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER_PACK;case"collection":return o("WAWebWamEnumMediaType").MEDIA_TYPE.MEDIA_ALBUM;case"motion_photo":return o("WAWebWamEnumMediaType").MEDIA_TYPE.MOTION_PHOTO;case"motion_video":return o("WAWebWamEnumMediaType").MEDIA_TYPE.MOTION_VIDEO;default:return o("WAWebWamEnumMediaType").MEDIA_TYPE.AUDIO}}l.handleNewsletterMsgError=s}),98);
__d("WAWebNewsletterMsgParser",["WASmaxMessageDeliverNewsletterRPC","WASmaxParsingFailure","WAWebJidToWid","WAWebNewsletterGatingUtils","WAWebReactionsBEUtils","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){function e(e){var t,n,r=o("WASmaxMessageDeliverNewsletterRPC").receiveNewsletterRPC(e),a=r.parsedRequest,i=r.makeNewsletterResponseSuccess,l={id:a.id,t:a.t,isSender:a.isSender==="true",serverId:a.serverId,offline:(t=a.offlineMixin)==null?void 0:t.offline,from:o("WAWebJidToWid").jidWithTypeToWid({jidType:"newsletter",newsletterJid:a.from}),to:o("WAWebUserPrefsMeUser").getMePnUserOrThrow()},s=(n=a.newsletterMessageFanoutContent.value.wAMOSubMixin)==null?void 0:n.metaIsWamoSub;return s!=null&&o("WAWebNewsletterGatingUtils").isWamoSubMessagesProcessingEnabled()&&(l.isWamoSub=s==="true"),{ack:i(),msg:d(l,a)}}function s(e){return e.reactionCode}function u(e){return e.votesVote.map(function(e){var t=e.elementValue;return t})}function c(e){return e.plaintextPayloadMixin.elementValue}function d(e,t){var n=t.newsletterMessageFanoutContent;switch(n.name){case"NewsletterPollVote":return babelHelpers.extends({},e,{type:"NewsletterPollVote",pollVote:u(n.value)});case"NewsletterReaction":return babelHelpers.extends({},e,{type:"NewsletterReaction",reactionCode:s(n.value)});case"NewsletterReactionRevoke":return babelHelpers.extends({},e,{type:"NewsletterReactionRevoke",reactionCode:o("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT});case"NewsletterRevoke":return babelHelpers.extends({},e,{type:"NewsletterRevoke"});case"NewsletterMedia":return babelHelpers.extends({},e,{type:n.name,payload:c(n.value)});case"NewsletterQuestion":case"NewsletterQuestionReply":{var r=babelHelpers.extends({},e,{payload:c(n.value.newsletterTextOrMediaMixinGroup.value)});return n.value.newsletterTextOrMediaMixinGroup.name==="NewsletterText"?babelHelpers.extends({},r,{type:"NewsletterText"}):babelHelpers.extends({},r,{type:"NewsletterMedia"})}case"NewsletterQuestionResponse":case"NewsletterText":return babelHelpers.extends({},e,{type:"NewsletterText",payload:c(n.value)});case"NewsletterPollCreation":return babelHelpers.extends({},e,{type:"NewsletterPollCreation",payload:c(n.value)});case"NewsletterEdit":{var a,i,l=n.value.newsletterQuestionReplyOrTextOrMediaMixinGroup,d;switch(l.name){case"NewsletterQuestionReply":d=c(l.value.newsletterTextOrMediaMixinGroup.value);break;case"NewsletterText":case"NewsletterMedia":d=c(l.value);break;default:throw l.name,new(o("WASmaxParsingFailure")).SmaxParsingFailure("unrecognized-newsletter-edit-type")}return babelHelpers.extends({},e,{type:"NewsletterEdit",payload:d,msgEditT:(a=t.newsletterMessageLastEditTimestampMixin)==null?void 0:a.metaMsgEditT,msgOriginalT:(i=t.newsletterMessageOriginalTimestampMixin)==null?void 0:i.metaOriginalMsgT})}case"NewsletterPollResultSnapshot":return babelHelpers.extends({},e,{type:"NewsletterPollResultSnapshot",payload:c(n.value)});case"NewsletterWAMOEmpty":return babelHelpers.extends({},e,{type:"NewsletterWAMOEmpty"});case"NewsletterQuizCreation":return babelHelpers.extends({},e,{type:"NewsletterPollCreation",payload:c(n.value)});default:throw n.name,new(o("WASmaxParsingFailure")).SmaxParsingFailure("unrecognized-newsletter-message-type")}}l.default=e}),98);
__d("WAWebNewsletterMsgEditUtils",["WAWebMsgKey","WAWebMsgType"],(function(t,n,r,o,a,i,l){function e(e){return babelHelpers.extends({},e,{type:o("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:o("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",protocolMessageKey:e.id,latestEditMsgKey:e.id,latestEditSenderTimestampMs:e.t})}function s(e,t){var n=e.id.clone(),a=new(r("WAWebMsgKey"))({remote:e.id.remote,fromMe:e.id.fromMe,id:r("WAWebMsgKey").newId_DEPRECATED()});return babelHelpers.extends({},e,{id:a,type:o("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:o("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",editMsgType:e.type,protocolMessageKey:n,latestEditMsgKey:a,latestEditSenderTimestampMs:t.latestEditSenderTimestampMs})}l.mapMsgToEditProtocolMsgLegacy=e,l.mapMsgToEditProtocolMsg=s}),98);
__d("WAWebNewsletterMsgStanzaAdapters",["WAAckLevel","WAWebMsgKey","WAWebMsgType","WAWebNewsletterMsgEditUtils","WAWebUserPrefsMeUser","WAWebViewMode.flow","err"],(function(t,n,r,o,a,i,l){function e(e,t,n){if(n.addOnParentKey==null)throw r("err")("Reaction message without parent");return{id:e,reactionParentKey:n.addOnParentKey,type:o("WAWebMsgType").MSG_TYPE.REACTION,kind:o("WAWebMsgType").MsgKind.ReactionDecrypted,viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,t:t.t,from:t.from,to:t.to,serverId:t.serverId,isNewMsg:!1,ack:o("WAAckLevel").ACK.SENT,read:!1,reactionText:t.reactionCode,reactionTimestamp:t.t*1e3}}function s(e,t,n){var a;if(n.addOnParentKey==null)throw r("err")("Reaction message without parent");return{id:e,t:t.t,from:t.from,to:t.to,serverId:t.serverId,isNewMsg:!1,ack:o("WAAckLevel").ACK.SENT,type:o("WAWebMsgType").MSG_TYPE.POLL_UPDATE,kind:o("WAWebMsgType").MsgKind.PollVoteDecrypted,viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"poll_vote",pollUpdateParentKey:n.addOnParentKey,selectedOptionLocalIds:(a=n.pollVotesAsLocalIds)!=null?a:[],senderTimestampMs:t.t*1e3,read:!1}}function u(e){var t=e.msgKey,n=e.msg,a=e.msgContext,i=e.baseMsgData,l=e.parsingContext,s=o("WAWebViewMode.flow").ViewModeType.NEWSLETTER_TOMBSTONE;if(l==="history"){var u,c;return{id:new(r("WAWebMsgKey"))({remote:n.from,fromMe:n.isSender,id:n.id}),from:n.from,to:n.isSender?n.from:o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),t:(u=a.metaOriginalMsgT)!=null?u:n.t,serverId:n.serverId,lastUpdateFromServerTs:(c=a.lastUpdateFromServerTs)!=null?c:void 0,type:"revoked",kind:o("WAWebMsgType").MsgKind.RevokedMessage,viewMode:s,revokeSender:n.from,subtype:"admin"}}return babelHelpers.extends({},i,{serverId:n.serverId,id:new(r("WAWebMsgKey"))({remote:n.from,fromMe:n.isSender,id:r("WAWebMsgKey").newId_DEPRECATED()}),type:o("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:o("WAWebMsgType").MsgKind.ProtocolRevoke,subtype:"admin_revoke",protocolMessageKey:t,viewMode:s})}function c(e,t,n){return t!=="history"?o("WAWebNewsletterMsgEditUtils").mapMsgToEditProtocolMsg(e,{latestEditSenderTimestampMs:n.latestEditSenderTimestampMs}):e}l.mapReactionMsgStanza=e,l.mapPollVoteMsgStanza=s,l.mapRevokeMsgStanza=u,l.mapEditMsgStanza=c}),98);
__d("WAWebNewsletterBackendMsgUtils",["WAAckLevel","WALogger","WATimeUtils","WAWebE2EProtoParser","WAWebMsgKey","WAWebMsgType","WAWebNewsletterFutureProofUtils","WAWebNewsletterGatingUtils","WAWebNewsletterMsgStanzaAdapters","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebViewMode.flow","decodeProtobuf","err"],(function(t,n,r,o,a,i,l){var e;function s(t,n){var a,i,l,s,c=t.msg,m=t.msgContext,p=new(r("WAWebMsgKey"))({remote:c.from,fromMe:c.isSender,id:c.id});switch(c.type){case"NewsletterReaction":case"NewsletterReactionRevoke":return o("WAWebNewsletterMsgStanzaAdapters").mapReactionMsgStanza(p,c,m);case"NewsletterPollVote":return o("WAWebNewsletterMsgStanzaAdapters").mapPollVoteMsgStanza(p,c,m)}var _=d(p,c);if(c.type==="NewsletterRevoke")return o("WAWebNewsletterMsgStanzaAdapters").mapRevokeMsgStanza({msgKey:p,msg:c,msgContext:m,baseMsgData:_,parsingContext:n});var f=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsE2E.pb").MessageSpec,c.payload),g=o("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:f,message:_,msgContext:n}),h=u(babelHelpers.extends({},g,{isNewMsg:m.isNewMsg,viewCount:(a=m.viewCount)!=null?a:void 0,forwardsCount:(i=m.forwardsCount)!=null?i:void 0,questionResponsesCount:(l=m.questionResponsesCount)!=null?l:0,hasReaction:!!m.hasReaction,latestEditSenderTimestampMs:m.latestEditSenderTimestampMs,lastUpdateFromSeuse strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getSpanContext=e.setSpanContext=e.deleteSpan=e.setSpan=e.getSpan=void 0;var t=G(),r=Y(),n=t.createContextKey("OpenTelemetry Context Key SPAN");function i(e){return e.getValue(n)||void 0}function o(e,t){return e.setValue(n,t)}e.getSpan=i,e.setSpan=o,e.deleteSpan=function(e){return e.deleteValue(n)},e.setSpanContext=function(e,t){return o(e,new r.NonRecordingSpan(t))},e.getSpanContext=function(e){var t;return null===(t=i(e))||void 0===t?void 0:t.spanContext()}})),ee=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.wrapSpanContext=e.isSpanContextValid=e.isValidSpanId=e.isValidTraceId=void 0;var t=Q(),r=Y(),n=/^([0-9a-f]{32})$/i,i=/^[0-9a-f]{16}$/i;function o(e){return n.test(e)&&e!==t.INVALID_TRACEID}function s(e){return i.test(e)&&e!==t.INVALID_SPANID}e.isValidTraceId=o,e.isValidSpanId=s,e.isSpanContextValid=function(e){return o(e.traceId)&&s(e.spanId)},e.wrapSpanContext=function(e){return new r.NonRecordingSpan(e)}})),te=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoopTracer=void 0;var t=X(),r=Z(),n=Y(),i=ee(),o=t.ContextAPI.getInstance(),s=function(){function e(){}return e.prototype.startSpan=function(e,t,o){if(Boolean(null==t?void 0:t.root))return new n.NonRecordingSpan;var s=o&&r.getSpanContext(o);return function(e){return"object"==typeof e&&"string"==typeof e.spanId&&"string"==typeof e.traceId&&"number"==typeof e.traceFlags}(s)&&i.isSpanContextValid(s)?new n.NonRecordingSpan(s):new n.NonRecordingSpan},e.prototype.startActiveSpan=function(e,t,n,i){var s,a,c;if(!(arguments.length<2)){2===arguments.length?c=t:3===arguments.length?(s=t,c=n):(s=t,a=n,c=i);var u=a??o.active(),l=this.startSpan(e,s,u),d=r.setSpan(u,l);return o.with(d,c,void 0,l)}},e}();e.NoopTracer=s})),re=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyTracer=void 0;var t=new(te().NoopTracer),r=function(){function e(e,t,r){this._provider=e,this.name=t,this.version=r}return e.prototype.startSpan=function(e,t,r){return this._getTracer().startSpan(e,t,r)},e.prototype.startActiveSpan=function(e,t,r,n){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version);return e?(this._delegate=e,this._delegate):t},e}();e.ProxyTracer=r})),ne=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoopTracerProvider=void 0;var t=te(),r=function(){function e(){}return e.prototype.getTracer=function(e,r){return new t.NoopTracer},e}();e.NoopTracerProvider=r})),ie=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyTracerProvider=void 0;var t=re(),r=new(ne().NoopTracerProvider),n=function(){function e(){}return e.prototype.getTracer=function(e,r){var n;return null!==(n=this.getDelegateTracer(e,r))&&void 0!==n?n:new t.ProxyTracer(this,e,r)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:r},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(e,t)},e}();e.ProxyTracerProvider=n})),oe=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),se=v((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.SamplingDecision=void 0,(t=e.SamplingDecision||(e.SamplingDecision={}))[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})),ae=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),ce=v((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.SpanKind=void 0,(t=e.SpanKind||(e.SpanKind={}))[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"})),ue=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),le=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),de=v((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.SpanStatusCode=void 0,(t=e.SpanStatusCode||(e.SpanStatusCode={}))[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"})),pe=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),fe=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),he=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),ge=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),me=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TraceAPI=void 0;var t=R(),r=ie(),n=ee(),i=Z(),o=M(),s="trace",a=function(){function e(){this._proxyTracerProvider=new r.ProxyTracerProvider,this.wrapSpanContext=n.wrapSpanContext,this.isSpanContextValid=n.isSpanContextValid,this.deleteSpan=i.deleteSpan,this.getSpan=i.getSpan,this.getSpanContext=i.getSpanContext,this.setSpan=i.setSpan,this.setSpanContext=i.setSpanContext}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var r=t.registerGlobal(s,this._proxyTracerProvider,o.DiagAPI.instance());return r&&this._proxyTracerProvider.setDelegate(e),r},e.prototype.getTracerProvider=function(){return t.getGlobal(s)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){t.unregisterGlobal(s,o.DiagAPI.instance()),this._proxyTracerProvider=new r.ProxyTracerProvider},e}();e.TraceAPI=a})),ve=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoopTextMapPropagator=void 0;var t=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}();e.NoopTextMapPropagator=t})),ye=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deleteBaggage=e.setBaggage=e.getBaggage=void 0;var t=G().createContextKey("OpenTelemetry Baggage Key");e.getBaggage=function(e){return e.getValue(t)||void 0},e.setBaggage=function(e,r){return e.setValue(t,r)},e.deleteBaggage=function(e){return e.deleteValue(t)}})),_e=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PropagationAPI=void 0;var t=R(),r=ve(),n=H(),i=ye(),o=U(),s=M(),a="propagation",c=new r.NoopTextMapPropagator,u=function(){function e(){this.createBaggage=o.createBaggage,this.getBaggage=i.getBaggage,this.setBaggage=i.setBaggage,this.deleteBaggage=i.deleteBaggage}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return t.registerGlobal(a,e,s.DiagAPI.instance())},e.prototype.inject=function(e,t,r){return void 0===r&&(r=n.defaultTextMapSetter),this._getGlobalPropagator().inject(e,t,r)},e.prototype.extract=function(e,t,r){return void 0===r&&(r=n.defaultTextMapGetter),this._getGlobalPropagator().extract(e,t,r)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){t.unregisterGlobal(a,s.DiagAPI.instance())},e.prototype._getGlobalPropagator=function(){return t.getGlobal(a)||c},e}();e.PropagationAPI=u})),Se=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.diag=e.propagation=e.trace=e.context=e.INVALID_SPAN_CONTEXT=e.INVALID_TRACEID=e.INVALID_SPANID=e.isValidSpanId=e.isValidTraceId=e.isSpanContextValid=e.baggageEntryMetadataFromString=void 0,r(C(),e);var n=U();Object.defineProperty(e,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return n.baggageEntryMetadataFromString}}),r(B(),e),r(V(),e),r(q(),e),r(H(),e),r(W(),e),r(z(),e),r(re(),e),r(ie(),e),r(oe(),e),r(se(),e),r(ae(),e),r(ce(),e),r(ue(),e),r(le(),e),r(de(),e),r(J(),e),r(pe(),e),r(fe(),e),r(he(),e);var i=ee();Object.defineProperty(e,"isSpanContextValid",{enumerable:!0,get:function(){return i.isSpanContextValid}}),Object.defineProperty(e,"isValidTraceId",{enumerable:!0,get:function(){return i.isValidTraceId}}),Object.defineProperty(e,"isValidSpanId",{enumerable:!0,get:function(){return i.isValidSpanId}});var o=Q();Object.defineProperty(e,"INVALID_SPANID",{enumerable:!0,get:function(){return o.INVALID_SPANID}}),Object.defineProperty(e,"INVALID_TRACEID",{enumerable:!0,get:function(){return o.INVALID_TRACEID}}),Object.defineProperty(e,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return o.INVALID_SPAN_CONTEXT}}),r(G(),e),r(ge(),e);var s=X();e.context=s.ContextAPI.getInstance();var a=me();e.trace=a.TraceAPI.getInstance();var c=_e();e.propagation=c.PropagationAPI.getInstance();var u=M();e.diag=u.DiagAPI.instance(),e.default={trace:e.trace,context:e.context,propagation:e.propagation,diag:e.diag}})),we=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isTracingSuppressed=e.unsuppressTracing=e.suppressTracing=void 0;var t=Se().createContextKey("OpenTelemetry SDK Context Key SUPPRESS_TRACING");e.suppressTracing=function(e){return e.setValue(t,!0)},e.unsuppressTracing=function(e){return e.deleteValue(t)},e.isTracingSuppressed=function(e){return!0===e.getValue(t)}})),be=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BAGGAGE_MAX_TOTAL_LENGTH=e.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=e.BAGGAGE_MAX_NAME_VALUE_PAIRS=e.BAGGAGE_HEADER=e.BAGGAGE_ITEMS_SEPARATOR=e.BAGGAGE_PROPERTIES_SEPARATOR=e.BAGGAGE_KEY_PAIR_SEPARATOR=void 0,e.BAGGAGE_KEY_PAIR_SEPARATOR="=",e.BAGGAGE_PROPERTIES_SEPARATOR=";",e.BAGGAGE_ITEMS_SEPARATOR=",",e.BAGGAGE_HEADER="baggage",e.BAGGAGE_MAX_NAME_VALUE_PAIRS=180,e.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=4096,e.BAGGAGE_MAX_TOTAL_LENGTH=8192})),Ee=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parseKeyPairsIntoRecord=e.parsePairKeyValue=e.getKeyPairs=e.serializeKeyPairs=void 0;var t=Se(),r=be();e.serializeKeyPairs=e=>e.reduce(((e,t)=>{let n=`${e}${""!==e?r.BAGGAGE_ITEMS_SEPARATOR:""}${t}`;return n.length>r.BAGGAGE_MAX_TOTAL_LENGTH?e:n}),""),e.getKeyPairs=e=>e.getAllEntries().map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t.value)}`)),e.parsePairKeyValue=e=>{let n=e.split(r.BAGGAGE_PROPERTIES_SEPARATOR);if(n.length<=0)return;let i=n.shift();if(!i)return;let o=i.split(r.BAGGAGE_KEY_PAIR_SEPARATOR);if(2!==o.length)return;let s,a=decodeURIComponent(o[0].trim()),c=decodeURIComponent(o[1].trim());return n.length>0&&(s=t.baggageEntryMetadataFromString(n.join(r.BAGGAGE_PROPERTIES_SEPARATOR))),{key:a,value:c,metadata:s}},e.parseKeyPairsIntoRecord=t=>"string"!=typeof t||0===t.length?{}:t.split(r.BAGGAGE_ITEMS_SEPARATOR).map((t=>e.parsePairKeyValue(t))).filter((e=>void 0!==e&&e.value.length>0)).reduce(((e,t)=>(e[t.key]=t.value,e)),{})})),Pe=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HttpBaggagePropagator=void 0;var t=Se(),r=we(),n=be(),i=Ee();e.HttpBaggagePropagator=class{inject(e,o,s){let a=t.propagation.getBaggage(e);if(!a||r.isTracingSuppressed(e))return;let c=i.getKeyPairs(a).filter((e=>e.length<=n.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS)).slice(0,n.BAGGAGE_MAX_NAME_VALUE_PAIRS),u=i.serializeKeyPairs(c);u.length>0&&s.set(o,n.BAGGAGE_HEADER,u)}extract(e,r,o){let s=o.get(r,n.BAGGAGE_HEADER);if(!s)return e;let a={};return 0===s.length||(s.split(n.BAGGAGE_ITEMS_SEPARATOR).forEach((e=>{let t=i.parsePairKeyValue(e);if(t){let e={value:t.value};t.metadata&&(e.metadata=t.metadata),a[t.key]=e}})),0===Object.entries(a).length)?e:t.propagation.setBaggage(e,t.propagation.createBaggage(a))}fields(){return[n.BAGGAGE_HEADER]}}})),Te=v((e=>{"use strict";function t(e){return null==e||(Array.isArray(e)?function(e){let t;for(let n of e)if(null!=n){if(!t){if(r(n)){t=typeof n;continue}return!1}if(typeof n!==t)return!1}return!0}(e):r(e))}function r(e){switch(typeof e){case"number":case"boolean":case"string":return!0}return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.isAttributeValue=e.sanitizeAttributes=void 0,e.sanitizeAttributes=function(e){let r={};if(null==e||"object"!=typeof e)return r;for(let[n,i]of Object.entries(e))t(i)&&(Array.isArray(i)?r[n]=i.slice():r[n]=i);return r},e.isAttributeValue=t})),Ce=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loggingErrorHandler=void 0;var t=Se();e.loggingErrorHandler=function(){return e=>{t.diag.error(function(e){return"string"==typeof e?e:JSON.stringify(function(e){let t={},r=e;for(;null!==r;)Object.getOwnPropertyNames(r).forEach((e=>{if(t[e])return;let n=r[e];n&&(t[e]=String(n))})),r=Object.getPrototypeOf(r);return t}(e))}(e))}}})),Ie=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.globalErrorHandler=e.setGlobalErrorHandler=void 0;var t=Ce().loggingErrorHandler();e.setGlobalErrorHandler=function(e){t=e},e.globalErrorHandler=e=>{try{t(e)}catch{}}})),Oe=v((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.TracesSamplerValues=void 0,(t=e.TracesSamplerValues||(e.TracesSamplerValues={})).AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"})),xe=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parseEnvironment=e.DEFAULT_ENVIRONMENT=void 0;var t=Se(),r=Oe(),n=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT"];function i(e){return n.indexOf(e)>-1}var o=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function s(e){return o.indexOf(e)>-1}function a(e,t,r,n=-1/0,i=1/0){if(typeof r[e]<"u"){let o=Number(r[e]);isNaN(o)||(t[e]=o<n?n:o>i?i:o)}}function c(e,t,r,n=","){let i=r[e];"string"==typeof i&&(t[e]=i.split(n).map((e=>e.trim())))}e.DEFAULT_ENVIRONMENT={CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:t.DiagLogLevel.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"none",OTEL_TRACES_SAMPLER:r.TracesSamplerValues.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:""};var u={ALL:t.DiagLogLevel.ALL,VERBOSE:t.DiagLogLevel.VERBOSE,DEBUG:t.DiagLogLevel.DEBUG,INFO:t.DiagLogLevel.INFO,WARN:t.DiagLogLevel.WARN,ERROR:t.DiagLogLevel.ERROR,NONE:t.DiagLogLevel.NONE};function l(e,t,r){let n=r[e];if("string"==typeof n){let r=u[n.toUpperCase()];null!=r&&(t[e]=r)}}e.parseEnvironment=function(t){let r={};for(let n in e.DEFAULT_ENVIRONMENT){let e=n;if("OTEL_LOG_LEVEL"===e)l(e,r,t);else if(i(e))a(e,r,t);else if(s(e))c(e,r,t);else{let n=t[e];typeof n<"u"&&null!==n&&(r[e]=String(n))}}return r}})),Ne=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getEnv=void 0;var t=r(22037),n=xe();e.getEnv=function(){let e=n.parseEnvironment(process.env);return Object.assign({HOSTNAME:t.hostname()},n.DEFAULT_ENVIRONMENT,e)}})),ke=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hexToBase64=void 0,e.hexToBase64=function(e){let t=e.length,r="";for(let n=0;n<t;n+=2){let t=e.substring(n,n+2),i=parseInt(t,16);r+=String.fromCharCode(i)}return Buffer.from(r,"ascii").toString("base64")}})),Re=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RandomIdGenerator=void 0,e.RandomIdGenerator=class{constructor(){this.generateTraceId=r(16),this.generateSpanId=r(8)}};var t=Buffer.allocUnsafe(16);function r(e){return function(){for(let r=0;r<e/4;r++)t.writeUInt32BE(Math.random()*2**32>>>0,4*r);for(let r=0;r<e&&!(t[r]>0);r++)r===e-1&&(t[e-1]=1);return t.toString("hex",0,e)}}})),Ae=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.otperformance=void 0;var t=r(4074);e.otperformance=t.performance})),De=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VERSION=void 0,e.VERSION="0.23.0"})),je=v((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.RpcGrpcStatusCodeValues=e.MessagingOperationValues=e.MessagingDestinationKindValues=e.HttpFlavorValues=e.NetTransportValues=e.FaasInvokedProviderValues=e.FaasDocumentOperationValues=e.FaasTriggerValues=e.DbCassandraConsistencyLevelValues=e.DbSystemValues=e.SemanticAttributes=void 0,e.SemanticAttributes={DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_METHOD:"rpc.jsonrpc.method",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message"},(t=e.DbSystemValues||(e.DbSystemValues={})).OTHER_SQL="other_sql",t.MSSQL="mssql",t.MYSQL="mysql",t.ORACLE="oracle",t.DB2="db2",t.POSTGRESQL="postgresql",t.REDSHIFT="redshift",t.HIVE="hive",t.CLOUDSCAPE="cloudscape",t.HSQLDB="hsqldb",t.PROGRESS="progress",t.MAXDB="maxdb",t.HANADB="hanadb",t.INGRES="ingres",t.FIRSTSQL="firstsql",t.EDB="edb",t.CACHE="cache",t.ADABAS="adabas",t.FIREBIRD="firebird",t.DERBY="derby",t.FILEMAKER="filemaker",t.INFORMIX="informix",t.INSTANTDB="instantdb",t.INTERBASE="interbase",t.MARIADB="mariadb",t.NETEZZA="netezza",t.PERVASIVE="pervasive",t.POINTBASE="pointbase",t.SQLITE="sqlite",t.SYBASE="sybase",t.TERADATA="teradata",t.VERTICA="vertica",t.H2="h2",t.COLDFUSION="coldfusion",t.CASSANDRA="cassandra",t.HBASE="hbase",t.MONGODB="mongodb",t.REDIS="redis",t.COUCHBASE="couchbase",t.COUCHDB="couchdb",t.COSMOSDB="cosmosdb",t.DYNAMODB="dynamodb",t.NEO4J="neo4j",t.GEODE="geode",t.ELASTICSEARCH="elasticsearch",t.MEMCACHED="memcached",t.COCKROACHDB="cockroachdb",function(e){e.ALL="all",e.EACH_QUORUM="each_quorum",e.QUORUM="quorum",e.LOCAL_QUORUM="local_quorum",e.ONE="one",e.TWO="two",e.THREE="three",e.LOCAL_ONE="local_one",e.ANY="any",e.SERIAL="serial",e.LOCAL_SERIAL="local_serial"}(e.DbCassandraConsistencyLevelValues||(e.DbCassandraConsistencyLevelValues={})),function(e){e.DATASOURCE="datasource",e.HTTP="http",e.PUBSUB="pubsub",e.TIMER="timer",e.OTHER="other"}(e.FaasTriggerValues||(e.FaasTriggerValues={})),function(e){e.INSERT="insert",e.EDIT="edit",e.DELETE="delete"}(e.FaasDocumentOperationValues||(e.FaasDocumentOperationValues={})),function(e){e.AWS="aws",e.AZURE="azure",e.GCP="gcp"}(e.FaasInvokedProviderValues||(e.FaasInvokedProviderValues={})),function(e){e.IP_TCP="ip_tcp",e.IP_UDP="ip_udp",e.IP="ip",e.UNIX="unix",e.PIPE="pipe",e.INPROC="inproc",e.OTHER="other"}(e.NetTransportValues||(e.NetTransportValues={})),function(e){e.HTTP_1_0="1.0",e.HTTP_1_1="1.1",e.HTTP_2_0="2.0",e.SPDY="SPDY",e.QUIC="QUIC"}(e.HttpFlavorValues||(e.HttpFlavorValues={})),function(e){e.QUEUE="queue",e.TOPIC="topic"}(e.MessagingDestinationKindValues||(e.MessagingDestinationKindValues={})),function(e){e.RECEIVE="receive",e.PROCESS="process"}(e.MessagingOperationValues||(e.MessagingOperationValues={})),function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(e.RpcGrpcStatusCodeValues||(e.RpcGrpcStatusCodeValues={}))})),Me=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(je(),e)})),Le=v((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.TelemetrySdkLanguageValues=e.OsTypeValues=e.HostArchValues=e.AwsEcsLaunchtypeValues=e.CloudPlatformValues=e.CloudProviderValues=e.ResourceAttributes=void 0,e.ResourceAttributes={CLOUD_PROVIDER:"cloud.provider",CLOUD_ACCOUNT_ID:"cloud.account.id",CLOUD_REGION:"cloud.region",CLOUD_AVAILABILITY_ZONE:"cloud.availability_zone",CLOUD_PLATFORM:"cloud.platform",AWS_ECS_CONTAINER_ARN:"aws.ecs.container.arn",AWS_ECS_CLUSTER_ARN:"aws.ecs.cluster.arn",AWS_ECS_LAUNCHTYPE:"aws.ecs.launchtype",AWS_ECS_TASK_ARN:"aws.ecs.task.arn",AWS_ECS_TASK_FAMILY:"aws.ecs.task.family",AWS_ECS_TASK_REVISION:"aws.ecs.task.revision",AWS_EKS_CLUSTER_ARN:"aws.eks.cluster.arn",AWS_LOG_GROUP_NAMES:"aws.log.group.names",AWS_LOG_GROUP_ARNS:"aws.log.group.arns",AWS_LOG_STREAM_NAMES:"aws.log.stream.names",AWS_LOG_STREAM_ARNS:"aws.log.stream.arns",CONTAINER_NAME:"container.name",CONTAINER_ID:"container.id",CONTAINER_RUNTIME:"container.runtime",CONTAINER_IMAGE_NAME:"container.image.name",CONTAINER_IMAGE_TAG:"container.image.tag",DEPLOYMENT_ENVIRONMENT:"deployment.environment",DEVICE_ID:"device.id",DEVICE_MODEL_IDENTIFIER:"device.model.identifier",DEVICE_MODEL_NAME:"device.model.name",FAAS_NAME:"faas.name",FAAS_ID:"faas.id",FAAS_VERSION:"faas.version",FAAS_INSTANCE:"faas.instance",FAAS_MAX_MEMORY:"faas.max_memory",HOST_ID:"host.id",HOST_NAME:"host.name",HOST_TYPE:"host.type",HOST_ARCH:"host.arch",HOST_IMAGE_NAME:"host.image.name",HOST_IMAGE_ID:"host.image.id",HOST_IMAGE_VERSION:"host.image.version",K8S_CLUSTER_NAME:"k8s.cluster.name",K8S_NODE_NAME:"k8s.node.name",K8S_NODE_UID:"k8s.node.uid",K8S_NAMESPACE_NAME:"k8s.namespace.name",K8S_POD_UID:"k8s.pod.uid",K8S_POD_NAME:"k8s.pod.name",K8S_CONTAINER_NAME:"k8s.container.name",K8S_REPLICASET_UID:"k8s.replicaset.uid",K8S_REPLICASET_NAME:"k8s.replicaset.name",K8S_DEPLOYMENT_UID:"k8s.deployment.uid",K8S_DEPLOYMENT_NAME:"k8s.deployment.name",K8S_STATEFULSET_UID:"k8s.statefulset.uid",K8S_STATEFULSET_NAME:"k8s.statefulset.name",K8S_DAEMONSET_UID:"k8s.daemonset.uid",K8S_DAEMONSET_NAME:"k8s.daemonset.name",K8S_JOB_UID:"k8s.job.uid",K8S_JOB_NAME:"k8s.job.name",K8S_CRONJOB_UID:"k8s.cronjob.uid",K8S_CRONJOB_NAME:"k8s.cronjob.name",OS_TYPE:"os.type",OS_DESCRIPTION:"os.description",OS_NAME:"os.name",OS_VERSION:"os.version",PROCESS_PID:"process.pid",PROCESS_EXECUTABLE_NAME:"process.executable.name",PROCESS_EXECUTABLE_PATH:"process.executable.path",PROCESS_COMMAND:"process.command",PROCESS_COMMAND_LINE:"process.command_line",PROCESS_COMMAND_ARGS:"process.command_args",PROCESS_OWNER:"process.owner",PROCESS_RUNTIME_NAME:"process.runtime.name",PROCESS_RUNTIME_VERSION:"process.runtime.version",PROCESS_RUNTIME_DESCRIPTION:"process.runtime.description",SERVICE_NAME:"service.name",SERVICE_NAMESPACE:"service.namespace",SERVICE_INSTANCE_ID:"service.instance.id",SERVICE_VERSION:"service.version",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version",TELEMETRY_AUTO_VERSION:"telemetry.auto.version",WEBENGINE_NAME:"webengine.name",WEBENGINE_VERSION:"webengine.version",WEBENGINE_DESCRIPTION:"webengine.description"},(t=e.CloudProviderValues||(e.CloudProviderValues={})).AWS="aws",t.AZURE="azure",t.GCP="gcp",function(e){e.AWS_EC2="aws_ec2",e.AWS_ECS="aws_ecs",e.AWS_EKS="aws_eks",e.AWS_LAMBDA="aws_lambda",e.AWS_ELASTIC_BEANSTALK="aws_elastic_beanstalk",e.AZURE_VM="azure_vm",e.AZURE_CONTAINER_INSTANCES="azure_container_instances",e.AZURE_AKS="azure_aks",e.AZURE_FUNCTIONS="azure_functions",e.AZURE_APP_SERVICE="azure_app_service",e.GCP_COMPUTE_ENGINE="gcp_compute_engine",e.GCP_CLOUD_RUN="gcp_cloud_run",e.GCP_KUBERNETES_ENGINE="gcp_kubernetes_engine",e.GCP_CLOUD_FUNCTIONS="gcp_cloud_functions",e.GCP_APP_ENGINE="gcp_app_engine"}(e.CloudPlatformValues||(e.CloudPlatformValues={})),function(e){e.EC2="ec2",e.FARGATE="fargate"}(e.AwsEcsLaunchtypeValues||(e.AwsEcsLaunchtypeValues={})),function(e){e.AMD64="amd64",e.ARM32="arm32",e.ARM64="arm64",e.IA64="ia64",e.PPC32="ppc32",e.PPC64="ppc64",e.X86="x86"}(e.HostArchValues||(e.HostArchValues={})),function(e){e.WINDOWS="windows",e.LINUX="linux",e.DARWIN="darwin",e.FREEBSD="freebsd",e.NETBSD="netbsd",e.OPENBSD="openbsd",e.DRAGONFLYBSD="dragonflybsd",e.HPUX="hpux",e.AIX="aix",e.SOLARIS="solaris",e.Z_OS="z_os"}(e.OsTypeValues||(e.OsTypeValues={})),function(e){e.CPP="cpp",e.DOTNET="dotnet",e.ERLANG="erlang",e.GO="go",e.JAVA="java",e.NODEJS="nodejs",e.PHP="php",e.PYTHON="python",e.RUBY="ruby",e.WEBJS="webjs"}(e.TelemetrySdkLanguageValues||(e.TelemetrySdkLanguageValues={}))})),Fe=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Le(),e)})),Ue=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Me(),e),r(Fe(),e)})),Be=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SDK_INFO=void 0;var t=De(),r=Ue();e.SDK_INFO={[r.ResourceAttributes.TELEMETRY_SDK_NAME]:"opentelemetry",[r.ResourceAttributes.PROCESS_RUNTIME_NAME]:"node",[r.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:r.TelemetrySdkLanguageValues.NODEJS,[r.ResourceAttributes.TELEMETRY_SDK_VERSION]:t.VERSION}})),Ve=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.unrefTimer=void 0,e.unrefTimer=function(e){e.unref()}})),$e=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Ne(),e),r(ke(),e),r(Re(),e),r(Ae(),e),r(Be(),e),r(Ve(),e)})),qe=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r($e(),e)})),He=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isTimeInput=e.isTimeInputHrTime=e.hrTimeToMicroseconds=e.hrTimeToMilliseconds=e.hrTimeToNanoseconds=e.hrTimeToTimeStamp=e.hrTimeDuration=e.timeInputToHrTime=e.hrTime=void 0;var t=qe(),r=9,n=Math.pow(10,r);function i(e){let t=e/1e3,i=Math.trunc(t);return[i,Number((t-i).toFixed(r))*n]}function o(){let e=t.otperformance.timeOrigin;if("number"!=typeof e){let r=t.otperformance;e=r.timing&&r.timing.fetchStart}return e}function s(e){let r=i(o()),s=i("number"==typeof e?e:t.otperformance.now()),a=r[0]+s[0],c=r[1]+s[1];return c>n&&(c-=n,a+=1),[a,c]}function a(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}e.hrTime=s,e.timeInputToHrTime=function(e){if(a(e))return e;if("number"==typeof e)return e<o()?s(e):i(e);if(e instanceof Date)return i(e.getTime());throw TypeError("Invalid input type")},e.hrTimeDuration=function(e,t){let r=t[0]-e[0],i=t[1]-e[1];return i<0&&(r-=1,i+=n),[r,i]},e.hrTimeToTimeStamp=function(e){let t=r,n=`${"0".repeat(t)}${e[1]}Z`,i=n.substr(n.length-t-1);return new Date(1e3*e[0]).toISOString().replace("000Z",i)},e.hrTimeToNanoseconds=function(e){return e[0]*n+e[1]},e.hrTimeToMilliseconds=function(e){return Math.round(1e3*e[0]+e[1]/1e6)},e.hrTimeToMicroseconds=function(e){return Math.round(1e6*e[0]+e[1]/1e3)},e.isTimeInputHrTime=a,e.isTimeInput=function(e){return a(e)||"number"==typeof e||e instanceof Date}})),We=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),ze=v((e=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.ExportResultCode=void 0,(t=e.ExportResultCode||(e.ExportResultCode={}))[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"})),Ge=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CompositePropagator=void 0;var t=Se();e.CompositePropagator=class{constructor(e={}){var t;this._propagators=null!==(t=e.propagators)&&void 0!==t?t:[],this._fields=Array.from(new Set(this._propagators.map((e=>"function"==typeof e.fields?e.fields():[])).reduce(((e,t)=>e.concat(t)),[])))}inject(e,r,n){for(let i of this._propagators)try{i.inject(e,r,n)}catch(e){t.diag.warn(`Failed to inject with ${i.constructor.name}. Err: ${e.message}`)}}extract(e,r,n){return this._propagators.reduce(((e,i)=>{try{return i.extract(e,r,n)}catch(e){t.diag.warn(`Failed to inject with ${i.constructor.name}. Err: ${e.message}`)}return e}),e)}fields(){return this._fields.slice()}}})),Ke=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateValue=e.validateKey=void 0;var t="[_0-9a-z-*/]",r=new RegExp(`^(?:[a-z]${t}{0,255}|[a-z0-9]${t}{0,240}@[a-z]${t}{0,13})$`),n=/^[ -~]{0,255}[!-~]$/,i=/,|=/;e.validateKey=function(e){return r.test(e)},e.validateValue=function(e){return n.test(e)&&!i.test(e)}})),Xe=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TraceState=void 0;var t=Ke(),r=class{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,t){let r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r}unset(e){let t=this._clone();return t._internalState.delete(e),t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce(((e,t)=>(e.push(t+"="+this.get(t)),e)),[]).join(",")}_parse(e){e.length>512||(this._internalState=e.split(",").reverse().reduce(((e,r)=>{let n=r.trim(),i=n.indexOf("=");if(-1!==i){let o=n.slice(0,i),s=n.slice(i+1,r.length);t.validateKey(o)&&t.validateValue(s)&&e.set(o,s)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new r;return e._internalState=new Map(this._internalState),e}};e.TraceState=r})),Je=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HttpTraceContextPropagator=e.parseTraceParent=e.TRACE_STATE_HEADER=e.TRACE_PARENT_HEADER=void 0;var t=Se(),r=we(),n=Xe();e.TRACE_PARENT_HEADER="traceparent",e.TRACE_STATE_HEADER="tracestate";var i=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");function o(e){let t=i.exec(e);return!t||"00"===t[1]&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}}e.parseTraceParent=o,e.HttpTraceContextPropagator=class{inject(n,i,o){let s=t.trace.getSpanContext(n);if(!s||r.isTracingSuppressed(n)||!t.isSpanContextValid(s))return;let a=`00-${s.traceId}-${s.spanId}-0${Number(s.traceFlags||t.TraceFlags.NONE).toString(16)}`;o.set(i,e.TRACE_PARENT_HEADER,a),s.traceState&&o.set(i,e.TRACE_STATE_HEADER,s.traceState.serialize())}extract(r,i,s){let a=s.get(i,e.TRACE_PARENT_HEADER);if(!a)return r;let c=Array.isArray(a)?a[0]:a;if("string"!=typeof c)return r;let u=o(c);if(!u)return r;u.isRemote=!0;let l=s.get(i,e.TRACE_STATE_HEADER);if(l){let e=Array.isArray(l)?l.join(","):l;u.traceState=new n.TraceState("string"==typeof e?e:void 0)}return t.trace.setSpanContext(r,u)}fields(){return[e.TRACE_PARENT_HEADER,e.TRACE_STATE_HEADER]}}})),Qe=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Ye=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getRPCMetadata=e.deleteRPCMetadata=e.setRPCMetadata=e.RPCType=void 0;var t=Se().createContextKey("OpenTelemetry SDK Context Key RPC_METADATA");(e.RPCType||(e.RPCType={})).HTTP="http",e.setRPCMetadata=function(e,r){return e.setValue(t,r)},e.deleteRPCMetadata=function(e){return e.deleteValue(t)},e.getRPCMetadata=function(e){return e.getValue(t)}})),Ze=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlwaysOffSampler=void 0;var t=Se();e.AlwaysOffSampler=class{shouldSample(){return{decision:t.SamplingDecision.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}})),et=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlwaysOnSampler=void 0;var t=Se();e.AlwaysOnSampler=class{shouldSample(){return{decision:t.SamplingDecision.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}})),tt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParentBasedSampler=void 0;var t=Se(),r=Ie(),n=Ze(),i=et();e.ParentBasedSampler=class{constructor(e){var t,o,s,a;this._root=e.root,this._root||(r.globalErrorHandler(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new i.AlwaysOnSampler),this._remoteParentSampled=null!==(t=e.remoteParentSampled)&&void 0!==t?t:new i.AlwaysOnSampler,this._remoteParentNotSampled=null!==(o=e.remoteParentNotSampled)&&void 0!==o?o:new n.AlwaysOffSampler,this._localParentSampled=null!==(s=e.localParentSampled)&&void 0!==s?s:new i.AlwaysOnSampler,this._localParentNotSampled=null!==(a=e.localParentNotSampled)&&void 0!==a?a:new n.AlwaysOffSampler}shouldSample(e,r,n,i,o,s){let a=t.trace.getSpanContext(e);return a&&t.isSpanContextValid(a)?a.isRemote?a.traceFlags&t.TraceFlags.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,i,o,s):this._remoteParentNotSampled.shouldSample(e,r,n,i,o,s):a.traceFlags&t.TraceFlags.SAMPLED?this._localParentSampled.shouldSample(e,r,n,i,o,s):this._localParentNotSampled.shouldSample(e,r,n,i,o,s):this._root.shouldSample(e,r,n,i,o,s)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}}})),rt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TraceIdRatioBasedSampler=void 0;var t=Se();e.TraceIdRatioBasedSampler=class{constructor(e=0){this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(4294967295*this._ratio)}shouldSample(e,r){return{decision:t.isValidTraceId(r)&&this._accumulate(r)<this._upperBound?t.SamplingDecision.RECORD_AND_SAMPLED:t.SamplingDecision.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(e){return"number"!=typeof e||isNaN(e)?0:e>=1?1:e<=0?0:e}_accumulate(e){let t=0;for(let r=0;r<e.length/8;r++){let n=8*r;t=(t^parseInt(e.slice(n,n+8),16))>>>0}return t}}})),nt=v((e=>{"use strict";function t(e,t){return"string"==typeof t?e===t:t.test(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.isUrlIgnored=e.urlMatches=void 0,e.urlMatches=t,e.isUrlIgnored=function(e,r){if(!r)return!1;for(let n of r)if(t(e,n))return!0;return!1}})),it=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isWrapped=void 0,e.isWrapped=function(e){return"function"==typeof e&&"function"==typeof e.__original&&"function"==typeof e.__unwrap&&!0===e.__wrapped}})),ot=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.baggageUtils=void 0,r(Pe(),e),r(Te(),e),r(Ie(),e),r(Ce(),e),r(He(),e),r(We(),e),r(ze(),e),r(De(),e),e.baggageUtils=Ee(),r(qe(),e),r(Ge(),e),r(Je(),e),r(Qe(),e),r(Ye(),e),r(Ze(),e),r(et(),e),r(tt(),e),r(rt(),e),r(we(),e),r(Xe(),e),r(xe(),e),r(Oe(),e),r(nt(),e),r(it(),e),r(De(),e)})),st=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExceptionEventName=void 0,e.ExceptionEventName="exception"})),at=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Span=void 0;var t=Se(),r=ot(),n=Ue(),i=st();e.Span=class{constructor(e,n,i,o,s,a,c=[],u=r.hrTime()){this.attributes={},this.links=[],this.events=[],this.status={code:t.SpanStatusCode.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=i,this._spanContext=o,this.parentSpanId=a,this.kind=s,this.links=c,this.startTime=r.timeInputToHrTime(u),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,n)}spanContext(){return this._spanContext}setAttribute(e,n){return null==n||this._isSpanEnded()?this:0===e.length?(t.diag.warn(`Invalid attribute key: ${e}`),this):r.isAttributeValue(n)?(Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)||(this.attributes[e]=n),this):(t.diag.warn(`Invalid attribute value set for key: ${e}`),this)}setAttributes(e){for(let[t,r]of Object.entries(e))this.setAttribute(t,r);return this}addEvent(e,n,i){return this._isSpanEnded()||(this.events.length>=this._spanLimits.eventCountLimit&&(t.diag.warn("Dropping extra events."),this.events.shift()),r.isTimeInput(n)&&(typeof i>"u"&&(i=n),n=void 0),typeof i>"u"&&(i=r.hrTime()),this.events.push({name:e,attributes:n,time:r.timeInputToHrTime(i)})),this}setStatus(e){return this._isSpanEnded()||(this.status=e),this}updateName(e){return this._isSpanEnded()||(this.name=e),this}end(e=r.hrTime()){this._isSpanEnded()?t.diag.error("You can only call end() on a span once."):(this._ended=!0,this.endTime=r.timeInputToHrTime(e),this._duration=r.hrTimeDuration(this.startTime,this.endTime),this._duration[0]<0&&t.diag.warn("Inconsistent start and end time, startTime > endTime",this.startTime,this.endTime),this._spanProcessor.onEnd(this))}isRecording(){return!1===this._ended}recordException(e,o=r.hrTime()){let s={};"string"==typeof e?s[n.SemanticAttributes.EXCEPTION_MESSAGE]=e:e&&(e.code?s[n.SemanticAttributes.EXCEPTION_TYPE]=e.code.toString():e.name&&(s[n.SemanticAttributes.EXCEPTION_TYPE]=e.name),e.message&&(s[n.SemanticAttributes.EXCEPTION_MESSAGE]=e.message),e.stack&&(s[n.SemanticAttributes.EXCEPTION_STACKTRACE]=e.stack)),s[n.SemanticAttributes.EXCEPTION_TYPE]||s[n.SemanticAttributes.EXCEPTION_MESSAGE]?this.addEvent(i.ExceptionEventName,s,o):t.diag.warn(`Failed to record an exception ${e}`)}get duration(){return this._duration}get ended(){return this._ended}_isSpanEnded(){return this._ended&&t.diag.warn("Can not execute the operation on ended Span {traceId: %s, spanId: %s}",this._spanContext.traceId,this._spanContext.spanId),this._ended}}})),ct=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.buildSamplerFromEnv=e.DEFAULT_CONFIG=void 0;var t=Se(),r=ot(),n=r.getEnv(),i=r.TracesSamplerValues.AlwaysOn;function o(e=r.getEnv()){switch(e.OTEL_TRACES_SAMPLER){case r.TracesSamplerValues.AlwaysOn:return new r.AlwaysOnSampler;case r.TracesSamplerValues.AlwaysOff:return new r.AlwaysOffSampler;case r.TracesSamplerValues.ParentBasedAlwaysOn:return new r.ParentBasedSampler({root:new r.AlwaysOnSampler});case r.TracesSamplerValues.ParentBasedAlwaysOff:return new r.ParentBasedSampler({root:new r.AlwaysOffSampler});case r.TracesSamplerValues.TraceIdRatio:return new r.TraceIdRatioBasedSampler(a(e));case r.TracesSamplerValues.ParentBasedTraceIdRatio:return new r.ParentBasedSampler({root:new r.TraceIdRatioBasedSampler(a(e))});default:return t.diag.error(`OTEL_TRACES_SAMPLER value "${e.OTEL_TRACES_SAMPLER} invalid, defaulting to ${i}".`),new r.AlwaysOnSampler}}e.DEFAULT_CONFIG={sampler:o(n),forceFlushTimeoutMillis:3e4,spanLimits:{attributeCountLimit:r.getEnv().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:r.getEnv().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:r.getEnv().OTEL_SPAN_EVENT_COUNT_LIMIT}},e.buildSamplerFromEnv=o;var s=1;function a(e){if(void 0===e.OTEL_TRACES_SAMPLER_ARG||""===e.OTEL_TRACES_SAMPLER_ARG)return t.diag.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${s}.`),s;let r=Number(e.OTEL_TRACES_SAMPLER_ARG);return isNaN(r)?(t.diag.error(`OTEL_TRACES_SAMPLER_ARG=${e.OTEL_TRACES_SAMPLER_ARG} was given, but it is invalid, defaulting to ${s}.`),s):r<0||r>1?(t.diag.error(`OTEL_TRACES_SAMPLER_ARG=${e.OTEL_TRACES_SAMPLER_ARG} was given, but it is out of range ([0..1]), defaulting to ${s}.`),s):r}})),ut=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mergeConfig=void 0;var t=ct();e.mergeConfig=function(e){let r={sampler:t.buildSamplerFromEnv()},n=Object.assign({},t.DEFAULT_CONFIG,r,e);return n.spanLimits=Object.assign({},t.DEFAULT_CONFIG.spanLimits,e.spanLimits||{}),n}})),lt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tracer=void 0;var t=Se(),r=ot(),n=at(),i=ut();e.Tracer=class{constructor(e,t,n){this._tracerProvider=n;let o=i.mergeConfig(t);this._sampler=o.sampler,this._spanLimits=o.spanLimits,this._idGenerator=t.idGenerator||new r.RandomIdGenerator,this.resource=n.resource,this.instrumentationLibrary=e}startSpan(e,i={},o=t.context.active()){var s,a;if(r.isTracingSuppressed(o))return t.diag.debug("Instrumentation suppressed, returning Noop Span"),t.trace.wrapSpanContext(t.INVALID_SPAN_CONTEXT);let c,u,l,d=function(e,r){if(!e.root)return t.trace.getSpanContext(r)}(i,o),p=this._idGenerator.generateSpanId();d&&t.trace.isSpanContextValid(d)?(c=d.traceId,u=d.traceState,l=d.spanId):c=this._idGenerator.generateTraceId();let f=null!==(s=i.kind)&&void 0!==s?s:t.SpanKind.INTERNAL,h=null!==(a=i.links)&&void 0!==a?a:[],g=r.sanitizeAttributes(i.attributes),m=this._sampler.shouldSample(i.root?t.trace.setSpanContext(o,t.INVALID_SPAN_CONTEXT):o,c,e,f,g,h),v={traceId:c,spanId:p,traceFlags:m.decision===t.SamplingDecision.RECORD_AND_SAMPLED?t.TraceFlags.SAMPLED:t.TraceFlags.NONE,traceState:u};if(m.decision===t.SamplingDecision.NOT_RECORD)return t.diag.debug("Recording is off, propagating context in a non-recording span"),t.trace.wrapSpanContext(v);let y=new n.Span(this,o,e,v,f,l,h,i.startTime);return y.setAttributes(Object.assign(g,m.attributes)),y}startActiveSpan(e,r,n,i){let o,s,a;if(arguments.length<2)return;2===arguments.length?a=r:3===arguments.length?(o=r,a=n):(o=r,s=n,a=i);let c=s??t.context.active(),u=this.startSpan(e,o,c),l=t.trace.setSpan(c,u);return t.context.with(l,a,void 0,u)}getSpanLimits(){return this._spanLimits}getActiveSpanProcessor(){return this._tracerProvider.getActiveSpanProcessor()}}})),dt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultServiceName=void 0,e.defaultServiceName=function(){return`unknown_service:${process.argv0}`}})),pt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.detectResources=void 0;var t=yt(),n=Se(),i=r(73837);e.detectResources=async(e={})=>{let r=Object.assign(e),i=await Promise.all((r.detectors||[]).map((async e=>{try{let t=await e.detect(r);return n.diag.debug(`${e.constructor.name} found resource.`,t),t}catch(r){return n.diag.debug(`${e.constructor.name} failed: ${r.message}`),t.Resource.empty()}})));return o(i),i.reduce(((e,t)=>e.merge(t)),t.Resource.empty())};var o=e=>{e.forEach((e=>{if(Object.keys(e.attributes).length>0){let t=i.inspect(e.attributes,{depth:2,breakLength:1/0,sorted:!0,compact:!1});n.diag.verbose(t)}}))}})),ft=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.envDetector=void 0;var t=Se(),r=ot(),n=Ue(),i=wt();e.envDetector=new class{constructor(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}async detect(e){let o={},s=r.getEnv(),a=s.OTEL_RESOURCE_ATTRIBUTES,c=s.OTEL_SERVICE_NAME;if(a)try{let e=this._parseResourceAttributes(a);Object.assign(o,e)}catch(e){t.diag.debug(`EnvDetector failed: ${e.message}`)}return c&&(o[n.ResourceAttributes.SERVICE_NAME]=c),new i.Resource(o)}_parseResourceAttributes(e){if(!e)return{};let t={},r=e.split(this._COMMA_SEPARATOR,-1);for(let e of r){let r=e.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(2!==r.length)continue;let[n,i]=r;if(n=n.trim(),i=i.trim().split('^"|"$').join(""),!this._isValidAndNotEmpty(n))throw new Error(`Attribute key ${this._ERROR_MESSAGE_INVALID_CHARS}`);if(!this._isValid(i))throw new Error(`Attribute value ${this._ERROR_MESSAGE_INVALID_VALUE}`);t[n]=i}return t}_isValid(e){return e.length<=this._MAX_LENGTH&&this._isPrintableString(e)}_isPrintableString(e){for(let t=0;t<e.length;t++){let r=e.charAt(t);if(r<=" "||r>="~")return!1}return!0}_isValidAndNotEmpty(e){return e.length>0&&this._isValid(e)}}})),ht=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.processDetector=void 0;var t=Se(),r=Ue(),n=wt();e.processDetector=new class{async detect(e){let t={[r.ResourceAttributes.PROCESS_PID]:process.pid,[r.ResourceAttributes.PROCESS_EXECUTABLE_NAME]:process.title||"",[r.ResourceAttributes.PROCESS_COMMAND]:process.argv[1]||"",[r.ResourceAttributes.PROCESS_COMMAND_LINE]:process.argv.join(" ")||""};return this._getResourceAttributes(t,e)}_getResourceAttributes(e,i){return""===e[r.ResourceAttributes.PROCESS_EXECUTABLE_NAME]||""===e[r.ResourceAttributes.PROCESS_EXECUTABLE_PATH]||""===e[r.ResourceAttributes.PROCESS_COMMAND]||""===e[r.ResourceAttributes.PROCESS_COMMAND_LINE]?(t.diag.debug("ProcessDetector failed: Unable to find required process resources. "),n.Resource.empty()):new n.Resource(Object.assign({},e))}}})),gt=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(ft(),e),r(ht(),e)})),mt=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(dt(),e),r(pt(),e),r(gt(),e)})),vt=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(mt(),e)})),yt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Resource=void 0;var t=Ue(),r=ot(),n=vt(),i=class{constructor(e){this.attributes=e}static empty(){return i.EMPTY}static default(){return new i({[t.ResourceAttributes.SERVICE_NAME]:n.defaultServiceName(),[t.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:r.SDK_INFO[t.ResourceAttributes.TELEMETRY_SDK_LANGUAGE],[t.ResourceAttributes.TELEMETRY_SDK_NAME]:r.SDK_INFO[t.ResourceAttributes.TELEMETRY_SDK_NAME],[t.ResourceAttributes.TELEMETRY_SDK_VERSION]:r.SDK_INFO[t.ResourceAttributes.TELEMETRY_SDK_VERSION]})}merge(e){if(!e||!Object.keys(e.attributes).length)return this;let t=Object.assign({},this.attributes,e.attributes);return new i(t)}};e.Resource=i,i.EMPTY=new i({})})),_t=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),St=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),wt=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(yt(),e),r(vt(),e),r(_t(),e),r(St(),e)})),bt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MultiSpanProcessor=void 0;var t=ot();e.MultiSpanProcessor=class{constructor(e){this._spanProcessors=e}forceFlush(){let e=[];for(let t of this._spanProcessors)e.push(t.forceFlush());return new Promise((r=>{Promise.all(e).then((()=>{r()})).catch((e=>{t.globalErrorHandler(e||new Error("MultiSpanProcessor: forceFlush failed")),r()}))}))}onStart(e,t){for(let r of this._spanProcessors)r.onStart(e,t)}onEnd(e){for(let t of this._spanProcessors)t.onEnd(e)}shutdown(){let e=[];for(let t of this._spanProcessors)e.push(t.shutdown());return new Promise(((t,r)=>{Promise.all(e).then((()=>{t()}),r)}))}}})),Et=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoopSpanProcessor=void 0,e.NoopSpanProcessor=class{onStart(e,t){}onEnd(e){}shutdown(){return Promise.resolve()}forceFlush(){return Promise.resolve()}}})),Pt=v(((e,t)=>{var r="__lodash_hash_undefined__",n=9007199254740991,i="[object Arguments]",o="[object AsyncFunction]",s="[object Function]",a="[object GeneratorFunction]",c="[object Null]",u="[object Object]",l="[object Proxy]",d="[object Undefined]",p=/^\[object .+?Constructor\]$/,f=/^(?:0|[1-9]\d*)$/,h={};h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h[i]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object Boolean]"]=h["[object DataView]"]=h["[object Date]"]=h["[object Error]"]=h[s]=h["[object Map]"]=h["[object Number]"]=h[u]=h["[object RegExp]"]=h["[object Set]"]=h["[object String]"]=h["[object WeakMap]"]=!1;var g,m="object"==typeof global&&global&&global.Object===Object&&global,v="object"==typeof self&&self&&self.Object===Object&&self,y=m||v||Function("return this")(),_="object"==typeof e&&e&&!e.nodeType&&e,S=_&&"object"==typeof t&&t&&!t.nodeType&&t,w=S&&S.exports===_,b=w&&m.process,E=function(){try{return S&&S.require&&S.require("util").types||b&&b.binding&&b.binding("util")}catch{}}(),P=E&&E.isTypedArray,T=Array.prototype,C=Function.prototype,I=Object.prototype,O=y["__core-js_shared__"],x=C.toString,N=I.hasOwnProperty,k=(g=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"",R=I.toString,A=x.call(Object),D=RegExp("^"+x.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),j=w?y.Buffer:void 0,M=y.Symbol,L=y.Uint8Array,F=(j&&j.allocUnsafe,function(e,t){return function(r){return e(t(r))}}(Object.getPrototypeOf,Object)),U=Object.create,B=I.propertyIsEnumerable,V=T.splice,$=M?M.toStringTag:void 0,q=function(){try{var e=le(Object,"defineProperty");return e({},"",{}),e}catch{}}(),H=j?j.isBuffer:void 0,W=Math.max,z=Date.now,G=le(y,"Map"),K=le(Object,"create"),X=function(){function e(){}return function(t){if(!be(t))return{};if(U)return U(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function J(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Q(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Y(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Z(e){var t=this.__data__=new Q(e);this.size=t.size}function ee(e,t,r){(void 0!==r&&!ge(e[t],r)||void 0===r&&!(t in e))&&ne(e,t,r)}function te(e,t,r){var n=e[t];(!N.call(e,t)||!ge(n,r)||void 0===r&&!(t in e))&&ne(e,t,r)}function re(e,t){for(var r=e.length;r--;)if(ge(e[r][0],t))return r;return-1}function ne(e,t,r){"__proto__"==t&&q?q(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}J.prototype.clear=function(){this.__data__=K?K(null):{},this.size=0},J.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},J.prototype.get=function(e){var t=this.__data__;if(K){var n=t[e];return n===r?void 0:n}return N.call(t,e)?t[e]:void 0},J.prototype.has=function(e){var t=this.__data__;return K?void 0!==t[e]:N.call(t,e)},J.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=K&&void 0===t?r:t,this},Q.prototype.clear=function(){this.__data__=[],this.size=0},Q.prototype.delete=function(e){var t=this.__data__,r=re(t,e);return!(r<0||(r==t.length-1?t.pop():V.call(t,r,1),--this.size,0))},Q.prototype.get=function(e){var t=this.__data__,r=re(t,e);return r<0?void 0:t[r][1]},Q.prototype.has=function(e){return re(this.__data__,e)>-1},Q.prototype.set=function(e,t){var r=this.__data__,n=re(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Y.prototype.clear=function(){this.size=0,this.__data__={hash:new J,map:new(G||Q),string:new J}},Y.prototype.delete=function(e){var t=ue(this,e).delete(e);return this.size-=t?1:0,t},Y.prototype.get=function(e){return ue(this,e).get(e)},Y.prototype.has=function(e){return ue(this,e).has(e)},Y.prototype.set=function(e,t){var r=ue(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Z.prototype.clear=function(){this.__data__=new Q,this.size=0},Z.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Z.prototype.get=function(e){return this.__data__.get(e)},Z.prototype.has=function(e){return this.__data__.has(e)},Z.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Q){var n=r.__data__;if(!G||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Y(n)}return r.set(e,t),this.size=r.size,this};var ie=function(e,t,r){for(var n=-1,i=Object(e),o=r(e),s=o.length;s--;){var a=o[++n];if(!1===t(i[a],a,i))break}return e};function oe(e){return null==e?void 0===e?d:c:$&&$ in Object(e)?function(e){var t=N.call(e,$),r=e[$];try{e[$]=void 0;var n=!0}catch{}var i=R.call(e);return n&&(t?e[$]=r:delete e[$]),i}(e):function(e){return R.call(e)}(e)}function se(e){return Ee(e)&&oe(e)==i}function ae(e,t,r,n,i){e!==t&&ie(t,(function(o,s){if(i||(i=new Z),be(o))!function(e,t,r,n,i,o,s){var a=fe(e,r),c=fe(t,r),l=s.get(c);if(l)ee(e,r,l);else{var d=o?o(a,c,r+"",e,t,s):void 0,p=void 0===d;if(p){var f=ve(c),h=!f&&_e(c),g=!f&&!h&&Pe(c);d=c,f||h||g?ve(a)?d=a:function(e){return Ee(e)&&ye(e)}(a)?d=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(a):h?(p=!1,d=function(e,t){return e.slice()}(c)):g?(p=!1,d=function(e,t){var r=function(e){var t=new e.constructor(e.byteLength);return new L(t).set(new L(e)),t}(e.buffer);return new e.constructor(r,e.byteOffset,e.length)}(c)):d=[]:function(e){if(!Ee(e)||oe(e)!=u)return!1;var t=F(e);if(null===t)return!0;var r=N.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&x.call(r)==A}(c)||me(c)?(d=a,me(a)?d=function(e){return function(e,t,r,n){var i=!r;r||(r={});for(var o=-1,s=t.length;++o<s;){var a=t[o],c=void 0;void 0===c&&(c=e[a]),i?ne(r,a,c):te(r,a,c)}return r}(e,Te(e))}(a):(!be(a)||Se(a))&&(d=function(e){return"function"!=typeof e.constructor||pe(e)?{}:X(F(e))}(c))):p=!1}p&&(s.set(c,d),i(d,c,n,o,s),s.delete(c)),ee(e,r,d)}}(e,t,s,r,ae,n,i);else{var a=n?n(fe(e,s),o,s+"",e,t,i):void 0;void 0===a&&(a=o),ee(e,s,a)}}),Te)}var ce=q?function(e,t){return q(e,"toString",{configurable:!0,enumerable:!1,value:Ie(t),writable:!0})}:Oe;function ue(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function le(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!be(e)||function(e){return!!k&&k in e}(e))&&(Se(e)?D:p).test(function(e){if(null!=e){try{return x.call(e)}catch{}try{return e+""}catch{}}return""}(e))}(r)?r:void 0}function de(e,t){var r=typeof e;return!!(t=t??n)&&("number"==r||"symbol"!=r&&f.test(e))&&e>-1&&e%1==0&&e<t}function pe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||I)}function fe(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var he=function(e){var t=0,r=0;return function(){var n=z(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(ce);function ge(e,t){return e===t||e!=e&&t!=t}var me=se(function(){return arguments}())?se:function(e){return Ee(e)&&N.call(e,"callee")&&!B.call(e,"callee")},ve=Array.isArray;function ye(e){return null!=e&&we(e.length)&&!Se(e)}var _e=H||function(){return!1};function Se(e){if(!be(e))return!1;var t=oe(e);return t==s||t==a||t==o||t==l}function we(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function be(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ee(e){return null!=e&&"object"==typeof e}var Pe=P?function(e){return function(t){return e(t)}}(P):function(e){return Ee(e)&&we(e.length)&&!!h[oe(e)]};function Te(e){return ye(e)?function(e,t){var r=ve(e),n=!r&&me(e),i=!r&&!n&&_e(e),o=!r&&!n&&!i&&Pe(e),s=r||n||i||o,a=s?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=a.length;for(var u in e)(t||N.call(e,u))&&(!s||!("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||de(u,c)))&&a.push(u);return a}(e,!0):function(e){if(!be(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=pe(e),r=[];for(var n in e)"constructor"==n&&(t||!N.call(e,n))||r.push(n);return r}(e)}var Ce=function(e){return function(e,t){return he(function(e,t,r){return t=W(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=W(n.length-t,0),s=Array(o);++i<o;)s[i]=n[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=n[i];return a[t]=r(s),function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(e,this,a)}}(e,t,Oe),e+"")}((function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&function(e,t,r){if(!be(r))return!1;var n=typeof t;return!!("number"==n?ye(r)&&de(t,r.length):"string"==n&&t in r)&&ge(r[t],e)}(r[0],r[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var a=r[n];a&&e(t,a,n)}return t}))}((function(e,t,r){ae(e,t,r)}));function Ie(e){return function(){return e}}function Oe(e){return e}t.exports=Ce})),Tt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BatchSpanProcessorBase=void 0;var t=Se(),r=ot();e.BatchSpanProcessorBase=class{constructor(e,t){this._exporter=e,this._finishedSpans=[],this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve();let n=r.getEnv();this._maxExportBatchSize="number"==typeof(null==t?void 0:t.maxExportBatchSize)?t.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize="number"==typeof(null==t?void 0:t.maxQueueSize)?t.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis="number"==typeof(null==t?void 0:t.scheduledDelayMillis)?t.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis="number"==typeof(null==t?void 0:t.exportTimeoutMillis)?t.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT}forceFlush(){return this._isShutdown?this._shuttingDownPromise:this._flushAll()}onStart(e){}onEnd(e){this._isShutdown||this._addToBuffer(e)}shutdown(){return this._isShutdown||(this._isShutdown=!0,this._shuttingDownPromise=new Promise(((e,t)=>{Promise.resolve().then((()=>this.onShutdown())).then((()=>this._flushAll())).then((()=>this._exporter.shutdown())).then(e).catch((e=>{t(e)}))}))),this._shuttingDownPromise}_addToBuffer(e){this._finishedSpans.length>=this._maxQueueSize||(this._finishedSpans.push(e),this._maybeStartTimer())}_flushAll(){return new Promise(((e,t)=>{let r=[];for(let e=0,t=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);e<t;e++)r.push(this._flushOneBatch());Promise.all(r).then((()=>{e()})).catch(t)}))}_flushOneBatch(){return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise(((e,n)=>{let i=setTimeout((()=>{n(new Error("Timeout"))}),this._exportTimeoutMillis);t.context.with(r.suppressTracing(t.context.active()),(()=>{this._exporter.export(this._finishedSpans.splice(0,this._maxExportBatchSize),(t=>{var o;clearTimeout(i),t.code===r.ExportResultCode.SUCCESS?e():n(null!==(o=t.error)&&void 0!==o?o:new Error("BatchSpanProcessor: span export failed"))}))}))}))}_maybeStartTimer(){void 0===this._timer&&(this._timer=setTimeout((()=>{this._flushOneBatch().then((()=>{this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())})).catch((e=>{r.globalErrorHandler(e)}))}),this._scheduledDelayMillis),r.unrefTimer(this._timer))}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}}})),Ct=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BatchSpanProcessor=void 0;var t=Tt(),r=class extends t.BatchSpanProcessorBase{onShutdown(){}};e.BatchSpanProcessor=r})),It=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Ct(),e)})),Ot=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(It(),e)})),xt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BasicTracerProvider=e.ForceFlushState=void 0;var t,r,n=Se(),i=ot(),o=wt(),s=Ft(),a=ct(),c=bt(),u=Et(),l=Pt(),d=Ot();(r=t=e.ForceFlushState||(e.ForceFlushState={}))[r.resolved=0]="resolved",r[r.timeout=1]="timeout",r[r.error=2]="error",r[r.unresolved=3]="unresolved";var p=class{constructor(e={}){var t;this._registeredSpanProcessors=[],this._tracers=new Map;let r=l({},a.DEFAULT_CONFIG,e);this.resource=null!==(t=r.resource)&&void 0!==t?t:o.Resource.empty(),this.resource=o.Resource.default().merge(this.resource),this._config=Object.assign({},r,{resource:this.resource});let n=this._buildExporterFromEnv();if(void 0!==n){let e=new d.BatchSpanProcessor(n);this.activeSpanProcessor=e}else this.activeSpanProcessor=new u.NoopSpanProcessor}getTracer(e,t){let r=`${e}@${t||""}`;return this._tracers.has(r)||this._tracers.set(r,new s.Tracer({name:e,version:t},this._config,this)),this._tracers.get(r)}addSpanProcessor(e){0===this._registeredSpanProcessors.length&&this.activeSpanProcessor.shutdown().catch((e=>n.diag.error("Error while trying to shutdown current span processor",e))),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new c.MultiSpanProcessor(this._registeredSpanProcessors)}getActiveSpanProcessor(){return this.activeSpanProcessor}register(e={}){n.trace.setGlobalTracerProvider(this),void 0===e.propagator&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&n.context.setGlobalContextManager(e.contextManager),e.propagator&&n.propagation.setGlobalPropagator(e.propagator)}forceFlush(){let e=this._config.forceFlushTimeoutMillis,r=this._registeredSpanProcessors.map((r=>new Promise((n=>{let i,o=setTimeout((()=>{n(new Error(`Span processor did not completed within timeout period of ${e} ms`)),i=t.timeout}),e);r.forceFlush().then((()=>{clearTimeout(o),i!==t.timeout&&(i=t.resolved,n(i))})).catch((e=>{clearTimeout(o),i=t.error,n(e)}))}))));return new Promise(((e,n)=>{Promise.all(r).then((r=>{let i=r.filter((e=>e!==t.resolved));i.length>0?n(i):e()})).catch((e=>n([e])))}))}shutdown(){return this.activeSpanProcessor.shutdown()}_getPropagator(e){var t;return null===(t=p._registeredPropagators.get(e))||void 0===t?void 0:t()}_getSpanExporter(e){var t;return null===(t=p._registeredExporters.get(e))||void 0===t?void 0:t()}_buildPropagatorFromEnv(){let e=Array.from(new Set(i.getEnv().OTEL_PROPAGATORS)),t=e.map((e=>{let t=this._getPropagator(e);return t||n.diag.warn(`Propagator "${e}" requested through environment variable is unavailable.`),t})).reduce(((e,t)=>(t&&e.push(t),e)),[]);if(0!==t.length)return 1===e.length?t[0]:new i.CompositePropagator({propagators:t})}_buildExporterFromEnv(){let e=i.getEnv().OTEL_TRACES_EXPORTER;if("none"===e)return;let t=this._getSpanExporter(e);return t||n.diag.error(`Exporter "${e}" requested through environment variable is unavailable.`),t}};e.BasicTracerProvider=p,p._registeredPropagators=new Map([["tracecontext",()=>new i.HttpTraceContextPropagator],["baggage",()=>new i.HttpBaggagePropagator]]),p._registeredExporters=new Map})),Nt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConsoleSpanExporter=void 0;var t=ot();e.ConsoleSpanExporter=class{export(e,t){return this._sendSpans(e,t)}shutdown(){return this._sendSpans([]),Promise.resolve()}_exportInfo(e){return{traceId:e.spanContext().traceId,parentId:e.parentSpanId,name:e.name,id:e.spanContext().spanId,kind:e.kind,timestamp:t.hrTimeToMicroseconds(e.startTime),duration:t.hrTimeToMicroseconds(e.duration),attributes:e.attributes,status:e.status,events:e.events}}_sendSpans(e,r){for(let t of e)console.log(this._exportInfo(t));if(r)return r({code:t.ExportResultCode.SUCCESS})}}})),kt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InMemorySpanExporter=void 0;var t=ot();e.InMemorySpanExporter=class{constructor(){this._finishedSpans=[],this._stopped=!1}export(e,r){if(this._stopped)return r({code:t.ExportResultCode.FAILED,error:new Error("Exporter has been stopped")});this._finishedSpans.push(...e),setTimeout((()=>r({code:t.ExportResultCode.SUCCESS})),0)}shutdown(){return this._stopped=!0,this._finishedSpans=[],Promise.resolve()}reset(){this._finishedSpans=[]}getFinishedSpans(){return this._finishedSpans}}})),Rt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),At=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleSpanProcessor=void 0;var t=Se(),r=ot();e.SimpleSpanProcessor=class{constructor(e){this._exporter=e,this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve()}forceFlush(){return Promise.resolve()}onStart(e){}onEnd(e){this._isShutdown||t.context.with(r.suppressTracing(t.context.active()),(()=>{this._exporter.export([e],(e=>{var t;e.code!==r.ExportResultCode.SUCCESS&&r.globalErrorHandler(null!==(t=e.error)&&void 0!==t?t:new Error(`SimpleSpanProcessor: span export failed (status ${e})`))}))}))}shutdown(){return this._isShutdown||(this._isShutdown=!0,this._shuttingDownPromise=new Promise(((e,t)=>{Promise.resolve().then((()=>this._exporter.shutdown())).then(e).catch((e=>{t(e)}))}))),this._shuttingDownPromise}}})),Dt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),jt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Mt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Lt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Ft=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(lt(),e),r(xt(),e),r(Ot(),e),r(Nt(),e),r(kt(),e),r(Rt(),e),r(At(),e),r(Dt(),e),r(Et(),e),r(at(),e),r(jt(),e),r(Mt(),e),r(Lt(),e)})),Ut=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.azureCoreTracing=e.AzureMonitorSymbol=void 0;var t=T();e.AzureMonitorSymbol="Azure_Monitor_Tracer";var r=!1;e.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:function(n){if(r)return n;try{var i=Ft(),o=Se(),s=(new i.BasicTracerProvider).getTracer("applicationinsights tracer"),a=n.setTracer;n.setTracer=function(r){var n=r.startSpan;r.startSpan=function(e,r,i){var o=n.call(this,e,r,i),s=o.end;return o.end=function(){var e=s.apply(this,arguments);return t.channel.publish("azure-coretracing",o),e},o},r[e.AzureMonitorSymbol]=!0,a.call(this,r)},o.trace.getSpan(o.context.active()),n.setTracer(s),r=!0}catch{}return n}},e.enable=function(){t.channel.registerMonkeyPatch("@azure/core-tracing",e.azureCoreTracing)}})),Bt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.bunyan=void 0;var t=T();e.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:function(e){var r=e.prototype._emit;return e.prototype._emit=function(e,n){var i=r.apply(this,arguments);if(!n){var o=i;o||(o=r.call(this,e,!0)),t.channel.publish("bunyan",{level:e.level,result:o})}return i},e}},e.enable=function(){t.channel.registerMonkeyPatch("bunyan",e.bunyan)}})),Vt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.console=void 0;var t=T(),n=r(12781);e.console={versionSpecifier:">= 4.0.0",patch:function(e){var r=new n.Writable,i=new n.Writable;r.write=function(e){if(!e)return!0;var r=e.toString();return t.channel.publish("console",{message:r}),!0},i.write=function(e){if(!e)return!0;var r=e.toString();return t.channel.publish("console",{message:r,stderr:!0}),!0};for(var o=new e.Console(r,i),s=function(t){var r=e[t];r&&(e[t]=function(){if(o[t])try{o[t].apply(o,arguments)}catch{}return r.apply(e,arguments)})},a=0,c=["log","info","warn","error","dir","time","timeEnd","trace","assert"];a<c.length;a++)s(c[a]);return e}},e.enable=function(){t.channel.registerMonkeyPatch("console",e.console),r(96206)}})),$t=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.mongoCore=void 0;var t=T();e.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:function(e){var r=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var e=r.apply(this,arguments),n=this.s.pool.write;this.s.pool.write=function(){var e="function"==typeof arguments[1]?1:2;return"function"==typeof arguments[e]&&(arguments[e]=t.channel.bindToContext(arguments[e])),n.apply(this,arguments)};var i=this.s.pool.logout;return this.s.pool.logout=function(){return"function"==typeof arguments[1]&&(arguments[1]=t.channel.bindToContext(arguments[1])),i.apply(this,arguments)},e},e}},e.enable=function(){t.channel.registerMonkeyPatch("mongodb-core",e.mongoCore)}})),qt=v((e=>{"use strict";var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.mongo330=e.mongo3=e.mongo2=void 0;var r=T();e.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:function(e){var n=e.instrument({operationIdGenerator:{next:function(){return r.channel.bindToContext((function(e){return e()}))}}}),i={};return n.on("started",(function(e){i[e.requestId]||(i[e.requestId]=t(t({},e),{time:new Date}))})),n.on("succeeded",(function(e){var t=i[e.requestId];t&&delete i[e.requestId],"function"==typeof e.operationId?e.operationId((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})):r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})),n.on("failed",(function(e){var t=i[e.requestId];t&&delete i[e.requestId],"function"==typeof e.operationId?e.operationId((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})):r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})),e}},e.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:function(e){var n=e.instrument(),i={},o={};return n.on("started",(function(e){i[e.requestId]||(o[e.requestId]=r.channel.bindToContext((function(e){return e()})),i[e.requestId]=t(t({},e),{time:new Date}))})),n.on("succeeded",(function(e){var t=i[e.requestId];t&&delete i[e.requestId],"object"==typeof e&&"function"==typeof o[e.requestId]&&(o[e.requestId]((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})),delete o[e.requestId])})),n.on("failed",(function(e){var t=i[e.requestId];t&&delete i[e.requestId],"object"==typeof e&&"function"==typeof o[e.requestId]&&(o[e.requestId]((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})),delete o[e.requestId])})),e}},e.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:function(e){!function(e){var t=e.Server.prototype.connect;e.Server.prototype.connect=function(){var e=t.apply(this,arguments),n=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var e="function"==typeof arguments[1]?1:2;return"function"==typeof arguments[e]&&(arguments[e]=r.channel.bindToContext(arguments[e])),n.apply(this,arguments)};var i=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return"function"==typeof arguments[1]&&(arguments[1]=r.channel.bindToContext(arguments[1])),i.apply(this,arguments)},e}}(e);var t=e.instrument(),n={},i={};return t.on("started",(function(e){n[e.requestId]||(i[e.requestId]=r.channel.bindToContext((function(e){return e()})),n[e.requestId]=e)})),t.on("succeeded",(function(e){var t=n[e.requestId];t&&delete n[e.requestId],"object"==typeof e&&"function"==typeof i[e.requestId]&&(i[e.requestId]((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})),delete i[e.requestId])})),t.on("failed",(function(e){var t=n[e.requestId];t&&delete n[e.requestId],"object"==typeof e&&"function"==typeof i[e.requestId]&&(i[e.requestId]((function(){return r.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})),delete i[e.requestId])})),e}},e.enable=function(){r.channel.registerMonkeyPatch("mongodb",e.mongo2),r.channel.registerMonkeyPatch("mongodb",e.mongo3),r.channel.registerMonkeyPatch("mongodb",e.mongo330)}})),Ht=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.mysql=void 0;var t=T(),n=r(71017);e.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:function(e,i){var o=function(e,r){return function(r,n){var i=e[r];i&&(e[r]=function(){for(var e=arguments.length-1,r=arguments.length-1;r>=0;--r){if("function"==typeof arguments[r]){e=r;break}if(typeof arguments[r]<"u")break}var o=arguments[e],s={result:null,startTime:null,startDate:null};"function"==typeof o&&(n?(s.startTime=process.hrtime(),s.startDate=new Date,arguments[e]=t.channel.bindToContext(n(s,o))):arguments[e]=t.channel.bindToContext(o));var a=i.apply(this,arguments);return s.result=a,a})}},s=function(e,t){return o(e.prototype)},a=r(70852)(n.dirname(i)+"/lib/Connection");["connect","changeUser","ping","statistics","end"].forEach((function(e){return s(a)(e)})),o(a)("createQuery",(function(e,r){return function(n){var i=process.hrtime(e.startTime),o=1e3*i[0]+i[1]/1e6|0;t.channel.publish("mysql",{query:e.result,callbackArgs:arguments,err:n,duration:o,time:e.startDate}),r.apply(this,arguments)}}));var c=r(41024)(n.dirname(i)+"/lib/Pool");return["_enqueueCallback"].forEach((function(e){return s(c)(e)})),e}},e.enable=function(){t.channel.registerMonkeyPatch("mysql",e.mysql)}})),Wt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.postgresPool1=void 0;var t=T();e.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:function(e){var r=e.prototype.connect;return e.prototype.connect=function(e){return e&&(arguments[0]=t.channel.bindToContext(e)),r.apply(this,arguments)},e}},e.enable=function(){t.channel.registerMonkeyPatch("pg-pool",e.postgresPool1)}})),zt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.postgres7=e.postgres6=void 0;var t=T(),n=r(82361);e.postgres6={versionSpecifier:"6.*",patch:function(e,r){var i=e.Client.prototype.query,o="__diagnosticOriginalFunc";return e.Client.prototype.query=function(e,r,s){var a,c={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},u=process.hrtime();function l(e){e&&e[o]&&(e=e[o]);var r=t.channel.bindToContext((function(r,i){var o=process.hrtime(u);if(c.result=i&&{rowCount:i.rowCount,command:i.command},c.error=r,c.duration=Math.ceil(1e3*o[0]+o[1]/1e6),t.channel.publish("postgres",c),r){if(e)return e.apply(this,arguments);a&&a instanceof n.EventEmitter&&a.emit("error",r)}else e&&e.apply(this,arguments)}));try{return Object.defineProperty(r,o,{value:e}),r}catch{return e}}try{"string"==typeof e?r instanceof Array?(c.query.preparable={text:e,args:r},s=l(s)):(c.query.text=e,s?s=l(s):r=l(r)):("string"==typeof e.name?c.query.plan=e.name:e.values instanceof Array?c.query.preparable={text:e.text,args:e.values}:c.query.text=e.text,s?s=l(s):r?r=l(r):e.callback=l(e.callback))}catch{return i.apply(this,arguments)}return arguments[0]=e,arguments[1]=r,arguments[2]=s,arguments.length=arguments.length>3?arguments.length:3,a=i.apply(this,arguments)},e}},e.postgres7={versionSpecifier:">=7.* <=8.*",patch:function(e,r){var i=e.Client.prototype.query,o="__diagnosticOriginalFunc";return e.Client.prototype.query=function(e,r,s){var a,c=this,u=!!s,l={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},d=process.hrtime();function p(e){e&&e[o]&&(e=e[o]);var r=t.channel.bindToContext((function(r,i){var o=process.hrtime(d);if(l.result=i&&{rowCount:i.rowCount,command:i.command},l.error=r,l.duration=Math.ceil(1e3*o[0]+o[1]/1e6),t.channel.publish("postgres",l),r){if(e)return e.apply(this,arguments);a&&a instanceof n.EventEmitter&&a.emit("error",r)}else e&&e.apply(this,arguments)}));try{return Object.defineProperty(r,o,{value:e}),r}catch{return e}}try{"string"==typeof e?r instanceof Array?(l.query.preparable={text:e,args:r},s=(u="function"==typeof s)?p(s):s):(l.query.text=e,s?s=(u="function"==typeof s)?p(s):s:r=(u="function"==typeof r)?p(r):r):("string"==typeof e.name?l.query.plan=e.name:e.values instanceof Array?l.query.preparable={text:e.text,args:e.values}:l.query.text=e.text,s?(u="function"==typeof s,s=p(s)):r?r=(u="function"==typeof r)?p(r):r:(u="function"==typeof e.callback,e.callback=u?p(e.callback):e.callback))}catch{return i.apply(this,arguments)}return arguments[0]=e,arguments[1]=r,arguments[2]=s,arguments.length=arguments.length>3?arguments.length:3,a=i.apply(this,arguments),u?a:a.then((function(e){return p()(void 0,e),new c._Promise((function(t,r){t(e)}))})).catch((function(e){return p()(e,void 0),new c._Promise((function(t,r){r(e)}))}))},e}},e.enable=function(){t.channel.registerMonkeyPatch("pg",e.postgres6),t.channel.registerMonkeyPatch("pg",e.postgres7)}})),Gt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.redis=void 0;var t=T();e.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:function(e){var r=e.RedisClient.prototype.internal_send_command;return e.RedisClient.prototype.internal_send_command=function(e){if(e){var n=e.callback;if(!n||!n.pubsubBound){var i=this.address,o=process.hrtime(),s=new Date;e.callback=t.channel.bindToContext((function(r,a){var c=process.hrtime(o),u=1e3*c[0]+c[1]/1e6|0;t.channel.publish("redis",{duration:u,address:i,commandObj:e,err:r,result:a,time:s}),"function"==typeof n&&n.apply(this,arguments)})),e.callback.pubsubBound=!0}}return r.call(this,e)},e}},e.enable=function(){t.channel.registerMonkeyPatch("redis",e.redis)}})),Kt=v((e=>{"use strict";var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.tedious=void 0;var r=T();e.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:function(e){var n=e.Connection.prototype.makeRequest;return e.Connection.prototype.makeRequest=function(){var e,i,o,s=arguments[0];arguments[0].callback=(e=s.callback,i=process.hrtime(),o={query:{},database:{host:null,port:null},result:null,error:null,duration:0},r.channel.bindToContext((function(n,s,a){var c=process.hrtime(i);o=t(t({},o),{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!n&&{rowCount:s,rows:a},query:{text:this.parametersByName.statement.value},error:n,duration:Math.ceil(1e3*c[0]+c[1]/1e6)}),r.channel.publish("tedious",o),e.call(this,n,s,a)}))),n.apply(this,arguments)},e}},e.enable=function(){r.channel.registerMonkeyPatch("tedious",e.tedious)}})),Xt=v((e=>{"use strict";var t,r=e&&e.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,r)},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),n=e&&e.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.winston2=e.winston3=void 0;var i=T();e.winston3={versionSpecifier:"3.x",patch:function(e){var t=function(e){function t(t,r){var n=e.call(this,r)||this;return n.winston=t,n}return r(t,e),t.prototype.log=function(e,t){var r=e.message,o=e.level,s=e.meta,a=n(e,["message","level","meta"]);o="function"==typeof Symbol.for?e[Symbol.for("level")]:o,r=e instanceof Error?e:r;var c=function(e,t){return null!=e.config.npm.levels[t]?"npm":null!=e.config.syslog.levels[t]?"syslog":"unknown"}(this.winston,o);for(var u in s=s||{},a)a.hasOwnProperty(u)&&(s[u]=a[u]);i.channel.publish("winston",{message:r,level:o,levelKind:c,meta:s}),t()},t}(e.Transport);function o(){var r,n=arguments[0].levels||e.config.npm.levels;for(var i in n)n.hasOwnProperty(i)&&(r=void 0===r||n[i]>n[r]?i:r);this.add(new t(e,{level:r}))}var s=e.createLogger;e.createLogger=function(){var r,n=arguments[0].levels||e.config.npm.levels;for(var i in n)n.hasOwnProperty(i)&&(r=void 0===r||n[i]>n[r]?i:r);var a=s.apply(this,arguments);a.add(new t(e,{level:r}));var c=a.configure;return a.configure=function(){c.apply(this,arguments),o.apply(this,arguments)},a};var a=e.configure;return e.configure=function(){a.apply(this,arguments),o.apply(this,arguments)},e.add(new t(e)),e}},e.winston2={versionSpecifier:"2.x",patch:function(e){var t,r=e.Logger.prototype.log,n=function(r,n,o){var s;return s=t===e.config.npm.levels?"npm":t===e.config.syslog.levels?"syslog":"unknown",i.channel.publish("winston",{level:r,message:n,meta:o,levelKind:s}),n};return e.Logger.prototype.log=function(){return t=this.levels,this.filters&&0!==this.filters.length?this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter((function(e){return e!==n})),this.filters.push(n)):this.filters=[n],r.apply(this,arguments)},e}},e.enable=function(){i.channel.registerMonkeyPatch("winston",e.winston2),i.channel.registerMonkeyPatch("winston",e.winston3)}})),Jt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.tedious=e.pgPool=e.pg=e.winston=e.redis=e.mysql=e.mongodb=e.mongodbCore=e.console=e.bunyan=e.azuresdk=void 0;var t=Ut();e.azuresdk=t;var r=Bt();e.bunyan=r;var n=Vt();e.console=n;var i=$t();e.mongodbCore=i;var o=qt();e.mongodb=o;var s=Ht();e.mysql=s;var a=Wt();e.pgPool=a;var c=zt();e.pg=c;var u=Gt();e.redis=u;var l=Kt();e.tedious=l;var d=Xt();e.winston=d,e.enable=function(){r.enable(),n.enable(),i.enable(),o.enable(),s.enable(),c.enable(),a.enable(),u.enable(),d.enable(),t.enable(),l.enable()}})),Qt=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.registerContextPreservation=e.IsInitialized=void 0;var t=w(),r=S();e.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var n,i,o,s,a="DiagnosticChannel";if(e.IsInitialized){for(s in n=Jt(),i=(process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"").split(","),o={bunyan:n.bunyan,console:n.console,mongodb:n.mongodb,mongodbCore:n.mongodbCore,mysql:n.mysql,redis:n.redis,pg:n.pg,pgPool:n.pgPool,winston:n.winston,azuresdk:n.azuresdk})-1===i.indexOf(s)&&(o[s].enable(),r.info(a,"Subscribed to "+s+" events"));i.length>0&&r.info(a,"Some modules will not be patched",i)}else r.info(a,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");e.registerContextPreservation=function(r){if(e.IsInitialized){var n=T();n.channel.addContextPreservation(r),n.channel.spanContextPropagator=t.AsyncScopeManager}}})),Yt=v(((e,t)=>{"use strict";t.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}})),Zt=v(((e,t)=>{"use strict";var n=e&&e.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=r(13685),o=r(95687),s=r(57310),a=r(22057),c=S(),u=Yt(),l=function(){function e(){}return e.getCookie=function(t,r){var n="";if(t&&t.length&&"string"==typeof r)for(var i=t+"=",o=r.split(";"),s=0;s<o.length;s++)if(r=o[s],(r=e.trim(r))&&0===r.indexOf(i)){n=r.substring(i.length,o[s].length);break}return n},e.trim=function(e){return"string"==typeof e?e.replace(/^\s+|\s+$/g,""):""},e.int32ArrayToBase64=function(e){var t=function(e,t){return String.fromCharCode(e>>t&255)},r=e.map((function(e){return t(e,24)+t(e,16)+t(e,8)+t(e,0)})).join(""),n=(Buffer.from?Buffer.from(r,"binary"):new Buffer(r,"binary")).toString("base64");return n.substr(0,n.indexOf("="))},e.random32=function(){return 4294967296*Math.random()|0},e.randomu32=function(){return e.random32()+2147483648},e.w3cTraceId=function(){for(var t,r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",i=0;i<4;i++)n+=r[15&(t=e.random32())]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var o=r[8+4*Math.random()|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+o+n.substr(16,3)+n.substr(19,12)},e.w3cSpanId=function(){return e.w3cTraceId().substring(16)},e.isValidW3CId=function(e){return 32===e.length&&"00000000000000000000000000000000"!==e},e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.isError=function(e){return e instanceof Error},e.isPrimitive=function(e){var t=typeof e;return"string"===t||"number"===t||"boolean"===t},e.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},e.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var t=(e/1e3%60).toFixed(7).replace(/0{0,4}$/,""),r=""+Math.floor(e/6e4)%60,n=""+Math.floor(e/36e5)%24,i=Math.floor(e/864e5);return t=t.indexOf(".")<2?"0"+t:t,r=r.length<2?"0"+r:r,(i>0?i+".":"")+(n=n.length<2?"0"+n:n)+":"+r+":"+t},e.extractError=function(e){var t=e;return{message:e.message,code:t.code||t.id||""}},e.extractObject=function(t){return t instanceof Error?e.extractError(t):"function"==typeof t.toJSON?t.toJSON():t},e.validateStringMap=function(t){if("object"==typeof t){var r={};for(var n in t){var i="",o=t[n],s=typeof o;if(e.isPrimitive(o))i=o.toString();else if(null===o||"undefined"===s)i="";else{if("function"===s){c.info("key: "+n+" was function; will not serialize");continue}var a=e.isArray(o)?o:e.extractObject(o);try{i=e.isPrimitive(a)?a:JSON.stringify(a)}catch(e){i=o.constructor.name.toString()+" (Error: "+e.message+")",c.info("key: "+n+", could not be serialized")}}r[n]=i.substring(0,e.MAX_PROPERTY_LENGTH)}return r}c.info("Invalid properties dropped from payload")},e.canIncludeCorrelationHeader=function(e,t){var r=e&&e.config&&e.config.correlationHeaderExcludedDomains;if(!r||0==r.length||!t)return!0;for(var n=0;n<r.length;n++)if(new RegExp(r[n].replace(/\./g,".").replace(/\*/g,".*")).test(s.parse(t).hostname))return!1;return!0},e.getCorrelationContextTarget=function(e,t){var r=e.headers&&e.headers[u.requestContextHeader];if(r)for(var n=r.split(","),i=0;i<n.length;++i){var o=n[i].split("=");if(2==o.length&&o[0]==t)return o[1]}},e.makeRequest=function(t,r,a,u){r&&0===r.indexOf("//")&&(r="https:"+r);var l=s.parse(r),d=n(n({},a),{host:l.hostname,port:l.port,path:l.pathname}),p=void 0;if("https:"===l.protocol&&(p=t.proxyHttpsUrl||void 0),"http:"===l.protocol&&(p=t.proxyHttpUrl||void 0),p){0===p.indexOf("//")&&(p="http:"+p);var f=s.parse(p);"https:"===f.protocol?(c.info("Proxies that use HTTPS are not supported"),p=void 0):d=n(n({},d),{host:f.hostname,port:f.port||"80",path:r,headers:n(n({},d.headers),{Host:l.hostname})})}var h="https:"===l.protocol&&!p;return h&&void 0!==t.httpsAgent?d.agent=t.httpsAgent:h||void 0===t.httpAgent?h&&(d.agent=e.tlsRestrictedAgent):d.agent=t.httpAgent,h?o.request(d,u):i.request(d,u)},e.safeIncludeCorrelationHeader=function(t,r,n){var i;if("string"==typeof n)i=n;else if(n instanceof Array)i=n.join(",");else if(n&&"function"==typeof n.toString)try{i=n.toString()}catch(e){c.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",e,n)}i?e.addCorrelationIdHeaderFromString(t,r,i):r.setHeader(u.requestContextHeader,u.requestContextSourceKey+"="+t.config.correlationId)},e.dumpObj=function(e){var t=Object.prototype.toString.call(e);return t+("[object Error]"===t?"{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":JSON.stringify(e))},e.addCorrelationIdHeaderFromString=function(e,t,r){var n=r.split(","),i=u.requestContextSourceKey+"=";n.some((function(e){return e.substring(0,i.length)===i}))||t.setHeader(u.requestContextHeader,r+","+u.requestContextSourceKey+"="+e.config.correlationId)},e.MAX_PROPERTY_LENGTH=8192,e.tlsRestrictedAgent=new o.Agent({keepAlive:!0,maxSockets:25,secureOptions:a.SSL_OP_NO_SSLv2|a.SSL_OP_NO_SSLv3|a.SSL_OP_NO_TLSv1|a.SSL_OP_NO_TLSv1_1}),e}();t.exports=l})),er=v(((e,t)=>{"use strict";var r=Zt(),n=S(),i=function(){function e(){}return e.queryCorrelationId=function(t,i){var o=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId";if(e.completedLookups.hasOwnProperty(o))i(e.completedLookups[o]);else if(e.pendingLookups[o])e.pendingLookups[o].push(i);else{e.pendingLookups[o]=[i];var s=function(){if(e.pendingLookups[o]){var i={method:"GET",disableAppInsightsAutoCollection:!0};n.info(e.TAG,i);var a=r.makeRequest(t,o,i,(function(r){if(200===r.statusCode){var i="";r.setEncoding("utf-8"),r.on("data",(function(e){i+=e})),r.on("end",(function(){n.info(e.TAG,i);var t=e.correlationIdPrefix+i;e.completedLookups[o]=t,e.pendingLookups[o]&&e.pendingLookups[o].forEach((function(e){return e(t)})),delete e.pendingLookups[o]}))}else r.statusCode>=400&&r.statusCode<500?(e.completedLookups[o]=void 0,delete e.pendingLookups[o]):setTimeout(s,t.correlationIdRetryIntervalMs)}));a&&(a.on("error",(function(t){n.warn(e.TAG,t)})),a.end())}};setTimeout(s,0)}},e.cancelCorrelationIdQuery=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId",i=e.pendingLookups[n];i&&(e.pendingLookups[n]=i.filter((function(e){return e!=r})),0==e.pendingLookups[n].length&&delete e.pendingLookups[n])},e.generateRequestId=function(t){if(t){"."!==(t="|"==t[0]?t:"|"+t)[t.length-1]&&(t+=".");var r=(e.currentRootId++).toString(16);return e.appendSuffix(t,r,"_")}return e.generateRootId()},e.getRootId=function(e){var t=e.indexOf(".");t<0&&(t=e.length);var r="|"===e[0]?1:0;return e.substring(r,t)},e.generateRootId=function(){return"|"+r.w3cTraceId()+"."},e.appendSuffix=function(t,n,i){if(t.length+n.length<e.requestIdMaxLength)return t+n+i;var o=e.requestIdMaxLength-9;if(t.length>o)for(;o>1;--o){var s=t[o-1];if("."===s||"_"===s)break}if(o<=1)return e.generateRootId();for(n=r.randomu32().toString(16);n.length<8;)n="0"+n;return t.substring(0,o)+n+"#"},e.TAG="CorrelationIdManager",e.correlationIdPrefix="cid-v1:",e.w3cEnabled=!0,e.pendingLookups={},e.completedLookups={},e.requestIdMaxLength=1024,e.currentRootId=r.randomu32(),e}();t.exports=i})),tr=v(((e,t)=>{"use strict";var r=Zt(),n=er(),i=function(){function e(t,i){if(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.version=e.DEFAULT_VERSION,t&&"string"==typeof t)if(t.split(",").length>1)this.traceId=r.w3cTraceId(),this.spanId=r.w3cTraceId().substr(0,16);else{var o=t.trim().split("-"),s=o.length;s>=4?(this.version=o[0],this.traceId=o[1],this.spanId=o[2],this.traceFlag=o[3]):(this.traceId=r.w3cTraceId(),this.spanId=r.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=e.DEFAULT_VERSION,this.traceId=r.w3cTraceId()),"00"===this.version&&4!==s&&(this.traceId=r.w3cTraceId(),this.spanId=r.w3cTraceId().substr(0,16)),"ff"===this.version&&(this.version=e.DEFAULT_VERSION,this.traceId=r.w3cTraceId(),this.spanId=r.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=e.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.traceId=r.w3cTraceId()),e.isValidTraceId(this.traceId)||(this.traceId=r.w3cTraceId()),e.isValidSpanId(this.spanId)||(this.spanId=r.w3cTraceId().substr(0,16),this.traceId=r.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(i){this.parentId=i.slice();var a=n.getRootId(i);e.isValidTraceId(a)||(this.legacyRootId=a,a=r.w3cTraceId()),-1!==i.indexOf("|")&&(i=i.substring(1+i.substring(0,i.length-1).lastIndexOf("."),i.length-1)),this.traceId=a,this.spanId=i}else this.traceId=r.w3cTraceId(),this.spanId=r.w3cTraceId().substr(0,16)}return e.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==e},e.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==e},e.formatOpenTelemetryTraceFlags=function(e){var t="0"+e.toString(16);return t.substring(t.length-2)},e.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},e.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},e.prototype.updateSpanId=function(){this.spanId=r.w3cTraceId().substr(0,16)},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}();t.exports=i})),rr=v(((e,t)=>{"use strict";var r=function(){function e(e){this.fieldmap=[],e&&(this.fieldmap=this.parseHeader(e))}return e.prototype.toString=function(){var e=this.fieldmap;return e&&0!=e.length?e.join(", "):null},e.validateKeyChars=function(e){var t=e.split("@");if(2==t.length){var r=t[0].trim(),n=t[1].trim(),i=Boolean(r.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),o=Boolean(n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return i&&o}return 1==t.length&&Boolean(e.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/))},e.prototype.parseHeader=function(t){var r=[],n={},i=t.split(",");if(i.length>32)return null;for(var o=0,s=i;o<s.length;o++){var a=s[o].trim();if(0!==a.length){var c=a.split("=");if(2!==c.length||!e.validateKeyChars(c[0])||n[c[0]])return null;n[c[0]]=!0,r.push(a)}}return r},e.strict=!0,e}();t.exports=r})),nr=v(((e,t)=>{"use strict";t.exports=function(){}})),ir=v(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return n(t,e),t}(nr());t.exports=i})),or=v(((e,t)=>{"use strict";t.exports=function(){}})),sr=v(((e,t)=>{"use strict";t.exports=function(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}})),ar=v(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(){return e.call(this)||this}return n(t,e),t}(or());t.exports=i})),cr=v(((e,t)=>{"use strict";var r,n;(n=r||(r={}))[n.Measurement=0]="Measurement",n[n.Aggregation=1]="Aggregation",t.exports=r})),ur=v(((e,t)=>{"use strict";var r=cr();t.exports=function(){this.kind=r.Measurement}})),lr=v(((e,t)=>{"use strict";t.exports=function(){this.ver=1,this.sampleRate=100,this.tags={}}})),dr=v(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return n(t,e),t}(nr());t.exports=i})),pr=v(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.exceptions=[],t.properties={},t.measurements={},t}return n(t,e),t}(nr());t.exports=i})),fr=v(((e,t)=>{"use strict";t.exports=function(){this.hasFullStack=!0,this.parsedStack=[]}})),hr=v(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t}return n(t,e),t}(nr());t.exports=i})),gr=v(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.metrics=[],t.properties={},t}return n(t,e),t}(nr());t.exports=i})),mr=v(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return n(t,e),t}(dr());t.exports=i})),vr=v(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.success=!0,t.properties={},t.measurements={},t}return n(t,e),t}(nr());t.exports=i})),yr=v(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return n(t,e),t}(nr());t.exports=i})),_r=v(((e,t)=>{"use strict";var r,n;(n=r||(r={}))[n.Verbose=0]="Verbose",n[n.Information=1]="Information",n[n.Warning=2]="Warning",n[n.Error=3]="Error",n[n.Critical=4]="Critical",t.exports=r})),Sr=v(((e,t)=>{"use strict";t.exports=function(){}})),wr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AvailabilityData=ir(),e.Base=or(),e.ContextTagKeys=sr(),e.Data=ar(),e.DataPoint=ur(),e.DataPointType=cr(),e.Domain=nr(),e.Envelope=lr(),e.EventData=dr(),e.ExceptionData=pr(),e.ExceptionDetails=fr(),e.MessageData=hr(),e.MetricData=gr(),e.PageViewData=mr(),e.RemoteDependencyData=vr(),e.RequestData=yr(),e.SeverityLevel=_r(),e.StackFrame=Sr()})),br=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.domainSupportsProperties=e.RemoteDependencyDataConstants=void 0;var t=wr(),r=function(){function e(){}return e.TYPE_HTTP="Http",e.TYPE_AI="Http (tracked component)",e}();e.RemoteDependencyDataConstants=r,e.domainSupportsProperties=function(e){return"properties"in e||e instanceof t.EventData||e instanceof t.ExceptionData||e instanceof t.MessageData||e instanceof t.MetricData||e instanceof t.PageViewData||e instanceof t.RemoteDependencyData||e instanceof t.RequestData}})),Er=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Pr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Tr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Cr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Ir=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Or=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),xr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Nr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),kr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Rr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Ar=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Dr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),jr=v((e=>{"use strict";var t,r;Object.defineProperty(e,"__esModule",{value:!0}),e.TelemetryType=e.TelemetryTypeString=e.baseTypeToTelemetryType=e.telemetryTypeToBaseType=void 0,e.telemetryTypeToBaseType=function(e){switch(e){case t.Event:return"EventData";case t.Exception:return"ExceptionData";case t.Trace:return"MessageData";case t.Metric:return"MetricData";case t.Request:return"RequestData";case t.Dependency:return"RemoteDependencyData";case t.Availability:return"AvailabilityData";case t.PageView:return"PageViewData"}},e.baseTypeToTelemetryType=function(e){switch(e){case"EventData":return t.Event;case"ExceptionData":return t.Exception;case"MessageData":return t.Trace;case"MetricData":return t.Metric;case"RequestData":return t.Request;case"RemoteDependencyData":return t.Dependency;case"AvailabilityData":return t.Availability;case"PageViewData":return t.PageView}},e.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"},(r=t=e.TelemetryType||(e.TelemetryType={}))[r.Event=0]="Event",r[r.Exception=1]="Exception",r[r.Trace=2]="Trace",r[r.Metric=3]="Metric",r[r.Request=4]="Request",r[r.Dependency=5]="Dependency",r[r.Availability=6]="Availability",r[r.PageView=7]="PageView"})),Mr=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Er(),e),r(Pr(),e),r(Tr(),e),r(Cr(),e),r(Ir(),e),r(Or(),e),r(xr(),e),r(Nr(),e),r(kr(),e),r(Rr(),e),r(Ar(),e),r(Dr(),e),r(jr(),e)})),Lr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Fr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Ur=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Br=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Vr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),$r=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),qr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Hr=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),Wr=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Lr(),e),r(Fr(),e),r(Ur(),e),r(Br(),e),r(Vr(),e),r($r(),e),r(qr(),e),r(Hr(),e)})),zr=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(br(),e),r(wr(),e),r(Mr(),e),r(Wr(),e)})),Gr=v(((e,t)=>{"use strict";var r=function(){function e(){}return e.prototype.getUrl=function(){return this.url},e.prototype.RequestParser=function(){this.startTime=+new Date},e.prototype._setStatus=function(e,t){var r=+new Date;this.duration=r-this.startTime,this.statusCode=e;var n=this.properties||{};if(t)if("string"==typeof t)n.error=t;else if(t instanceof Error)n.error=t.message;else if("object"==typeof t)for(var i in t)n[i]=t[i]&&t[i].toString&&t[i].toString();this.properties=n},e.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},e}();t.exports=r})),Kr=v(((e,t)=>{"use strict";var n,i=e&&e.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=r(57310),s=zr(),a=Zt(),c=Yt(),u=Gr(),l=er(),d=rr(),p=tr(),f=function(e){function t(t,r){var n=e.call(this)||this;return t&&(n.method=t.method,n.url=n._getAbsoluteUrl(t),n.startTime=+new Date,n.socketRemoteAddress=t.socket&&t.socket.remoteAddress,n.parseHeaders(t,r),t.connection&&(n.connectionRemoteAddress=t.connection.remoteAddress,n.legacySocketRemoteAddress=t.connection.socket&&t.connection.socket.remoteAddress)),n}return i(t,e),t.prototype.onError=function(e,t){this._setStatus(void 0,e),t&&(this.duration=t)},t.prototype.onResponse=function(e,t){this._setStatus(e.statusCode,void 0),t&&(this.duration=t)},t.prototype.getRequestTelemetry=function(e){var t={id:this.requestId,name:this.method+" "+o.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(e&&e.time?t.time=e.time:this.startTime&&(t.time=new Date(this.startTime)),e){for(var r in e)t[r]||(t[r]=e[r]);if(e.properties)for(var r in e.properties)t.properties[r]=e.properties[r]}return t},t.prototype.getRequestTags=function(e){var r={};for(var n in e)r[n]=e[n];return r[t.keys.locationIp]=e[t.keys.locationIp]||this._getIp(),r[t.keys.sessionId]=e[t.keys.sessionId]||this._getId("ai_session"),r[t.keys.userId]=e[t.keys.userId]||this._getId("ai_user"),r[t.keys.userAuthUserId]=e[t.keys.userAuthUserId]||this._getId("ai_authUser"),r[t.keys.operationName]=this.getOperationName(e),r[t.keys.operationParentId]=this.getOperationParentId(e),r[t.keys.operationId]=this.getOperationId(e),r},t.prototype.getOperationId=function(e){return e[t.keys.operationId]||this.operationId},t.prototype.getOperationParentId=function(e){return e[t.keys.operationParentId]||this.parentId||this.getOperationId(e)},t.prototype.getOperationName=function(e){return e[t.keys.operationName]||this.method+" "+o.parse(this.url).pathname},t.prototype.getRequestId=function(){return this.requestId},t.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},t.prototype.getTraceparent=function(){return this.traceparent},t.prototype.getTracestate=function(){return this.tracestate},t.prototype.getLegacyRootId=function(){return this.legacyRootId},t.prototype._getAbsoluteUrl=function(e){if(!e.headers)return e.url;var t=e.connection?e.connection.encrypted:null,r=o.parse(e.url),n=r.pathname,i=r.search,s=t||"https"==e.headers["x-forwarded-proto"]?"https":"http";return o.format({protocol:s,host:e.headers.host,pathname:n,search:i})},t.prototype._getIp=function(){var e=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,t=function(t){var r=e.exec(t);if(r)return r[0]},r=t(this.rawHeaders["x-forwarded-for"])||t(this.rawHeaders["x-client-ip"])||t(this.rawHeaders["x-real-ip"])||t(this.connectionRemoteAddress)||t(this.socketRemoteAddress)||t(this.legacySocketRemoteAddress);return!r&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&"::"===this.connectionRemoteAddress.substr(0,2)&&(r="127.0.0.1"),r},t.prototype._getId=function(e){var r=this.rawHeaders&&this.rawHeaders.cookie&&"string"==typeof this.rawHeaders.cookie&&this.rawHeaders.cookie||"";return t.parseId(a.getCookie(e,r))},t.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},t.prototype.parseHeaders=function(e,t){if(this.rawHeaders=e.headers||e.rawHeaders,this.userAgent=e.headers&&e.headers["user-agent"],this.sourceCorrelationId=a.getCorrelationContextTarget(e,c.requestContextSourceKey),e.headers){var r=e.headers[c.traceStateHeader]?e.headers[c.traceStateHeader].toString():null,n=e.headers[c.traceparentHeader]?e.headers[c.traceparentHeader].toString():null,i=e.headers[c.requestIdHeader]?e.headers[c.requestIdHeader].toString():null,o=e.headers[c.parentIdHeader]?e.headers[c.parentIdHeader].toString():null,s=e.headers[c.rootIdHeader]?e.headers[c.rootIdHeader].toString():null;this.correlationContextHeader=e.headers[c.correlationContextHeader]?e.headers[c.correlationContextHeader].toString():null,l.w3cEnabled&&(n||r)?(this.traceparent=new p(n?n.toString():null),this.tracestate=n&&r&&new d(r?r.toString():null),this.setBackCompatFromThisTraceContext()):i?l.w3cEnabled?(this.traceparent=new p(null,i),this.setBackCompatFromThisTraceContext()):(this.parentId=i,this.requestId=l.generateRequestId(this.parentId),this.operationId=l.getRootId(this.requestId)):l.w3cEnabled?(this.traceparent=new p,this.traceparent.parentId=o,this.traceparent.legacyRootId=s||o,this.setBackCompatFromThisTraceContext()):(this.parentId=o,this.requestId=l.generateRequestId(s||this.parentId),this.correlationContextHeader=null,this.operationId=l.getRootId(this.requestId)),t&&(this.requestId=t,this.operationId=l.getRootId(this.requestId))}},t.parseId=function(e){var t=e.split("|");return t.length>0?t[0]:""},t.keys=new s.ContextTagKeys,t}(u);t.exports=f})),Xr=v(((e,t)=>{var r;e=t.exports=G,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},e.SEMVER_SPEC_VERSION="2.0.0";var n=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,o=e.re=[],s=e.src=[],a=0,c=a++;s[c]="0|[1-9]\\d*";var u=a++;s[u]="[0-9]+";var l=a++;s[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var d=a++;s[d]="("+s[c]+")\\.("+s[c]+")\\.("+s[c]+")";var p=a++;s[p]="("+s[u]+")\\.("+s[u]+")\\.("+s[u]+")";var f=a++;s[f]="(?:"+s[c]+"|"+s[l]+")";var h=a++;s[h]="(?:"+s[u]+"|"+s[l]+")";var g=a++;s[g]="(?:-("+s[f]+"(?:\\."+s[f]+")*))";var m=a++;s[m]="(?:-?("+s[h]+"(?:\\."+s[h]+")*))";var v=a++;s[v]="[0-9A-Za-z-]+";var y=a++;s[y]="(?:\\+("+s[v]+"(?:\\."+s[v]+")*))";var _=a++,S="v?"+s[d]+s[g]+"?"+s[y]+"?";s[_]="^"+S+"$";var w="[v=\\s]*"+s[p]+s[m]+"?"+s[y]+"?",b=a++;s[b]="^"+w+"$";var E=a++;s[E]="((?:<|>)?=?)";var P=a++;s[P]=s[u]+"|x|X|\\*";var T=a++;s[T]=s[c]+"|x|X|\\*";var C=a++;s[C]="[v=\\s]*("+s[T]+")(?:\\.("+s[T]+")(?:\\.("+s[T]+")(?:"+s[g]+")?"+s[y]+"?)?)?";var I=a++;s[I]="[v=\\s]*("+s[P]+")(?:\\.("+s[P]+")(?:\\.("+s[P]+")(?:"+s[m]+")?"+s[y]+"?)?)?";var O=a++;s[O]="^"+s[E]+"\\s*"+s[C]+"$";var x=a++;s[x]="^"+s[E]+"\\s*"+s[I]+"$";var N=a++;s[N]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var k=a++;s[k]="(?:~>?)";var R=a++;s[R]="(\\s*)"+s[k]+"\\s+",o[R]=new RegExp(s[R],"g");var A=a++;s[A]="^"+s[k]+s[C]+"$";var D=a++;s[D]="^"+s[k]+s[I]+"$";var j=a++;s[j]="(?:\\^)";var M=a++;s[M]="(\\s*)"+s[j]+"\\s+",o[M]=new RegExp(s[M],"g");var L=a++;s[L]="^"+s[j]+s[C]+"$";var F=a++;s[F]="^"+s[j]+s[I]+"$";var U=a++;s[U]="^"+s[E]+"\\s*("+w+")$|^$";var B=a++;s[B]="^"+s[E]+"\\s*("+S+")$|^$";var V=a++;s[V]="(\\s*)"+s[E]+"\\s*("+w+"|"+s[C]+")",o[V]=new RegExp(s[V],"g");var $=a++;s[$]="^\\s*("+s[C]+")\\s+-\\s+("+s[C]+")\\s*$";var q=a++;s[q]="^\\s*("+s[I]+")\\s+-\\s+("+s[I]+")\\s*$";var H,W=a++;for(s[W]="(<|>)?=?\\s*\\*",H=0;H<35;H++)r(H,s[H]),o[H]||(o[H]=new RegExp(s[H]));function z(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof G)return e;if("string"!=typeof e||e.length>n)return null;if(!(t.loose?o[b]:o[_]).test(e))return null;try{return new G(e,t)}catch{return null}}function G(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof G){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof G))return new G(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var s=e.trim().match(t.loose?o[b]:o[_]);if(!s)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}e.parse=z,e.valid=function(e,t){var r=z(e,t);return r?r.version:null},e.clean=function(e,t){var r=z(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},e.SemVer=G,G.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},G.prototype.toString=function(){return this.version},G.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof G||(e=new G(e,this.options)),this.compareMain(e)||this.comparePre(e)},G.prototype.compareMain=function(e){return e instanceof G||(e=new G(e,this.options)),X(this.major,e.major)||X(this.minor,e.minor)||X(this.patch,e.patch)},G.prototype.comparePre=function(e){if(e instanceof G||(e=new G(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return X(n,i)}while(++t)},G.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},e.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new G(e,r).inc(t,n).version}catch{return null}},e.diff=function(e,t){if(Z(e,t))return null;var r=z(e),n=z(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var s in r)if(("major"===s||"minor"===s||"patch"===s)&&r[s]!==n[s])return i+s;return o},e.compareIdentifiers=X;var K=/^[0-9]+$/;function X(e,t){var r=K.test(e),n=K.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function J(e,t,r){return new G(e,r).compare(new G(t,r))}function Q(e,t,r){return J(e,t,r)>0}function Y(e,t,r){return J(e,t,r)<0}function Z(e,t,r){return 0===J(e,t,r)}function ee(e,t,r){return 0!==J(e,t,r)}function te(e,t,r){return J(e,t,r)>=0}function re(e,t,r){return J(e,t,r)<=0}function ne(e,t,r,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return Z(e,r,n);case"!=":return ee(e,r,n);case">":return Q(e,r,n);case">=":return te(e,r,n);case"<":return Y(e,r,n);case"<=":return re(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}function ie(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof ie){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ie))return new ie(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===oe?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}e.rcompareIdentifiers=function(e,t){return X(t,e)},e.major=function(e,t){return new G(e,t).major},e.minor=function(e,t){return new G(e,t).minor},e.patch=function(e,t){return new G(e,t).patch},e.compare=J,e.compareLoose=function(e,t){return J(e,t,!0)},e.rcompare=function(e,t,r){return J(t,e,r)},e.sort=function(t,r){return t.sort((function(t,n){return e.compare(t,n,r)}))},e.rsort=function(t,r){return t.sort((function(t,n){return e.rcompare(t,n,r)}))},e.gt=Q,e.lt=Y,e.eq=Z,e.neq=ee,e.gte=te,e.lte=re,e.cmp=ne,e.Comparator=ie;var oe={};function se(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof se)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new se(e.raw,t);if(e instanceof ie)return new se(e.value,t);if(!(this instanceof se))return new se(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function ce(e,t,r,n,i,o,s,a,c,u,l,d,p){return((t=ae(r)?"":ae(n)?">="+r+".0.0":ae(i)?">="+r+"."+n+".0":">="+t)+" "+(a=ae(c)?"":ae(u)?"<"+(+c+1)+".0.0":ae(l)?"<"+c+"."+(+u+1)+".0":d?"<="+c+"."+u+"."+l+"-"+d:"<="+a)).trim()}function ue(e,t,n){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(i=0;i<e.length;i++)if(r(e[i].semver),e[i].semver!==oe&&e[i].semver.prerelease.length>0){var o=e[i].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}function le(e,t,r){try{t=new se(t,r)}catch{return!1}return t.test(e)}function de(e,t,r,n){var i,o,s,a,c;switch(e=new G(e,n),t=new se(t,n),r){case">":i=Q,o=re,s=Y,a=">",c=">=";break;case"<":i=Y,o=te,s=Q,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(le(e,t,n))return!1;for(var u=0;u<t.set.length;++u){var l=t.set[u],d=null,p=null;if(l.forEach((function(e){e.semver===oe&&(e=new ie(">=0.0.0")),d=d||e,p=p||e,i(e.semver,d.semver,n)?d=e:s(e.semver,p.semver,n)&&(p=e)})),d.operator===a||d.operator===c||(!p.operator||p.operator===a)&&o(e,p.semver))return!1;if(p.operator===c&&s(e,p.semver))return!1}return!0}ie.prototype.parse=function(e){var t=this.options.loose?o[U]:o[B],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new G(r[2],this.options.loose):this.semver=oe},ie.prototype.toString=function(){return this.value},ie.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===oe||("string"==typeof e&&(e=new G(e,this.options)),ne(e,this.operator,this.semver,this.options))},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Comparator is required");var r;if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new se(e.value,t),le(this.value,r,t);if(""===e.operator)return r=new se(this.value,t),le(e.semver,r,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=ne(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=ne(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||i||o&&s||a||c},e.Range=se,se.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},se.prototype.toString=function(){return this.range},se.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?o[q]:o[$];e=e.replace(n,ce),r("hyphen replace",e),e=e.replace(o[V],"$1$2$3"),r("comparator trim",e,o[V]),e=(e=(e=e.replace(o[R],"$1~")).replace(o[M],"$1^")).split(/\s+/).join(" ");var i=t?o[U]:o[B],s=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?o[F]:o[L];return e.replace(n,(function(t,n,i,o,s){var a;return r("caret",e,t,n,i,o,s),ae(n)?a="":ae(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(o)?a="0"===n?">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":">="+n+"."+i+".0 <"+(+n+1)+".0.0":s?(r("replaceCaret pr",s),a="0"===n?"0"===i?">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+"-"+s+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===i?">="+n+"."+i+"."+o+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+" <"+(+n+1)+".0.0"),r("caret return",a),a}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?o[D]:o[A];return e.replace(n,(function(t,n,i,o,s){var a;return r("tilde",e,t,n,i,o,s),ae(n)?a="":ae(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(o)?a=">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":s?(r("replaceTilde pr",s),a=">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+(+i+1)+".0"):a=">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0",r("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?o[x]:o[O];return e.replace(n,(function(t,n,i,o,s,a){r("xRange",e,t,n,i,o,s,a);var c=ae(i),u=c||ae(o),l=u||ae(s);return"="===n&&l&&(n=""),c?t=">"===n||"<"===n?"<0.0.0":"*":n&&l?(u&&(o=0),s=0,">"===n?(n=">=",u?(i=+i+1,o=0,s=0):(o=+o+1,s=0)):"<="===n&&(n="<",u?i=+i+1:o=+o+1),t=n+i+"."+o+"."+s):u?t=">="+i+".0.0 <"+(+i+1)+".0.0":l&&(t=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0"),r("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(o[W],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(s=s.filter((function(e){return!!e.match(i)}))),s.map((function(e){return new ie(e,this.options)}),this)},se.prototype.intersects=function(e,t){if(!(e instanceof se))throw new TypeError("a Range is required");return this.set.some((function(r){return r.every((function(r){return e.set.some((function(e){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},e.toComparators=function(e,t){return new se(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},se.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new G(e,this.options));for(var t=0;t<this.set.length;t++)if(ue(this.set[t],e,this.options))return!0;return!1},e.satisfies=le,e.maxSatisfying=function(e,t,r){var n=null,i=null;try{var o=new se(t,r)}catch{return null}return e.forEach((function(e){o.test(e)&&(!n||-1===i.compare(e))&&(i=new G(n=e,r))})),n},e.minSatisfying=function(e,t,r){var n=null,i=null;try{var o=new se(t,r)}catch{return null}return e.forEach((function(e){o.test(e)&&(!n||1===i.compare(e))&&(i=new G(n=e,r))})),n},e.minVersion=function(e,t){e=new se(e,t);var r=new G("0.0.0");if(e.test(r)||(r=new G("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n)e.set[n].forEach((function(e){var t=new G(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":(!r||Q(r,t))&&(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}));return r&&e.test(r)?r:null},e.validRange=function(e,t){try{return new se(e,t).range||"*"}catch{return null}},e.ltr=function(e,t,r){return de(e,t,"<",r)},e.gtr=function(e,t,r){return de(e,t,">",r)},e.outside=de,e.prerelease=function(e,t){var r=z(e,t);return r&&r.prerelease.length?r.prerelease:null},e.intersects=function(e,t,r){return e=new se(e,r),t=new se(t,r),e.intersects(t)},e.coerce=function(e){if(e instanceof G)return e;if("string"!=typeof e)return null;var t=e.match(o[N]);return null==t?null:z(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}})),Jr=v(((e,t)=>{"use strict";function r(e){return"function"==typeof e}var n=console.error.bind(console);function i(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function o(e){e&&e.logger&&(r(e.logger)?n=e.logger:n("new logger isn't a function, not replacing"))}function s(e,t,o){if(e&&e[t]){if(!o)return n("no wrapper function"),void n((new Error).stack);if(r(e[t])&&r(o)){var s=e[t],a=o(s,t);return i(a,"__original",s),i(a,"__unwrap",(function(){e[t]===a&&i(e,t,s)})),i(a,"__wrapped",!0),i(e,t,a),a}n("original object and wrapper must be functions")}else n("no original function "+t+" to wrap")}function a(e,t){return e&&e[t]?e[t].__unwrap?e[t].__unwrap():void n("no original to unwrap to -- has "+t+" already been unwrapped?"):(n("no function to unwrap."),void n((new Error).stack))}o.wrap=s,o.massWrap=function(e,t,r){if(!e)return n("must provide one or more modules to patch"),void n((new Error).stack);Array.isArray(e)||(e=[e]),t&&Array.isArray(t)?e.forEach((function(e){t.forEach((function(t){s(e,t,r)}))})):n("must provide one or more functions to wrap on modules")},o.unwrap=a,o.massUnwrap=function(e,t){if(!e)return n("must provide one or more modules to patch"),void n((new Error).stack);Array.isArray(e)||(e=[e]),t&&Array.isArray(t)?e.forEach((function(e){t.forEach((function(t){a(e,t)}))})):n("must provide one or more functions to unwrap on modules")},t.exports=o})),Qr=v(((e,t)=>{"use strict";var r=Jr(),n=r.wrap,i=r.unwrap,o="wrap@before";function s(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function a(e,t){var r;return r=e._events&&e._events[t],Array.isArray(r)||(r=r?[r]:[]),r}function c(e,t){if(e){var r=e;if("function"==typeof e)r=t(e);else if(Array.isArray(e)){r=[];for(var n=0;n<e.length;n++)r[n]=t(e[n])}return r}}t.exports=function(e,t,r){if(!(e&&e.on&&e.addListener&&e.removeListener&&e.emit))throw new Error("can only wrap real EEs");if(!t)throw new Error("must have function to run on listener addition");if(!r)throw new Error("must have function to wrap listeners when emitting");function u(e){return function(t,r){var i=a(this,t).slice();try{var s=e.call(this,t,r);return function(e,t,r){var n=a(e,t).filter((function(e){return-1===r.indexOf(e)}));n.length>0&&function(e,t){for(var r=t.length,n=0;n<r;n++){var i=t[n],s=e[o];if("function"==typeof s)s(i);else if(Array.isArray(s))for(var a=s.length,c=0;c<a;c++)s[c](i)}}(e,n)}(this,t,i),s}finally{this.on.__wrapped||n(this,"on",u),this.addListener.__wrapped||n(this,"addListener",u)}}}e[o]?"function"==typeof e[o]?s(e,o,[e[o],t]):Array.isArray(e[o])&&e[o].push(t):s(e,o,t),e.__wrapped||(n(e,"addListener",u),n(e,"on",u),n(e,"emit",(function(e){return function(t){if(!this._events||!this._events[t])return e.apply(this,arguments);var o=this._events[t];n(this,"removeListener",(function(e){return function(){this._events[t]=o;try{return e.apply(this,arguments)}finally{o=this._events[t],this._events[t]=c(o,r)}}}));try{return this._events[t]=c(o,r),e.apply(this,arguments)}finally{i(this,"removeListener"),this._events[t]=o}}})),s(e,"__unwrap",(function(){i(e,"addListener"),i(e,"on"),i(e,"emit"),delete e[o],delete e.__wrapped})),s(e,"__wrapped",!0))}})),Yr=v(((e,t)=>{"use strict";var n=r(73837),i=r(39491),o=Qr(),s=r(50852),a="cls@contexts",c="error@context",u=process.env.DEBUG_CLS_HOOKED,l=-1;function d(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}function p(e){return process.namespaces[e]}function f(e){let t=p(e);i.ok(t,"can't delete nonexistent namespace! \""+e+'"'),i.ok(t.id,"don't assign to process.namespaces directly! "+n.inspect(t)),process.namespaces[e]=null}function h(...e){u&&process._rawDebug(`${n.format(...e)}`)}t.exports={getNamespace:p,createNamespace:function(e){i.ok(e,"namespace must be given a name."),u&&h(`NS-CREATING NAMESPACE (${e})`);let t=new d(e);return t.id=l,s.createHook({init(r,i,o,a){if(l=s.executionAsyncId(),t.active)t._contexts.set(r,t.active),u&&h(`${" ".repeat(t._indent<0?0:t._indent)}INIT [${i}] (${e}) asyncId:${r} currentUid:${l} triggerId:${o} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`);else if(0===l){let o=s.triggerAsyncId(),c=t._contexts.get(o);c?(t._contexts.set(r,c),u&&h(`${" ".repeat(t._indent<0?0:t._indent)}INIT USING CONTEXT FROM TRIGGERID [${i}] (${e}) asyncId:${r} currentUid:${l} triggerId:${o} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)):u&&h(`${" ".repeat(t._indent<0?0:t._indent)}INIT MISSING CONTEXT [${i}] (${e}) asyncId:${r} currentUid:${l} triggerId:${o} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}if(u&&"PROMISE"===i){h(n.inspect(a,{showHidden:!0}));let s=a.parentId;h(`${" ".repeat(t._indent<0?0:t._indent)}INIT RESOURCE-PROMISE [${i}] (${e}) parentId:${s} asyncId:${r} currentUid:${l} triggerId:${o} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}},before(r){let i;if(l=s.executionAsyncId(),i=t._contexts.get(r)||t._contexts.get(l),i){if(u){let o=s.triggerAsyncId();h(`${" ".repeat(t._indent<0?0:t._indent)}BEFORE (${e}) asyncId:${r} currentUid:${l} triggerId:${o} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${n.inspect(i)}`),t._indent+=2}t.enter(i)}else if(u){let i=s.triggerAsyncId();h(`${" ".repeat(t._indent<0?0:t._indent)}BEFORE MISSING CONTEXT (${e}) asyncId:${r} currentUid:${l} triggerId:${i} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${n.inspect(t._contexts,{showHidden:!0,depth:2,colors:!0})}`),t._indent+=2}},after(r){let i;if(l=s.executionAsyncId(),i=t._contexts.get(r)||t._contexts.get(l),i){if(u){let o=s.triggerAsyncId();t._indent-=2,h(`${" ".repeat(t._indent<0?0:t._indent)}AFTER (${e}) asyncId:${r} currentUid:${l} triggerId:${o} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${n.inspect(i)}`)}t.exit(i)}else if(u){let o=s.triggerAsyncId();t._indent-=2,h(`${" ".repeat(t._indent<0?0:t._indent)}AFTER MISSING CONTEXT (${e}) asyncId:${r} currentUid:${l} triggerId:${o} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${n.inspect(i)}`)}},destroy(r){if(l=s.executionAsyncId(),u){let i=s.triggerAsyncId();h(`${" ".repeat(t._indent<0?0:t._indent)}DESTROY (${e}) currentUid:${l} asyncId:${r} triggerId:${i} active:${n.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${n.inspect(t._contexts.get(l))}`)}t._contexts.delete(r)}}).enable(),process.namespaces[e]=t,t},destroyNamespace:f,reset:function(){process.namespaces&&Object.keys(process.namespaces).forEach((function(e){f(e)})),process.namespaces=Object.create(null)},ERROR_SYMBOL:c},d.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[e]=t,u&&h(" ".repeat(this._indent<0?0:this._indent)+"CONTEXT-SET KEY:"+e+"="+t+" in ns:"+this.name+" currentUid:"+l+" active:"+n.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),t},d.prototype.get=function(e){if(this.active){if(u){let t=s.executionAsyncId(),r=s.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);h(i+"CONTEXT-GETTING KEY:"+e+"="+this.active[e]+" ("+this.name+") currentUid:"+l+" active:"+n.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),h(`${i}CONTEXT-GETTING KEY: (${this.name}) ${e}=${this.active[e]} currentUid:${l} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length} active:${n.inspect(this.active)}`)}return this.active[e]}if(u){let t=s.currentId(),r=s.triggerAsyncId();h(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${e}=undefined currentUid:${l} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length}`)}},d.prototype.createContext=function(){let e=Object.create(this.active?this.active:Object.prototype);if(e._ns_name=this.name,e.id=l,u){let t=s.executionAsyncId(),r=s.triggerAsyncId();h(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-CREATED Context: (${this.name}) currentUid:${l} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length} context:${n.inspect(e,{showHidden:!0,depth:2,colors:!0})}`)}return e},d.prototype.run=function(e){let t=this.createContext();this.enter(t);try{if(u){let e=s.triggerAsyncId(),r=s.executionAsyncId();h(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${l} triggerId:${e} asyncHooksCurrentId:${r} len:${this._set.length} context:${n.inspect(t)}`)}return e(t),t}catch(e){throw e&&(e[c]=t),e}finally{if(u){let e=s.triggerAsyncId(),r=s.executionAsyncId();h(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-RUN END: (${this.name}) currentUid:${l} triggerId:${e} asyncHooksCurrentId:${r} len:${this._set.length} ${n.inspect(t)}`)}this.exit(t)}},d.prototype.runAndReturn=function(e){let t;return this.run((function(r){t=e(r)})),t},d.prototype.runPromise=function(e){let t=this.createContext();this.enter(t);let r=e(t);if(!r||!r.then||!r.catch)throw new Error("fn must return a promise.");return u&&h("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+l+" len:"+this._set.length+" "+n.inspect(t)),r.then((e=>(u&&h("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+l+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e))).catch((e=>{throw e[c]=t,u&&h("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+l+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e}))},d.prototype.bind=function(e,t){t||(t=this.active?this.active:this.createContext());let r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(e){throw e&&(e[c]=t),e}finally{r.exit(t)}}},d.prototype.enter=function(e){if(i.ok(e,"context must be provided for entering"),u){let t=s.executionAsyncId(),r=s.triggerAsyncId();h(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-ENTER: (${this.name}) currentUid:${l} triggerId:${r} asyncHooksCurrentId:${t} len:${this._set.length} ${n.inspect(e)}`)}this._set.push(this.active),this.active=e},d.prototype.exit=function(e){if(i.ok(e,"context must be provided for exiting"),u){let t=s.executionAsyncId(),r=s.triggerAsyncId();h(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-EXIT: (${this.name}) currentUid:${l} triggerId:${r} asyncHooksCurrentId:${t} len:${this._set.length} ${n.inspect(e)}`)}if(this.active===e)return i.ok(this._set.length,"can't remove top context"),void(this.active=this._set.pop());let t=this._set.lastIndexOf(e);t<0?(u&&h("??ERROR?? context exiting but not entered - ignoring: "+n.inspect(e)),i.ok(t>=0,"context not currently entered; can't exit. \n"+n.inspect(this)+"\n"+n.inspect(e))):(i.ok(t,"can't remove top context"),this._set.splice(t,1))},d.prototype.bindEmitter=function(e){i.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let t=this,r="context@"+this.name;o(e,(function(e){!e||(e[a]||(e[a]=Object.create(null)),e[a][r]={namespace:t,context:t.active})}),(function(e){if(!e||!e[a])return e;let t=e,r=e[a];return Object.keys(r).forEach((function(e){let n=r[e];t=n.namespace.bind(t,n.context)})),t}))},d.prototype.fromException=function(e){return e[c]},process.namespaces={}})),Zr=v(((e,t)=>{"use strict";function r(){}t.exports=function(){let e=this._hooks,t=this._state,n=process.nextTick;process.nextTick=function(){if(!t.enabled)return n.apply(process,arguments);let i=new Array(arguments.length);for(let e=0;e<arguments.length;e++)i[e]=arguments[e];let o=i[0];if("function"!=typeof o)throw new TypeError("callback is not a function");let s=new r,a=--t.counter;return e.init.call(s,a,0,null,null),i[0]=function(){e.pre.call(s,a);let t=!0;try{o.apply(this,arguments),t=!1}finally{t&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",(function(){e.post.call(s,a,!0),e.destroy.call(null,a)}))}e.post.call(s,a,!1),e.destroy.call(null,a)},n.apply(process,i)}}})),en=v(((e,t)=>{"use strict";function r(){}t.exports=function(){let e=this._hooks,t=this._state,n=global.Promise,i=n.prototype.then;function o(t,r,n,i){return"function"!=typeof t?i?function(t){return function(r){return e.destroy.call(null,t),r}}(n):function(t){return function(r){throw e.destroy.call(null,t),r}}(n):function(){e.pre.call(r,n);try{return t.apply(this,arguments)}finally{e.post.call(r,n,!1),e.destroy.call(null,n)}}}n.prototype.then=function(n,s){if(!t.enabled)return i.call(this,n,s);let a=new r,c=--t.counter;return e.init.call(a,c,0,null,null),i.call(this,o(n,a,c,!0),o(s,a,c,!1))}}})),tn=v(((e,t)=>{"use strict";var n=r(39512);function i(){}function o(){}function s(){}var a=new Map,c=new Map,u=new Map,l=null,d=!1;function p(e,t,r,i,o,s,a){let c=n[r],u=n[i];n[r]=function(){if(!t.enabled)return c.apply(n,arguments);let r=new Array(arguments.length);for(let e=0;e<arguments.length;e++)r[e]=arguments[e];let i=r[0];if("function"!=typeof i)throw new TypeError('"callback" argument must be a function');let u,p=new o,f=--t.counter;return e.init.call(p,f,0,null,null),r[0]=function(){l=u,e.pre.call(p,f);let t=!0;try{i.apply(this,arguments),t=!1}finally{t&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",(function(){e.post.call(p,f,!0),s.delete(u),e.destroy.call(null,f)}))}e.post.call(p,f,!1),l=null,(a||d)&&(d=!1,s.delete(u),e.destroy.call(null,f))},u=c.apply(n,r),s.set(u,f),u},n[i]=function(t){if(l===t&&null!==t)d=!0;else if(s.has(t)){let r=s.get(t);s.delete(t),e.destroy.call(null,r)}u.apply(n,arguments)}}t.exports=function(){p(this._hooks,this._state,"setTimeout","clearTimeout",i,a,!0),p(this._hooks,this._state,"setInterval","clearInterval",o,c,!1),p(this._hooks,this._state,"setImmediate","clearImmediate",s,u,!0),global.setTimeout=n.setTimeout,global.setInterval=n.setInterval,global.setImmediate=n.setImmediate,global.clearTimeout=n.clearTimeout,global.clearInterval=n.clearInterval,global.clearImmediate=n.clearImmediate}})),rn=v(((e,t)=>{t.exports={name:"async-hook-jl",description:"Inspect the life of handle objects in node",version:"1.7.6",author:"Andreas Madsen <amwebdk@gmail.com>",main:"./index.js",scripts:{test:"node ./test/runner.js && eslint ."},repository:{type:"git",url:"git://github.com/jeff-lewis/async-hook-jl.git"},keywords:["async","async hooks","inspect","async wrap"],license:"MIT",dependencies:{"stack-chain":"^1.3.7"},devDependencies:{async:"1.5.x","cli-color":"1.1.x",eslint:"^3.4.0",endpoint:"0.4.x"},engines:{node:"^4.7 || >=6.9 || >=7.3"}}})),nn=v(((e,t)=>{"use strict";var r=process.binding("async_wrap"),n=r.Providers.TIMERWRAP,i={nextTick:Zr(),promise:en(),timers:tn()},o=new Set;function s(){this.enabled=!1,this.counter=0}function a(){let e=this.initFns=[],t=this.preFns=[],r=this.postFns=[],i=this.destroyFns=[];this.init=function(t,r,i,s){if(r!==n)for(let n of e)n(t,this,r,i,s);else o.add(t)},this.pre=function(e){if(!o.has(e))for(let r of t)r(e,this)},this.post=function(e,t){if(!o.has(e))for(let n of r)n(e,this,t)},this.destroy=function(e){if(o.has(e))o.delete(e);else for(let t of i)t(e)}}function c(e,t){let r=e.indexOf(t);-1!==r&&e.splice(r,1)}function u(){this._state=new s,this._hooks=new a,this.version=rn().version,this.providers=r.Providers;for(let e of Object.keys(i))i[e].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),r.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}a.prototype.add=function(e){e.init&&this.initFns.push(e.init),e.pre&&this.preFns.push(e.pre),e.post&&this.postFns.push(e.post),e.destroy&&this.destroyFns.push(e.destroy)},a.prototype.remove=function(e){e.init&&c(this.initFns,e.init),e.pre&&c(this.preFns,e.pre),e.post&&c(this.postFns,e.post),e.destroy&&c(this.destroyFns,e.destroy)},t.exports=u,u.prototype.addHooks=function(e){this._hooks.add(e)},u.prototype.removeHooks=function(e){this._hooks.remove(e)},u.prototype.enable=function(){this._state.enabled=!0,r.enable()},u.prototype.disable=function(){this._state.enabled=!1,r.disable()}})),on=v(((e,t)=>{t.exports={name:"stack-chain",description:"API for combining call site modifiers",version:"1.3.7",author:"Andreas Madsen <amwebdk@gmail.com>",scripts:{test:"tap ./test/simple"},repository:{type:"git",url:"git://github.com/AndreasMadsen/stack-chain.git"},keywords:["stack","chain","trace","call site","concat","format"],devDependencies:{tap:"2.x.x","uglify-js":"2.5.x"},license:"MIT"}})),sn=v(((e,t)=>{t.exports=function(e,t){var r=[];r.push(function(e){try{return Error.prototype.toString.call(e)}catch(e){try{return"<error: "+e+">"}catch{return"<error>"}}}(e));for(var n=0;n<t.length;n++){var i,o=t[n];try{i=o.toString()}catch(e){try{i="<error: "+e+">"}catch{i="<error>"}}r.push("    at "+i)}return r.join("\n")}})),an=v(((e,t)=>{var r=sn();function n(){this.extend=new s,this.filter=new s,this.format=new a,this.version=on().version}var i=!1;n.prototype.callSite=function e(t){t||(t={}),i=!0;var r={};Error.captureStackTrace(r,e);var n=r.stack;return i=!1,n=n.slice(t.slice||0),t.extend&&(n=this.extend._modify(r,n)),t.filter&&(n=this.filter._modify(r,n)),n};var o=new n;function s(){this._modifiers=[]}function a(){this._formater=r,this._previous=void 0}s.prototype._modify=function(e,t){for(var r=0,n=this._modifiers.length;r<n;r++)t=this._modifiers[r](e,t);return t},s.prototype.attach=function(e){this._modifiers.push(e)},s.prototype.deattach=function(e){var t=this._modifiers.indexOf(e);return-1!==t&&(this._modifiers.splice(t,1),!0)},a.prototype.replace=function(e){e?this._formater=e:this.restore()},a.prototype.restore=function(){this._formater=r,this._previous=void 0},a.prototype._backup=function(){this._previous=this._formater},a.prototype._roolback=function(){this._previous===r?this.replace(void 0):this.replace(this._previous),this._previous=void 0},Error.prepareStackTrace&&o.format.replace(Error.prepareStackTrace);var c=!1;function u(e,t){if(i)return t;if(c)return r(e,t);var n=t.concat();n=o.extend._modify(e,n),n=(n=o.filter._modify(e,n)).slice(0,Error.stackTraceLimit),Object.isExtensible(e)&&void 0===Object.getOwnPropertyDescriptor(e,"callSite")&&(e.callSite={original:t,mutated:n}),c=!0;var s=o.format._formater(e,n);return c=!1,s}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return u},set:function(e){e===u?o.format._roolback():(o.format._backup(),o.format.replace(e))}}),Object.defineProperty(Error.prototype,"callSite",{get:function(){return this.stack,this.callSite},set:function(e){Object.defineProperty(this,"callSite",{value:e,writable:!0,configurable:!0})},configurable:!0}),t.exports=o})),cn=v(((e,t)=>{if(global._stackChain){if(global._stackChain.version!==on().version)throw new Error("Conflicting version of stack-chain found");t.exports=global._stackChain}else t.exports=global._stackChain=an()})),un=v(((e,t)=>{"use strict";var r=nn();if(global._asyncHook){if(global._asyncHook.version!==rn().version)throw new Error("Conflicting version of async-hook-jl found");t.exports=global._asyncHook}else cn().filter.attach((function(e,t){return t.filter((function(e){let t=e.getFileName();return!(t&&t.slice(0,__dirname.length)===__dirname)}))})),t.exports=global._asyncHook=new r})),ln=v(((e,t)=>{"use strict";var n=r(73837),i=r(39491),o=Qr(),s=un(),a="cls@contexts",c="error@context",u=[];for(let e in s.providers)u[s.providers[e]]=e;var l,d,p=process.env.DEBUG_CLS_HOOKED,f=-1;function h(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map}function g(e){return process.namespaces[e]}function m(e){let t=g(e);i.ok(t,"can't delete nonexistent namespace! \""+e+'"'),i.ok(t.id,"don't assign to process.namespaces directly! "+n.inspect(t)),process.namespaces[e]=null}function v(e){process.env.DEBUG&&process._rawDebug(e)}function y(e){return e?"function"==typeof e?e.name?e.name:(e.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1]:e.constructor&&e.constructor.name?e.constructor.name:void 0:e}if(t.exports={getNamespace:g,createNamespace:function(e){i.ok(e,"namespace must be given a name."),p&&v("CREATING NAMESPACE "+e);let t=new h(e);return t.id=f,s.addHooks({init(r,i,o,s,a){f=r,s?(t._contexts.set(r,t._contexts.get(s)),p&&v("PARENTID: "+e+" uid:"+r+" parent:"+s+" provider:"+o)):t._contexts.set(f,t.active),p&&v("INIT "+e+" uid:"+r+" parent:"+s+" provider:"+u[o]+" active:"+n.inspect(t.active,!0))},pre(r,i){f=r;let o=t._contexts.get(r);o?(p&&v(" PRE "+e+" uid:"+r+" handle:"+y(i)+" context:"+n.inspect(o)),t.enter(o)):p&&v(" PRE MISSING CONTEXT "+e+" uid:"+r+" handle:"+y(i))},post(r,i){f=r;let o=t._contexts.get(r);o?(p&&v(" POST "+e+" uid:"+r+" handle:"+y(i)+" context:"+n.inspect(o)),t.exit(o)):p&&v(" POST MISSING CONTEXT "+e+" uid:"+r+" handle:"+y(i))},destroy(r){f=r,p&&v("DESTROY "+e+" uid:"+r+" context:"+n.inspect(t._contexts.get(f))+" active:"+n.inspect(t.active,!0)),t._contexts.delete(r)}}),process.namespaces[e]=t,t},destroyNamespace:m,reset:function(){process.namespaces&&Object.keys(process.namespaces).forEach((function(e){m(e)})),process.namespaces=Object.create(null)},ERROR_SYMBOL:c},h.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return p&&v("    SETTING KEY:"+e+"="+t+" in ns:"+this.name+" uid:"+f+" active:"+n.inspect(this.active,!0)),this.active[e]=t,t},h.prototype.get=function(e){if(this.active)return p&&v("    GETTING KEY:"+e+"="+this.active[e]+" "+this.name+" uid:"+f+" active:"+n.inspect(this.active,!0)),this.active[e];p&&v("    GETTING KEY:"+e+"=undefined "+this.name+" uid:"+f+" active:"+n.inspect(this.active,!0))},h.prototype.createContext=function(){p&&v("   CREATING Context: "+this.name+" uid:"+f+" len:"+this._set.length+"  active:"+n.inspect(this.active,!0,2,!0));let e=Object.create(this.active?this.active:Object.prototype);return e._ns_name=this.name,e.id=f,p&&v("   CREATED Context: "+this.name+" uid:"+f+" len:"+this._set.length+"  context:"+n.inspect(e,!0,2,!0)),e},h.prototype.run=function(e){let t=this.createContext();this.enter(t);try{return p&&v(" BEFORE RUN: "+this.name+" uid:"+f+" len:"+this._set.length+" "+n.inspect(t)),e(t),t}catch(e){throw e&&(e[c]=t),e}finally{p&&v(" AFTER RUN: "+this.name+" uid:"+f+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t)}},h.prototype.runAndReturn=function(e){var t;return this.run((function(r){t=e(r)})),t},h.prototype.runPromise=function(e){let t=this.createContext();this.enter(t);let r=e(t);if(!r||!r.then||!r.catch)throw new Error("fn must return a promise.");return p&&v(" BEFORE runPromise: "+this.name+" uid:"+f+" len:"+this._set.length+" "+n.inspect(t)),r.then((e=>(p&&v(" AFTER runPromise: "+this.name+" uid:"+f+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e))).catch((e=>{throw e[c]=t,p&&v(" AFTER runPromise: "+this.name+" uid:"+f+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e}))},h.prototype.bind=function(e,t){t||(t=this.active?this.active:this.createContext());let r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(e){throw e&&(e[c]=t),e}finally{r.exit(t)}}},h.prototype.enter=function(e){i.ok(e,"context must be provided for entering"),p&&v("  ENTER "+this.name+" uid:"+f+" len:"+this._set.length+" context: "+n.inspect(e)),this._set.push(this.active),this.active=e},h.prototype.exit=function(e){if(i.ok(e,"context must be provided for exiting"),p&&v("  EXIT "+this.name+" uid:"+f+" len:"+this._set.length+" context: "+n.inspect(e)),this.active===e)return i.ok(this._set.length,"can't remove top context"),void(this.active=this._set.pop());let t=this._set.lastIndexOf(e);t<0?(p&&v("??ERROR?? context exiting but not entered - ignoring: "+n.inspect(e)),i.ok(t>=0,"context not currently entered; can't exit. \n"+n.inspect(this)+"\n"+n.inspect(e))):(i.ok(t,"can't remove top context"),this._set.splice(t,1))},h.prototype.bindEmitter=function(e){i.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let t=this,r="context@"+this.name;o(e,(function(e){!e||(e[a]||(e[a]=Object.create(null)),e[a][r]={namespace:t,context:t.active})}),(function(e){if(!e||!e[a])return e;let t=e,r=e[a];return Object.keys(r).forEach((function(e){let n=r[e];t=n.namespace.bind(t,n.context)})),t}))},h.prototype.fromException=function(e){return e[c]},process.namespaces={},s._state&&!s._state.enabled&&s.enable(),p)for(d in(l=cn()).filter._modifiers)l.filter.deattach(d)})),dn=v(((e,t)=>{"use strict";var r=Xr();process&&r.gte(process.versions.node,"8.0.0")?t.exports=Yr():t.exports=ln()})),pn=v(((e,t)=>{var r;e=t.exports=G,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},e.SEMVER_SPEC_VERSION="2.0.0";var n=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,o=e.re=[],s=e.src=[],a=0,c=a++;s[c]="0|[1-9]\\d*";var u=a++;s[u]="[0-9]+";var l=a++;s[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var d=a++;s[d]="("+s[c]+")\\.("+s[c]+")\\.("+s[c]+")";var p=a++;s[p]="("+s[u]+")\\.("+s[u]+")\\.("+s[u]+")";var f=a++;s[f]="(?:"+s[c]+"|"+s[l]+")";var h=a++;s[h]="(?:"+s[u]+"|"+s[l]+")";var g=a++;s[g]="(?:-("+s[f]+"(?:\\."+s[f]+")*))";var m=a++;s[m]="(?:-?("+s[h]+"(?:\\."+s[h]+")*))";var v=a++;s[v]="[0-9A-Za-z-]+";var y=a++;s[y]="(?:\\+("+s[v]+"(?:\\."+s[v]+")*))";var _=a++,S="v?"+s[d]+s[g]+"?"+s[y]+"?";s[_]="^"+S+"$";var w="[v=\\s]*"+s[p]+s[m]+"?"+s[y]+"?",b=a++;s[b]="^"+w+"$";var E=a++;s[E]="((?:<|>)?=?)";var P=a++;s[P]=s[u]+"|x|X|\\*";var T=a++;s[T]=s[c]+"|x|X|\\*";var C=a++;s[C]="[v=\\s]*("+s[T]+")(?:\\.("+s[T]+")(?:\\.("+s[T]+")(?:"+s[g]+")?"+s[y]+"?)?)?";var I=a++;s[I]="[v=\\s]*("+s[P]+")(?:\\.("+s[P]+")(?:\\.("+s[P]+")(?:"+s[m]+")?"+s[y]+"?)?)?";var O=a++;s[O]="^"+s[E]+"\\s*"+s[C]+"$";var x=a++;s[x]="^"+s[E]+"\\s*"+s[I]+"$";var N=a++;s[N]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var k=a++;s[k]="(?:~>?)";var R=a++;s[R]="(\\s*)"+s[k]+"\\s+",o[R]=new RegExp(s[R],"g");var A=a++;s[A]="^"+s[k]+s[C]+"$";var D=a++;s[D]="^"+s[k]+s[I]+"$";var j=a++;s[j]="(?:\\^)";var M=a++;s[M]="(\\s*)"+s[j]+"\\s+",o[M]=new RegExp(s[M],"g");var L=a++;s[L]="^"+s[j]+s[C]+"$";var F=a++;s[F]="^"+s[j]+s[I]+"$";var U=a++;s[U]="^"+s[E]+"\\s*("+w+")$|^$";var B=a++;s[B]="^"+s[E]+"\\s*("+S+")$|^$";var V=a++;s[V]="(\\s*)"+s[E]+"\\s*("+w+"|"+s[C]+")",o[V]=new RegExp(s[V],"g");var $=a++;s[$]="^\\s*("+s[C]+")\\s+-\\s+("+s[C]+")\\s*$";var q=a++;s[q]="^\\s*("+s[I]+")\\s+-\\s+("+s[I]+")\\s*$";var H,W=a++;for(s[W]="(<|>)?=?\\s*\\*",H=0;H<35;H++)r(H,s[H]),o[H]||(o[H]=new RegExp(s[H]));function z(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof G)return e;if("string"!=typeof e||e.length>n)return null;if(!(t.loose?o[b]:o[_]).test(e))return null;try{return new G(e,t)}catch{return null}}function G(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof G){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof G))return new G(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var s=e.trim().match(t.loose?o[b]:o[_]);if(!s)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}e.parse=z,e.valid=function(e,t){var r=z(e,t);return r?r.version:null},e.clean=function(e,t){var r=z(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},e.SemVer=G,G.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},G.prototype.toString=function(){return this.version},G.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof G||(e=new G(e,this.options)),this.compareMain(e)||this.comparePre(e)},G.prototype.compareMain=function(e){return e instanceof G||(e=new G(e,this.options)),X(this.major,e.major)||X(this.minor,e.minor)||X(this.patch,e.patch)},G.prototype.comparePre=function(e){if(e instanceof G||(e=new G(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return X(n,i)}while(++t)},G.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},e.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new G(e,r).inc(t,n).version}catch{return null}},e.diff=function(e,t){if(Z(e,t))return null;var r=z(e),n=z(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var s in r)if(("major"===s||"minor"===s||"patch"===s)&&r[s]!==n[s])return i+s;return o},e.compareIdentifiers=X;var K=/^[0-9]+$/;function X(e,t){var r=K.test(e),n=K.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function J(e,t,r){return new G(e,r).compare(new G(t,r))}function Q(e,t,r){return J(e,t,r)>0}function Y(e,t,r){return J(e,t,r)<0}function Z(e,t,r){return 0===J(e,t,r)}function ee(e,t,r){return 0!==J(e,t,r)}function te(e,t,r){return J(e,t,r)>=0}function re(e,t,r){return J(e,t,r)<=0}function ne(e,t,r,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return Z(e,r,n);case"!=":return ee(e,r,n);case">":return Q(e,r,n);case">=":return te(e,r,n);case"<":return Y(e,r,n);case"<=":return re(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}function ie(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof ie){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ie))return new ie(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===oe?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}e.rcompareIdentifiers=function(e,t){return X(t,e)},e.major=function(e,t){return new G(e,t).major},e.minor=function(e,t){return new G(e,t).minor},e.patch=function(e,t){return new G(e,t).patch},e.compare=J,e.compareLoose=function(e,t){return J(e,t,!0)},e.rcompare=function(e,t,r){return J(t,e,r)},e.sort=function(t,r){return t.sort((function(t,n){return e.compare(t,n,r)}))},e.rsort=function(t,r){return t.sort((function(t,n){return e.rcompare(t,n,r)}))},e.gt=Q,e.lt=Y,e.eq=Z,e.neq=ee,e.gte=te,e.lte=re,e.cmp=ne,e.Comparator=ie;var oe={};function se(e,t){if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),e instanceof se)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new se(e.raw,t);if(e instanceof ie)return new se(e.value,t);if(!(this instanceof se))return new se(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function ce(e,t,r,n,i,o,s,a,c,u,l,d,p){return((t=ae(r)?"":ae(n)?">="+r+".0.0":ae(i)?">="+r+"."+n+".0":">="+t)+" "+(a=ae(c)?"":ae(u)?"<"+(+c+1)+".0.0":ae(l)?"<"+c+"."+(+u+1)+".0":d?"<="+c+"."+u+"."+l+"-"+d:"<="+a)).trim()}function ue(e,t,n){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(i=0;i<e.length;i++)if(r(e[i].semver),e[i].semver!==oe&&e[i].semver.prerelease.length>0){var o=e[i].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}function le(e,t,r){try{t=new se(t,r)}catch{return!1}return t.test(e)}function de(e,t,r,n){var i,o,s,a,c;switch(e=new G(e,n),t=new se(t,n),r){case">":i=Q,o=re,s=Y,a=">",c=">=";break;case"<":i=Y,o=te,s=Q,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(le(e,t,n))return!1;for(var u=0;u<t.set.length;++u){var l=t.set[u],d=null,p=null;if(l.forEach((function(e){e.semver===oe&&(e=new ie(">=0.0.0")),d=d||e,p=p||e,i(e.semver,d.semver,n)?d=e:s(e.semver,p.semver,n)&&(p=e)})),d.operator===a||d.operator===c||(!p.operator||p.operator===a)&&o(e,p.semver))return!1;if(p.operator===c&&s(e,p.semver))return!1}return!0}ie.prototype.parse=function(e){var t=this.options.loose?o[U]:o[B],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new G(r[2],this.options.loose):this.semver=oe},ie.prototype.toString=function(){return this.value},ie.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===oe||("string"==typeof e&&(e=new G(e,this.options)),ne(e,this.operator,this.semver,this.options))},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Comparator is required");var r;if((!t||"object"!=typeof t)&&(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new se(e.value,t),le(this.value,r,t);if(""===e.operator)return r=new se(this.value,t),le(e.semver,r,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=ne(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=ne(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||i||o&&s||a||c},e.Range=se,se.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},se.prototype.toString=function(){return this.range},se.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?o[q]:o[$];e=e.replace(n,ce),r("hyphen replace",e),e=e.replace(o[V],"$1$2$3"),r("comparator trim",e,o[V]),e=(e=(e=e.replace(o[R],"$1~")).replace(o[M],"$1^")).split(/\s+/).join(" ");var i=t?o[U]:o[B],s=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?o[F]:o[L];return e.replace(n,(function(t,n,i,o,s){var a;return r("caret",e,t,n,i,o,s),ae(n)?a="":ae(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(o)?a="0"===n?">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":">="+n+"."+i+".0 <"+(+n+1)+".0.0":s?(r("replaceCaret pr",s),a="0"===n?"0"===i?">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+"-"+s+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===i?">="+n+"."+i+"."+o+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+" <"+(+n+1)+".0.0"),r("caret return",a),a}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?o[D]:o[A];return e.replace(n,(function(t,n,i,o,s){var a;return r("tilde",e,t,n,i,o,s),ae(n)?a="":ae(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(o)?a=">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":s?(r("replaceTilde pr",s),a=">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+(+i+1)+".0"):a=">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0",r("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?o[x]:o[O];return e.replace(n,(function(t,n,i,o,s,a){r("xRange",e,t,n,i,o,s,a);var c=ae(i),u=c||ae(o),l=u||ae(s);return"="===n&&l&&(n=""),c?t=">"===n||"<"===n?"<0.0.0":"*":n&&l?(u&&(o=0),s=0,">"===n?(n=">=",u?(i=+i+1,o=0,s=0):(o=+o+1,s=0)):"<="===n&&(n="<",u?i=+i+1:o=+o+1),t=n+i+"."+o+"."+s):u?t=">="+i+".0.0 <"+(+i+1)+".0.0":l&&(t=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0"),r("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(o[W],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(s=s.filter((function(e){return!!e.match(i)}))),s.map((function(e){return new ie(e,this.options)}),this)},se.prototype.intersects=function(e,t){if(!(e instanceof se))throw new TypeError("a Range is required");return this.set.some((function(r){return r.every((function(r){return e.set.some((function(e){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},e.toComparators=function(e,t){return new se(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},se.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new G(e,this.options));for(var t=0;t<this.set.length;t++)if(ue(this.set[t],e,this.options))return!0;return!1},e.satisfies=le,e.maxSatisfying=function(e,t,r){var n=null,i=null;try{var o=new se(t,r)}catch{return null}return e.forEach((function(e){o.test(e)&&(!n||-1===i.compare(e))&&(i=new G(n=e,r))})),n},e.minSatisfying=function(e,t,r){var n=null,i=null;try{var o=new se(t,r)}catch{return null}return e.forEach((function(e){o.test(e)&&(!n||1===i.compare(e))&&(i=new G(n=e,r))})),n},e.minVersion=function(e,t){e=new se(e,t);var r=new G("0.0.0");if(e.test(r)||(r=new G("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n)e.set[n].forEach((function(e){var t=new G(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":(!r||Q(r,t))&&(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}));return r&&e.test(r)?r:null},e.validRange=function(e,t){try{return new se(e,t).range||"*"}catch{return null}},e.ltr=function(e,t,r){return de(e,t,"<",r)},e.gtr=function(e,t,r){return de(e,t,">",r)},e.outside=de,e.prerelease=function(e,t){var r=z(e,t);return r&&r.prerelease.length?r.prerelease:null},e.intersects=function(e,t,r){return e=new se(e,r),t=new se(t,r),e.intersects(t)},e.coerce=function(e){if(e instanceof G)return e;if("string"!=typeof e)return null;var t=e.match(o[N]);return null==t?null:z(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}})),fn=v(((e,t)=>{var r,n,i,o,s,a=Jr().wrap,c=1,u=2,l=4,d=8,p=[],f=0,h=!1,g=[];function m(e,t){var r=e.length,n=t.length,i=[];if(0===r&&0===n)return i;for(var o=0;o<r;o++)i[o]=e[o];if(0===n)return i;for(var s=0;s<n;s++){var a=!0;for(o=0;o<r;o++)if(e[o].uid===t[s].uid){a=!1;break}a&&i.push(t[s])}return i}function v(e,t){"function"==typeof e.create&&(this.create=e.create,this.flags|=c),"function"==typeof e.before&&(this.before=e.before,this.flags|=u),"function"==typeof e.after&&(this.after=e.after,this.flags|=l),"function"==typeof e.error&&(this.error=e.error,this.flags|=d),this.uid=++f,this.data=void 0===t?null:t}function y(e,t){if("object"!=typeof e||!e)throw new TypeError("callbacks argument must be an object");return e instanceof v?e:new v(e,t)}process._fatalException?(i=!1,r=function(e){var t=p.length;if(i||0===t)return!1;var r=!1;i=!0;for(var n=0;n<t;++n){var s=p[n];if(0!=(s.flags&d)){var a=o&&o[s.uid];r=s.error(a,e)||r}}return i=!1,g.length>0&&(p=g.pop()),o=void 0,r&&!h},n=function(e,t,r){var n=[];h=!0;for(var i=0;i<r;++i){var s=t[i];if(n[s.uid]=s.data,0!=(s.flags&c)){var a=s.create(s.data);void 0!==a&&(n[s.uid]=a)}}return h=!1,function(){o=n,g.push(p),p=m(t,p),h=!0;for(var i=0;i<r;++i)(t[i].flags&u)>0&&t[i].before(this,n[t[i].uid]);h=!1;var s=e.apply(this,arguments);for(h=!0,i=0;i<r;++i)(t[i].flags&l)>0&&t[i].after(this,n[t[i].uid]);return h=!1,p=g.pop(),o=void 0,s}},a(process,"_fatalException",(function(e){return function(t){return r(t)||e(t)}}))):(s=!1,r=function(e){if(s)throw e;for(var t=!1,r=p.length,n=0;n<r;++n){var i=p[n];0!=(i.flags&d)&&(t=i.error(null,e)||t)}if(!t&&h)throw e},n=function(e,t,n){var i=[];h=!0;for(var o=0;o<n;++o){var a=t[o];if(i[a.uid]=a.data,0!=(a.flags&c)){var f=a.create(a.data);void 0!==f&&(i[a.uid]=f)}}return h=!1,function(){var o,a=!1,c=!1;g.push(p),p=m(t,p),h=!0;for(var f=0;f<n;++f)(t[f].flags&u)>0&&t[f].before(this,i[t[f].uid]);h=!1;try{o=e.apply(this,arguments)}catch(e){for(a=!0,f=0;f<n;++f)if(0!=(p[f].flags&d))try{c=p[f].error(i[t[f].uid],e)||c}catch(e){throw s=!0,e}if(!c)throw process.removeListener("uncaughtException",r),process._originalNextTick((function(){process.addListener("uncaughtException",r)})),e}finally{if(!a||c){for(h=!0,f=0;f<n;++f)(t[f].flags&l)>0&&t[f].after(this,i[t[f].uid]);h=!1}p=g.pop()}return o}},process.addListener("uncaughtException",r)),v.prototype.create=void 0,v.prototype.before=void 0,v.prototype.after=void 0,v.prototype.error=void 0,v.prototype.data=void 0,v.prototype.uid=0,v.prototype.flags=0,process.createAsyncListener=y,process.addAsyncListener=function(e,t){var r;r=e instanceof v?e:y(e,t);for(var n=!1,i=0;i<p.length;i++)if(r===p[i]){n=!0;break}return n||p.push(r),r},process.removeAsyncListener=function(e){for(var t=0;t<p.length;t++)if(e===p[t]){p.splice(t,1);break}},t.exports=function(e){var t=p.length;if(0===t)return e;for(var r=p.slice(),i=0;i<t;++i)if(r[i].flags>0)return n(e,r,t);return function(e,t,r){h=!0;for(var n=0;n<r;++n){var i=t[n];i.create&&i.create(i.data)}return h=!1,function(){g.push(p),p=m(t,p);var r=e.apply(this,arguments);return p=g.pop(),r}}(e,r,t)}})),hn=v(((e,t)=>{"use strict";t.exports=(e,t)=>class extends e{constructor(e){var r,n;super((function(e,o){r=this,n=[function(r){return t(i,!1),e(r)},function(e){return t(i,!1),o(e)}]}));var i=this;try{e.apply(r,n)}catch(e){n[1](e)}return i}}})),gn=v((()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var e=Jr(),t=pn(),n=e.wrap,i=e.massWrap,o=fn(),s=r(73837),a=t.gte(process.version,"6.0.0"),c=t.gte(process.version,"7.0.0"),u=t.gte(process.version,"8.0.0"),l=t.gte(process.version,"11.0.0"),d=r(41808);function p(e){return function(){this.on("connection",(function(e){e._handle&&(e._handle.onread=o(e._handle.onread))}));try{return e.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=o(this._handle.onconnection))}}}function f(e){if(e&&e._handle){var t=e._handle;t._originalOnread||(t._originalOnread=t.onread),t.onread=o(t._originalOnread)}}c&&!d._normalizeArgs?d._normalizeArgs=function(e){if(0===e.length)return[{},null];var t=e[0],r={};"object"==typeof t&&null!==t?r=t:function(e){return"string"==typeof e&&!1===function(e){return(e=Number(e))>=0&&e}(e)}(t)?r.path=t:(r.port=t,e.length>1&&"string"==typeof e[1]&&(r.host=e[1]));var n=e[e.length-1];return"function"!=typeof n?[r,null]:[r,n]}:!c&&!d._normalizeConnectArgs&&(d._normalizeConnectArgs=function(e){var t,r={};"object"==typeof e[0]&&null!==e[0]?r=e[0]:"string"==typeof e[0]&&!1===(t=e[0],(t=Number(t))>=0&&t)?r.path=e[0]:(r.port=e[0],"string"==typeof e[1]&&(r.host=e[1]));var n=e[e.length-1];return"function"==typeof n?[r,n]:[r]}),"_setUpListenHandle"in d.Server.prototype?n(d.Server.prototype,"_setUpListenHandle",p):n(d.Server.prototype,"_listen2",p),n(d.Socket.prototype,"connect",(function(e){return function(){var t;(t=u&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?arguments[0]:c?d._normalizeArgs(arguments):d._normalizeConnectArgs(arguments))[1]&&(t[1]=o(t[1]));var r=e.apply(this,t);return f(this),r}}));var h=r(13685);n(h.Agent.prototype,"addRequest",(function(e){return function(t){var r=t.onSocket;return t.onSocket=o((function(e){return f(e),r.apply(this,arguments)})),e.apply(this,arguments)}}));var g=r(32081);function m(e){Array.isArray(e.stdio)&&e.stdio.forEach((function(e){e&&e._handle&&(e._handle.onread=o(e._handle.onread),n(e._handle,"close",N))})),e._handle&&(e._handle.onexit=o(e._handle.onexit))}g.ChildProcess?n(g.ChildProcess.prototype,"spawn",(function(e){return function(){var t=e.apply(this,arguments);return m(this),t}})):i(g,["execFile","fork","spawn"],(function(e){return function(){var t=e.apply(this,arguments);return m(t),t}})),process._fatalException||(process._originalNextTick=process.nextTick);var v=[];process._nextDomainTick&&v.push("_nextDomainTick"),process._tickDomainCallback&&v.push("_tickDomainCallback"),i(process,v,x),n(process,"nextTick",N);var y=["setTimeout","setInterval"];global.setImmediate&&y.push("setImmediate");var _=r(39512),S=global.setTimeout===_.setTimeout;i(_,y,N),S&&i(global,y,N);var w=r(9523);i(w,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],x),w.resolveNaptr&&n(w,"resolveNaptr",x);var b,E,P,T=r(57147);i(T,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],x),T.lchown&&n(T,"lchown",x),T.lchmod&&n(T,"lchmod",x),T.ftruncate&&n(T,"ftruncate",x);try{b=r(59796)}catch{}b&&b.Deflate&&b.Deflate.prototype&&((E=Object.getPrototypeOf(b.Deflate.prototype))._transform?n(E,"_transform",x):E.write&&E.flush&&E.end&&i(E,["write","flush","end"],x));try{P=r(6113)}catch{}P&&(C=["pbkdf2","randomBytes"],l||C.push("pseudoRandomBytes"),i(P,C,x));var C,I,O=!!global.Promise&&"function Promise() { [native code] }"===Promise.toString()&&"function toString() { [native code] }"===Promise.toString.toString();function x(e){var t=function(){var t,r=arguments.length-1;if("function"==typeof arguments[r]){t=Array(arguments.length);for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n];t[r]=o(arguments[r])}return e.apply(this,t||arguments)};switch(e.length){case 1:return function(r){return 1!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=o(r)),e.call(this,r))};case 2:return function(r,n){return 2!==arguments.length?t.apply(this,arguments):("function"==typeof n&&(n=o(n)),e.call(this,r,n))};case 3:return function(r,n,i){return 3!==arguments.length?t.apply(this,arguments):("function"==typeof i&&(i=o(i)),e.call(this,r,n,i))};case 4:return function(r,n,i,s){return 4!==arguments.length?t.apply(this,arguments):("function"==typeof s&&(s=o(s)),e.call(this,r,n,i,s))};case 5:return function(r,n,i,s,a){return 5!==arguments.length?t.apply(this,arguments):("function"==typeof a&&(a=o(a)),e.call(this,r,n,i,s,a))};case 6:return function(r,n,i,s,a,c){return 6!==arguments.length?t.apply(this,arguments):("function"==typeof c&&(c=o(c)),e.call(this,r,n,i,s,a,c))};default:return t}}function N(e){var t=function(){var t;if("function"==typeof arguments[0]){(t=Array(arguments.length))[0]=o(arguments[0]);for(var r=1;r<arguments.length;r++)t[r]=arguments[r]}return e.apply(this,t||arguments)};switch(e.length){case 1:return function(r){return 1!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=o(r)),e.call(this,r))};case 2:return function(r,n){return 2!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=o(r)),e.call(this,r,n))};case 3:return function(r,n,i){return 3!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=o(r)),e.call(this,r,n,i))};case 4:return function(r,n,i,s){return 4!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=o(r)),e.call(this,r,n,i,s))};case 5:return function(r,n,i,s,a){return 5!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=o(r)),e.call(this,r,n,i,s,a))};case 6:return function(r,n,i,s,a,c){return 6!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=o(r)),e.call(this,r,n,i,s,a,c))};default:return t}}O&&(I=process.addAsyncListener({create:function(){O=!1}}),global.Promise.resolve(!0).then((function(){O=!1})),process.removeAsyncListener(I)),O&&function(){var e=global.Promise;function t(n){if(!(this instanceof t))return e(n);if("function"!=typeof n)return new e(n);var i,o,s=new e((function(e,t){i=this,o=[function(t){return r(s,!1),e(t)},function(e){return r(s,!1),t(e)}]}));s.__proto__=t.prototype;try{n.apply(i,o)}catch(e){o[1](e)}return s}function r(e,t){(!e.__asl_wrapper||t)&&(e.__asl_wrapper=o(i))}function i(t,n,o,s){var a;try{return{returnVal:a=n.call(t,o),error:!1}}catch(e){return{errorVal:e,error:!0}}finally{a instanceof e?s.__asl_wrapper=function(){return(a.__asl_wrapper||i).apply(this,arguments)}:r(s,!0)}}function c(e){return function(){var t=this,r=e.apply(t,Array.prototype.map.call(arguments,(function(e){return"function"!=typeof e?e:o((function(n){var o=(t.__asl_wrapper||i)(this,e,n,r);if(o.error)throw o.errorVal;return o.returnVal}))})));return r.__asl_wrapper=function(e,n,o,s){return t.__asl_wrapper?(t.__asl_wrapper(e,(function(){}),null,r),r.__asl_wrapper(e,n,o,s)):i(e,n,o,s)},r}}s.inherits(t,e),n(e.prototype,"then",c),e.prototype.chain&&n(e.prototype,"chain",c),a?global.Promise=hn()(e,r):(["all","race","reject","resolve","accept","defer"].forEach((function(r){"function"==typeof e[r]&&(t[r]=e[r])})),global.Promise=t)}()})),mn=v(((e,t)=>{"use strict";var n=r(39491),i=Qr(),o="cls@contexts",s="error@context";function a(e){this.name=e,this.active=null,this._set=[],this.id=null}function c(e){return process.namespaces[e]}function u(e){var t=c(e);n.ok(t,"can't delete nonexistent namespace!"),n.ok(t.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(t.id),process.namespaces[e]=null}function l(){process.namespaces&&Object.keys(process.namespaces).forEach((function(e){u(e)})),process.namespaces=Object.create(null)}process.addAsyncListener||gn(),a.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[e]=t,t},a.prototype.get=function(e){if(this.active)return this.active[e]},a.prototype.createContext=function(){return Object.create(this.active)},a.prototype.run=function(e){var t=this.createContext();this.enter(t);try{return e(t),t}catch(e){throw e&&(e[s]=t),e}finally{this.exit(t)}},a.prototype.runAndReturn=function(e){var t;return this.run((function(r){t=e(r)})),t},a.prototype.bind=function(e,t){t||(t=this.active?this.active:this.createContext());var r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(e){throw e&&(e[s]=t),e}finally{r.exit(t)}}},a.prototype.enter=function(e){n.ok(e,"context must be provided for entering"),this._set.push(this.active),this.active=e},a.prototype.exit=function(e){if(n.ok(e,"context must be provided for exiting"),this.active===e)return n.ok(this._set.length,"can't remove top context"),void(this.active=this._set.pop());var t=this._set.lastIndexOf(e);n.ok(t>=0,"context not currently entered; can't exit"),n.ok(t,"can't remove top context"),this._set.splice(t,1)},a.prototype.bindEmitter=function(e){n.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");var t=this,r="context@"+this.name;i(e,(function(e){!e||(e[o]||(e[o]=Object.create(null)),e[o][r]={namespace:t,context:t.active})}),(function(e){if(!e||!e[o])return e;var t=e,r=e[o];return Object.keys(r).forEach((function(e){var n=r[e];t=n.namespace.bind(t,n.context)})),t}))},a.prototype.fromException=function(e){return e[s]},process.namespaces||l(),t.exports={getNamespace:c,createNamespace:function(e){n.ok(e,"namespace must be given a name!");var t=new a(e);return t.id=process.addAsyncListener({create:function(){return t.active},before:function(e,r){r&&t.enter(r)},after:function(e,r){r&&t.exit(r)},error:function(e){e&&t.exit(e)}}),process.namespaces[e]=t,t},destroyNamespace:u,reset:l}})),vn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CorrelationContextManager=void 0;var t=S(),r=Qt(),n=tr(),i=rr(),o=Kr(),s=function(){function e(){}return e.getCurrentContext=function(){if(!e.enabled)return null;var t=e.session.get(e.CONTEXT_NAME);return void 0===t?null:t},e.generateContextObject=function(e,t,r,n,i,o){return t=t||e,this.enabled?{operation:{name:r,id:e,parentId:t,traceparent:i,tracestate:o},customProperties:new a(n)}:null},e.spanToContextObject=function(t,r,i){var o=new n;return o.traceId=t.traceId,o.spanId=t.spanId,o.traceFlag=n.formatOpenTelemetryTraceFlags(t.traceFlags)||n.DEFAULT_TRACE_FLAG,o.parentId=r,e.generateContextObject(o.traceId,o.parentId,i,null,o)},e.runWithContext=function(t,r){var n;return e.enabled?e.session.bind(r,((n={})[e.CONTEXT_NAME]=t,n))():r()},e.wrapEmitter=function(t){e.enabled&&e.session.bindEmitter(t)},e.wrapCallback=function(t,r){var n;return e.enabled?e.session.bind(t,r?((n={})[e.CONTEXT_NAME]=r,n):void 0):t},e.enable=function(t){if(!this.enabled){if(!this.isNodeVersionCompatible())return void(this.enabled=!1);e.hasEverEnabled||(this.forceClsHooked=t,this.hasEverEnabled=!0,typeof this.cls>"u"&&(!0===e.forceClsHooked||void 0===e.forceClsHooked&&e.shouldUseClsHooked()?this.cls=dn():this.cls=mn()),e.session=this.cls.createNamespace("AI-CLS-Session"),r.registerContextPreservation((function(t){return e.session.bind(t)}))),this.enabled=!0}},e.startOperation=function(r,s){var a=r&&r.traceContext||null,c=r&&r.traceId?r:null,u=r&&r.headers;if(c){var l=new n("00-"+c.traceId+"-"+c.spanId+"-01"),d=new i(c.traceState?c.traceState.serialize():null);return e.generateContextObject(c.traceId,"|"+c.traceId+"."+c.spanId+".","string"==typeof s?s:"",void 0,l,d)}if(a){l=new n(a.traceparent),d=new i(a.tracestate);var p="object"==typeof s?new o(s):null;return e.generateContextObject(l.traceId,l.parentId,"string"==typeof s?s:p.getOperationName({}),p&&p.getCorrelationContextHeader()||void 0,l,d)}return u?(l=new n(u.traceparent?u.traceparent.toString():null),d=new i(u.tracestate?u.tracestate.toString():null),p=new o(r),e.generateContextObject(l.traceId,l.parentId,p.getOperationName({}),p.getCorrelationContextHeader(),l,d)):(t.warn("startOperation was called with invalid arguments",arguments),null)},e.disable=function(){this.enabled=!1},e.reset=function(){e.hasEverEnabled&&(e.session=null,e.session=this.cls.createNamespace("AI-CLS-Session"))},e.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>3||parseInt(e[0])>2&&parseInt(e[1])>2},e.shouldUseClsHooked=function(){var e=process.versions.node.split(".");return parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=2},e.canUseClsHooked=function(){var e=process.versions.node.split("."),t=parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=0,r=parseInt(e[0])<8||parseInt(e[0])<=8&&parseInt(e[1])<2,n=parseInt(e[0])>4||parseInt(e[0])>=4&&parseInt(e[1])>=7;return!(t&&r)&&n},e.enabled=!1,e.hasEverEnabled=!1,e.forceClsHooked=void 0,e.CONTEXT_NAME="ApplicationInsights-Context",e}();e.CorrelationContextManager=s;var a=function(){function e(e){this.props=[],this.addHeaderData(e)}return e.prototype.addHeaderData=function(e){var t=e?e.split(", "):[];this.props=t.map((function(e){var t=e.split("=");return{key:t[0],value:t[1]}})).concat(this.props)},e.prototype.serializeToHeader=function(){return this.props.map((function(e){return e.key+"="+e.value})).join(", ")},e.prototype.getProperty=function(e){for(var t=0;t<this.props.length;++t){var r=this.props[t];if(r.key===e)return r.value}},e.prototype.setProperty=function(r,n){if(e.bannedCharacters.test(r)||e.bannedCharacters.test(n))t.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+r+" and value: "+n);else{for(var i=0;i<this.props.length;++i){var o=this.props[i];if(o.key===r)return void(o.value=n)}this.props.push({key:r,value:n})}},e.bannedCharacters=/[,=]/,e}()})),yn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.enable=void 0;var t=zr(),r=T(),n=[],i=function(e){var r=e.data.message;n.forEach((function(n){r instanceof Error?n.trackException({exception:r}):(r.lastIndexOf("\n")==r.length-1&&(r=r.substring(0,r.length-1)),n.trackTrace({message:r,severity:e.data.stderr?t.SeverityLevel.Warning:t.SeverityLevel.Information}))}))};e.enable=function(e,t){e?(0===n.length&&r.channel.subscribe("console",i),n.push(t)):0===(n=n.filter((function(e){return e!=t}))).length&&r.channel.unsubscribe("console",i)},e.dispose=function(){r.channel.unsubscribe("console",i),n=[]}})),_n=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.enable=void 0;var t=zr(),r=T(),n=[],i={10:t.SeverityLevel.Verbose,20:t.SeverityLevel.Verbose,30:t.SeverityLevel.Information,40:t.SeverityLevel.Warning,50:t.SeverityLevel.Error,60:t.SeverityLevel.Critical},o=function(e){var t=e.data.result;n.forEach((function(r){var n=i[e.data.level];t instanceof Error?r.trackException({exception:t}):r.trackTrace({message:t,severity:n})}))};e.enable=function(e,t){e?(0===n.length&&r.channel.subscribe("bunyan",o),n.push(t)):0===(n=n.filter((function(e){return e!=t}))).length&&r.channel.unsubscribe("bunyan",o)},e.dispose=function(){r.channel.unsubscribe("bunyan",o),n=[]}})),Sn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.enable=void 0;var t=zr(),r=T(),n=[],i={syslog:function(e){var r={emerg:t.SeverityLevel.Critical,alert:t.SeverityLevel.Critical,crit:t.SeverityLevel.Critical,error:t.SeverityLevel.Error,warning:t.SeverityLevel.Warning,notice:t.SeverityLevel.Information,info:t.SeverityLevel.Information,debug:t.SeverityLevel.Verbose};return void 0===r[e]?t.SeverityLevel.Information:r[e]},npm:function(e){var r={error:t.SeverityLevel.Error,warn:t.SeverityLevel.Warning,info:t.SeverityLevel.Information,verbose:t.SeverityLevel.Verbose,debug:t.SeverityLevel.Verbose,silly:t.SeverityLevel.Verbose};return void 0===r[e]?t.SeverityLevel.Information:r[e]},unknown:function(e){return t.SeverityLevel.Information}},o=function(e){var t=e.data.message;n.forEach((function(r){if(t instanceof Error)r.trackException({exception:t,properties:e.data.meta});else{var n=i[e.data.levelKind](e.data.level);r.trackTrace({message:t,severity:n,properties:e.data.meta})}}))};e.enable=function(e,t){e?(0===n.length&&r.channel.subscribe("winston",o),n.push(t)):0===(n=n.filter((function(e){return e!=t}))).length&&r.channel.unsubscribe("winston",o)},e.dispose=function(){r.channel.unsubscribe("winston",o),n=[]}})),wn=v(((e,t)=>{"use strict";var r=Qt(),n=function(){function e(t){if(e.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=t,e.INSTANCE=this}return e.prototype.enable=function(e,t){r.IsInitialized&&(yn().enable(e&&t,this._client),_n().enable(e,this._client),Sn().enable(e,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1,!1)},e._methodNames=["debug","info","log","warn","error"],e}();t.exports=n})),bn=v(((e,t)=>{"use strict";var r=function(){function e(t){if(e.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t;var r=process.versions.node.split(".");e._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||13===parseInt(r[0])&&parseInt(r[1])>=7}return e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.enable=function(t){var r=this;if(t){if(this._isInitialized=!0,!this._exceptionListenerHandle){var n=function(t,n,i){void 0===i&&(i=new Error(e._FALLBACK_ERROR_MESSAGE)),r._client.trackException({exception:i}),r._client.flush({isAppCrashing:!0}),t&&n&&1===process.listeners(n).length&&(console.error(i),process.exit(1))};e._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=n.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=n.bind(this,!0,e.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=n.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(e._canUseUncaughtExceptionMonitor?process.removeListener(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.INSTANCE=null,e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",e.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",e.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",e._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",e._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",e._canUseUncaughtExceptionMonitor=!1,e}();t.exports=r})),En=v((e=>{"use strict";var t,r,n,i;Object.defineProperty(e,"__esModule",{value:!0}),e.HeartBeatMetricName=e.DependencyTypeName=e.SpanAttribute=e.TelemetryTypeStringToQuickPulseDocumentType=e.TelemetryTypeStringToQuickPulseType=e.QuickPulseType=e.QuickPulseDocumentType=e.PerformanceToQuickPulseCounter=e.MetricId=e.PerformanceCounter=e.QuickPulseCounter=e.DEFAULT_LIVEMETRICS_HOST=e.DEFAULT_LIVEMETRICS_ENDPOINT=e.DEFAULT_BREEZE_ENDPOINT=void 0,e.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com",e.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com",e.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com",(n=r=e.QuickPulseCounter||(e.QuickPulseCounter={})).COMMITTED_BYTES="\\Memory\\Committed Bytes",n.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",n.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",n.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",n.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",n.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",n.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",n.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",n.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec",function(e){e.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",e.AVAILABLE_BYTES="\\Memory\\Available Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",e.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",e.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"}(i=e.PerformanceCounter||(e.PerformanceCounter={})),function(e){e.REQUESTS_DURATION="requests/duration",e.DEPENDENCIES_DURATION="dependencies/duration",e.EXCEPTIONS_COUNT="exceptions/count",e.TRACES_COUNT="traces/count"}(e.MetricId||(e.MetricId={})),e.PerformanceToQuickPulseCounter=((t={})[i.PROCESSOR_TIME]=r.PROCESSOR_TIME,t[i.REQUEST_RATE]=r.REQUEST_RATE,t[i.REQUEST_DURATION]=r.REQUEST_DURATION,t[r.COMMITTED_BYTES]=r.COMMITTED_BYTES,t[r.REQUEST_FAILURE_RATE]=r.REQUEST_FAILURE_RATE,t[r.DEPENDENCY_RATE]=r.DEPENDENCY_RATE,t[r.DEPENDENCY_FAILURE_RATE]=r.DEPENDENCY_FAILURE_RATE,t[r.DEPENDENCY_DURATION]=r.DEPENDENCY_DURATION,t[r.EXCEPTION_RATE]=r.EXCEPTION_RATE,t),e.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"},e.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"},e.TelemetryTypeStringToQuickPulseType={EventData:e.QuickPulseType.Event,ExceptionData:e.QuickPulseType.Exception,MessageData:e.QuickPulseType.Trace,MetricData:e.QuickPulseType.Metric,RequestData:e.QuickPulseType.Request,RemoteDependencyData:e.QuickPulseType.Dependency,AvailabilityData:e.QuickPulseType.Availability,PageViewData:e.QuickPulseType.PageView},e.TelemetryTypeStringToQuickPulseDocumentType={EventData:e.QuickPulseDocumentType.Event,ExceptionData:e.QuickPulseDocumentType.Exception,MessageData:e.QuickPulseDocumentType.Trace,MetricData:e.QuickPulseDocumentType.Metric,RequestData:e.QuickPulseDocumentType.Request,RemoteDependencyData:e.QuickPulseDocumentType.Dependency,AvailabilityData:e.QuickPulseDocumentType.Availability,PageViewData:e.QuickPulseDocumentType.PageView},e.SpanAttribute={HttpHost:"http.host",HttpMethod:"http.method",HttpPort:"http.port",HttpStatusCode:"http.status_code",HttpUrl:"http.url",HttpUserAgent:"http.user_agent",GrpcMethod:"grpc.method",GrpcService:"rpc.service"},e.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc"},e.HeartBeatMetricName="HeartBeat"})),Pn=v(((e,t)=>{"use strict";var n=r(22037),i=En(),o=function(){function e(t,r,n){void 0===r&&(r=6e4),void 0===n&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return e.prototype.enable=function(t,r){var i=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._lastCpus=n.cpus(),this._lastRequests={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:e._totalExceptionCount,time:+new Date},"function"==typeof process.cpuUsage&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval((function(){return i.trackPerformance()}),this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},e.countRequest=function(t,r){var n;if(e.isEnabled()){if("string"==typeof t)n=+new Date("1970-01-01T"+t+"Z");else{if("number"!=typeof t)return;n=t}e._intervalRequestExecutionTime+=n,!1===r&&e._totalFailedRequestCount++,e._totalRequestCount++}},e.countException=function(){e._totalExceptionCount++},e.countDependency=function(t,r){var n;if(e.isEnabled()){if("string"==typeof t)n=+new Date("1970-01-01T"+t+"Z");else{if("number"!=typeof t)return;n=t}e._intervalDependencyExecutionTime+=n,!1===r&&e._totalFailedDependencyCount++,e._totalDependencyCount++}},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},e.prototype._trackCpu=function(){var e=n.cpus();if(e&&e.length&&this._lastCpus&&e.length===this._lastCpus.length){for(var t=0,r=0,o=0,s=0,a=0,c=0;e&&c<e.length;c++){var u=e[c],l=this._lastCpus[c],d=(u.model,u.speed,u.times),p=l.times;t+=d.user-p.user||0,r+=d.sys-p.sys||0,o+=d.nice-p.nice||0,s+=d.idle-p.idle||0,a+=d.irq-p.irq||0}var f=void 0;if("function"==typeof process.cpuUsage){var h=process.cpuUsage(),g=process.hrtime(),m=h.user-this._lastAppCpuUsage.user+(h.system-this._lastAppCpuUsage.system)||0;typeof this._lastHrtime<"u"&&2===this._lastHrtime.length&&(f=100*m/((1e6*(g[0]-this._lastHrtime[0])+(g[1]-this._lastHrtime[1])/1e3||0)*e.length)),this._lastAppCpuUsage=h,this._lastHrtime=g}var v=t+r+o+s+a||1;this._client.trackMetric({name:i.PerformanceCounter.PROCESSOR_TIME,value:(v-s)/v*100}),this._client.trackMetric({name:i.PerformanceCounter.PROCESS_TIME,value:f||t/v*100})}this._lastCpus=e},e.prototype._trackMemory=function(){var e=n.freemem(),t=process.memoryUsage().rss,r=n.totalmem()-e;this._client.trackMetric({name:i.PerformanceCounter.PRIVATE_BYTES,value:t}),this._client.trackMetric({name:i.PerformanceCounter.AVAILABLE_BYTES,value:e}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:i.QuickPulseCounter.COMMITTED_BYTES,value:r})},e.prototype._trackNetwork=function(){var t=this._lastRequests,r={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-t.totalRequestCount||0,o=r.totalFailedRequestCount-t.totalFailedRequestCount||0,s=r.time-t.time,a=s/1e3,c=(e._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=e._intervalRequestExecutionTime,s>0){var u=n/a,l=o/a;this._client.trackMetric({name:i.PerformanceCounter.REQUEST_RATE,value:u}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:i.PerformanceCounter.REQUEST_DURATION,value:c}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:i.QuickPulseCounter.REQUEST_FAILURE_RATE,value:l})}this._lastRequests=r},e.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastDependencies,r={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-t.totalDependencyCount||0,o=r.totalFailedDependencyCount-t.totalFailedDependencyCount||0,s=r.time-t.time,a=s/1e3,c=(e._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=e._intervalDependencyExecutionTime,s>0){var u=n/a,l=o/a;this._client.trackMetric({name:i.QuickPulseCounter.DEPENDENCY_RATE,value:u}),this._client.trackMetric({name:i.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:l}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:i.QuickPulseCounter.DEPENDENCY_DURATION,value:c})}this._lastDependencies=r}},e.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastExceptions,r={totalExceptionCount:e._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-t.totalExceptionCount||0,o=r.time-t.time;if(o>0){var s=n/(o/1e3);this._client.trackMetric({name:i.QuickPulseCounter.EXCEPTION_RATE,value:s})}this._lastExceptions=r}},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e._totalRequestCount=0,e._totalFailedRequestCount=0,e._totalDependencyCount=0,e._totalFailedDependencyCount=0,e._totalExceptionCount=0,e._intervalDependencyExecutionTime=0,e._intervalRequestExecutionTime=0,e}();t.exports=o})),Tn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AggregatedMetricCounter=void 0;e.AggregatedMetricCounter=function(e){this.dimensions=e,this.totalCount=0,this.lastTotalCount=0,this.intervalExecutionTime=0,this.lastTime=+new Date,this.lastIntervalExecutionTime=0}})),Cn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PreaggregatedMetricPropertyNames=void 0,e.PreaggregatedMetricPropertyNames={cloudRoleInstance:"cloud/roleInstance",cloudRoleName:"cloud/roleName",operationSynthetic:"operation/synthetic",requestSuccess:"Request.Success",requestResultCode:"request/resultCode",dependencyType:"Dependency.Type",dependencyTarget:"dependency/target",dependencySuccess:"Dependency.Success",dependencyResultCode:"dependency/resultCode",traceSeverityLevel:"trace/severityLevel"}})),In=v(((e,t)=>{"use strict";var r=e&&e.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},n=En(),i=Tn(),o=Cn(),s=function(){function e(t,r){void 0===r&&(r=6e4),e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,e._dependencyCountersCollection=[],e._requestCountersCollection=[],e._exceptionCountersCollection=[],e._traceCountersCollection=[],this._client=t,this._collectionInterval=r}return e.prototype.enable=function(e,t){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._collectionInterval=t||this._collectionInterval,this._handle=setInterval((function(){return r.trackPreAggregatedMetrics()}),this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},e.countException=function(t){e.isEnabled()&&e._getAggregatedCounter(t,this._exceptionCountersCollection).totalCount++},e.countTrace=function(t){e.isEnabled()&&e._getAggregatedCounter(t,this._traceCountersCollection).totalCount++},e.countRequest=function(t,r){if(e.isEnabled()){var n,i=e._getAggregatedCounter(r,this._requestCountersCollection);if("string"==typeof t)n=+new Date("1970-01-01T"+t+"Z");else{if("number"!=typeof t)return;n=t}i.intervalExecutionTime+=n,i.totalCount++}},e.countDependency=function(t,r){if(e.isEnabled()){var n,i=e._getAggregatedCounter(r,this._dependencyCountersCollection);if("string"==typeof t)n=+new Date("1970-01-01T"+t+"Z");else{if("number"!=typeof t)return;n=t}i.intervalExecutionTime+=n,i.totalCount++}},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackPreAggregatedMetrics=function(){this._trackRequestMetrics(),this._trackDependencyMetrics(),this._trackExceptionMetrics(),this._trackTraceMetrics()},e._getAggregatedCounter=function(e,t){for(var r=!1,n=0;n<t.length;n++){if(e===t[n].dimensions)return t[n];if(Object.keys(e).length===Object.keys(t[n].dimensions).length){for(var o in e)if(e[o]!=t[n].dimensions[o]){r=!0;break}if(!r)return t[n];r=!1}}var s=new i.AggregatedMetricCounter(e);return t.push(s),s},e.prototype._trackRequestMetrics=function(){for(var t=0;t<e._requestCountersCollection.length;t++){var r=e._requestCountersCollection[t];r.time=+new Date;var i=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime,s=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/i||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,o>0&&i>0&&this._trackPreAggregatedMetric({name:"Server response time",dimensions:r.dimensions,value:s,count:i,aggregationInterval:o,metricType:n.MetricId.REQUESTS_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackDependencyMetrics=function(){for(var t=0;t<e._dependencyCountersCollection.length;t++){var r=e._dependencyCountersCollection[t];r.time=+new Date;var i=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime,s=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/i||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,o>0&&i>0&&this._trackPreAggregatedMetric({name:"Dependency duration",dimensions:r.dimensions,value:s,count:i,aggregationInterval:o,metricType:n.MetricId.DEPENDENCIES_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackExceptionMetrics=function(){for(var t=0;t<e._exceptionCountersCollection.length;t++){var r=e._exceptionCountersCollection[t],i=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime;this._trackPreAggregatedMetric({name:"Exceptions",dimensions:r.dimensions,value:i,count:i,aggregationInterval:o,metricType:n.MetricId.EXCEPTIONS_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackTraceMetrics=function(){for(var t=0;t<e._traceCountersCollection.length;t++){var r=e._traceCountersCollection[t],i=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime;this._trackPreAggregatedMetric({name:"Traces",dimensions:r.dimensions,value:i,count:i,aggregationInterval:o,metricType:n.MetricId.TRACES_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},e.prototype._trackPreAggregatedMetric=function(e){var t={};for(var n in e.dimensions)t[o.PreaggregatedMetricPropertyNames[n]]=e.dimensions[n];t=r(r({},t),{"_MS.MetricId":e.metricType,"_MS.AggregationIntervalMs":String(e.aggregationInterval),"_MS.IsAutocollected":"True"});var i={name:e.name,value:e.value,count:e.count,properties:t,kind:"Aggregation"};this._client.trackMetric(i)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e}();t.exports=s})),On=v(((e,t)=>{"use strict";var n=r(22037),i=r(57147),o=r(71017),s=zr(),a=S(),c=function(){function e(e){this.keys=new s.ContextTagKeys,this.tags={},this._loadApplicationContext(e),this._loadDeviceContext(),this._loadInternalContext()}return e.prototype._loadApplicationContext=function(t){if(t=t||o.resolve(__dirname,"../../../../package.json"),!e.appVersion[t]){e.appVersion[t]="unknown";try{var r=JSON.parse(i.readFileSync(t,"utf8"));r&&"string"==typeof r.version&&(e.appVersion[t]=r.version)}catch(e){a.info("unable to read app version: ",e)}}this.tags[this.keys.applicationVersion]=e.appVersion[t]},e.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=n&&n.hostname(),this.tags[this.keys.deviceOSVersion]=n&&n.type()+" "+n.release(),this.tags[this.keys.cloudRole]=e.DefaultRoleName,this.tags["ai.device.osArchitecture"]=n&&n.arch(),this.tags["ai.device.osPlatform"]=n&&n.platform()},e.prototype._loadInternalContext=function(){var t=o.resolve(__dirname,"../../package.json");if(!e.sdkVersion){e.sdkVersion="unknown";try{var r=JSON.parse(i.readFileSync(t,"utf8"));r&&"string"==typeof r.version&&(e.sdkVersion=r.version)}catch(e){a.info("unable to read app version: ",e)}}this.tags[this.keys.internalSdkVersion]="node:"+e.sdkVersion},e.DefaultRoleName="Web",e.appVersion={},e.sdkVersion=null,e}();t.exports=c})),xn=v(((e,t)=>{"use strict";var n,i=e&&e.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=r(57310),s=zr(),a=Zt(),c=Yt(),u=Gr(),l=er(),d=function(e){function t(r,n){var i=e.call(this)||this;return n&&n.method&&r&&(i.method=n.method,i.url=t._getUrlFromRequestOptions(r,n),i.startTime=+new Date),i}return i(t,e),t.prototype.onError=function(e){this._setStatus(void 0,e)},t.prototype.onResponse=function(e){this._setStatus(e.statusCode,void 0),this.correlationId=a.getCorrelationContextTarget(e,c.requestContextTargetKey)},t.prototype.getDependencyTelemetry=function(e,t){var r=o.parse(this.url);r.search=void 0,r.hash=void 0;var n=this.method.toUpperCase()+" "+r.pathname,i=s.RemoteDependencyDataConstants.TYPE_HTTP,a=r.hostname;r.port&&(a+=":"+r.port),this.correlationId?(i=s.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==l.correlationIdPrefix&&(a+=" | "+this.correlationId)):i=s.RemoteDependencyDataConstants.TYPE_HTTP;var c={id:t,name:n,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:i,target:a};if(e&&e.time?c.time=e.time:this.startTime&&(c.time=new Date(this.startTime)),e){for(var u in e)c[u]||(c[u]=e[u]);if(e.properties)for(var u in e.properties)c.properties[u]=e.properties[u]}return c},t._getUrlFromRequestOptions=function(e,t){if("string"==typeof e)if(0===e.indexOf("http://")||0===e.indexOf("https://"))e=o.parse(e);else{var r=o.parse(e);e="443"===r.host?o.parse("https://"+e):o.parse("http://"+e)}else{if(e&&"function"==typeof o.URL&&e instanceof o.URL)return o.format(e);var n=e;e={},n&&Object.keys(n).forEach((function(t){e[t]=n[t]}))}if(e.path){var i=o.parse(e.path);e.pathname=i.pathname,e.search=i.search}return e.host&&e.port&&!o.parse("http://"+e.host).port&&e.port&&(e.hostname=e.host,delete e.host),e.protocol=e.protocol||t.agent&&t.agent.protocol||t.protocol||void 0,e.hostname=e.hostname||"localhost",o.format(e)},t}(u);t.exports=d})),Nn=v((e=>{"use strict";var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.spanToTelemetryContract=void 0;var r=Se(),n=En();function i(e){var r=t({},e);return Object.keys(n.SpanAttribute).forEach((function(e){delete r[e]})),r}e.spanToTelemetryContract=function(e){var o="|"+e.spanContext().traceId+"."+e.spanContext().spanId+".",s=Math.round(1e3*e._duration[0]+e._duration[1]/1e6),a=e.attributes["peer.address"]?e.attributes["peer.address"].toString():"",c=e.attributes.component?e.attributes.component.toString():"",u=c.toUpperCase()===n.DependencyTypeName.Http||!!e.attributes[n.SpanAttribute.HttpUrl],l=c.toLowerCase()===n.DependencyTypeName.Grpc;if(u){var d=e.attributes[n.SpanAttribute.HttpMethod]||"GET",p=new URL(e.attributes[n.SpanAttribute.HttpUrl].toString()),f=e.attributes[n.SpanAttribute.HttpHost]||p.host,h=e.attributes[n.SpanAttribute.HttpPort]||p.port||null,g=d+" "+(p.pathname||"/"),m=n.DependencyTypeName.Http,v=h?(f+":"+h).toString():f.toString(),y=p.toString(),_=e.attributes[n.SpanAttribute.HttpStatusCode]||e.status.code||0;return{id:o,name:g,dependencyTypeName:m,target:v,data:y,success:_<400,duration:s,url:y,resultCode:String(_),properties:i(e.attributes)}}if(l){d=e.attributes[n.SpanAttribute.GrpcMethod]||"rpc";var S=e.attributes[n.SpanAttribute.GrpcService],w=S?d+" "+S:e.name;return{id:o,duration:s,name:w,target:S.toString(),data:S.toString()||w,url:S.toString()||w,dependencyTypeName:n.DependencyTypeName.Grpc,resultCode:String(e.status.code||0),success:0===e.status.code,properties:i(e.attributes)}}var b=e.name,E=e.links&&e.links.map((function(e){return{operation_Id:e.context.traceId,id:e.context.spanId}}));return{id:o,duration:s,name:b,target:a,data:a||b,url:a||b,dependencyTypeName:e.kind===r.SpanKind.INTERNAL?n.DependencyTypeName.InProc:c||e.name,resultCode:String(e.status.code||0),success:0===e.status.code,properties:t(t({},i(e.attributes)),{"_MS.links":E||void 0})}}})),kn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.subscriber=void 0;var t=Se(),r=T(),n=tr(),i=Nn(),o=w(),s=[];e.subscriber=function(e){var r=e.data,a=i.spanToTelemetryContract(r),c=r.spanContext(),u=new n;u.traceId=c.traceId,u.spanId=c.spanId,u.traceFlag=n.formatOpenTelemetryTraceFlags(c.traceFlags),u.parentId=r.parentSpanId?"|"+c.traceId+"."+r.parentSpanId+".":null,o.AsyncScopeManager.with(r,(function(){s.forEach((function(e){r.kind===t.SpanKind.SERVER?e.trackRequest(a):(r.kind===t.SpanKind.CLIENT||r.kind===t.SpanKind.INTERNAL)&&e.trackDependency(a)}))}))},e.enable=function(t,n){t?(0===s.length&&r.channel.subscribe("azure-coretracing",e.subscriber),s.push(n)):0===(s=s.filter((function(e){return e!=n}))).length&&r.channel.unsubscribe("azure-coretracing",e.subscriber)}})),Rn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.subscriber=void 0;var t=T(),r=[];e.subscriber=function(e){"ismaster"!==e.data.event.commandName&&r.forEach((function(t){var r=e.data.startedData&&e.data.startedData.databaseName||"Unknown database";t.trackDependency({target:r,data:e.data.event.commandName,name:e.data.event.commandName,duration:e.data.event.duration,success:e.data.succeeded,resultCode:e.data.succeeded?"0":"1",time:e.data.startedData.time,dependencyTypeName:"mongodb"})}))},e.enable=function(n,i){n?(0===r.length&&t.channel.subscribe("mongodb",e.subscriber),r.push(i)):0===(r=r.filter((function(e){return e!=i}))).length&&t.channel.unsubscribe("mongodb",e.subscriber)}})),An=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.subscriber=void 0;var t=T(),r=[];e.subscriber=function(e){r.forEach((function(t){var r=e.data.query||{},n=r.sql||"Unknown query",i=!e.data.err,o=(r._connection||{}).config||{},s=o.socketPath?o.socketPath:(o.host||"localhost")+":"+o.port;t.trackDependency({target:s,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"mysql"})}))},e.enable=function(n,i){n?(0===r.length&&t.channel.subscribe("mysql",e.subscriber),r.push(i)):0===(r=r.filter((function(e){return e!=i}))).length&&t.channel.unsubscribe("mysql",e.subscriber)}})),Dn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.subscriber=void 0;var t=T(),r=[];e.subscriber=function(e){r.forEach((function(t){"info"!==e.data.commandObj.command&&t.trackDependency({target:e.data.address,name:e.data.commandObj.command,data:e.data.commandObj.command,duration:e.data.duration,success:!e.data.err,resultCode:e.data.err?"1":"0",time:e.data.time,dependencyTypeName:"redis"})}))},e.enable=function(n,i){n?(0===r.length&&t.channel.subscribe("redis",e.subscriber),r.push(i)):0===(r=r.filter((function(e){return e!=i}))).length&&t.channel.unsubscribe("redis",e.subscriber)}})),jn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.enable=e.subscriber=void 0;var t=T(),r=[];e.subscriber=function(e){r.forEach((function(t){var r=e.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",i=!e.data.error,o=e.data.database.host+":"+e.data.database.port;t.trackDependency({target:o,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"postgres"})}))},e.enable=function(n,i){n?(0===r.length&&t.channel.subscribe("postgres",e.subscriber),r.push(i)):0===(r=r.filter((function(e){return e!=i}))).length&&t.channel.unsubscribe("postgres",e.subscriber)}})),Mn=v(((e,t)=>{"use strict";var n=e&&e.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},i=r(13685),o=r(95687),s=S(),a=Zt(),c=Yt(),u=xn(),l=vn(),d=er(),p=tr(),f=Qt(),h=function(){function e(t){if(e.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(e){this._isEnabled=e,this._isEnabled&&!this._isInitialized&&this._initialize(),f.IsInitialized&&(kn().enable(!0,this._client),Rn().enable(e,this._client),An().enable(e,this._client),Dn().enable(e,this._client),jn().enable(e,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=i.request,s=o.request,a=function(r,n){var i=!n[e.disableCollectionRequestOption]&&!r[e.alreadyAutoCollectedFlag];n.headers&&n.headers["user-agent"]&&-1!==n.headers["user-agent"].toString().indexOf("azsdk-js")&&(i=!1),r[e.alreadyAutoCollectedFlag]=!0,r&&n&&i&&(l.CorrelationContextManager.wrapEmitter(r),e.trackRequest(t._client,{options:n,request:r}))};i.request=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var s=r.call.apply(r,n([i,e],t));return a(s,e),s},o.request=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var i=s.call.apply(s,n([o,e],t));return a(i,e),i},i.get=function(e){for(var t,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var s=(t=i.request).call.apply(t,n([i,e],r));return s.end(),s},o.get=function(e){for(var t,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var s=(t=o.request).call.apply(t,n([o,e],r));return s.end(),s}},e.trackRequest=function(t,r){if(r.options&&r.request&&t){var n,i,o=new u(r.options,r.request),f=l.CorrelationContextManager.getCurrentContext();if(f&&f.operation&&f.operation.traceparent&&p.isValidTraceId(f.operation.traceparent.traceId)?(f.operation.traceparent.updateSpanId(),n=f.operation.traceparent.getBackCompatRequestId()):d.w3cEnabled?(i=(g=new p).toString(),n=g.getBackCompatRequestId()):n=f&&f.operation&&f.operation.parentId+e.requestNumber+++".",a.canIncludeCorrelationHeader(t,o.getUrl())&&r.request.getHeader&&r.request.setHeader&&t.config&&t.config.correlationId){var h=r.request.getHeader(c.requestContextHeader);try{a.safeIncludeCorrelationHeader(t,r.request,h)}catch(e){s.warn("Request-Context header could not be set. Correlation of requests may be lost",e)}if(f&&f.operation)try{if(r.request.setHeader(c.requestIdHeader,n),t.config.ignoreLegacyHeaders||(r.request.setHeader(c.parentIdHeader,f.operation.id),r.request.setHeader(c.rootIdHeader,n)),i||f.operation.traceparent)r.request.setHeader(c.traceparentHeader,i||f.operation.traceparent.toString());else if(d.w3cEnabled){var g=(new p).toString();r.request.setHeader(c.traceparentHeader,g)}if(f.operation.tracestate){var m=f.operation.tracestate.toString();m&&r.request.setHeader(c.traceStateHeader,m)}var v=f.customProperties.serializeToHeader();v&&r.request.setHeader(c.correlationContextHeader,v)}catch(e){s.warn("Correlation headers could not be set. Correlation of requests may be lost.",e)}}r.request.on&&(r.request.on("response",(function(e){o.onResponse(e);var i=o.getDependencyTelemetry(r,n);i.contextObjects=i.contextObjects||{},i.contextObjects["http.RequestOptions"]=r.options,i.contextObjects["http.ClientRequest"]=r.request,i.contextObjects["http.ClientResponse"]=e,t.trackDependency(i)})),r.request.on("error",(function(e){o.onError(e);var i=o.getDependencyTelemetry(r,n);i.contextObjects=i.contextObjects||{},i.contextObjects["http.RequestOptions"]=r.options,i.contextObjects["http.ClientRequest"]=r.request,i.contextObjects.Error=e,t.trackDependency(i)})),r.request.on("abort",(function(){o.onError(new Error);var e=o.getDependencyTelemetry(r,n);e.contextObjects=e.contextObjects||{},e.contextObjects["http.RequestOptions"]=r.options,e.contextObjects["http.ClientRequest"]=r.request,t.trackDependency(e)})))}else s.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!t)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.disableCollectionRequestOption="disableAppInsightsAutoCollection",e.requestNumber=1,e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();t.exports=h})),Ln=v(((e,t)=>{"use strict";var n=r(22037),i=En(),o=Zt(),s=On(),a=Mn(),c=function(){function e(t){this._collectionInterval=9e5,this._vmData={},this._azInst_vmId="",this._azInst_subscriptionId="",this._azInst_osType="",e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t}return e.prototype.enable=function(e,t){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._handle=setInterval((function(){return r.trackHeartBeat(t,(function(){}))}),this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackHeartBeat=function(e,t){var r=this,o=!1,a={},c=s.sdkVersion;a.sdk=c,a.osType=n.type(),process.env.WEBSITE_SITE_NAME?(a.appSrv_SiteName=process.env.WEBSITE_SITE_NAME||"",a.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME||"",a.appSrv_wsHost=process.env.WEBSITE_HOSTNAME||""):process.env.FUNCTIONS_WORKER_RUNTIME?a.azfunction_appId=process.env.WEBSITE_HOSTNAME:e&&(void 0===this._isVM?(o=!0,this._getAzureComputeMetadata(e,(function(){r._isVM&&Object.keys(r._vmData).length>0&&(a.azInst_vmId=r._vmData.vmId||"",a.azInst_subscriptionId=r._vmData.subscriptionId||"",a.azInst_osType=r._vmData.osType||"",r._azInst_vmId=r._vmData.vmId||"",r._azInst_subscriptionId=r._vmData.subscriptionId||"",r._azInst_osType=r._vmData.osType||""),r._client.trackMetric({name:i.HeartBeatMetricName,value:0,properties:a}),t()}))):this._isVM&&(a.azInst_vmId=this._azInst_vmId,a.azInst_subscriptionId=this._azInst_subscriptionId,a.azInst_osType=this._azInst_osType)),o||(this._client.trackMetric({name:i.HeartBeatMetricName,value:0,properties:a}),t())},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.prototype._getAzureComputeMetadata=function(e,t){var r,n=this,i=((r={method:"GET"})[a.disableCollectionRequestOption]=!0,r.headers={Metadata:"True"},r),s=o.makeRequest(e,"http://169.254.169.254/metadata/instance/compute?api-version=2017-12-01&format=json",i,(function(e){if(200===e.statusCode){n._isVM=!0;var r="";e.on("data",(function(e){r+=e})),e.on("end",(function(){n._vmData=n._isJSON(r)?JSON.parse(r):{},t()}))}else t()}));s&&(s.on("error",(function(e){e&&e.message&&e.message.indexOf("ENETUNREACH")>-1&&(n._isVM=!1),t()})),s.end())},e.prototype._isJSON=function(e){try{return JSON.parse(e)&&!!e}catch{return!1}},e}();t.exports=c})),Fn=v(((e,t)=>{"use strict";var n=r(13685),i=r(95687),o=S(),s=Zt(),a=Yt(),c=Kr(),u=vn(),l=Pn(),d=function(){function e(t){if(e.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(e){this._isEnabled=e,(this._isAutoCorrelating||this._isEnabled||l.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},e.prototype.useAutoCorrelation=function(e,t){e&&!this._isAutoCorrelating?u.CorrelationContextManager.enable(t):!e&&this._isAutoCorrelating&&u.CorrelationContextManager.disable(),this._isAutoCorrelating=e},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},e.prototype._generateCorrelationContext=function(e){if(this._isAutoCorrelating)return u.CorrelationContextManager.generateContextObject(e.getOperationId(this._client.context.tags),e.getRequestId(),e.getOperationName(this._client.context.tags),e.getCorrelationContextHeader(),e.getTraceparent(),e.getTracestate())},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=function(r){if(r){if("function"!=typeof r)throw new Error("onRequest handler must be a function");return function(n,i){u.CorrelationContextManager.wrapEmitter(n),u.CorrelationContextManager.wrapEmitter(i);var o=n&&!n[e.alreadyAutoCollectedFlag];if(n&&o){var s=new c(n),a=t._generateCorrelationContext(s);u.CorrelationContextManager.runWithContext(a,(function(){t._isEnabled&&(n[e.alreadyAutoCollectedFlag]=!0,e.trackRequest(t._client,{request:n,response:i},s)),"function"==typeof r&&r(n,i)}))}else"function"==typeof r&&r(n,i)}}},o=function(e){var t=e.addListener.bind(e);e.addListener=function(e,n){switch(e){case"request":case"checkContinue":return t(e,r(n));default:return t(e,n)}},e.on=e.addListener},s=n.createServer;n.createServer=function(e,t){if(t&&"function"==typeof t){var n=s(e,r(t));return o(n),n}return n=s(r(e)),o(n),n};var a=i.createServer;i.createServer=function(e,t){var n=a(e,r(t));return o(n),n}},e.trackRequestSync=function(t,r){if(r.request&&r.response&&t){e.addResponseCorrelationIdHeader(t,r.response);var n=u.CorrelationContextManager.getCurrentContext(),i=new c(r.request,n&&n.operation.parentId);n&&(n.operation.id=i.getOperationId(t.context.tags)||n.operation.id,n.operation.name=i.getOperationName(t.context.tags)||n.operation.name,n.operation.parentId=i.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(i.getCorrelationContextHeader())),e.endRequest(t,i,r,r.duration,r.error)}else o.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!t)},e.trackRequest=function(t,r,n){if(r.request&&r.response&&t){var i=u.CorrelationContextManager.getCurrentContext(),a=n||new c(r.request,i&&i.operation.parentId);s.canIncludeCorrelationHeader(t,a.getUrl())&&e.addResponseCorrelationIdHeader(t,r.response),i&&!n&&(i.operation.id=a.getOperationId(t.context.tags)||i.operation.id,i.operation.name=a.getOperationName(t.context.tags)||i.operation.name,i.operation.parentId=a.getOperationParentId(t.context.tags)||i.operation.parentId,i.customProperties.addHeaderData(a.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",(function(){e.endRequest(t,a,r,null,null)})),r.request.on&&r.request.on("error",(function(n){e.endRequest(t,a,r,null,n)})),r.request.on&&r.request.on("aborted",(function(){e.endRequest(t,a,r,null,"The request has been aborted and the network socket has closed.")}))}else o.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!t)},e.addResponseCorrelationIdHeader=function(e,t){if(e.config&&e.config.correlationId&&t.getHeader&&t.setHeader&&!t.headersSent){var r=t.getHeader(a.requestContextHeader);s.safeIncludeCorrelationHeader(e,t,r)}},e.endRequest=function(e,t,r,n,i){i?t.onError(i,n):t.onResponse(r.response,n);var o=t.getRequestTelemetry(r);if(o.tagOverrides=t.getRequestTags(e.context.tags),r.tagOverrides)for(var s in r.tagOverrides)o.tagOverrides[s]=r.tagOverrides[s];var a=t.getLegacyRootId();a&&(o.properties.ai_legacyRootId=a),o.contextObjects=o.contextObjects||{},o.contextObjects["http.ServerRequest"]=r.request,o.contextObjects["http.ServerResponse"]=r.response,e.trackRequest(o)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1,u.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();t.exports=d})),Un=v(((e,t)=>{"use strict";var n=e&&e.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=r(22037),o=zr(),s=En(),a=Zt(),c=S(),u=a.w3cTraceId(),l=function(){function e(){}return e.createQuickPulseEnvelope=function(e,t,r,n){var o=i&&"function"==typeof i.hostname&&i.hostname()||"Unknown",s=n.tags&&n.keys&&n.keys.cloudRoleInstance&&n.tags[n.keys.cloudRoleInstance]||o,a=n.tags&&n.keys&&n.keys.cloudRole&&n.tags[n.keys.cloudRole]||null;return{Documents:t.length>0?t:null,InstrumentationKey:r.instrumentationKey||"",Metrics:e.length>0?e:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:n.tags[n.keys.internalSdkVersion],StreamId:u,MachineName:o,Instance:s,RoleName:a}},e.createQuickPulseMetric=function(e){return{Name:e.name,Value:e.value,Weight:e.count||1}},e.telemetryEnvelopeToQuickPulseDocument=function(t){switch(t.data.baseType){case o.TelemetryTypeString.Event:return e.createQuickPulseEventDocument(t);case o.TelemetryTypeString.Exception:return e.createQuickPulseExceptionDocument(t);case o.TelemetryTypeString.Trace:return e.createQuickPulseTraceDocument(t);case o.TelemetryTypeString.Dependency:return e.createQuickPulseDependencyDocument(t);case o.TelemetryTypeString.Request:return e.createQuickPulseRequestDocument(t)}return null},e.createQuickPulseEventDocument=function(t){var r=e.createQuickPulseDocument(t),i=t.data.baseData.name;return n(n({},r),{Name:i})},e.createQuickPulseTraceDocument=function(t){var r=e.createQuickPulseDocument(t),i=t.data.baseData.severityLevel||0;return n(n({},r),{Message:t.data.baseData.message,SeverityLevel:o.SeverityLevel[i]})},e.createQuickPulseExceptionDocument=function(t){var r=e.createQuickPulseDocument(t),i=t.data.baseData.exceptions,o="",s="",a="";return i&&i.length>0&&(i[0].parsedStack&&i[0].parsedStack.length>0?i[0].parsedStack.forEach((function(e){o+=e.assembly+"\n"})):i[0].stack&&i[0].stack.length>0&&(o=i[0].stack),s=i[0].message,a=i[0].typeName),n(n({},r),{Exception:o,ExceptionMessage:s,ExceptionType:a})},e.createQuickPulseRequestDocument=function(t){var r=e.createQuickPulseDocument(t),i=t.data.baseData;return n(n({},r),{Name:i.name,Success:i.success,Duration:i.duration,ResponseCode:i.responseCode,OperationName:i.name})},e.createQuickPulseDependencyDocument=function(t){var r=e.createQuickPulseDocument(t),i=t.data.baseData;return n(n({},r),{Name:i.name,Target:i.target,Success:i.success,Duration:i.duration,ResultCode:i.resultCode,CommandName:i.data,OperationName:r.OperationId,DependencyTypeName:i.type})},e.createQuickPulseDocument=function(t){var r,n;return t.data.baseType?(n=s.TelemetryTypeStringToQuickPulseType[t.data.baseType],r=s.TelemetryTypeStringToQuickPulseDocumentType[t.data.baseType]):c.warn("Document type invalid; not sending live metric document",t.data.baseType),{DocumentType:r,__type:n,OperationId:t.tags[e.keys.operationId],Version:"1.0",Properties:e.aggregateProperties(t)}},e.aggregateProperties=function(e){var t=[],r=e.data.baseData.measurements||{};for(var n in r)if(r.hasOwnProperty(n)){var i={key:n,value:r[n]};t.push(i)}var o=e.data.baseData.properties||{};for(var n in o)o.hasOwnProperty(n)&&(i={key:n,value:o[n]},t.push(i));return t},e.keys=new o.ContextTagKeys,e}();t.exports=l})),Bn=v(((e,t)=>{"use strict";t.exports={getTransmissionTime:function(){return 1e4*(Date.now()+621355968e5)}}})),Vn=v(((e,t)=>{"use strict";var n=e&&e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=e&&e.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=r(95687),s=Mn(),a=S(),c=Bn(),u=Zt(),l="x-ms-qps-service-polling-interval-hint",d="x-ms-qps-service-endpoint-redirect",p=function(){function e(e){this._config=e,this._consecutiveErrors=0}return e.prototype.ping=function(e,t,r){var n=[{name:"x-ms-qps-stream-id",value:e.StreamId},{name:"x-ms-qps-machine-name",value:e.MachineName},{name:"x-ms-qps-role-name",value:e.RoleName},{name:"x-ms-qps-instance-name",value:e.Instance},{name:"x-ms-qps-invariant-version",value:e.InvariantVersion.toString()}];this._submitData(e,t,r,"ping",n)},e.prototype.post=function(e,t,r){return n(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,this._submitData([e],t,r,"post")];case 1:return n.sent(),[2]}}))}))},e.prototype._submitData=function(e,t,r,a,p){return n(this,void 0,void 0,(function(){var n,f,h,g,m,v=this;return i(this,(function(i){return n=JSON.stringify(e),(g={})[s.disableCollectionRequestOption]=!0,g.host=t&&t.length>0?t:this._config.quickPulseHost,g.method="POST",g.path="/QuickPulseService.svc/"+a+"?ikey="+this._config.instrumentationKey,g.headers=((m={Expect:"100-continue"})["x-ms-qps-transmission-time"]=c.getTransmissionTime(),m["Content-Type"]="application/json",m["Content-Length"]=Buffer.byteLength(n),m),f=g,p&&p.length>0&&p.forEach((function(e){return f.headers[e.name]=e.value})),this._config.httpsAgent?f.agent=this._config.httpsAgent:f.agent=u.tlsRestrictedAgent,(h=o.request(f,(function(e){if(200==e.statusCode){var t="true"===e.headers["x-ms-qps-subscribed"],n=e.headers[d]?e.headers[d].toString():null,i=e.headers[l]?parseInt(e.headers[l].toString()):null;v._consecutiveErrors=0,r(t,e,n,i)}else v._onError("StatusCode:"+e.statusCode+" StatusMessage:"+e.statusMessage),r()}))).on("error",(function(e){v._onError(e),r()})),h.write(n),h.end(),[2]}))}))},e.prototype._onError=function(t){this._consecutiveErrors++;var r="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";this._consecutiveErrors%e.MAX_QPS_FAILURES_BEFORE_WARN==0?(r="Live Metrics endpoint could not be reached "+this._consecutiveErrors+" consecutive times. Most recent error:",a.warn(e.TAG,r,t)):a.info(e.TAG,r,t)},e.TAG="QuickPulseSender",e.MAX_QPS_FAILURES_BEFORE_WARN=25,e}();t.exports=p})),$n=v(((e,t)=>{"use strict";var r=e&&e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())}))},n=e&&e.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},i=S(),o=Un(),s=Vn(),a=En(),c=On(),u=function(){function e(e,t){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this._redirectedHost=null,this._pollingIntervalHint=-1,this.config=e,this.context=t||new c,this._sender=new s(this.config),this._isEnabled=!1}return e.prototype.addCollector=function(e){this._collectors.push(e)},e.prototype.trackMetric=function(e){this._addMetric(e)},e.prototype.addDocument=function(e){var t=o.telemetryEnvelopeToQuickPulseDocument(e);t&&this._documents.push(t)},e.prototype.enable=function(e){e&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!e&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},e.prototype.enableCollectors=function(e){this._collectors.forEach((function(t){t.enable(e)}))},e.prototype._addMetric=function(e){var t=e.value,r=e.count||1,n=a.PerformanceToQuickPulseCounter[e.name];n&&(this._metrics[n]?(this._metrics[n].Value=(this._metrics[n].Value*this._metrics[n].Weight+t*r)/(this._metrics[n].Weight+r),this._metrics[n].Weight+=r):(this._metrics[n]=o.createQuickPulseMetric(e),this._metrics[n].Name=n,this._metrics[n].Weight=1))},e.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},e.prototype._goQuickPulse=function(){return r(this,void 0,void 0,(function(){var t,r,i,s,a=this;return n(this,(function(n){switch(n.label){case 0:return t=Object.keys(this._metrics).map((function(e){return a._metrics[e]})),r=o.createQuickPulseEnvelope(t,this._documents.slice(),this.config,this.context),this._resetQuickPulseBuffer(),this._isCollectingData?[4,this._post(r)]:[3,2];case 1:return n.sent(),[3,3];case 2:this._ping(r),n.label=3;case 3:return i=this._pollingIntervalHint>0?this._pollingIntervalHint:e.PING_INTERVAL,s=this._isCollectingData?e.POST_INTERVAL:i,this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,s=e.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(s=e.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),s),this._handle.unref(),[2]}}))}))},e.prototype._ping=function(e){this._sender.ping(e,this._redirectedHost,this._quickPulseDone.bind(this))},e.prototype._post=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,this._sender.post(e,this._redirectedHost,this._quickPulseDone.bind(this))];case 1:return t.sent(),[2]}}))}))},e.prototype._quickPulseDone=function(e,t,r,n){null!=e?(this._isCollectingData!==e&&(i.info("Live Metrics sending data",e),this.enableCollectors(e)),this._isCollectingData=e,r&&r.length>0&&(this._redirectedHost=r,i.info("Redirecting endpoint to: ",r)),n&&n>0&&(this._pollingIntervalHint=n),t&&t.statusCode<300&&t.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},e.MAX_POST_WAIT_TIME=2e4,e.MAX_PING_WAIT_TIME=6e4,e.FALLBACK_INTERVAL=6e4,e.PING_INTERVAL=5e3,e.POST_INTERVAL=1e3,e}();t.exports=u})),qn=v(((e,t)=>{"use strict";var r=En(),n=function(){function e(){}return e.parse=function(t){if(!t)return{};var n=t.split(e._FIELDS_SEPARATOR).reduce((function(t,r){var n=r.split(e._FIELD_KEY_VALUE_SEPARATOR);if(2===n.length){var i=n[0].toLowerCase(),o=n[1];t[i]=o}return t}),{});if(Object.keys(n).length>0){if(n.endpointsuffix){var i=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+i+"dc."+n.endpointsuffix,n.liveendpoint=n.liveendpoint||"https://"+i+"live."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||r.DEFAULT_BREEZE_ENDPOINT,n.liveendpoint=n.liveendpoint||r.DEFAULT_LIVEMETRICS_ENDPOINT}return n},e._FIELDS_SEPARATOR=";",e._FIELD_KEY_VALUE_SEPARATOR="=",e}();t.exports=n})),Hn=v(((e,t)=>{"use strict";var n=er(),i=qn(),o=(S(),En()),s=r(57310),a=function(){function e(t){var r=this;this.endpointBase=o.DEFAULT_BREEZE_ENDPOINT;var n=process.env[e.ENV_connectionString],a=i.parse(t),c=i.parse(n),u=!a.instrumentationkey&&Object.keys(a).length>0?null:t;this.instrumentationKey=a.instrumentationkey||u||c.instrumentationkey||e._getInstrumentationKey(),e._validateInstrumentationKey(this.instrumentationKey),this.endpointUrl=(a.ingestionendpoint||c.ingestionendpoint||this.endpointBase)+"/v2.1/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=3e4,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(e){return r.correlationId=e},this.proxyHttpUrl=process.env[e.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[e.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=a.ingestionendpoint||c.ingestionendpoint||process.env[e.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=a.liveendpoint||c.liveendpoint||process.env[e.ENV_quickPulseHost]||o.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=s.parse(this._quickPulseHost).host)}return Object.defineProperty(e.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(e){n.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=e,this.correlationId=n.correlationIdPrefix,n.queryCorrelationId(this,this.setCorrelationId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(e){this._quickPulseHost=e},enumerable:!1,configurable:!0}),e._getInstrumentationKey=function(){var t=process.env[e.ENV_iKey]||process.env[e.ENV_azurePrefix+e.ENV_iKey]||process.env[e.legacy_ENV_iKey]||process.env[e.ENV_azurePrefix+e.legacy_ENV_iKey];if(!t||""==t)throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return t},e._validateInstrumentationKey=function(e){return new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(e)},e.ENV_azurePrefix="APPSETTING_",e.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",e.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",e.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",e.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",e.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",e.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",e.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",e.ENV_http_proxy="http_proxy",e.ENV_https_proxy="https_proxy",e}();t.exports=a})),Wn=v((e=>{"use strict";var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.AutoCollectNativePerformance=void 0;var n=Hn(),i=On(),o=S(),s=function(){function e(t){this._disabledMetrics={},e.INSTANCE&&e.INSTANCE.dispose(),e.INSTANCE=this,this._client=t}return e.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>=6},e.prototype.enable=function(t,n,i){var s=this;if(void 0===n&&(n={}),void 0===i&&(i=6e4),e.isNodeVersionCompatible()){if(null==e._metricsAvailable&&t&&!this._isInitialized)try{var a=r(89166);e._emitter=new a,e._metricsAvailable=!0,o.info("Native metrics module successfully loaded!")}catch{return void(e._metricsAvailable=!1)}this._isEnabled=t,this._disabledMetrics=n,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&e._emitter?(e._emitter.enable(!0,i),this._handle||(this._handle=setInterval((function(){return s._trackNativeMetrics()}),i),this._handle.unref())):e._emitter&&(e._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},e.prototype.dispose=function(){this.enable(!1)},e.parseEnabled=function(e){var r=process.env[n.ENV_nativeMetricsDisableAll],i=process.env[n.ENV_nativeMetricsDisablers];if(r)return{isEnabled:!1,disabledMetrics:{}};if(i){var o=i.split(","),s={};if(o.length>0)for(var a=0,c=o;a<c.length;a++)s[c[a]]=!0;return"object"==typeof e?{isEnabled:!0,disabledMetrics:t(t({},e),s)}:{isEnabled:e,disabledMetrics:s}}return"boolean"==typeof e?{isEnabled:e,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:e}},e.prototype._trackNativeMetrics=function(){var e=!0;"object"!=typeof this._isEnabled&&(e=this._isEnabled),e&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},e.prototype._trackGarbageCollection=function(){var t;if(!this._disabledMetrics.gc){var r=e._emitter.getGCData();for(var n in r){var o=r[n].metrics,s=n+" Garbage Collection Duration",a=Math.sqrt(o.sumSquares/o.count-Math.pow(o.total/o.count,2))||0;this._client.trackMetric({name:s,value:o.total,count:o.count,max:o.max,min:o.min,stdDev:a,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+i.sdkVersion,t)})}}},e.prototype._trackEventLoop=function(){var t;if(!this._disabledMetrics.loop){var r=e._emitter.getLoopData().loopUsage;if(0!=r.count){var n=Math.sqrt(r.sumSquares/r.count-Math.pow(r.total/r.count,2))||0;this._client.trackMetric({name:"Event Loop CPU Time",value:r.total,count:r.count,min:r.min,max:r.max,stdDev:n,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+i.sdkVersion,t)})}}},e.prototype._trackHeapUsage=function(){var e,t,r;if(!this._disabledMetrics.heap){var n=process.memoryUsage(),o=n.heapUsed,s=n.heapTotal,a=n.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:o,count:1,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+i.sdkVersion,e)}),this._client.trackMetric({name:"Memory Total (Heap)",value:s,count:1,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+i.sdkVersion,t)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:a-s,count:1,tagOverrides:(r={},r[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+i.sdkVersion,r)})}},e}();e.AutoCollectNativePerformance=s})),zn=v(((e,t)=>{"use strict";var r=S(),n=function(){function e(e,t,r,n){this._buffer=[],this._lastSend=0,this._isDisabled=e,this._getBatchSize=t,this._getBatchIntervalMs=r,this._sender=n}return e.prototype.setUseDiskRetryCaching=function(e,t,r){this._sender.setDiskRetryMode(e,t,r)},e.prototype.send=function(e){var t=this;if(!this._isDisabled()){if(!e)return void r.warn("Cannot send null/undefined telemetry");if(this._buffer.push(e),this._buffer.length>=this._getBatchSize())return void this.triggerSend(!1);!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout((function(){t._timeoutHandle=null,t.triggerSend(!1)}),this._getBatchIntervalMs()))}},e.prototype.triggerSend=function(e,t){var r=this._buffer.length<1;r||(e?(this._sender.saveOnCrash(this._buffer),"function"==typeof t&&t("data saved on crash")):this._sender.send(this._buffer,t)),this._lastSend=+new Date,this._buffer=[],clearTimeout(this._timeoutHandle),this._timeoutHandle=null,r&&"function"==typeof t&&t("no data to send")},e}();t.exports=n})),Gn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.azureRoleEnvironmentTelemetryProcessor=void 0,e.azureRoleEnvironmentTelemetryProcessor=function(e,t){process.env.WEBSITE_SITE_NAME&&(e.tags[t.keys.cloudRole]=process.env.WEBSITE_SITE_NAME)}})),Kn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getSamplingHashCode=e.samplingTelemetryProcessor=void 0;var t=zr();function r(e){var t=2147483647,r=5381;if(!e)return 0;for(;e.length<8;)e+=e;for(var n=0;n<e.length;n++)r=((r<<5)+r|0)+e.charCodeAt(n)|0;return(r=r<=-2147483648?t:Math.abs(r))/t*100}e.samplingTelemetryProcessor=function(e,n){var i=e.sampleRate;return!!(null==i||i>=100||e.data&&t.TelemetryType.Metric===t.baseTypeToTelemetryType(e.data.baseType))||(n.correlationContext&&n.correlationContext.operation?r(n.correlationContext.operation.id)<i:100*Math.random()<i)},e.getSamplingHashCode=r})),Xn=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.performanceMetricsTelemetryProcessor=void 0;var t=Pn(),r=zr();e.performanceMetricsTelemetryProcessor=function(e,n){switch(n&&n.addDocument(e),e.data.baseType){case r.TelemetryTypeString.Exception:t.countException();break;case r.TelemetryTypeString.Request:var i=e.data.baseData;t.countRequest(i.duration,i.success);break;case r.TelemetryTypeString.Dependency:var o=e.data.baseData;t.countDependency(o.duration,o.success)}return!0}})),Jn=v((e=>{"use strict";var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.preAggregatedMetricsTelemetryProcessor=void 0;var r=zr(),n=In(),i=zr();e.preAggregatedMetricsTelemetryProcessor=function(e,o){if(n.isEnabled())switch(e.data.baseType){case i.TelemetryTypeString.Exception:var s=e.data.baseData;s.properties=t(t({},s.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Exceptions', Ver:'1.1')"});var a={cloudRoleInstance:e.tags[o.keys.cloudRoleInstance],cloudRoleName:e.tags[o.keys.cloudRole]};n.countException(a);break;case i.TelemetryTypeString.Trace:var c=e.data.baseData;c.properties=t(t({},c.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Traces', Ver:'1.1')"});var u={cloudRoleInstance:e.tags[o.keys.cloudRoleInstance],cloudRoleName:e.tags[o.keys.cloudRole],traceSeverityLevel:r.SeverityLevel[c.severity]};n.countTrace(u);break;case i.TelemetryTypeString.Request:var l=e.data.baseData;l.properties=t(t({},l.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Requests', Ver:'1.1')"});var d={cloudRoleInstance:e.tags[o.keys.cloudRoleInstance],cloudRoleName:e.tags[o.keys.cloudRole],operationSynthetic:e.tags[o.keys.operationSyntheticSource],requestSuccess:l.success,requestResultCode:l.responseCode};n.countRequest(l.duration,d);break;case i.TelemetryTypeString.Dependency:var p=e.data.baseData;p.properties=t(t({},p.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Dependencies', Ver:'1.1')"});var f={cloudRoleInstance:e.tags[o.keys.cloudRoleInstance],cloudRoleName:e.tags[o.keys.cloudRole],operationSynthetic:e.tags[o.keys.operationSyntheticSource],dependencySuccess:p.success,dependencyType:p.type,dependencyTarget:p.target,dependencyResultCode:p.resultCode};n.countDependency(p.duration,f)}return!0}})),Qn=v((e=>{"use strict";var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"!==n&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Gn(),e),r(Kn(),e),r(Xn(),e),r(Jn(),e)})),Yn=v(((e,t)=>{"use strict";var n=e&&e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=e&&e.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=r(57147),s=r(22037),a=r(71017),c=r(59796),u=r(32081),l=S(),d=Mn(),p=Zt(),f=function(){function e(t,r,n){if(this._redirectedHost=null,this._config=t,this._onSuccess=r,this._onError=n,this._enableDiskRetryMode=!1,this._resendInterval=e.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=e.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._numConsecutiveRedirects=0,this._resendTimer=null,this._fileCleanupTimer=null,this._tempDir=a.join(s.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey),!e.OS_PROVIDES_FILE_PROTECTION)if(e.USE_ICACLS){try{e.OS_PROVIDES_FILE_PROTECTION=o.existsSync(e.ICACLS_PATH)}catch{}e.OS_PROVIDES_FILE_PROTECTION||l.warn(e.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else e.OS_PROVIDES_FILE_PROTECTION=!0}return e.prototype.setDiskRetryMode=function(t,r,n){var i=this;this._enableDiskRetryMode=e.OS_PROVIDES_FILE_PROTECTION&&t,"number"==typeof r&&r>=0&&(this._resendInterval=Math.floor(r)),"number"==typeof n&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),t&&!e.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,l.warn(e.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected.")),this._enableDiskRetryMode?this._fileCleanupTimer||(this._fileCleanupTimer=setTimeout((function(){i._fileCleanupTask()}),e.CLEANUP_TIMEOUT),this._fileCleanupTimer.unref()):this._fileCleanupTimer&&clearTimeout(this._fileCleanupTimer)},e.prototype.send=function(t,r){return n(this,void 0,void 0,(function(){var n,o,s,a,u=this;return i(this,(function(i){return t&&(n=this._redirectedHost||this._config.endpointUrl,o={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}},s="",t.forEach((function(e){var t=u._stringify(e);"string"==typeof t&&(s+=t+"\n")})),s.length>0&&(s=s.substring(0,s.length-1)),a=Buffer.from?Buffer.from(s):new Buffer(s),c.gzip(a,(function(i,s){var c=s;i?(l.warn(i),c=a,o.headers["Content-Length"]=a.length.toString()):(o.headers["Content-Encoding"]="gzip",o.headers["Content-Length"]=s.length.toString()),l.info(e.TAG,o),o[d.disableCollectionRequestOption]=!0;var f=p.makeRequest(u._config,n,o,(function(n){n.setEncoding("utf-8");var i="";n.on("data",(function(e){i+=e})),n.on("end",(function(){if(u._numConsecutiveFailures=0,u._enableDiskRetryMode)if(200===n.statusCode)u._resendTimer||(u._resendTimer=setTimeout((function(){u._resendTimer=null,u._sendFirstFileOnDisk()}),u._resendInterval),u._resendTimer.unref());else if(u._isRetriable(n.statusCode))try{var o=JSON.parse(i),s=[];o.errors.forEach((function(e){u._isRetriable(e.statusCode)&&s.push(t[e.index])})),s.length>0&&u._storeToDisk(s)}catch{u._storeToDisk(t)}if(307===n.statusCode||308===n.statusCode)if(u._numConsecutiveRedirects++,u._numConsecutiveRedirects<10){var a=n.headers.location?n.headers.location.toString():null;a&&(u._redirectedHost=a,u.send(t,r))}else"function"==typeof r&&r("Error sending telemetry because of circular redirects.");else u._numConsecutiveRedirects=0,"function"==typeof r&&r(i),l.info(e.TAG,i),"function"==typeof u._onSuccess&&u._onSuccess(i)}))}));f.on("error",(function(n){if(u._numConsecutiveFailures++,!u._enableDiskRetryMode||u._numConsecutiveFailures>0&&u._numConsecutiveFailures%e.MAX_CONNECTION_FAILURES_BEFORE_WARN==0){var i="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";u._enableDiskRetryMode&&(i="Ingestion endpoint could not be reached "+u._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),l.warn(e.TAG,i,p.dumpObj(n))}else i="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:",l.info(e.TAG,i,p.dumpObj(n));u._onErrorHelper(n),"function"==typeof r&&(n&&r(p.dumpObj(n)),r("Error sending telemetry")),u._enableDiskRetryMode&&u._storeToDisk(t)})),f.write(c),f.end()}))),[2]}))}))},e.prototype.saveOnCrash=function(e){this._enableDiskRetryMode&&this._storeToDiskSync(this._stringify(e))},e.prototype._isRetriable=function(e){return 206===e||408===e||429===e||439===e||500===e||503===e},e.prototype._runICACLS=function(t,r){var n=u.spawn(e.ICACLS_PATH,t,{windowsHide:!0});n.on("error",(function(e){return r(e)})),n.on("close",(function(e,t){return r(0===e?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+e+")"))}))},e.prototype._runICACLSSync=function(t){if(!u.spawnSync)throw new Error("Could not synchronously call ICACLS under current version of Node.js");var r=u.spawnSync(e.ICACLS_PATH,t,{windowsHide:!0});if(r.error)throw r.error;if(0!==r.status)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")},e.prototype._getACLIdentity=function(t){if(e.ACL_IDENTITY)return t(null,e.ACL_IDENTITY);var r=u.spawn(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),n="";r.stdout.on("data",(function(e){return n+=e})),r.on("error",(function(e){return t(e,null)})),r.on("close",(function(r,i){return e.ACL_IDENTITY=n&&n.trim(),t(0===r?null:new Error("Getting ACL identity did not succeed (PS returned code "+r+")"),e.ACL_IDENTITY)}))},e.prototype._getACLIdentitySync=function(){if(e.ACL_IDENTITY)return e.ACL_IDENTITY;if(u.spawnSync){var t=u.spawnSync(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(t.error)throw t.error;if(0!==t.status)throw new Error("Getting ACL identity did not succeed (PS returned code "+t.status+")");return e.ACL_IDENTITY=t.stdout&&t.stdout.toString().trim(),e.ACL_IDENTITY}throw new Error("Could not synchronously get ACL identity under current version of Node.js")},e.prototype._getACLArguments=function(e,t){return[e,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",t+":(OI)(CI)F","/inheritance:r"]},e.prototype._applyACLRules=function(t,r){var n=this;return e.USE_ICACLS?void 0!==e.ACLED_DIRECTORIES[t]?r(e.ACLED_DIRECTORIES[t]?null:new Error("Setting ACL restrictions did not succeed (cached result)")):(e.ACLED_DIRECTORIES[t]=!1,void this._getACLIdentity((function(i,o){if(i)return e.ACLED_DIRECTORIES[t]=!1,r(i);n._runICACLS(n._getACLArguments(t,o),(function(n){return e.ACLED_DIRECTORIES[t]=!n,r(n)}))}))):r(null)},e.prototype._applyACLRulesSync=function(t){if(e.USE_ICACLS){if(void 0===e.ACLED_DIRECTORIES[t])return this._runICACLSSync(this._getACLArguments(t,this._getACLIdentitySync())),void(e.ACLED_DIRECTORIES[t]=!0);if(!e.ACLED_DIRECTORIES[t])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},e.prototype._confirmDirExists=function(e,t){var r=this;o.lstat(e,(function(n,i){n&&"ENOENT"===n.code?o.mkdir(e,(function(n){n&&"EEXIST"!==n.code?t(n):r._applyACLRules(e,t)})):!n&&i.isDirectory()?r._applyACLRules(e,t):t(n||new Error("Path existed but was not a directory"))}))},e.prototype._getShallowDirectorySize=function(e,t){o.readdir(e,(function(r,n){if(r)return t(r,-1);var i=null,s=0,c=0;if(0!==n.length)for(var u=0;u<n.length;u++)o.stat(a.join(e,n[u]),(function(e,r){c++,e?i=e:r.isFile()&&(s+=r.size),c===n.length&&t(i,i?-1:s)}));else t(null,0)}))},e.prototype._getShallowDirectorySizeSync=function(e){for(var t=o.readdirSync(e),r=0,n=0;n<t.length;n++)r+=o.statSync(a.join(e,t[n])).size;return r},e.prototype._storeToDisk=function(t){var r=this;l.info(e.TAG,"Checking existence of data storage directory: "+this._tempDir),this._confirmDirExists(this._tempDir,(function(n){if(n)return l.warn(e.TAG,"Error while checking/creating directory: "+(n&&n.message)),void r._onErrorHelper(n);r._getShallowDirectorySize(r._tempDir,(function(n,i){if(n||i<0)return l.warn(e.TAG,"Error while checking directory size: "+(n&&n.message)),void r._onErrorHelper(n);if(i>r._maxBytesOnDisk)l.warn(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+i);else{var s=(new Date).getTime()+".ai.json",c=a.join(r._tempDir,s);l.info(e.TAG,"saving data to disk at: "+c),o.writeFile(c,r._stringify(t),{mode:384},(function(e){return r._onErrorHelper(e)}))}}))}))},e.prototype._storeToDiskSync=function(t){try{l.info(e.TAG,"Checking existence of data storage directory: "+this._tempDir),o.existsSync(this._tempDir)||o.mkdirSync(this._tempDir),this._applyACLRulesSync(this._tempDir);var r=this._getShallowDirectorySizeSync(this._tempDir);if(r>this._maxBytesOnDisk)return void l.info(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+r);var n=(new Date).getTime()+".ai.json",i=a.join(this._tempDir,n);l.info(e.TAG,"saving data before crash to disk at: "+i),o.writeFileSync(i,t,{mode:384})}catch(t){l.warn(e.TAG,"Error while saving data to disk: "+(t&&t.message)),this._onErrorHelper(t)}},e.prototype._sendFirstFileOnDisk=function(){var e=this;o.exists(this._tempDir,(function(t){t&&o.readdir(e._tempDir,(function(t,r){if(t)e._onErrorHelper(t);else if((r=r.filter((function(e){return a.basename(e).indexOf(".ai.json")>-1}))).length>0){var n=r[0],i=a.join(e._tempDir,n);o.readFile(i,(function(t,r){t?e._onErrorHelper(t):o.unlink(i,(function(t){if(t)e._onErrorHelper(t);else try{var n=JSON.parse(r.toString());e.send(n)}catch(e){l.warn("Failed to read persisted file",e)}}))}))}}))}))},e.prototype._onErrorHelper=function(e){"function"==typeof this._onError&&this._onError(e)},e.prototype._stringify=function(e){try{return JSON.stringify(e)}catch(t){l.warn("Failed to serialize payload",t,e)}},e.prototype._fileCleanupTask=function(){var t=this;o.exists(this._tempDir,(function(r){r&&o.readdir(t._tempDir,(function(r,n){r?t._onErrorHelper(r):(n=n.filter((function(e){return a.basename(e).indexOf(".ai.json")>-1}))).length>0&&n.forEach((function(r){var n=new Date(parseInt(r.split(".ai.json")[0]));if(new Date(+new Date-e.FILE_RETEMPTION_PERIOD)>n){var i=a.join(t._tempDir,r);o.unlink(i,(function(e){e&&t._onErrorHelper(e)}))}}))}))}))},e.TAG="Sender",e.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",e.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",e.ACLED_DIRECTORIES={},e.ACL_IDENTITY=null,e.WAIT_BETWEEN_RESEND=6e4,e.MAX_BYTES_ON_DISK=52428800,e.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,e.CLEANUP_TIMEOUT=36e5,e.FILE_RETEMPTION_PERIOD=6048e5,e.TEMPDIR_PREFIX="appInsights-node",e.OS_PROVIDES_FILE_PROTECTION=!1,e.USE_ICACLS="Windows_NT"===s.type(),e}();t.exports=f})),Zn=v(((e,t)=>{"use strict";var r=zr(),n=Zt(),i=vn(),o=function(){function e(){}return e.createEnvelope=function(t,i,o,s,a){var c=null;switch(i){case r.TelemetryType.Trace:c=e.createTraceData(t);break;case r.TelemetryType.Dependency:c=e.createDependencyData(t);break;case r.TelemetryType.Event:c=e.createEventData(t);break;case r.TelemetryType.Exception:c=e.createExceptionData(t);break;case r.TelemetryType.Request:c=e.createRequestData(t);break;case r.TelemetryType.Metric:c=e.createMetricData(t);break;case r.TelemetryType.Availability:c=e.createAvailabilityData(t);break;case r.TelemetryType.PageView:c=e.createPageViewData(t)}if(o&&r.domainSupportsProperties(c.baseData)){if(c&&c.baseData)if(c.baseData.properties)for(var u in o)c.baseData.properties[u]||(c.baseData.properties[u]=o[u]);else c.baseData.properties=o;c.baseData.properties=n.validateStringMap(c.baseData.properties)}var l=a&&a.instrumentationKey||"",d=new r.Envelope;return d.data=c,d.iKey=l,d.name="Microsoft.ApplicationInsights."+l.replace(/-/g,"")+"."+c.baseType.substr(0,c.baseType.length-4),d.tags=this.getTags(s,t.tagOverrides),d.time=(new Date).toISOString(),d.ver=1,d.sampleRate=a?a.samplingPercentage:100,i===r.TelemetryType.Metric&&(d.sampleRate=100),d},e.createTraceData=function(e){var t=new r.MessageData;t.message=e.message,t.properties=e.properties,isNaN(e.severity)?t.severityLevel=r.SeverityLevel.Information:t.severityLevel=e.severity;var n=new r.Data;return n.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Trace),n.baseData=t,n},e.createDependencyData=function(e){var t=new r.RemoteDependencyData;"string"==typeof e.name&&(t.name=e.name.length>1024?e.name.slice(0,1021)+"...":e.name),t.data=e.data,t.target=e.target,t.duration=n.msToTimeSpan(e.duration),t.success=e.success,t.type=e.dependencyTypeName,t.properties=e.properties,t.resultCode=e.resultCode?e.resultCode+"":"",e.id?t.id=e.id:t.id=n.w3cTraceId();var i=new r.Data;return i.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Dependency),i.baseData=t,i},e.createEventData=function(e){var t=new r.EventData;t.name=e.name,t.properties=e.properties,t.measurements=e.measurements;var n=new r.Data;return n.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Event),n.baseData=t,n},e.createExceptionData=function(e){var t=new r.ExceptionData;t.properties=e.properties,isNaN(e.severity)?t.severityLevel=r.SeverityLevel.Error:t.severityLevel=e.severity,t.measurements=e.measurements,t.exceptions=[];var i=e.exception.stack,o=new r.ExceptionDetails;o.message=e.exception.message,o.typeName=e.exception.name,o.parsedStack=this.parseStack(i),o.hasFullStack=n.isArray(o.parsedStack)&&o.parsedStack.length>0,t.exceptions.push(o);var s=new r.Data;return s.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Exception),s.baseData=t,s},e.createRequestData=function(e){var t=new r.RequestData;e.id?t.id=e.id:t.id=n.w3cTraceId(),t.name=e.name,t.url=e.url,t.source=e.source,t.duration=n.msToTimeSpan(e.duration),t.responseCode=e.resultCode?e.resultCode+"":"",t.success=e.success,t.properties=e.properties;var i=new r.Data;return i.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Request),i.baseData=t,i},e.createMetricData=function(e){var t=new r.MetricData;t.metrics=[];var n=new r.DataPoint;n.count=isNaN(e.count)?1:e.count,n.kind=r.DataPointType.Aggregation,n.max=isNaN(e.max)?e.value:e.max,n.min=isNaN(e.min)?e.value:e.min,n.name=e.name,n.stdDev=isNaN(e.stdDev)?0:e.stdDev,n.value=e.value,t.metrics.push(n),t.properties=e.properties;var i=new r.Data;return i.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Metric),i.baseData=t,i},e.createAvailabilityData=function(e){var t=new r.AvailabilityData;e.id?t.id=e.id:t.id=n.w3cTraceId(),t.name=e.name,t.duration=n.msToTimeSpan(e.duration),t.success=e.success,t.runLocation=e.runLocation,t.message=e.message,t.measurements=e.measurements,t.properties=e.properties;var i=new r.Data;return i.baseType=r.telemetryTypeToBaseType(r.TelemetryType.Availability),i.baseData=t,i},e.createPageViewData=function(e){var t=new r.PageViewData;t.name=e.name,t.duration=n.msToTimeSpan(e.duration),t.url=e.url,t.measurements=e.measurements,t.properties=e.properties;var i=new r.Data;return i.baseType=r.telemetryTypeToBaseType(r.TelemetryType.PageView),i.baseData=t,i},e.getTags=function(e,t){var r=i.CorrelationContextManager.getCurrentContext(),n={};if(e&&e.tags)for(var o in e.tags)n[o]=e.tags[o];if(t)for(var o in t)n[o]=t[o];return r&&(n[e.keys.operationId]=n[e.keys.operationId]||r.operation.id,n[e.keys.operationName]=n[e.keys.operationName]||r.operation.name,n[e.keys.operationParentId]=n[e.keys.operationParentId]||r.operation.parentId),n},e.parseStack=function(e){var t=void 0;if("string"==typeof e){var r=e.split("\n");t=[];for(var n=0,i=0,o=0;o<=r.length;o++){var a=r[o];if(s.regex.test(a)){var c=new s(r[o],n++);i+=c.sizeInBytes,t.push(c)}}if(i>32768)for(var u=0,l=t.length-1,d=0,p=u,f=l;u<l;){if((d+=t[u].sizeInBytes+t[l].sizeInBytes)>32768){var h=f-p+1;t.splice(p,h);break}p=u,f=l,u++,l--}}return t},e}(),s=function(){function e(t,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=n.trim(t);var i=t.match(e.regex);i&&i.length>=5&&(this.method=n.trim(i[2])||this.method,this.fileName=n.trim(i[4])||"<no_filename>",this.line=parseInt(i[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=e.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return e.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,e.baseSize=58,e}();t.exports=o})),ei=v(((e,t)=>{"use strict";var n=r(57310),i=Hn(),o=On(),s=zr(),a=zn(),c=Qn(),u=vn(),l=Yn(),d=Zt(),p=S(),f=Zn(),h=function(){function e(e){this._telemetryProcessors=[],this._enableAzureProperties=!1;var t=new i(e);this.config=t,this.context=new o,this.commonProperties={};var r=new l(this.config);this.channel=new a((function(){return t.disableAppInsights}),(function(){return t.maxBatchSize}),(function(){return t.maxBatchIntervalMs}),r)}return e.prototype.trackAvailability=function(e){this.track(e,s.TelemetryType.Availability)},e.prototype.trackPageView=function(e){this.track(e,s.TelemetryType.PageView)},e.prototype.trackTrace=function(e){this.track(e,s.TelemetryType.Trace)},e.prototype.trackMetric=function(e){this.track(e,s.TelemetryType.Metric)},e.prototype.trackException=function(e){e&&e.exception&&!d.isError(e.exception)&&(e.exception=new Error(e.exception.toString())),this.track(e,s.TelemetryType.Exception)},e.prototype.trackEvent=function(e){this.track(e,s.TelemetryType.Event)},e.prototype.trackRequest=function(e){this.track(e,s.TelemetryType.Request)},e.prototype.trackDependency=function(e){e&&!e.target&&e.data&&(e.target=n.parse(e.data).host),this.track(e,s.TelemetryType.Dependency)},e.prototype.flush=function(e){this.channel.triggerSend(!!e&&!!e.isAppCrashing,e?e.callback:void 0)},e.prototype.track=function(e,t){if(e&&s.telemetryTypeToBaseType(t)){var r=f.createEnvelope(e,t,this.commonProperties,this.context,this.config);e.time&&(r.time=e.time.toISOString()),this._enableAzureProperties&&c.azureRoleEnvironmentTelemetryProcessor(r,this.context);var n=this.runTelemetryProcessors(r,e.contextObjects);n=n&&c.samplingTelemetryProcessor(r,{correlationContext:u.CorrelationContextManager.getCurrentContext()}),c.preAggregatedMetricsTelemetryProcessor(r,this.context),n&&(c.performanceMetricsTelemetryProcessor(r,this.quickPulseClient),this.channel.send(r))}else p.warn("track() requires telemetry object and telemetryType to be specified.")},e.prototype.setAutoPopulateAzureProperties=function(e){this._enableAzureProperties=e},e.prototype.addTelemetryProcessor=function(e){this._telemetryProcessors.push(e)},e.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},e.prototype.runTelemetryProcessors=function(e,t){var r=!0,n=this._telemetryProcessors.length;if(0===n)return r;(t=t||{}).correlationContext=u.CorrelationContextManager.getCurrentContext();for(var i=0;i<n;++i)try{var o=this._telemetryProcessors[i];if(o&&!1===o.apply(null,[e,t])){r=!1;break}}catch(t){r=!0,p.warn("One of telemetry processors failed, telemetry item will be sent.",t,e)}return r&&(e&&e.tags&&(e.tags=d.validateStringMap(e.tags)),e&&e.data&&e.data.baseData&&e.data.baseData.properties&&(e.data.baseData.properties=d.validateStringMap(e.data.baseData.properties))),r},e}();t.exports=h})),ti=v(((e,t)=>{"use strict";var r,n=e&&e.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=ei(),o=Fn(),s=Mn(),a=S(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.trackNodeHttpRequestSync=function(e){e&&e.request&&e.response&&e.duration?o.trackRequestSync(this,e):a.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},t.prototype.trackNodeHttpRequest=function(e){(e.duration||e.error)&&a.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),e&&e.request&&e.response?o.trackRequest(this,e):a.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},t.prototype.trackNodeHttpDependency=function(e){e&&e.request?s.trackRequest(this,e):a.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},t}(i);t.exports=c})),ri=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})})),ni=v((e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.Configuration=e.wrapWithCorrelationContext=e.startOperation=e.getCorrelationContext=e.start=e.setup=e.liveMetricsClient=e.defaultClient=e.DistributedTracingModes=void 0;var t,r,n=vn(),i=wn(),o=bn(),s=Pn(),a=In(),c=Ln(),u=Mn(),l=Fn(),d=er(),p=S(),f=$n(),h=Wn();e.TelemetryClient=ti(),e.Contracts=zr(),e.azureFunctionsTypes=ri(),(r=t=e.DistributedTracingModes||(e.DistributedTracingModes={}))[r.AI=0]="AI",r[r.AI_AND_W3C=1]="AI_AND_W3C";var g,m,v,y,_,w,b,E,P,T,C,I=!0,O=!1,x=!0,N=!0,k=!0,R=!1,A=!0,D=!0,j=!0,M=!0,L=!1,F=!0,U=void 0,B=void 0,V=!1;function $(){return e.defaultClient?(V=!0,v.enable(I,O),y.enable(x),_.enable(N),w.enable(k),b.enable(R,e.defaultClient.config),E.enable(F,m),P.useAutoCorrelation(M,g),P.enable(A),T.enable(D),e.liveMetricsClient&&L&&e.liveMetricsClient.enable(L)):p.warn("Start cannot be called before setup"),q}e.setup=function(t){return e.defaultClient?p.info("The default client is already setup"):(e.defaultClient=new e.TelemetryClient(t),v=new i(e.defaultClient),y=new o(e.defaultClient),_=new s(e.defaultClient),w=new a(e.defaultClient),b=new c(e.defaultClient),P=new l(e.defaultClient),T=new u(e.defaultClient),E||(E=new h.AutoCollectNativePerformance(e.defaultClient))),e.defaultClient&&e.defaultClient.channel&&e.defaultClient.channel.setUseDiskRetryCaching(j,U,B),q},e.start=$,e.getCorrelationContext=function(){return M?n.CorrelationContextManager.getCurrentContext():null},e.startOperation=function(e,t){return n.CorrelationContextManager.startOperation(e,t)},e.wrapWithCorrelationContext=function(e,t){return n.CorrelationContextManager.wrapCallback(e,t)};var q=function(){function r(){}return r.setDistributedTracingMode=function(e){return d.w3cEnabled=e===t.AI_AND_W3C,r},r.setAutoCollectConsole=function(e,t){return void 0===t&&(t=!1),I=e,O=t,V&&v.enable(e,t),r},r.setAutoCollectExceptions=function(e){return x=e,V&&y.enable(e),r},r.setAutoCollectPerformance=function(e,t){void 0===t&&(t=!0),N=e;var n=h.AutoCollectNativePerformance.parseEnabled(t);return F=n.isEnabled,m=n.disabledMetrics,V&&(_.enable(e),E.enable(n.isEnabled,n.disabledMetrics)),r},r.setAutoCollectPreAggregatedMetrics=function(e){return k=e,V&&w.enable(e),r},r.setAutoCollectHeartbeat=function(t){return R=t,V&&b.enable(t,e.defaultClient.config),r},r.setAutoCollectRequests=function(e){return A=e,V&&P.enable(e),r},r.setAutoCollectDependencies=function(e){return D=e,V&&T.enable(e),r},r.setAutoDependencyCorrelation=function(e,t){return M=e,g=t,V&&P.useAutoCorrelation(e,t),r},r.setUseDiskRetryCaching=function(t,n,i){return j=t,U=n,B=i,e.defaultClient&&e.defaultClient.channel&&e.defaultClient.channel.setUseDiskRetryCaching(t,n,i),r},r.setInternalLogging=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!0),p.enableDebug=e,p.disableWarnings=!t,r},r.setSendLiveMetrics=function(t){return void 0===t&&(t=!1),e.defaultClient?(!e.liveMetricsClient&&t?(e.liveMetricsClient=new f(e.defaultClient.config,null),C=new s(e.liveMetricsClient,1e3,!0),e.liveMetricsClient.addCollector(C),e.defaultClient.quickPulseClient=e.liveMetricsClient):e.liveMetricsClient&&e.liveMetricsClient.enable(t),L=t,r):(p.warn("Live metrics client cannot be setup without the default client"),r)},r.start=$,r}();e.Configuration=q,e.dispose=function(){d.w3cEnabled=!0,e.defaultClient=null,V=!1,v&&v.dispose(),y&&y.dispose(),_&&_.dispose(),w&&w.dispose(),b&&b.dispose(),E&&E.dispose(),P&&P.dispose(),T&&T.dispose(),e.liveMetricsClient&&(e.liveMetricsClient.enable(!1),L=!1,e.liveMetricsClient=void 0)}})),ii={};((e,t)=>{for(var r in t)o(e,r,{get:t[r],enumerable:!0})})(ii,{default:()=>li}),e.exports=(n=ii,y(o({},"__esModule",{value:!0}),n));var oi=_(r(22037)),si=_(r(89496)),ai=_(r(95687)),ci=class{constructor(e){this.vscodeAPI=e}getTelemetryLevel(){try{let e=this.vscodeAPI.env.telemetryConfiguration;return e.isUsageEnabled&&e.isErrorsEnabled&&e.isCrashEnabled?"on":e.isErrorsEnabled&&e.isCrashEnabled?"error":"off"}catch{return void 0!==this.vscodeAPI.env.isTelemetryEnabled?this.vscodeAPI.env.isTelemetryEnabled?"on":"off":this.vscodeAPI.workspace.getConfiguration("telemetry").get("enableTelemetry")?"on":"off"}}static applyReplacements(e,t){for(let r of Object.keys(e))for(let n of t)n.lookup.test(r)&&(void 0!==n.replacementString?e[r]=n.replacementString:delete e[r])}static shouldUseOneDataSystemSDK(e){return 74===e.length&&"-"===e[32]&&"-"===e[41]&&"-"===e[46]&&"-"===e[51]&&"-"===e[56]&&"-"===e[69]}static getInstance(e){return ci._instance||(ci._instance=new ci(e)),ci._instance}},ui=class{constructor(e,t,r,n,i,o){this.extensionId=e,this.extensionVersion=t,this.telemetryAppender=r,this.osShim=n,this.vscodeAPI=i,this.firstParty=!1,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this.firstParty=!!o,this.updateUserOptStatus(),void 0!==i.env.onDidChangeTelemetryEnabled?(this.disposables.push(i.env.onDidChangeTelemetryEnabled((()=>this.updateUserOptStatus()))),this.disposables.push(i.workspace.onDidChangeConfiguration((()=>this.updateUserOptStatus())))):this.disposables.push(i.workspace.onDidChangeConfiguration((()=>this.updateUserOptStatus())))}updateUserOptStatus(){let e=ci.getInstance(this.vscodeAPI).getTelemetryLevel();this.userOptIn="on"===e,this.errorOptIn="error"===e||this.userOptIn,(this.userOptIn||this.errorOptIn)&&this.telemetryAppender.instantiateAppender()}cleanRemoteName(e){if(!e)return"none";let t="other";return["ssh-remote","dev-container","attached-container","wsl","codespaces"].forEach((r=>{0===e.indexOf(`${r}`)&&(t=r)})),t}get extension(){return void 0===this._extension&&(this._extension=this.vscodeAPI.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(e,t){if(null===e||"object"!=typeof e||"function"!=typeof t)return e;let r={};for(let n in e)r[n]=t(n,e[n]);return r}shouldSendErrorTelemetry(){return!(!1===this.errorOptIn||this.firstParty&&this.vscodeAPI.env.remoteName&&"other"===this.cleanRemoteName(this.vscodeAPI.env.remoteName))}getCommonProperties(){let e={};if(e["common.os"]=this.osShim.platform,e["common.nodeArch"]=this.osShim.architecture,e["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),e["common.extname"]=this.extensionId,e["common.extversion"]=this.extensionVersion,this.vscodeAPI&&this.vscodeAPI.env){switch(e["common.vscodemachineid"]=this.vscodeAPI.env.machineId,e["common.vscodesessionid"]=this.vscodeAPI.env.sessionId,e["common.vscodeversion"]=this.vscodeAPI.version,e["common.isnewappinstall"]=this.vscodeAPI.env.isNewAppInstall?this.vscodeAPI.env.isNewAppInstall.toString():"false",e["common.product"]=this.vscodeAPI.env.appHost,this.vscodeAPI.env.uiKind){case this.vscodeAPI.UIKind.Web:e["common.uikind"]="web";break;case this.vscodeAPI.UIKind.Desktop:e["common.uikind"]="desktop";break;default:e["common.uikind"]="unknown"}e["common.remotename"]=this.cleanRemoteName(this.vscodeAPI.env.remoteName)}return e}anonymizeFilePaths(e,t){let r;if(null==e)return"";let n=[];""!==this.vscodeAPI.env.appRoot&&n.push(new RegExp(this.vscodeAPI.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")),this.extension&&n.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let i=e;if(t){let t=[];for(let i of n)for(;(r=i.exec(e))&&r;)t.push([r.index,i.lastIndex]);let o=/^[\\/]?(node_modules|node_modules\.asar)[\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-._]+(\\\\|\\|\/))+[\w-._]*/g,a=0;for(i="";(r=s.exec(e))&&r;)r[0]&&!o.test(r[0])&&t.every((([e,t])=>r.index<e||r.index>=t))&&(i+=e.substring(a,r.index)+"<REDACTED: user-file-path>",a=s.lastIndex);a<e.length&&(i+=e.substr(a))}for(let e of n)i=i.replace(e,"");return i}removePropertiesWithPossibleUserInfo(e){if("object"!=typeof e)return;let t={};for(let r of Object.keys(e)){let n=e[r];if(!n)continue;let i=/@[a-zA-Z0-9-.]+/,o=/xox[pbaors]-[a-zA-Z0-9]+-[a-zA-Z0-9-]+?/;/(key|token|sig|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/.test(n.toLowerCase())?t[r]="<REDACTED: secret>":i.test(n)?t[r]="<REDACTED: email>":o.test(n)?t[r]="<REDACTED: token>":t[r]=n}return t}get telemetryLevel(){switch(ci.getInstance(this.vscodeAPI).getTelemetryLevel()){case"on":return"all";case"error":return"error";case"off":return"off"}}internalSendTelemetryEvent(e,t,r,n,i){if((this.userOptIn||i)&&""!==e){if(t=g(g({},t),this.getCommonProperties()),n){let e=this.cloneAndChange(t,((e,t)=>this.anonymizeFilePaths(t,this.firstParty)));t=this.removePropertiesWithPossibleUserInfo(e)}t=t??{},r=r??{},e=`${this.extensionId}/${e}`,this.telemetryAppender.logEvent(e,{properties:t,measurements:r})}}sendTelemetryEvent(e,t,r){this.internalSendTelemetryEvent(e,t,r,!0,!1)}sendRawTelemetryEvent(e,t,r){this.internalSendTelemetryEvent(e,t,r,!1,!1)}sendDangerousTelemetryEvent(e,t,r,n=!0){this.telemetryAppender.instantiateAppender(),this.internalSendTelemetryEvent(e,t,r,n,!0)}internalSendTelemetryErrorEvent(e,t,r,n,i){if((this.shouldSendErrorTelemetry()||i)&&""!==e){if(t=g(g({},t),this.getCommonProperties()),n){let e=this.cloneAndChange(t,((e,t)=>this.anonymizeFilePaths(t,this.firstParty)));t=this.removePropertiesWithPossibleUserInfo(e)}t=t??{},r=r??{},e=`${this.extensionId}/${e}`,this.telemetryAppender.logEvent(e,{properties:t,measurements:r})}}sendTelemetryErrorEvent(e,t,r){this.internalSendTelemetryErrorEvent(e,t,r,!0,!1)}sendDangerousTelemetryErrorEvent(e,t,r,n=!0){this.telemetryAppender.instantiateAppender(),this.internalSendTelemetryErrorEvent(e,t,r,n,!0)}internalSendTelemetryException(e,t,r,n,i){if((this.shouldSendErrorTelemetry()||i)&&e){if(t=g(g({},t),this.getCommonProperties()),n){let r=this.cloneAndChange(t,((e,t)=>this.anonymizeFilePaths(t,this.firstParty)));e.stack&&(e.stack=this.anonymizeFilePaths(e.stack,this.firstParty)),t=this.removePropertiesWithPossibleUserInfo(r)}t=t??{},r=r??{},this.telemetryAppender.logException(e,{properties:t,measurements:r})}}sendTelemetryException(e,t,r){this.internalSendTelemetryException(e,t,r,!0,!1)}sendDangerousTelemetryException(e,t,r,n=!0){this.telemetryAppender.instantiateAppender(),this.internalSendTelemetryException(e,t,r,n,!0)}dispose(){return this.telemetryAppender.flush(),Promise.all(this.disposables.map((e=>e.dispose())))}},li=class extends ui{constructor(e,t,n,i,o){let s=e=>(async(e,t)=>{let r;try{process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL="1";let t=await Promise.resolve().then((()=>_(ni())));t.defaultClient?(r=new t.TelemetryClient(e),r.channel.setUseDiskRetryCaching(!0)):(t.setup(e).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setAutoCollectHeartbeat(!1).setUseDiskRetryCaching(!0).start(),r=t.defaultClient),si&&si.env&&(r.context.tags[r.context.keys.userId]=si.env.machineId,r.context.tags[r.context.keys.sessionId]=si.env.sessionId,r.context.tags[r.context.keys.cloudRole]=si.env.appName,r.context.tags[r.context.keys.cloudRoleInstance]=si.env.appName),e&&0===e.indexOf("AIF-")&&(r.config.endpointUrl="https://mobile.events.data.microsoft.com/collect/v1")}catch(e){return Promise.reject("Failed to initialize app insights!\n"+e.message)}return null!=t&&t.length&&function(e,t){e.addTelemetryProcessor((e=>(Array.isArray(e.tags)?e.tags.forEach((e=>ci.applyReplacements(e,t))):e.tags&&ci.applyReplacements(e.tags,t),e.data.baseData&&ci.applyReplacements(e.data.baseData,t),!0)))}(r,t),{logEvent:(e,t)=>{try{null==r||r.trackEvent({name:e,properties:null==t?void 0:t.properties,measurements:null==t?void 0:t.measurements})}catch(e){throw new Error("Failed to log event to app insights!\n"+e.message)}},logException:(e,t)=>{try{null==r||r.trackException({exception:e,properties:null==t?void 0:t.properties,measurements:null==t?void 0:t.measurements})}catch(e){throw new Error("Failed to log exception to app insights!\n"+e.message)}},flush:async()=>{try{null==r||r.flush()}catch(e){throw new Error("Failed to flush app insights!\n"+e.message)}}}})(e,o);ci.shouldUseOneDataSystemSDK(n)&&(s=e=>(async(e,t,n)=>{let i=await(async(e,t,n)=>{let i=await Promise.all([r.e(844),r.e(779)]).then(r.bind(r,50779)),o=await Promise.all([r.e(844),r.e(172)]).then(r.bind(r,21172)),s=new i.AppInsightsCore,a=new o.PostChannel,c={instrumentationKey:e,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[a]]};if(n){c.extensionConfig={};let e={alwaysUseXhrOverride:!0,httpXHROverride:n};c.extensionConfig[a.identifier]=e}let u=t.workspace.getConfiguration("telemetry").get("internalTesting");return s.initialize(c,[]),s.addTelemetryInitializer((e=>{!u||(e.ext=e.ext??{},e.ext.utc=e.ext.utc??{},e.ext.utc.flags=8462029)})),s})(e,t,n);return{logEvent:(e,t)=>{try{null==i||i.track({name:e,baseData:{name:e,properties:null==t?void 0:t.properties,measurements:null==t?void 0:t.measurements}})}catch(e){throw new Error("Failed to log event to app insights!\n"+e.message)}},logException:(e,t)=>{throw new Error("1DS SDK does not support logging exceptions, please use logEvent for exception tracking")},flush:async()=>{try{null==i||i.unload()}catch(e){throw new Error("Failed to flush app insights!\n"+e.message)}}}})(e,si,{sendPOST:(e,t)=>{let r={method:"POST",headers:m(g({},e.headers),{"Content-Type":"application/json","Content-Length":Buffer.byteLength(e.data)})};try{let n=ai.request(e.urlString,r,(e=>{e.on("data",(function(r){t(e.statusCode??200,e.headers,r.toString())})),e.on("error",(function(){t(0,{})}))}));n.write(e.data),n.end()}catch{t(0,{})}}}));let a=new class{constructor(e,t){this._instantiationStatus=0,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=t,this._key=e}logEvent(e,t){this._telemetryClient?this._telemetryClient.logEvent(e,t):2!==this._instantiationStatus&&this._eventQueue.push({eventName:e,data:t})}logException(e,t){this._telemetryClient?this._telemetryClient.logException(e,t):2!==this._instantiationStatus&&this._exceptionQueue.push({exception:e,data:t})}async flush(){this._telemetryClient&&(await this._telemetryClient.flush(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach((({eventName:e,data:t})=>this.logEvent(e,t))),this._eventQueue=[],this._exceptionQueue.forEach((({exception:e,data:t})=>this.logException(e,t))),this._exceptionQueue=[]}instantiateAppender(){0===this._instantiationStatus&&(this._instantiationStatus=1,this._clientFactory(this._key).then((e=>{this._telemetryClient=e,this._instantiationStatus=2,this._flushQueues()})).catch((e=>{console.error(e),this._instantiationStatus=2})))}}(n,s);n&&(0===n.indexOf("AIF-")||ci.shouldUseOneDataSystemSDK(n))&&(i=!0),super(e,t,a,{release:oi.release(),platform:oi.platform(),architecture:oi.arch()},si,i)}}},70852:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=70852,e.exports=t},41024:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=41024,e.exports=t},69183:(e,t,r)=>{"use strict";r.r(t),r.d(t,{NIL:()=>b,parse:()=>v,stringify:()=>d,v1:()=>m,v3:()=>_,v4:()=>S,v5:()=>w,validate:()=>u,version:()=>E});var n=r(6113),i=r.n(n);const o=new Uint8Array(256);let s=o.length;function a(){return s>o.length-16&&(i().randomFillSync(o),s=0),o.slice(s,s+=16)}const c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,u=function(e){return"string"==typeof e&&c.test(e)},l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).substr(1));const d=function(e,t=0){const r=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!u(r))throw TypeError("Stringified UUID is invalid");return r};let p,f,h=0,g=0;const m=function(e,t,r){let n=t&&r||0;const i=t||new Array(16);let o=(e=e||{}).node||p,s=void 0!==e.clockseq?e.clockseq:f;if(null==o||null==s){const t=e.random||(e.rng||a)();null==o&&(o=p=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==s&&(s=f=16383&(t[6]<<8|t[7]))}let c=void 0!==e.msecs?e.msecs:Date.now(),u=void 0!==e.nsecs?e.nsecs:g+1;const l=c-h+(u-g)/1e4;if(l<0&&void 0===e.clockseq&&(s=s+1&16383),(l<0||c>h)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=c,g=u,f=s,c+=122192928e5;const m=(1e4*(268435455&c)+u)%4294967296;i[n++]=m>>>24&255,i[n++]=m>>>16&255,i[n++]=m>>>8&255,i[n++]=255&m;const v=c/4294967296*1e4&268435455;i[n++]=v>>>8&255,i[n++]=255&v,i[n++]=v>>>24&15|16,i[n++]=v>>>16&255,i[n++]=s>>>8|128,i[n++]=255&s;for(let e=0;e<6;++e)i[n+e]=o[e];return t||d(i)},v=function(e){if(!u(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function y(e,t,r){function n(e,n,i,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=v(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let s=new Uint8Array(16+e.length);if(s.set(n),s.set(e,n.length),s=r(s),s[6]=15&s[6]|t,s[8]=63&s[8]|128,i){o=o||0;for(let e=0;e<16;++e)i[o+e]=s[e];return i}return d(s)}try{n.name=e}catch(e){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}const _=y("v3",48,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),i().createHash("md5").update(e).digest()})),S=function(e,t,r){const n=(e=e||{}).random||(e.rng||a)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return d(n)},w=y("v5",80,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),i().createHash("sha1").update(e).digest()})),b="00000000-0000-0000-0000-000000000000",E=function(e){if(!u(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},23870:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressType=t.ProgressToken=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.AbstractMessageBuffer=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.LRUCache=t.Touch=t.LinkedMap=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.Message=t.RAL=void 0,t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=void 0;const n=r(20839);Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return n.Message}}),Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return n.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return n.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return n.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return n.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return n.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return n.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return n.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return n.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return n.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return n.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return n.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return n.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return n.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return n.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return n.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return n.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return n.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return n.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return n.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return n.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return n.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return n.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return n.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return n.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return n.ParameterStructures}});const i=r(96184);Object.defineProperty(t,"LinkedMap",{enumerable:!0,get:function(){return i.LinkedMap}}),Object.defineProperty(t,"LRUCache",{enumerable:!0,get:function(){return i.LRUCache}}),Object.defineProperty(t,"Touch",{enumerable:!0,get:function(){return i.Touch}});const o=r(83911);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return o.Disposable}});const s=r(27135);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return s.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return s.Emitter}});const a=r(13881);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return a.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return a.CancellationToken}});const c=r(98211);Object.defineProperty(t,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return c.SharedArraySenderStrategy}}),Object.defineProperty(t,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return c.SharedArrayReceiverStrategy}});const u=r(56525);Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return u.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return u.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return u.ReadableStreamMessageReader}});const l=r(96654);Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return l.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return l.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return l.WriteableStreamMessageWriter}});const d=r(75530);Object.defineProperty(t,"AbstractMessageBuffer",{enumerable:!0,get:function(){return d.AbstractMessageBuffer}});const p=r(61343);Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return p.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return p.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return p.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return p.createMessageConnection}}),Object.defineProperty(t,"ProgressToken",{enumerable:!0,get:function(){return p.ProgressToken}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return p.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return p.Trace}}),Object.defineProperty(t,"TraceValues",{enumerable:!0,get:function(){return p.TraceValues}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return p.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return p.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return p.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return p.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return p.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return p.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return p.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return p.CancellationStrategy}}),Object.defineProperty(t,"MessageStrategy",{enumerable:!0,get:function(){return p.MessageStrategy}});const f=r(30147);t.RAL=f.default},13881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=t.CancellationToken=void 0;const n=r(30147),i=r(67574),o=r(27135);var s;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:o.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:o.Event.None}),e.is=function(t){const r=t;return r&&(r===e.None||r===e.Cancelled||i.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}}(s=t.CancellationToken||(t.CancellationToken={}));const a=Object.freeze((function(e,t){const r=(0,n.default)().timer.setTimeout(e.bind(t),0);return{dispose(){r.dispose()}}}));class c{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new o.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new c),this._token}cancel(){this._token?this._token.cancel():this._token=s.Cancelled}dispose(){this._token?this._token instanceof c&&this._token.dispose():this._token=s.None}}},61343:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.RequestCancellationReceiverStrategy=t.IdCancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=t.NullLogger=t.ProgressType=t.ProgressToken=void 0;const n=r(30147),i=r(67574),o=r(20839),s=r(96184),a=r(27135),c=r(13881);var u,l,d,p,f,h,g,m,v,y,_,S,w,b,E,P,T,C;!function(e){e.type=new o.NotificationType("$/cancelRequest")}(u||(u={})),function(e){e.is=function(e){return"string"==typeof e||"number"==typeof e}}(l=t.ProgressToken||(t.ProgressToken={})),function(e){e.type=new o.NotificationType("$/progress")}(d||(d={})),t.ProgressType=class{constructor(){}},function(e){e.is=function(e){return i.func(e)}}(p||(p={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Compact=2]="Compact",e[e.Verbose=3]="Verbose"}(f=t.Trace||(t.Trace={})),(C=t.TraceValues||(t.TraceValues={})).Off="off",C.Messages="messages",C.Compact="compact",C.Verbose="verbose",function(e){e.fromString=function(t){if(!i.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":default:return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}}(f=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return i.string(t)&&"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(h=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new o.NotificationType("$/setTrace")}(g=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new o.NotificationType("$/logTrace")}(m=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(v=t.ConnectionErrors||(t.ConnectionErrors={}));class I extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,I.prototype)}}t.ConnectionError=I,function(e){e.is=function(e){const t=e;return t&&i.func(t.cancelUndispatched)}}(y=t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e.is=function(e){const t=e;return t&&(void 0===t.kind||"id"===t.kind)&&i.func(t.createCancellationTokenSource)&&(void 0===t.dispose||i.func(t.dispose))}}(_=t.IdCancellationReceiverStrategy||(t.IdCancellationReceiverStrategy={})),function(e){e.is=function(e){const t=e;return t&&"request"===t.kind&&i.func(t.createCancellationTokenSource)&&(void 0===t.dispose||i.func(t.dispose))}}(S=t.RequestCancellationReceiverStrategy||(t.RequestCancellationReceiverStrategy={})),function(e){e.Message=Object.freeze({createCancellationTokenSource:e=>new c.CancellationTokenSource}),e.is=function(e){return _.is(e)||S.is(e)}}(w=t.CancellationReceiverStrategy||(t.CancellationReceiverStrategy={})),function(e){e.Message=Object.freeze({sendCancellation:(e,t)=>e.sendNotification(u.type,{id:t}),cleanup(e){}}),e.is=function(e){const t=e;return t&&i.func(t.sendCancellation)&&i.func(t.cleanup)}}(b=t.CancellationSenderStrategy||(t.CancellationSenderStrategy={})),function(e){e.Message=Object.freeze({receiver:w.Message,sender:b.Message}),e.is=function(e){const t=e;return t&&w.is(t.receiver)&&b.is(t.sender)}}(E=t.CancellationStrategy||(t.CancellationStrategy={})),function(e){e.is=function(e){const t=e;return t&&i.func(t.handleMessage)}}(P=t.MessageStrategy||(t.MessageStrategy={})),(t.ConnectionOptions||(t.ConnectionOptions={})).is=function(e){const t=e;return t&&(E.is(t.cancellationStrategy)||y.is(t.connectionStrategy)||P.is(t.messageStrategy))},function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(T||(T={})),t.createMessageConnection=function(e,r,y,S){const w=void 0!==y?y:t.NullLogger;let b=0,C=0,O=0;const x="2.0";let N;const k=new Map;let R;const A=new Map,D=new Map;let j,M,L=new s.LinkedMap,F=new Map,U=new Set,B=new Map,V=f.Off,$=h.Text,q=T.New;const H=new a.Emitter,W=new a.Emitter,z=new a.Emitter,G=new a.Emitter,K=new a.Emitter,X=S&&S.cancellationStrategy?S.cancellationStrategy:E.Message;function J(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function Q(e){}function Y(){return q===T.Listening}function Z(){return q===T.Closed}function ee(){return q===T.Disposed}function te(){q!==T.New&&q!==T.Listening||(q=T.Closed,W.fire(void 0))}function re(){j||0===L.size||(j=(0,n.default)().timer.setImmediate((()=>{j=void 0,function(){if(0===L.size)return;const e=L.shift();try{const t=S?.messageStrategy;P.is(t)?t.handleMessage(e,ne):ne(e)}finally{re()}}()})))}function ne(e){o.Message.isRequest(e)?function(e){if(ee())return;function t(t,n,i){const s={jsonrpc:x,id:e.id};t instanceof o.ResponseError?s.error=t.toJson():s.result=void 0===t?null:t,se(s,n,i),r.write(s).catch((()=>w.error("Sending response failed.")))}function n(t,n,i){const o={jsonrpc:x,id:e.id,error:t.toJson()};se(o,n,i),r.write(o).catch((()=>w.error("Sending response failed.")))}!function(e){if(V!==f.Off&&M)if($===h.Text){let t;V!==f.Verbose&&V!==f.Compact||!e.params||(t=`Params: ${oe(e.params)}\n\n`),M.log(`Received request '${e.method} - (${e.id})'.`,t)}else ce("receive-request",e)}(e);const s=k.get(e.method);let a,c;s&&(a=s.type,c=s.handler);const u=Date.now();if(c||N){const s=e.id??String(Date.now()),l=_.is(X.receiver)?X.receiver.createCancellationTokenSource(s):X.receiver.createCancellationTokenSource(e);null!==e.id&&U.has(e.id)&&l.cancel(),null!==e.id&&B.set(s,l);try{let d;if(c)if(void 0===e.params){if(void 0!==a&&0!==a.numberOfParams)return void n(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines ${a.numberOfParams} params but received none.`),e.method,u);d=c(l.token)}else if(Array.isArray(e.params)){if(void 0!==a&&a.parameterStructures===o.ParameterStructures.byName)return void n(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,u);d=c(...e.params,l.token)}else{if(void 0!==a&&a.parameterStructures===o.ParameterStructures.byPosition)return void n(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,u);d=c(e.params,l.token)}else N&&(d=N(e.method,e.params,l.token));const p=d;d?p.then?p.then((r=>{B.delete(s),t(r,e.method,u)}),(t=>{B.delete(s),t instanceof o.ResponseError?n(t,e.method,u):t&&i.string(t.message)?n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)})):(B.delete(s),t(d,e.method,u)):(B.delete(s),function(t,n,i){void 0===t&&(t=null);const o={jsonrpc:x,id:e.id,result:t};se(o,n,i),r.write(o).catch((()=>w.error("Sending response failed.")))}(d,e.method,u))}catch(r){B.delete(s),r instanceof o.ResponseError?t(r,e.method,u):r&&i.string(r.message)?n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${r.message}`),e.method,u):n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else n(new o.ResponseError(o.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,u)}(e):o.Message.isNotification(e)?function(e){if(ee())return;let t,r;if(e.method===u.type.method){const t=e.params.id;return U.delete(t),void ae(e)}{const n=A.get(e.method);n&&(r=n.handler,t=n.type)}if(r||R)try{if(ae(e),r)if(void 0===e.params)void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==o.ParameterStructures.byName&&w.error(`Notification ${e.method} defines ${t.numberOfParams} params but received none.`),r();else if(Array.isArray(e.params)){const n=e.params;e.method===d.type.method&&2===n.length&&l.is(n[0])?r({token:n[0],value:n[1]}):(void 0!==t&&(t.parameterStructures===o.ParameterStructures.byName&&w.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&w.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${n.length} arguments`)),r(...n))}else void 0!==t&&t.parameterStructures===o.ParameterStructures.byPosition&&w.error(`Notification ${e.method} defines parameters by position but received parameters by name`),r(e.params);else R&&R(e.method,e.params)}catch(t){t.message?w.error(`Notification handler '${e.method}' failed with message: ${t.message}`):w.error(`Notification handler '${e.method}' failed unexpectedly.`)}else z.fire(e)}(e):o.Message.isResponse(e)?function(e){if(!ee())if(null===e.id)e.error?w.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):w.error("Received response message without id. No further error information provided.");else{const t=e.id,r=F.get(t);if(function(e,t){if(V!==f.Off&&M)if($===h.Text){let r;if(V!==f.Verbose&&V!==f.Compact||(e.error&&e.error.data?r=`Error data: ${oe(e.error.data)}\n\n`:e.result?r=`Result: ${oe(e.result)}\n\n`:void 0===e.error&&(r="No result returned.\n\n")),t){const n=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";M.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${n}`,r)}else M.log(`Received response ${e.id} without active response promise.`,r)}else ce("receive-response",e)}(e,r),void 0!==r){F.delete(t);try{if(e.error){const t=e.error;r.reject(new o.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");r.resolve(e.result)}}catch(e){e.message?w.error(`Response handler '${r.method}' failed with message: ${e.message}`):w.error(`Response handler '${r.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void w.error("Received empty message.");w.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(i.string(t.id)||i.number(t.id)){const e=t.id,r=F.get(e);r&&r.reject(new Error("The received response has neither a result nor an error property."))}}(e)}e.onClose(te),e.onError((function(e){H.fire([e,void 0,void 0])})),r.onClose(te),r.onError((function(e){H.fire(e)}));const ie=e=>{try{if(o.Message.isNotification(e)&&e.method===u.type.method){const t=e.params.id,n=J(t),i=L.get(n);if(o.Message.isRequest(i)){const o=S?.connectionStrategy,s=o&&o.cancelUndispatched?o.cancelUndispatched(i,Q):void 0;if(s&&(void 0!==s.error||void 0!==s.result))return L.delete(n),B.delete(t),s.id=i.id,se(s,e.method,Date.now()),void r.write(s).catch((()=>w.error("Sending response for canceled message failed.")))}const s=B.get(t);if(void 0!==s)return s.cancel(),void ae(e);U.add(t)}!function(e,t){var r;o.Message.isRequest(t)?e.set(J(t.id),t):o.Message.isResponse(t)?e.set(null===(r=t.id)?"res-unknown-"+(++O).toString():"res-"+r.toString(),t):e.set("not-"+(++C).toString(),t)}(L,e)}finally{re()}};function oe(e){if(null!=e)switch(V){case f.Verbose:return JSON.stringify(e,null,4);case f.Compact:return JSON.stringify(e);default:return}}function se(e,t,r){if(V!==f.Off&&M)if($===h.Text){let n;V!==f.Verbose&&V!==f.Compact||(e.error&&e.error.data?n=`Error data: ${oe(e.error.data)}\n\n`:e.result?n=`Result: ${oe(e.result)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),M.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-r}ms`,n)}else ce("send-response",e)}function ae(e){if(V!==f.Off&&M&&e.method!==m.type.method)if($===h.Text){let t;V!==f.Verbose&&V!==f.Compact||(t=e.params?`Params: ${oe(e.params)}\n\n`:"No parameters provided.\n\n"),M.log(`Received notification '${e.method}'.`,t)}else ce("receive-notification",e)}function ce(e,t){if(!M||V===f.Off)return;const r={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};M.log(r)}function ue(){if(Z())throw new I(v.Closed,"Connection is closed.");if(ee())throw new I(v.Disposed,"Connection is disposed.")}function le(e){return void 0===e?null:e}function de(e){return null===e?void 0:e}function pe(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function fe(e,t){switch(e){case o.ParameterStructures.auto:return pe(t)?de(t):[le(t)];case o.ParameterStructures.byName:if(!pe(t))throw new Error("Received parameters by name but param is not an object literal.");return de(t);case o.ParameterStructures.byPosition:return[le(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function he(e,t){let r;const n=e.numberOfParams;switch(n){case 0:r=void 0;break;case 1:r=fe(e.parameterStructures,t[0]);break;default:r=[];for(let e=0;e<t.length&&e<n;e++)r.push(le(t[e]));if(t.length<n)for(let e=t.length;e<n;e++)r.push(null)}return r}const ge={sendNotification:(e,...t)=>{let n,s;if(ue(),i.string(e)){n=e;const r=t[0];let i=0,a=o.ParameterStructures.auto;o.ParameterStructures.is(r)&&(i=1,a=r);let c=t.length;const u=c-i;switch(u){case 0:s=void 0;break;case 1:s=fe(a,t[i]);break;default:if(a===o.ParameterStructures.byName)throw new Error(`Received ${u} parameters for 'by Name' notification parameter structure.`);s=t.slice(i,c).map((e=>le(e)))}}else{const r=t;n=e.method,s=he(e,r)}const a={jsonrpc:x,method:n,params:s};return function(e){if(V!==f.Off&&M)if($===h.Text){let t;V!==f.Verbose&&V!==f.Compact||(t=e.params?`Params: ${oe(e.params)}\n\n`:"No parameters provided.\n\n"),M.log(`Sending notification '${e.method}'.`,t)}else ce("send-notification",e)}(a),r.write(a).catch((e=>{throw w.error("Sending notification failed."),e}))},onNotification:(e,t)=>{let r;return ue(),i.func(e)?R=e:t&&(i.string(e)?(r=e,A.set(e,{type:void 0,handler:t})):(r=e.method,A.set(e.method,{type:e,handler:t}))),{dispose:()=>{void 0!==r?A.delete(r):R=void 0}}},onProgress:(e,t,r)=>{if(D.has(t))throw new Error(`Progress handler for token ${t} already registered`);return D.set(t,r),{dispose:()=>{D.delete(t)}}},sendProgress:(e,t,r)=>ge.sendNotification(d.type,{token:t,value:r}),onUnhandledProgress:G.event,sendRequest:(e,...t)=>{let n,s,a;if(ue(),function(){if(!Y())throw new Error("Call listen() first.")}(),i.string(e)){n=e;const r=t[0],i=t[t.length-1];let u=0,l=o.ParameterStructures.auto;o.ParameterStructures.is(r)&&(u=1,l=r);let d=t.length;c.CancellationToken.is(i)&&(d-=1,a=i);const p=d-u;switch(p){case 0:s=void 0;break;case 1:s=fe(l,t[u]);break;default:if(l===o.ParameterStructures.byName)throw new Error(`Received ${p} parameters for 'by Name' request parameter structure.`);s=t.slice(u,d).map((e=>le(e)))}}else{const r=t;n=e.method,s=he(e,r);const i=e.numberOfParams;a=c.CancellationToken.is(r[i])?r[i]:void 0}const u=b++;let l;a&&(l=a.onCancellationRequested((()=>{const e=X.sender.sendCancellation(ge,u);return void 0===e?(w.log(`Received no promise from cancellation strategy when cancelling id ${u}`),Promise.resolve()):e.catch((()=>{w.log(`Sending cancellation messages for id ${u} failed`)}))})));const d={jsonrpc:x,id:u,method:n,params:s};return function(e){if(V!==f.Off&&M)if($===h.Text){let t;V!==f.Verbose&&V!==f.Compact||!e.params||(t=`Params: ${oe(e.params)}\n\n`),M.log(`Sending request '${e.method} - (${e.id})'.`,t)}else ce("send-request",e)}(d),"function"==typeof X.sender.enableCancellation&&X.sender.enableCancellation(d),new Promise((async(e,t)=>{const i={method:n,timerStart:Date.now(),resolve:t=>{e(t),X.sender.cleanup(u),l?.dispose()},reject:e=>{t(e),X.sender.cleanup(u),l?.dispose()}};try{await r.write(d),F.set(u,i)}catch(e){throw w.error("Sending request failed."),i.reject(new o.ResponseError(o.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),e}}))},onRequest:(e,t)=>{ue();let r=null;return p.is(e)?(r=void 0,N=e):i.string(e)?(r=null,void 0!==t&&(r=e,k.set(e,{handler:t,type:void 0}))):void 0!==t&&(r=e.method,k.set(e.method,{type:e,handler:t})),{dispose:()=>{null!==r&&(void 0!==r?k.delete(r):N=void 0)}}},hasPendingResponse:()=>F.size>0,trace:async(e,t,r)=>{let n=!1,o=h.Text;void 0!==r&&(i.boolean(r)?n=r:(n=r.sendNotification||!1,o=r.traceFormat||h.Text)),V=e,$=o,M=V===f.Off?void 0:t,!n||Z()||ee()||await ge.sendNotification(g.type,{value:f.toString(e)})},onError:H.event,onClose:W.event,onUnhandledNotification:z.event,onDispose:K.event,end:()=>{r.end()},dispose:()=>{if(ee())return;q=T.Disposed,K.fire(void 0);const t=new o.ResponseError(o.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const e of F.values())e.reject(t);F=new Map,B=new Map,U=new Set,L=new s.LinkedMap,i.func(r.dispose)&&r.dispose(),i.func(e.dispose)&&e.dispose()},listen:()=>{ue(),function(){if(Y())throw new I(v.AlreadyListening,"Connection is already listening")}(),q=T.Listening,e.listen(ie)},inspect:()=>{(0,n.default)().console.log("inspect")}};return ge.onNotification(m.type,(e=>{if(V===f.Off||!M)return;const t=V===f.Verbose||V===f.Compact;M.log(e.message,t?e.verbose:void 0)})),ge.onNotification(d.type,(e=>{const t=D.get(e.token);t?t(e.value):G.fire(e)})),ge}},83911:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,(t.Disposable||(t.Disposable={})).create=function(e){return{dispose:e}}},27135:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Event=void 0;const n=r(30147);!function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class i{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let n=0,i=this._callbacks.length;n<i;n++)if(this._callbacks[n]===e){if(this._contexts[n]===t)return this._callbacks.splice(n,1),void this._contexts.splice(n,1);r=!0}if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,s=r.length;o<s;o++)try{t.push(r[o].apply(i[o],e))}catch(e){(0,n.default)().console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class o{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new i),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const n={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),n.dispose=o._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(n),n}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=o,o._noop=function(){}},67574:(e,t)=>{"use strict";function r(e){return"string"==typeof e||e instanceof String}function n(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=r,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=n,t.stringArray=function(e){return n(e)&&e.every((e=>r(e)))}},96184:(e,t)=>{"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.LinkedMap=t.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(n=t.Touch||(t.Touch={}));class i{constructor(){this[r]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=n.None){const r=this._map.get(e);if(r)return t!==n.None&&this.touch(r,t),r.value}set(e,t,r=n.None){let i=this._map.get(e);if(i)i.value=t,r!==n.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case n.None:this.addItemLast(i);break;case n.First:this.addItemFirst(i);break;case n.Last:default:this.addItemLast(i)}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const r=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.key,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return r}values(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.value,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return r}entries(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:[t.key,t.value],done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return r}[(r=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===n.First||t===n.Last)if(t===n.First){if(e===this._head)return;const t=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(t.previous=r,r.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===n.Last){if(e===this._tail)return;const t=e.next,r=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=r,r.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,r)=>{e.push([r,t])})),e}fromJSON(e){this.clear();for(const[t,r]of e)this.set(t,r)}}t.LinkedMap=i,t.LRUCache=class extends i{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=n.AsNew){return super.get(e,t)}peek(e){return super.get(e,n.None)}set(e,t){return super.set(e,t,n.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},75530:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessageBuffer=void 0,t.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(0===this._chunks.length)return;let t=0,r=0,n=0,i=0;e:for(;r<this._chunks.length;){const e=this._chunks[r];for(n=0;n<e.length;){switch(e[n]){case 13:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case 10:switch(t){case 1:t=2;break;case 3:t=4,n++;break e;default:t=0}break;default:t=0}n++}i+=e.byteLength,r++}if(4!==t)return;const o=this._read(i+n),s=new Map,a=this.toString(o,"ascii").split("\r\n");if(a.length<2)return s;for(let t=0;t<a.length-2;t++){const r=a[t],n=r.indexOf(":");if(-1===n)throw new Error("Message header must separate key and value using :");const i=r.substr(0,n),o=r.substr(n+1).trim();s.set(e?i.toLowerCase():i,o)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],r=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,r}const t=this.allocNative(e);let r=0;for(;e>0;){const n=this._chunks[0];if(n.byteLength>e){const i=n.slice(0,e);t.set(i,r),r+=e,this._chunks[0]=n.slice(e),this._totalLength-=e,e-=e}else t.set(n,r),r+=n.byteLength,this._chunks.shift(),this._totalLength-=n.byteLength,e-=n.byteLength}return t}}},56525:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const n=r(30147),i=r(67574),o=r(27135),s=r(80142);var a;(t.MessageReader||(t.MessageReader={})).is=function(e){let t=e;return t&&i.func(t.listen)&&i.func(t.dispose)&&i.func(t.onError)&&i.func(t.onClose)&&i.func(t.onPartialMessage)};class c{constructor(){this.errorEmitter=new o.Emitter,this.closeEmitter=new o.Emitter,this.partialMessageEmitter=new o.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${i.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=c,function(e){e.fromOptions=function(e){let t,r;const i=new Map;let o;const s=new Map;if(void 0===e||"string"==typeof e)t=e??"utf-8";else{if(t=e.charset??"utf-8",void 0!==e.contentDecoder&&(r=e.contentDecoder,i.set(r.name,r)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)i.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(o=e.contentTypeDecoder,s.set(o.name,o)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)s.set(t.name,t)}return void 0===o&&(o=(0,n.default)().applicationJson.decoder,s.set(o.name,o)),{charset:t,contentDecoder:r,contentDecoders:i,contentTypeDecoder:o,contentTypeDecoders:s}}}(a||(a={})),t.ReadableStreamMessageReader=class extends c{constructor(e,t){super(),this.readable=e,this.options=a.fromOptions(t),this.buffer=(0,n.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new s.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders(!0);if(!e)return;const t=e.get("content-length");if(!t)return void this.fireError(new Error("Header must provide a Content-Length property."));const r=parseInt(t);if(isNaN(r))return void this.fireError(new Error("Content-Length value must be a number."));this.nextMessageLength=r}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock((async()=>{const t=void 0!==this.options.contentDecoder?await this.options.contentDecoder.decode(e):e,r=await this.options.contentTypeDecoder.decode(t,this.options);this.callback(r)})).catch((e=>{this.fireError(e)}))}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=(0,n.default)().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}},96654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const n=r(30147),i=r(67574),o=r(80142),s=r(27135);var a;(t.MessageWriter||(t.MessageWriter={})).is=function(e){let t=e;return t&&i.func(t.dispose)&&i.func(t.onClose)&&i.func(t.onError)&&i.func(t.write)};class c{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${i.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=c,function(e){e.fromOptions=function(e){return void 0===e||"string"==typeof e?{charset:e??"utf-8",contentTypeEncoder:(0,n.default)().applicationJson.encoder}:{charset:e.charset??"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:e.contentTypeEncoder??(0,n.default)().applicationJson.encoder}}}(a||(a={})),t.WriteableStreamMessageWriter=class extends c{constructor(e,t){super(),this.writable=e,this.options=a.fromOptions(t),this.errorCount=0,this.writeSemaphore=new o.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const r=[];return r.push("Content-Length: ",t.byteLength.toString(),"\r\n"),r.push("\r\n"),this.doWrite(e,r,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}},20839:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Message=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const n=r(67574);var i,o;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=-32099,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.PendingResponseRejected=-32097,e.ConnectionInactive=-32096,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=-32e3}(i=t.ErrorCodes||(t.ErrorCodes={}));class s extends Error{constructor(e,t,r){super(t),this.code=n.number(e)?e:i.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,s.prototype)}toJson(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),e}}t.ResponseError=s;class a{constructor(e){this.kind=e}static is(e){return e===a.auto||e===a.byName||e===a.byPosition}toString(){return this.kind}}t.ParameterStructures=a,a.auto=new a("auto"),a.byPosition=new a("byPosition"),a.byName=new a("byName");class c{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return a.auto}}t.AbstractMessageSignature=c,t.RequestType0=class extends c{constructor(e){super(e,0)}},t.RequestType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType2=class extends c{constructor(e){super(e,2)}},t.RequestType3=class extends c{constructor(e){super(e,3)}},t.RequestType4=class extends c{constructor(e){super(e,4)}},t.RequestType5=class extends c{constructor(e){super(e,5)}},t.RequestType6=class extends c{constructor(e){super(e,6)}},t.RequestType7=class extends c{constructor(e){super(e,7)}},t.RequestType8=class extends c{constructor(e){super(e,8)}},t.RequestType9=class extends c{constructor(e){super(e,9)}},t.NotificationType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType0=class extends c{constructor(e){super(e,0)}},t.NotificationType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType2=class extends c{constructor(e){super(e,2)}},t.NotificationType3=class extends c{constructor(e){super(e,3)}},t.NotificationType4=class extends c{constructor(e){super(e,4)}},t.NotificationType5=class extends c{constructor(e){super(e,5)}},t.NotificationType6=class extends c{constructor(e){super(e,6)}},t.NotificationType7=class extends c{constructor(e){super(e,7)}},t.NotificationType8=class extends c{constructor(e){super(e,8)}},t.NotificationType9=class extends c{constructor(e){super(e,9)}},(o=t.Message||(t.Message={})).isRequest=function(e){const t=e;return t&&n.string(t.method)&&(n.string(t.id)||n.number(t.id))},o.isNotification=function(e){const t=e;return t&&n.string(t.method)&&void 0===e.id},o.isResponse=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(n.string(t.id)||n.number(t.id)||null===t.id)}},30147:(e,t)=>{"use strict";let r;function n(){if(void 0===r)throw new Error("No runtime abstraction layer installed");return r}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");r=e}}(n||(n={})),t.default=n},80142:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const n=r(30147);t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&(0,n.default)().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}},98211:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=void 0;const n=r(13881);var i;!function(e){e.Continue=0,e.Cancelled=1}(i||(i={})),t.SharedArraySenderStrategy=class{constructor(){this.buffers=new Map}enableCancellation(e){if(null===e.id)return;const t=new SharedArrayBuffer(4);new Int32Array(t,0,1)[0]=i.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){const r=this.buffers.get(t);if(void 0===r)return;const n=new Int32Array(r,0,1);Atomics.store(n,0,i.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};class o{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===i.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class s{constructor(e){this.token=new o(e)}cancel(){}dispose(){}}t.SharedArrayReceiverStrategy=class{constructor(){this.kind="request"}createCancellationTokenSource(e){const t=e.$cancellationData;return void 0===t?new n.CancellationTokenSource:new s(t)}}},74389:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.createServerSocketTransport=t.createClientSocketTransport=t.createServerPipeTransport=t.createClientPipeTransport=t.generateRandomPipeName=t.StreamMessageWriter=t.StreamMessageReader=t.SocketMessageWriter=t.SocketMessageReader=t.PortMessageWriter=t.PortMessageReader=t.IPCMessageWriter=t.IPCMessageReader=void 0;const o=r(23034);o.default.install();const s=r(71017),a=r(22037),c=r(6113),u=r(41808),l=r(23870);i(r(23870),t);class d extends l.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose()))}listen(e){return this.process.on("message",e),l.Disposable.create((()=>this.process.off("message",e)))}}t.IPCMessageReader=d;class p extends l.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;const t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose))}write(e){try{return"function"==typeof this.process.send&&this.process.send(e,void 0,void 0,(t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0})),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.IPCMessageWriter=p;class f extends l.AbstractMessageReader{constructor(e){super(),this.onData=new l.Emitter,e.on("close",(()=>this.fireClose)),e.on("error",(e=>this.fireError(e))),e.on("message",(e=>{this.onData.fire(e)}))}listen(e){return this.onData.event(e)}}t.PortMessageReader=f;class h extends l.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",(()=>this.fireClose())),e.on("error",(e=>this.fireError(e)))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.PortMessageWriter=h;class g extends l.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,o.default)().stream.asReadableStream(e),t)}}t.SocketMessageReader=g;class m extends l.WriteableStreamMessageWriter{constructor(e,t){super((0,o.default)().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}}t.SocketMessageWriter=m;class v extends l.ReadableStreamMessageReader{constructor(e,t){super((0,o.default)().stream.asReadableStream(e),t)}}t.StreamMessageReader=v;class y extends l.WriteableStreamMessageWriter{constructor(e,t){super((0,o.default)().stream.asWritableStream(e),t)}}t.StreamMessageWriter=y;const _=process.env.XDG_RUNTIME_DIR,S=new Map([["linux",107],["darwin",103]]);t.generateRandomPipeName=function(){const e=(0,c.randomBytes)(21).toString("hex");if("win32"===process.platform)return`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`;let t;t=_?s.join(_,`vscode-ipc-${e}.sock`):s.join(a.tmpdir(),`vscode-${e}.sock`);const r=S.get(process.platform);return void 0!==r&&t.length>r&&(0,o.default)().console.warn(`WARNING: IPC handle "${t}" is longer than ${r} characters.`),t},t.createClientPipeTransport=function(e,t="utf-8"){let r;const n=new Promise(((e,t)=>{r=e}));return new Promise(((i,o)=>{let s=(0,u.createServer)((e=>{s.close(),r([new g(e,t),new m(e,t)])}));s.on("error",o),s.listen(e,(()=>{s.removeListener("error",o),i({onConnected:()=>n})}))}))},t.createServerPipeTransport=function(e,t="utf-8"){const r=(0,u.createConnection)(e);return[new g(r,t),new m(r,t)]},t.createClientSocketTransport=function(e,t="utf-8"){let r;const n=new Promise(((e,t)=>{r=e}));return new Promise(((i,o)=>{const s=(0,u.createServer)((e=>{s.close(),r([new g(e,t),new m(e,t)])}));s.on("error",o),s.listen(e,"127.0.0.1",(()=>{s.removeListener("error",o),i({onConnected:()=>n})}))}))},t.createServerSocketTransport=function(e,t="utf-8"){const r=(0,u.createConnection)(e,"127.0.0.1");return[new g(r,t),new m(r,t)]},t.createMessageConnection=function(e,t,r,n){r||(r=l.NullLogger);const i=function(e){const t=e;return void 0!==t.read&&void 0!==t.addListener}(e)?new v(e):e,o=function(e){const t=e;return void 0!==t.write&&void 0!==t.addListener}(t)?new y(t):t;return l.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),(0,l.createMessageConnection)(i,o,r,n)}},23034:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(73837),i=r(23870);class o extends i.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return o.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new n.TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}}o.emptyBuffer=Buffer.allocUnsafe(0);class s{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),i.Disposable.create((()=>this.stream.off("close",e)))}onError(e){return this.stream.on("error",e),i.Disposable.create((()=>this.stream.off("error",e)))}onEnd(e){return this.stream.on("end",e),i.Disposable.create((()=>this.stream.off("end",e)))}onData(e){return this.stream.on("data",e),i.Disposable.create((()=>this.stream.off("data",e)))}}class a{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),i.Disposable.create((()=>this.stream.off("close",e)))}onError(e){return this.stream.on("error",e),i.Disposable.create((()=>this.stream.off("error",e)))}onEnd(e){return this.stream.on("end",e),i.Disposable.create((()=>this.stream.off("end",e)))}write(e,t){return new Promise(((r,n)=>{const i=e=>{null==e?r():n(e)};"string"==typeof e?this.stream.write(e,t,i):this.stream.write(e,i)}))}end(){this.stream.end()}}const c=Object.freeze({messageBuffer:Object.freeze({create:e=>new o(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(e,void 0,0),t.charset))}catch(e){return Promise.reject(e)}}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{try{return e instanceof Buffer?Promise.resolve(JSON.parse(e.toString(t.charset))):Promise.resolve(JSON.parse(new n.TextDecoder(t.charset).decode(e)))}catch(e){return Promise.reject(e)}}})}),stream:Object.freeze({asReadableStream:e=>new s(e),asWritableStream:e=>new a(e)}),console,timer:Object.freeze({setTimeout(e,t,...r){const n=setTimeout(e,t,...r);return{dispose:()=>clearTimeout(n)}},setImmediate(e,...t){const r=setImmediate(e,...t);return{dispose:()=>clearImmediate(r)}},setInterval(e,t,...r){const n=setInterval(e,t,...r);return{dispose:()=>clearInterval(n)}}})});function u(){return c}!function(e){e.install=function(){i.RAL.install(c)}}(u||(u={})),t.default=u},95028:(e,t,r)=>{"use strict";e.exports=r(74389)},69279:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DOTNET67_OUT_OF_SUPPORT_MD_PATH=t.GITHUB_BUG_2266_DISABLE_SOLUTION_URL=t.NET_SDK_CSFILE_DEBUG_SUPPORT=t.AZUREFUNCTION_EXTENSION_API_REQUIRED_VERSION=t.AZUREFUNCTION_EXTENSION_REQUIRED_VERSION=t.AZUREFUNCTION_EXTENSION_ID=t.MAUI_WORKLOAD_URL=t.MAUI_EXTENSION_URL=t.MAUI_EXTENSION_ID=t.NET_SDK_VERSION_SUPPORTING_SLNX=t.NET_SDK_MIMIMUM_SUPPORTED_VERSION=t.NET_SDK_SUPPORTED_PREVIEW_RUNTIME_MIN_VERSION=t.NET_RUNTIME_VERSION_PATCH=t.NET_RUNTIME_VERSION=t.CSHARP_EXTENSION_TERMINATE_ASPIRE_REQUIRED_VERSION=t.CSHARP_EXTENSION_AZ_FUNCTIONS_REQUIRED_VERSION=t.CSHARP_EXTENSION_BLAZORWASM_REQUIRED_VERSION=t.CSHARP_EXTENSION_SUPPORTS_DEFERRAL_VERSION=t.CSHARP_EXTENSION_REQUIRED_VERSION=t.CSHARP_EXTENSION_ID=t.LICENSE_URL=t.EXTENSION_ID=void 0,t.EXTENSION_ID="ms-dotnettools.csdevkit",t.LICENSE_URL="https://aka.ms/vs/csdevkit/license",t.CSHARP_EXTENSION_ID="ms-dotnettools.csharp",t.CSHARP_EXTENSION_REQUIRED_VERSION="2.0.0",t.CSHARP_EXTENSION_SUPPORTS_DEFERRAL_VERSION="2.4.0",t.CSHARP_EXTENSION_BLAZORWASM_REQUIRED_VERSION="2.0.2",t.CSHARP_EXTENSION_AZ_FUNCTIONS_REQUIRED_VERSION="2.55.0",t.CSHARP_EXTENSION_TERMINATE_ASPIRE_REQUIRED_VERSION="2.87.0",t.NET_RUNTIME_VERSION="9.0",t.NET_RUNTIME_VERSION_PATCH="2",t.NET_SDK_SUPPORTED_PREVIEW_RUNTIME_MIN_VERSION="9.0.200",t.NET_SDK_MIMIMUM_SUPPORTED_VERSION="6.0",t.NET_SDK_VERSION_SUPPORTING_SLNX="9.0.200",t.MAUI_EXTENSION_ID="ms-dotnettools.dotnet-maui",t.MAUI_EXTENSION_URL="https://marketplace.visualstudio.com/items?itemName=ms-dotnettools.dotnet-maui",t.MAUI_WORKLOAD_URL="https://learn.microsoft.com/dotnet/maui/get-started/installation?tabs=visual-studio-code#install-net-and-net-maui-workloads",t.AZUREFUNCTION_EXTENSION_ID="ms-azuretools.vscode-azurefunctions",t.AZUREFUNCTION_EXTENSION_REQUIRED_VERSION="1.15.5",t.AZUREFUNCTION_EXTENSION_API_REQUIRED_VERSION="^1.10.0",t.NET_SDK_CSFILE_DEBUG_SUPPORT="10.0.0",t.GITHUB_BUG_2266_DISABLE_SOLUTION_URL="https://github.com/microsoft/vscode-dotnettools/issues/2266#issuecomment-3373048619",t.DOTNET67_OUT_OF_SUPPORT_MD_PATH="contents/Retiring-dotnet67-sdk-support.md"},76051:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomBuildTaskTerminal=void 0;const n=r(89496),i=r(32081),o=r(88242),s=r(22037),a=r(41062),c=r(7195);t.CustomBuildTaskTerminal=class{command;args;cwd;dotnetTaskDefinition;writeEmitter=new n.EventEmitter;onDidWrite=this.writeEmitter.event;closeEmitter=new n.EventEmitter;onDidClose=this.closeEmitter.event;constructor(e,t,r,n){this.command=e,this.args=t,this.cwd=r,this.dotnetTaskDefinition=n}async open(e){const t=this.dotnetTaskDefinition.file;if(this.dotnetTaskDefinition.rejoinAspireSession){c.logger.log("Aspire session rejoin is enabled.");const e=(await(0,a.queryActiveAspireSessionsAsync)()).filter((e=>e.projectInfo?.projectPath?.toLowerCase()===t?.toLowerCase()));await(0,a.stopAspireSessionsAsync)(e);const r=await this.executeBuild();await(0,a.rejoinAspireSessionsAsync)(e),this.closeEmitter.fire(r??1)}else{const e=await this.executeBuild();this.closeEmitter.fire(e??1)}}close(){}async executeBuild(){let e="dotnet "+this.args.join(" ");this.writeEmitter.fire(e+" \r\n"),this.writeEmitter.fire("C# extension build result service is available.\r\n"),(0,o.startBuildResultServiceAsync)();let t="",r="";return new Promise((e=>{const s=i.spawn(this.command,this.args,{cwd:this.cwd,env:{...process.env,DOTNET_CLI_UI_LANGUAGE:n.env.language}});s.stdout.on("data",(e=>{t=t.concat(e);let r=this.formatResult(e);this.writeEmitter.fire(r)})),s.stderr.on("data",(e=>{r=r.concat(e);let t=this.formatResult(e);this.writeEmitter.fire(t)})),s.on("close",(r=>{(0,o.reportBuildResultsToCSharpExtension)(t),e(r??1)})),s.on("error",(t=>{console.log(`child process exited with code ${t}`),e(1)}))}))}formatResult(e){return e.toString().replaceAll(s.EOL,"\n\r")}}},49397:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dotnetSolutionBuildActionUsingTask=t.getAllAspireAppHostProjects=t.getAllProjects=t.getOpenedWorkspaceHelper=t.DotnetTaskProvider=void 0;const n=r(89496),i=r(65300),o=r(20695),s=r(7195),a=r(73228),c=r(76051),u=r(88242),l="watch",d="rebuild",p="--no-incremental",f="AnyCPU",h="Any CPU";class g{static dotnetType="dotnet";cachedTasks=void 0;cachedTasksNames=new Set;lastOpenedSolution=void 0;autoDetect=m.on;constructor(){n.workspace.onDidChangeConfiguration(this.onConfigurationChanged,this),this.onConfigurationChanged()}async provideTasks(){if(this.autoDetect===m.off)return;const e=await(0,i.getOpenedSolution)();if(this.lastOpenedSolution!==e){this.lastOpenedSolution=e,this.cachedTasks=await async function(){const e=n.workspace.workspaceFolders,t=[];if(!e||0===e.length)return t;const r=await(0,i.getOpenedSolution)(),s=_();if(r&&s){const e=await v(s,o.BUILD,r,{taskGroup:n.TaskGroup.Build,persistFilePath:!1,rejoinAspireSession:!1});e&&t.push(e);const i=await v(s,o.CLEAN,r,{taskGroup:n.TaskGroup.Clean,persistFilePath:!1,rejoinAspireSession:!1});i&&t.push(i);const a=await S();a&&a.forEach((async e=>{const r=await v(s,`${l} ${e.Name}`,e.Path,{action:l,rejoinAspireSession:!1});r&&t.push(r)}))}return t}(),this.cachedTasksNames.clear();for(const e of this.cachedTasks)this.cachedTasksNames.add(e.name)}return this.cachedTasks}async resolveTask(e){if(e.definition.task){const t=e.definition;if(t.task.startsWith(l)&&t.file)return v(e.scope??n.TaskScope.Workspace,e.name,t.file,{taskGroup:e.group,action:l,persistFilePath:!0,taskDefinition:t,rejoinAspireSession:!1});if(t.task.startsWith(o.BUILD)||t.task.startsWith(o.CLEAN)||t.task.startsWith(d)){const r=await(0,i.getOpenedSolution)(),o=_();if(r&&o){const i=t?.file??r;return v(e.scope??n.TaskScope.Workspace,e.name,i,{taskGroup:e.group,persistFilePath:!1,taskDefinition:t})}}}}onConfigurationChanged(){const e=n.workspace.getConfiguration("dotnet").get("autoDetect");this.autoDetect=void 0===e?m.on:e}cacheNewTask(e){if(e.definition.type!==g.dotnetType)throw new Error(`Error: Trying to cache a task that is not ${g.dotnetType}. Actual type ${e.definition.type}`);this.cachedTasks?this.cachedTasksNames.has(e.name)||(this.cachedTasksNames.add(e.name),this.cachedTasks.push(e)):(this.cachedTasksNames.add(e.name),this.cachedTasks=[e])}}var m;async function v(e,t,r,i){var a;if(i.action)a=i.action;else switch(i.taskGroup?.id){case n.TaskGroup.Build.id:case n.TaskGroup.Rebuild.id:a=o.BUILD;break;case n.TaskGroup.Clean.id:a=o.CLEAN;break;default:return}const l=await(0,u.isCSharpExtensionBuildResultServiceAvailable)(),d=i?.taskDefinition??{type:g.dotnetType,task:t,file:i.persistFilePath??1?r:void 0,rejoinAspireSession:i.rejoinAspireSession},p=_();if(!p)return void s.logger.log("Cannot find the current workspace folder. The build operation is aborted.");let f;if(l){const o=new n.CustomExecution((async e=>{const t=e.file??r,n=await y(t,a,i.taskGroup,i.projectTarget);return new c.CustomBuildTaskTerminal(s.dotnetSdkPath??"dotnet",n,p.uri.fsPath,{rejoinAspireSession:i.rejoinAspireSession,...e})}));f=new n.Task(d,e,t,"dotnet",o)}else{s.logger.log("Microsoft.VisualStudio.CSharpExtension.BuildResultService not found.");const o={env:{DOTNET_CLI_UI_LANGUAGE:n.env.language},cwd:p.uri.fsPath},c=await y(r,a,i.taskGroup,i.projectTarget),u=new n.ProcessExecution(s.dotnetSdkPath??"dotnet",c,o);f=new n.Task(d,e,t,"dotnet",u),f.problemMatchers=["$msCompile"]}return f.group=i.taskGroup,f}async function y(e,t,r,o){let c;const u=function(){const e=s.environmentStateManager?.getLatestEnvironmentState()?.configuration;if("string"!=typeof e)return{configurationName:void 0,platformName:void 0};const t=e.split("|",2);return{configurationName:t[0]||void 0,platformName:t[1]||void 0}}(),d=u.platformName?(g=u.platformName)===h?f:g:void 0;var g;if(t===l)c=[t,"--project",e];else if((r?.id===n.TaskGroup.Rebuild.id||r?.id===n.TaskGroup.Build.id)&&(0,a.endsWithInvariantIgnoreCase)(e,".csproj")&&o){const s=await(0,i.getOpenedSolution)();r?.id===n.TaskGroup.Rebuild.id&&(o+=":rebuild"),c=s?[t,s,o,"/property:GenerateFullPaths=true"]:[t,e,p,"/property:GenerateFullPaths=true"],u.configurationName&&c.push(`/p:Configuration=${u.configurationName}`);const a=s?u.platformName:d;a&&c.push(`/p:Platform="${a}"`)}else if(c=r?.id===n.TaskGroup.Rebuild.id?[t,e,p,"/property:GenerateFullPaths=true"]:[t,e,"/property:GenerateFullPaths=true"],r?.id===n.TaskGroup.Rebuild.id||r?.id===n.TaskGroup.Build.id||r?.id===n.TaskGroup.Clean.id){u.configurationName&&c.push(`/p:Configuration=${u.configurationName}`);const t=(0,a.endsWithInvariantIgnoreCase)(e,".csproj")||(0,a.endsWithInvariantIgnoreCase)(e,".cs")?d:u.platformName;t&&c.push(`/p:Platform=${t}`)}return(0,a.endsWithInvariantIgnoreCase)(e,".cs")||c.push("/consoleloggerparameters:NoSummary"),c}function _(){if(n.workspace.workspaceFolders&&n.workspace.workspaceFolders.length>=1)return s.environmentStateManager?.getActiveWorkspace()}async function S(){const e={context:"Projects",query:{$properties:["Name","Path","Guid"],$filter:{ProjectsByCapabilities:["!SharedAssetsProject"]}}};return await s.logger.watch("Query for all projects",(async()=>{const t=await s.projectQueryableSpace.executeQuery(e),r=[];return t&&t.Items?.forEach((e=>{e&&r.push(e)})),r}),{catchUnhandledErrors:!0})}async function w(){const e={context:"Projects",query:{$properties:["Name","Path"],$filter:{ProjectsByCapabilities:["Aspire | AspireOrchestration"]}}};return await s.logger.watch("Query for Aspire AppHost projects",(async()=>{const t=await s.projectQueryableSpace.executeQuery(e),r=[];return t&&t.Items?.forEach((e=>{e&&r.push(e)})),r}),{catchUnhandledErrors:!0})}t.DotnetTaskProvider=g,function(e){e.on="on",e.off="off"}(m||(m={})),t.getOpenedWorkspaceHelper=_,t.getAllProjects=S,t.getAllAspireAppHostProjects=w,t.dotnetSolutionBuildActionUsingTask=async function(e,t,r,a,c){const u=n.workspace.workspaceFolders;if(!u||0===u.length||!u[0])return{success:Promise.resolve(!1)};var l=void 0,p=e;e===o.BUILD?r?(l=n.TaskGroup.Rebuild,p=d):l=n.TaskGroup.Build:e===o.CLEAN&&(l=n.TaskGroup.Clean);var f=void 0;const h=t.toUpperCase(),m={type:g.dotnetType},y=await n.tasks.fetchTasks(m),S=s.environmentStateManager?.getOpenedSolutionExt();for(const e of y){const t=e.definition;if(t&&t.task.startsWith(p)&&(t.file?.toUpperCase()===h||void 0===t.file&&S&&h.endsWith(S.toUpperCase()))){if(void 0===t.file){const e=await(0,i.getOpenedSolution)();if(e?.toUpperCase()!==h)continue}f=e;break}}if(!f){const e=_();if(e){const r=await w(),n=!!(r&&r.length>0);if((f=await v(e,`${p} ${t}`,t,{taskGroup:l,projectTarget:a,rejoinAspireSession:n}))&&c){if(!s.dotnetTaskProvider)return{success:Promise.resolve(!1)};s.dotnetTaskProvider.cacheNewTask(f)}}}return f?{taskName:`${f.definition.type}: ${f.name}`,success:new Promise((async(e,t)=>{const r=n.tasks.onDidEndTaskProcess((t=>{t.execution.task===f&&(r.dispose(),e(0===t.exitCode))}));try{await n.tasks.executeTask(f)}catch(e){r.dispose(),t(e)}}))}:{success:Promise.resolve(!1)}}},81297:(e,t)=>{"use strict";function r(e){const t=()=>{if(void 0===t.value&&t.loader&&(t.value=t.loader()),void 0===t.value)throw new Error("No loader o value was supplied.");return t.value};return t.loader=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.setLazyLoadMutable=t.delayedLoadMutable=t.lazyLoadNotImplemented=t.lazyLoadMutable=t.lazyLoad=void 0,t.lazyLoad=function(e){let t;return(r=!0)=>void 0!==t?t:r?t=e():void 0},t.lazyLoadMutable=r,t.lazyLoadNotImplemented=function(){throw new Error("Dependencies: Instance not provided.")},t.delayedLoadMutable=function(e){return r((()=>{throw Error(`Dependencies: ${e} is not yet initialized`)}))},t.setLazyLoadMutable=function(e,t){return"function"==typeof t&&(e.loader=t),e}},89781:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsonOutputMonitor=t.OutputMonitor=t.StepProgressLogger=t.NuGetLogger=t.Logger=t.LoggerBase=t.LogImportance=void 0;const n=r(89496),i=r(30077),o=r(22677);var s;!function(e){e[e.low=0]="low",e[e.normal=1]="normal",e[e.high=2]="high"}(s||(t.LogImportance=s={}));class a{async watch(e,t,r){const n=r?.importance;this.log(`Starting ${e}...`,n);const o=performance.now();try{const r=await t(),i=performance.now();return this.log(`Completed ${e} (${(i-o).toFixed()}ms)`,n),r}catch(t){const s=performance.now();if(this.log(`Failed at '${e}' (${(s-o).toFixed()}ms) with error: ${t}`,n),r?.telemetry?.addOrUpdateProperties({succeeded:String(!1),error:t instanceof Error?t.name:"error"}),r?.telemetry?.addOrUpdateMeasurements({errorCode:t instanceof i.ErrorCodeError?t.errorCode:void 0}),!r?.catchUnhandledErrors)throw t}}}t.LoggerBase=a;class c extends a{outputChannel;level;constructor(e){switch(super(),this.outputChannel="string"==typeof e?n.window.createOutputChannel(e,{log:!0}):e,this.level=s.normal,process.env.MINIMUM_LOG_LEVEL?.toLowerCase()){case"low":this.level=s.low;break;case"normal":this.level=s.normal;break;case"high":this.level=s.high}}log(e,t){if(void 0===t||t>=this.level){const r="object"==typeof e?JSON.stringify(e,null,2):void 0===e?"":e;if(r&&"trace"in this.outputChannel){const e=this.outputChannel;switch(t??s.normal){case s.low:e.debug(r);break;case s.normal:e.info(r);break;case s.high:e.error(r)}}else r&&this.outputChannel.appendLine(r)}}reportExceptionTelemetryAndLog(e,t,r,n,i,o){let a=null,c=n;c&&(a=c.stack??null);let u={methodName:e,fault:t=t??"(missing)",errorName:r??""};a&&(u.exceptionStack=a),i?.sendTelemetryErrorEvent(c,{...u,...o}),this.log("Error occurred in "+e+": "+n,s.high)}show(){this.outputChannel.show()}}t.Logger=c;class u extends c{static userInteractionRequiredMessage="[CredentialProvider]ATTENTION: User interaction required.";log(e,t){super.log(e,t),e.includes(u.userInteractionRequiredMessage)&&n.window.showWarningMessage(o.NuGet.requiresCredentialsMessage,o.NuGet.showDeviceCodeLoginInfo).then((e=>{e===o.NuGet.showDeviceCodeLoginInfo&&this.outputChannel.show()}))}}t.NuGetLogger=u,t.StepProgressLogger=class{logger;name;constructor(e,t){this.logger=e,this.name=t}report(e){this.logger.log(`${this.name}: Step ${e.currentStep} of ${e.totalSteps}.`)}};class l extends a{outputLog;constructor(){super(),this.outputLog=[]}log(e){this.outputLog.push(e)}getOutput(){return this.outputLog.join("")}clearOutput(){this.outputLog=[]}}t.OutputMonitor=l,t.JsonOutputMonitor=class extends l{logger;constructor(e){super(),this.logger=e}log(e){super.log(e),this.logger.log(e)}getOutput(){const e=super.getOutput();return this.extractJson(e)}extractJson(e){const t=e.indexOf("{"),r=e.lastIndexOf("}");if(-1===t||-1===r)throw new Error("No valid JSON object found in the output");return e.slice(t,r+1)}}},78343:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prepareBrokeredServices=void 0;const n=r(19679),i=r(73292),o=r(89496),s=r(7631),a=r(89781),c=r(61925),u=r(75056),l=r(11694),d=r(65979),p=r(22485),f=r(15158),h=r(72902),g=r(8240),m=r(22743),v=r(73228),y=r(39491),_=r(71017),S=r(81855),w=r(31467),b=r(98349),E=r(90965),P=r(42300),T=r(57787),C=r(50979),I=r(6315),O=r(22188),x=r(277),N=r(55825),k=r(69751),R=r(17407),A=r(58305),D=r(60700),j=r(28510),M=r(69279),L=r(98387);function F(e,t){return async function(r,i){await e.watch(`JIT proffering for ${n.ServiceMoniker.toString(i)} is awaiting for the .NET server`,(async function(){await t}),{importance:a.LogImportance.low})}}function U(e,t,r){const i=[],o=new n.ServiceRegistration(n.ServiceAudience.local,!1,(()=>t));for(const t of e)i.push({moniker:t.moniker,registration:o,serviceHub:{serviceModuleInfo:t.serviceModuleInfo,baseDir:t.baseDir}}),r.log(`Registered ServiceHub-hosted brokered service ${n.ServiceMoniker.toString(t.moniker)}.`,a.LogImportance.low);return i}async function B(e){const t=(await(0,i.readdir)(e)).filter((e=>e.endsWith(".servicehub.service.json")));let r=[];for(const i of t){const t=n.ServiceMoniker.create(i.slice(0,i.length-24)),o=await(0,v.readJsonFile)(_.join(e,i));r.push({moniker:t,serviceModuleInfo:o,baseDir:e})}return r}async function V(e){const t=_.join(e,"platforms"),r=await(0,i.readdir)(t,{withFileTypes:!0});let n=[];for(const e of r)if(e.isDirectory()){const r=_.join(t,e.name);if((await(0,i.readdir)(_.join(r))).indexOf("node_modules")>=0){const e=await(0,b.getPackageInfo)(r);for(const t of e){const e=_.resolve(r,"node_modules",t.fullName);n.push(...await B(e))}}}return n}t.prepareBrokeredServices=async function(e,t,r){const b=!o.workspace.workspaceFolders,$=new n.GlobalBrokeredServiceContainer,q=$.getFullAccessServiceBroker();let H=!1,W=new o.EventEmitter;const z=(0,v.lazyPromiseLambda)((()=>(H=!0,W.fire(),r.watch("Spawn .NET server",(()=>(0,c.launchDotNetServer)(e,t,$))))));let G,K=!1;const X=(0,v.lazyPromiseLambda)((()=>(K=!0,r.watch("Register services with .NET server",(async()=>{await async function(e,t){const r=await t.getProxy(d.default.outOfProcServiceRegistration);try{y(r);for(const{moniker:t,serviceHub:n}of e)n?await r.registerServiceHubService(t,n.serviceModuleInfo,n.baseDir):await r.registerParentProcessService(t)}finally{r?.dispose()}}(G,q)}),{importance:a.LogImportance.low}))));G=await async function(e,t,r,i,o,c){const u=await(0,s.loadOrCreateCachedValue)(e,"brokered-services-from-components",(async()=>{const e={dotNetServerBrokeredServices:[],serviceHubServices:{}};for(const t in r){const o=r[t],s=await B(o);s.length>0&&(e.serviceHubServices[t]=s);const u=await(0,v.readJsonFile)(_.join(o,"package.json"));if(u.brokeredServices)for(const r of u.brokeredServices){const o=new n.ServiceRegistration(r.audience??n.ServiceAudience.local,r.allowGuestClients??!1,F(c,i)),s=".NET runtime";if(Array.isArray(r.moniker))for(const i of r.moniker)e.dotNetServerBrokeredServices.push({moniker:i,registration:o}),c.log(`Registered ${s}-hosted brokered service ${n.ServiceMoniker.toString(i)} from component ${t}.`,a.LogImportance.low);else e.dotNetServerBrokeredServices.push({moniker:r.moniker,registration:o}),c.log(`Registered ${s}-hosted brokered service ${n.ServiceMoniker.toString(r.moniker)} from extension ${t}.`,a.LogImportance.low)}}return e})),l=[];if(!o)for(const e in u.serviceHubServices)l.push(...U(u.serviceHubServices[e],i,c));return l.push(...u.dotNetServerBrokeredServices.map((e=>({...e,registration:new n.ServiceRegistration(e.registration.audience,e.registration.allowGuestClients,(()=>i))})))),t.register(l),l}(e,$,t,X,b,r),G.push(...await async function(e,t,r,s,c){const u=E.idsOfExtensionsAllowedToExtendCsDevKit.map((e=>o.extensions.getExtension(e))),l=[];for(const o of u)if(o&&(!s||o.id===M.EXTENSION_ID))try{const u=o.packageJSON;if(u.brokeredServices){const i=(0,v.lazyPromiseLambda)((async()=>{await c.watch(`JIT proffering brokered services from the '${o.id}' extension `,(async function(){await o.activate(),o.exports.profferBrokeredServices&&o.exports.profferBrokeredServices(e)}),{importance:a.LogImportance.low})}));for(const e of u.brokeredServices){let s,u;e.serviceHub?(s=Array.isArray(e.moniker)||e.moniker.name!==d.default.outOfProcServiceRegistration.moniker.name?F(c,r):async function(e,r){await t},u=".NET runtime"):(s=(e,t)=>i,u="Extension Host");const p=new n.ServiceRegistration(e.audience??n.ServiceAudience.local,e.allowGuestClients??!1,s);if(Array.isArray(e.moniker))for(const t of e.moniker)l.push({moniker:t,registration:p,isInProcVsServer:!!e.serviceHub}),c.log(`Registered ${u}-hosted brokered service ${n.ServiceMoniker.toString(t)} from extension ${o.id}.`,a.LogImportance.low);else l.push({moniker:e.moniker,registration:p,isInProcVsServer:!!e.serviceHub}),c.log(`Registered ${u}-hosted brokered service ${n.ServiceMoniker.toString(e.moniker)} from extension ${o.id}.`,a.LogImportance.low)}}if(!s&&u.serviceHubServiceDirectories)for(const e of u.serviceHubServiceDirectories){const t=_.join(o.extensionPath,e);let n=await B(t);(await(0,i.readdir)(t)).indexOf("platforms")>=0&&n.push(...await V(t));for(const e of U(n,r,c))l.push({...e,isInProcVsServer:!1})}}catch(e){c.log(`Error trying to register services from extension ${o.id}: ${e}`)}return e.register(l),o.extensions.onDidChange((()=>{})),l.filter((e=>!e.isInProcVsServer))}($,z,X,b,r)),y(!K);const J={serviceBroker:q,ensureInitialized:async()=>{await z},getBrokeredServiceServerPipeName:async()=>(await z).brokeredServiceServerPipeName,hasServerProcessLoaded:()=>H,serverProcessLoaded:W.event};return function(e,t,r,n){e.subscriptions.push(t.profferServiceFactory(d.default.helloWorld.extensionHost,((e,t,r)=>new f.HelloWorld(r)))),e.subscriptions.push(t.profferServiceFactory(d.default.tokenAcquisitionService,((e,t,r)=>new h.TokenAcquisitionService))),e.subscriptions.push(t.profferServiceFactory(d.default.errorReportingService,((t,r,n)=>new p.ErrorReportingService(e)))),e.subscriptions.push(t.profferServiceFactory(d.default.activeDocumentsInformationService,((e,t,r)=>new u.ActiveDocumentsInformationService))),e.subscriptions.push(t.profferServiceFactory(d.default.buildService,((t,r,n)=>new S.BuildService(e))));const i=(0,v.lazyPromiseLambda)((()=>l.ComponentExportsState.create(e,r)));e.subscriptions.push(t.profferServiceFactory(d.default.componentExportsService,(async()=>new l.ComponentExportsService(await i)))),e.subscriptions.push(t.profferServiceFactory(d.default.vsCodeFileWatcherService,((e,t,r)=>new O.VsCodeFileWatcherService(t))));const s=new w.BrokeredServiceExportsRegistrarState;e.subscriptions.push(t.profferServiceFactory(d.default.brokeredServiceExportsRegistrar,(()=>new w.BrokeredServiceExportsRegistrar(s))));const a=(0,v.lazyPromiseLambda)((async()=>o.window.createOutputChannel("NuGet",{log:!0}))),c=(0,v.lazyPromiseLambda)((async()=>g.NuGetSolutionRestoreState.create(await a)));e.subscriptions.push(t.profferServiceFactory(d.default.nugetSolutionRestoreService,(async(e,t,r)=>new g.NuGetSolutionRestoreService(await c,t))));const y=(0,v.lazyPromiseLambda)((async()=>m.LogOutputChannelState.create()));e.subscriptions.push(t.profferServiceFactory(d.default.logOutputChannelService,(async(e,t,r)=>(await y).createOutputChannel(t)))),e.subscriptions.push(t.profferServiceFactory(d.default.hotReloadLogger,((e,t,r)=>P.hotReloadLogger))),e.subscriptions.push(t.profferServiceFactory(d.default.hotReloadClientListener,((e,t,r)=>new T.HotReloadClientListener))),e.subscriptions.push(t.profferServiceFactory(d.default.hotReloadOptionService,((e,t,r)=>C.hotReloadOptionService))),e.subscriptions.push(t.profferServiceFactory(d.default.dotnetDebugConfigurationService,((e,t,r)=>new I.DotnetDebugConfigurationService(r,n)))),e.subscriptions.push(t.profferServiceFactory(d.default.dotnetDebugLaunchService,((e,t,r)=>new D.DotnetDebugLaunchService(n)))),e.subscriptions.push(t.profferServiceFactory(d.default.nugetCommandsService,((e,t,r)=>new x.NuGetDotnetCommandsService(a)))),e.subscriptions.push(t.profferServiceFactory(d.default.workspaceConfigurationOptionsService,((e,t,r)=>N.workspaceConfigurationOptionsService))),e.subscriptions.push(t.profferServiceFactory(d.default.vscodeAzureFunctionExtensionService,((e,t,r)=>j.vsCodeAzureFunctionExtensionService)));const _=(0,v.lazyPromiseLambda)((async()=>k.OutputChannelState.create()));e.subscriptions.push(t.profferServiceFactory(d.default.outputChannelService,(async(e,t,r)=>(await _).createOutputChannel(t)))),e.subscriptions.push(t.profferServiceFactory(d.default.startupProjectService,((e,t,r)=>new A.FilteredStartupProjectService(R.startupProjectService)))),e.subscriptions.push(t.profferServiceFactory(d.default.aspireCopilotService,((e,t,r)=>new L.AspireCopilotService(t))))}(e,$,t,J),J}},7631:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCacheDirectory=t.loadOrCreateCachedValue=t.isCacheEnabled=void 0;const n=r(57147),i=r(73292),o=r(89496),s=r(71017),a="utf8";function c(e){return e.extensionMode===o.ExtensionMode.Production||false}let u;function l(e){return s.join(e.extensionPath,"cache")}function d(e){return s.join(l(e),"discovery.json")}t.isCacheEnabled=c,t.loadOrCreateCachedValue=async function(e,t,r){let o;if(c(e)&&(u??=async function(e){const t=d(e);try{const e=(0,n.readFileSync)(t);return JSON.parse(e.toString(a))}catch{return{}}}(e),o=await u,t in o))return o[t];const l=await r();return o&&(o[t]=l,await async function(e,t){const r=d(e);await(0,i.mkdir)(s.dirname(r),{recursive:!0}),await(0,i.writeFile)(r,JSON.stringify(t),{encoding:a})}(e,o)),JSON.parse(JSON.stringify(l))},t.getCacheDirectory=l},11144:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkHostApp=void 0;const n=r(89496);r(71017),r(6113),["You may install and use any number of copies of the software only with Microsoft Visual Studio,","Visual Studio for Mac, Visual Studio Code, Azure DevOps, Team Foundation Server, and successor Microsoft products","and services (collectively, the Visual Studio Products and Services) to develop and test your applications.","The software is licensed, not sold. This agreement only gives you some rights to use the software. Microsoft reserves all other rights.","You may not:","work around any technical limitations in the software that only allow you to use it in certain ways;","reverse engineer, decompile or disassemble the software, or otherwise attempt to derive the source code for the software,","except and to the extent required by third party licensing terms governing use of certain open source components that may be included in the software;","remove, minimize, block, or modify any notices of Microsoft or its suppliers in the software;","use the software in any way that is against the law or to create or propagate malware; or","share, publish, distribute, or lease the software (except for any distributable code, subject to the terms above),","provide the software as a stand-alone offering for others to use, or transfer the software or this agreement to any third party."].join(" "),t.checkHostApp=function(){return!!["Visual Studio Code","Visual Studio Code - Insiders","Visual Studio Code - Exploration","Visual Studio Code @ Meta","Visual Studio Code @ Meta - Insiders"].includes(n.env.appName)}},2155:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(92181),o=r(69279),s=r(65300),a=r(7195),c=r(65979),u=r(79994),l=r(71017),d=r(2906),p=r(22677),f=r(75010),h=r(73228);t.default=async function(e){const t=n.extensions.getExtension(o.EXTENSION_ID);if(!t)throw new Error("Unable to find the extension");if(e.contextValue===i.contextValues.solutionFolder){const r=t.exports.serviceBroker,i=await(0,s.getOpenedSolution)(),o=u.getActiveWorkspaceRoot();let g=o;i&&(0,h.containsFileOrFolder)(o,i)&&(g=l.dirname(i));const m=await n.window.showOpenDialog({canSelectFolders:!1,canSelectFiles:!0,canSelectMany:!1,title:p.promptStrings.addExistingFile,openLabel:p.promptStrings.selectFile,defaultUri:n.Uri.file(g)});if(!m)return;const v=m[0].fsPath,y=l.parse(v).base,_=l.relative(l.dirname(i),v),S=new f.TelemetryActivity("add-existing-file",a.telemetryService),w=await r.getProxy(c.default.solutionFileService);try{await a.logger.watch("Add an existing solution file.",(async function(){let t=e.node.ProjectGuid;t&&0!==t.length||(t=u.emptyGuid),await(w?.addSolutionItem(t,_)),n.window.showTextDocument(n.Uri.file(v)),(0,d.expandToNewNode)(e,y)}),{telemetry:S,catchUnhandledErrors:!0})}finally{S.end(),S.sendTelemetry(),w?.dispose()}e&&(0,a.sendFirstInteractionWithExplorerTelemetry)()}}},92614:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addProjectFromWorkspace=void 0;const n=r(89496),i=r(7195),o=r(65979),s=r(22677),a=r(65300),c=r(79994),u=r(79994),l=r(71017);async function d(e,t,r,n){await i.logger.watch("Add existing project",(async()=>{let s=!1;if(i.environmentStateManager?.isSolutionGeneratedOutsideWorkspace())s=await(0,u.doesSolutionContainProjectByPath)(t);else{const e=l.parse(t).name;s=await(0,u.doesSolutionContainProject)(e)}if(!s){await c.addProjectToSolution(e,r,t,n),await(0,a.reloadSolution)(r);const i=c.getExtensionBrokerService(),s=await i.getProxy(o.default.solutionFileService);try{await(s?.addProjectToFilter(t))}finally{s?.dispose()}}}))}t.default=async function(e){const t=await(0,a.getOpenedSolution)(),r=c.getActiveWorkspaceRoot(),o=c.parseSolutionFolderFromContextMenu(e),u={};u[s.promptStrings.projectFilesFilterName]=["csproj"];const l=await n.window.showOpenDialog({canSelectFolders:!1,canSelectFiles:!0,canSelectMany:!1,title:s.promptStrings.addExistingProject,filters:u,openLabel:s.promptStrings.chooseProjectFileLabel,defaultUri:n.Uri.file(r)});l&&(await d(r,l[0].fsPath,t,o),e&&(0,i.sendFirstInteractionWithExplorerTelemetry)())},t.addProjectFromWorkspace=async function(e){const t=await(0,a.getOpenedSolution)(),r=c.getActiveWorkspaceRoot();await d(r,e,t)}},81106:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addNewFile=t.addNewFileFromNewFileMenu=void 0;const n=r(57147),i=r(89496),o=r(7195),s=r(65979),a=r(22677),c=r(75010),u=r(73228),l=r(92181),d=r(2906),p=r(2906),f=r(65300),h=r(79994),g=r(79994),m=r(71017),v=r(60279),y=r(55471);async function _(e,t){if(t??=e?y.InvocationSource.solutionExplorer:y.InvocationSource.commandPalette,!e&&!(e=await(0,p.getSelectedSolutionTreeNodeInExplorer)()))return void await async function(e){const t=new c.TelemetryActivity("add-untitled-file",o.telemetryService);t.addOrUpdateProperties({invocationSource:String(y.InvocationSource[e])});try{await o.logger.watch("create new file in buffer",(async function(){await i.commands.executeCommand("workbench.action.files.newUntitledFile");const e=i.window.activeTextEditor;if(!e)return;await i.languages.setTextDocumentLanguage(e.document,"csharp");e.insertSnippet(new i.SnippetString("namespace ${3:ConsoleApp1};\n\npublic ${1|class,interface,enum,record,struct|} ${2:Class1}\n{\n\t${0}\n}\n"))}),{telemetry:t})}finally{t.end(),t.sendTelemetry()}}(t);if(e.contextValue!==l.contextValues.solutionFolder&&e.contextValue!==l.contextValues.project&&e.contextValue!==l.contextValues.folder)return;const r=await(0,v.getTemplateService)();if(!r)return;const _=e.contextValue===l.contextValues.solutionFolder;var T=await async function(e,t){if(t){const e=h.getActiveWorkspaceRoot(),t=await(0,f.getOpenedSolution)();return t&&(0,u.containsFileOrFolder)(e,t)?m.dirname(t):e}return e.contextValue===l.contextValues.project?m.dirname(e.node.Path):e.node.Path}(e,_);if(!(0,g.isWorkingDirectoryInWorkspace)(T))return void o.logger.log(`The selected node's path is located outside the workspace. ${T}`);const C=_?void 0:S(e),I=await async function(e,t){const r=t?await e.getProjectItemTemplates(t):await e.getSolutionItemTemplates();if(!r)throw new Error("Unable to fetch item templates");const n=r.map((e=>({label:e.name,defaultName:e.defaultName,groupIdentity:e.groupIdentity,fixedFile:e.fixedFile,fileExtension:e.fileExtension}))).concat({label:a.addNewItemUiStrings.custom,defaultName:"",groupIdentity:"custom",fixedFile:!1,fileExtension:""});return n.sort(((e,t)=>e.label.localeCompare(t.label))),await i.window.showQuickPick(n,{title:a.addNewItemUiStrings.createNewFile,placeHolder:a.addNewItemUiStrings.searchForTemplates})}(r,C);if(!I)return;var O=I.defaultName;if(I.fixedFile&&P(T,O,I.fileExtension)){const r=_?a.addNewItemUiStrings.addExistingFileToSolutionFolder(O):a.addNewItemUiStrings.addExistingFileToProject(O);if(await i.window.showQuickPick([a.addNewItemUiStrings.yes,a.addNewItemUiStrings.cancel],{placeHolder:r})!==a.addNewItemUiStrings.yes)return;const n=new c.TelemetryActivity("add-new-file",o.telemetryService);n.addOrUpdateProperties({solutionExplorerNodeType:e.node.NodeType,existingFileAdded:"true",templateGroupIdentity:I.groupIdentity,invocationSource:String(y.InvocationSource[t])});const u=h.getExtensionBrokerService(),l=await u.getProxy(s.default.solutionFileService);try{await o.logger.watch("Add a file to project/solution folder",(async function(){const t=O+(I.fileExtension?"."+I.fileExtension:""),r=m.join(T,t);if(_){const r=o.environmentStateManager?.getLatestEnvironmentState();if(r?.containsTemporarySolutionFile)return void i.window.showErrorMessage(a.promptStrings.addSolutionItemNotSupportedWorkspaceBased);await b(l,e,t)}else await w(e,r);i.window.showTextDocument(i.Uri.file(r)),(0,d.expandToNewNode)(e,t)}),{telemetry:n})}finally{n.end(),n.sendTelemetry(),l?.dispose()}return void(e&&(0,o.sendFirstInteractionWithExplorerTelemetry)())}if(!I.fixedFile){const e=await async function(e,t){const r="custom"!==e.groupIdentity&&null!==e.fileExtension&&void 0!==e.fileExtension;let n=e.defaultName,o=n;if(r){""===n&&(n=m.parse(t).base,o=n);let r=1;do{o=n+r.toString(),r++}while(P(t,o,e.fileExtension))}const s=await i.window.showInputBox({title:a.addNewItemUiStrings.nameNewFile,value:o,validateInput:async function(r){if(!r||0===r.length||0===r.trim().length)return a.addNewItemUiStrings.noFileName;if("custom"===e.groupIdentity){const e=r.lastIndexOf(".");if(-1!==e&&(0===r.substring(0,e).trim().length||0===r.substring(e+1).trim().length))return a.addNewItemUiStrings.noFileName}return m.isAbsolute(r)?a.addNewItemUiStrings.onlyRelative:m.parse(m.normalize(r)).dir.startsWith("..")?a.addNewItemUiStrings.outsideDirectory:(r=E(r,e.fileExtension),P(t,r,e.fileExtension))}});return s?E(s,e.fileExtension):s}(I,T);if(!e)return;const t=m.join(T,e);O=m.basename(t),T=m.dirname(t)}const x=h.getExtensionBrokerService(),N=await x.getProxy(s.default.solutionFileService),k=new c.TelemetryActivity("add-new-file",o.telemetryService);if(k.addOrUpdateProperties({solutionExplorerNodeType:e.node.NodeType,templateGroupIdentity:I.groupIdentity,invocationSource:String(y.InvocationSource[t])}),!_){const e=-1!==m.extname(C).localeCompare(".shproj",void 0,{sensitivity:"base"});k.addOrUpdateProperties({projectType:e?"SharedProject":"CSharpProject"})}try{await o.logger.watch("Add a new file"+("custom"===I.groupIdentity?"":" using template: "+I.label),(async function(){const t=O+(I.fileExtension?"."+I.fileExtension:""),s=m.join(T,t);if("custom"===I.groupIdentity)(0,n.writeFile)(m.join(T,O),"",(e=>{if(e)throw e}));else{let e;if(_){const t=o.environmentStateManager?.getLatestEnvironmentState();if(t?.containsTemporarySolutionFile)return void i.window.showErrorMessage(a.promptStrings.addSolutionItemNotSupportedWorkspaceBased);e=await r.createSolutionItem(I.groupIdentity,O,T)}else e=await r.createProjectItem(I.groupIdentity,O,T,C);if(e.errorMessage)return void i.window.showErrorMessage(e.errorMessage)}_?await b(N,e,t):await w(e,s),i.window.showTextDocument(i.Uri.file(s)),(0,d.expandToNewNode)(e,t)}),{telemetry:k})}finally{k.end(),k.sendTelemetry(),N?.dispose()}}function S(e){return e.contextValue===l.contextValues.project?e.node.Path:S(e.parentNode)}async function w(e,t){const r={update:{target:{context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[e.node.ProjectGuid]]},$properties:["Id"]}},steps:[{AddFiles:{ItemsPath:[t]}}]}},n=await o.projectQueryableSpace.executeAction(r);n.Errors&&n.Errors.forEach((e=>{o.logger.log(e.Message)}))}async function b(e,t,r){let n=t.node.ProjectGuid;n&&0!==n.length||(n=h.emptyGuid),await(e?.addSolutionItem(n,r))}function E(e,t){return t&&e.length>t.length&&e.substring(e.length-t.length).toLowerCase()===t?e.substring(0,e.length-t.length-1):e}function P(e,t,r){const i=r?t+"."+r:t;return(0,n.existsSync)(m.join(e,i))?a.addNewItemUiStrings.fileExists:null}t.addNewFileFromNewFileMenu=async function(){await _(void 0,y.InvocationSource.newFileMenu)},t.addNewFile=_},17702:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addNewProject=t.addNewProjectFromNewFileMenu=void 0;const n=r(57147),i=r(73292),o=r(89496),s=r(69279),a=r(30077),c=r(93197),u=r(7195),l=r(77867),d=r(32081),p=r(65979),f=r(55471),h=r(60279),g=r(22677),m=r(75010),v=r(73228),y=r(2906),_=r(65300),S=r(79994),w=r(79994),b=r(71017),E=r(89781);async function P(e,t,r){const a=await(0,c.getAllComponentsMap)(e.asAbsolutePath("components"));let l=b.join(a["@microsoft/vscode.projectsystem.managed"],"Microsoft.TemplateEngine.VSCode.Tool.exe");await(0,v.exists)(l)||(l=void 0);const d=new m.TelemetryActivity("AddNewProject/show-list-of-templates",u.telemetryService);r??=t?f.InvocationSource.solutionExplorer:f.InvocationSource.commandPalette;const p=o.extensions.getExtension(s.EXTENSION_ID);if(!p)throw new Error("Unable to find the extension");const y=p.exports.hasServerProcessLoaded();d.addOrUpdateProperties({serverProcessLoaded:String(!y),templateServiceInitialized:String(!h.isTemplateServiceInitialized)});const P=o.window.createQuickPick();P.busy=!0,P.items=[{label:g.addNewItemUiStrings.waitingTemplateService}],P.ignoreFocusOut=!0,P.show();let I=!1;const N=o.Disposable.from(P,P.onDidHide((()=>{I=!0})),o.window.setStatusBarMessage(g.addNewItemUiStrings.waitingTemplateService));let k=null;try{if(y||!l?k=await R.create():(k=await A.create(l),k||(u.logger.log("Failed to start project template tool. Using brokered service instead.",E.LogImportance.high),k=await R.create())),I)return void u.logger.log("Add new project command cancelled by user",E.LogImportance.low);const a=await async function(e){const t=await e.getProjectTemplates();if(!t)throw new Error("Unable to fetch project templates");const r=t.filter((e=>"Microsoft.Maui.MultiProjectApp"!==e.groupIdentity)).map((e=>({label:e.name,defaultName:e.defaultName,groupIdentity:e.groupIdentity,detail:e.description})));return r.sort(((e,t)=>e.label.localeCompare(t.label))),r}(k);d.sendTelemetry();const c=await o.window.showQuickPick(a,{title:g.addNewItemUiStrings.createNewProject,placeHolder:g.addNewItemUiStrings.searchForTemplates});if(!c)return;c.groupIdentity.startsWith("Microsoft.Maui")&&(o.extensions.getExtension(s.MAUI_EXTENSION_ID)||o.window.showWarningMessage(g.addNewItemUiStrings.mauiExtensionNotFound,g.addNewItemUiStrings.installMaui).then((e=>{e===g.addNewItemUiStrings.installMaui&&o.env.openExternal(o.Uri.parse(s.MAUI_EXTENSION_URL))})));const p=await async function(e,t,r){const s=o.workspace.workspaceFolders;if(s&&0!==s.length){const n=S.getActiveWorkspaceRoot();let i=await(0,_.getOpenedSolution)();const s=void 0!==i;a=i&&(0,v.containsFileOrFolder)(n,i)?b.dirname(i):n;const c=S.parseSolutionFolderFromContextMenu(r),{solutionFolder:u,projectName:l}=await T(a,e,void 0!==i,c);if(!l)return;const d=await async function(e,t,r){const n=b.join(e,t??"."),i=g.addNewItemUiStrings.projectCreatedIn(b.join(n,r)),s=[{label:g.addNewItemUiStrings.defaultDirectory,id:"default",description:i},{label:g.addNewItemUiStrings.chooseDirectory,id:"picker"}],a=await o.window.showQuickPick(s,{title:g.addNewItemUiStrings.locationForNewProject,placeHolder:i});if(!a)return;if("default"===a.id)return n;const c=await o.window.showOpenDialog({canSelectFolders:!0,canSelectFiles:!1,canSelectMany:!1,title:g.addNewItemUiStrings.projectLocation,defaultUri:o.Uri.file(n)});return c?c[0].fsPath:void 0}(a,u,l);if(!d)return;if(!i){const e=await(0,w.selectSolutionFileFormat)(a);if(!e)return;const t=b.parse(l).name+e;i=b.join(a,t)}return{templateGroupIdentity:e.groupIdentity,projectName:l,rootDirectory:a,projectLocation:d,solutionFolder:u,fullSolutionPath:i,openFolder:!1,invocationSource:t,inOpenSolution:s}}{const r=await async function(){const e=await o.window.showOpenDialog({canSelectFolders:!0,canSelectFiles:!1,canSelectMany:!1,title:g.addNewItemUiStrings.projectLocation});if(e)return e[0].fsPath}();if(!r)return;const{solutionFolder:s,projectName:c}=await T(r,e,!0);if(!c)return;var a=r;let u;if(!(0,n.existsSync)(a)||C(a)||(a=b.join(a,c),await(0,i.mkdir)(a,{recursive:!0})),u=S.shouldUseWorkspaceBased()?".sln":await(0,w.selectSolutionFileFormat)(a),!u)return;const l=b.join(a,b.parse(a).name)+u,d=b.join(a,s??".");return{templateGroupIdentity:e.groupIdentity,projectName:c,rootDirectory:a,solutionFolder:s,fullSolutionPath:l,projectLocation:d,openFolder:!0,invocationSource:t,inOpenSolution:!1}}}(c,r,t);if(!p)return;await async function(e,t,r,n){const i=g.addNewItemUiStrings.projectCreatedIn(b.join(t.projectLocation,t.projectName)),s={label:g.addNewItemUiStrings.createProject,description:i,id:0},a={label:g.addNewItemUiStrings.showTemplateOptions,id:1},c=await o.window.showQuickPick([s,a],{title:g.addNewItemUiStrings.createProjectOrViewOptions,placeHolder:i});if(!c)return;if(0===c.id)return void await x(r,e,t,n,void 0);const u=await e.getProjectParameters(t.templateGroupIdentity);await O(e,t,u,r,n)}(k,p,e,t),t&&(0,u.sendFirstInteractionWithExplorerTelemetry)()}catch(e){u.logger.log("Error while adding new project "+e,E.LogImportance.high)}finally{N.dispose(),k?.dispose()}}async function T(e,t,r,n){let i,s=1;do{i=t.defaultName+s.toString(),n&&(i=b.join(n,i)),s++}while(await I(e,i,r));const a=(await o.window.showInputBox({title:g.addNewItemUiStrings.nameNewProject,value:i,validateInput:async function(t){return t&&0!==t.length?(t=t.trim(),b.isAbsolute(t)?g.addNewItemUiStrings.onlyRelative:b.parse(b.normalize(t)).dir.startsWith("..")?g.addNewItemUiStrings.outsideDirectory:await I(e,t,r)):g.addNewItemUiStrings.noProjectName}}))?.trim();if(a){const e=b.normalize(a),t=b.dirname(e),r=b.basename(e);return t&&"."!==t?{solutionFolder:t,projectName:r}:{projectName:r}}return{}}function C(e){try{return 0===(0,n.readdirSync)(e).length}catch{return!1}}async function I(e,t,r){for(const e of'"*<>:|?')if(-1!==t.indexOf(e))return g.addNewItemUiStrings.pathInvalidChars;if(e.length+3*t.length>240)return g.addNewItemUiStrings.pathTooLong;const i=b.resolve(e,t);return(0,n.existsSync)(i)&&!C(i)?g.addNewItemUiStrings.projectDirectoryExists:!r&&await(0,w.doesSolutionContainProject)(t,!0)?g.addNewItemUiStrings.solutionContainsItem(t):null}async function O(e,t,r,n,i){const s=g.addNewItemUiStrings.projectCreatedIn(b.join(t.projectLocation,t.projectName)),a=[{label:g.addNewItemUiStrings.createProject,description:s,id:0},{label:g.addNewItemUiStrings.templateOptions,kind:o.QuickPickItemKind.Separator,id:-1}];var c=0;const u={};for(const e of r){c++;const t=e.selectedValue??e.defaultValue;var l=!0;if(e.visibilityConditions)for(const t of e.visibilityConditions){if(!(t.parameterId in u)){l=!1;break}var d=t.values.includes(u[t.parameterId]);if(t.negated&&(d=!d),!d){l=!1;break}}if(!l)continue;u[e.id]=t;const r=e.values?.find((e=>e.value===t))?.displayName??t,n={label:e.displayName,description:r??t,id:c};a.push(n)}const p=await o.window.showQuickPick(a,{placeHolder:g.addNewItemUiStrings.selectOption,title:g.addNewItemUiStrings.selectOptionToConfigure});p&&(0!==p.id?(await async function(e){const t=e.dataType??"choice";if("choice"===t){const t=[];for(const r of e.values)t.push({label:r.displayName,id:r.value,description:N(e,r.value)});const r=await o.window.showQuickPick(t,{title:g.addNewItemUiStrings.configureOption(e.displayName),placeHolder:g.addNewItemUiStrings.specifyValue(e.displayName)});r&&(e.selectedValue=r.id)}else if("bool"===t){const t=[{label:g.addNewItemUiStrings.trueValue,id:"true",description:N(e,"true")},{label:g.addNewItemUiStrings.falseValue,id:"false",description:N(e,"false")}],r=await o.window.showQuickPick(t,{title:g.addNewItemUiStrings.configureOption(e.displayName),placeHolder:g.addNewItemUiStrings.specifyValue(e.displayName)});r&&(e.selectedValue=r.id)}}(r[p.id-1]),await O(e,t,r,n,i)):await x(n,e,t,i,r))}async function x(e,t,r,i,s){await async function(e,t,r,i){const s=new m.TelemetryActivity("add-project",u.telemetryService);s.addOrUpdateProperties({openFolder:String(r.openFolder),templateGroupIdentity:r.templateGroupIdentity,invocationSource:String(f.InvocationSource[r.invocationSource]),inOpenSolution:String(r.inOpenSolution)});const c=[];try{await u.logger.watch("Instantiate a project template",(async()=>{const u="Aspire.Empty"===r.templateGroupIdentity||"Aspire.Starter"===r.templateGroupIdentity||"Aspire.Empty.9"===r.templateGroupIdentity||"Aspire.Starter.9"===r.templateGroupIdentity?r.projectLocation:b.join(r.projectLocation,r.projectName),d=function(e){const t={};if(e)for(const r of e)r.selectedValue&&("bool"===r.dataType&&r.invertBoolean?t[r.name]="true"===r.selectedValue?"false":"true":t[r.name]=r.selectedValue);return t}(i),f=await t.createProject(r.templateGroupIdentity,r.projectName,u,d);if(f.errorMessage)return void o.window.showErrorMessage(f.errorMessage);if(f.postActions&&f.postActions.length>0){const g="84c0da2151c8454199406ca19af04ee6";for(const m of f.postActions)if(m.actionId.toLowerCase()===g){const v=m.args.files;v&&c.push(...v.split(";").map((e=>parseInt(e,10))).filter((e=>e>=0&&e<f.primaryOutputPaths.length)).map((e=>b.resolve(b.join(r.projectLocation,r.projectName),f.primaryOutputPaths[e]))).filter((e=>(0,n.existsSync)(e))).map((e=>o.Uri.file(e))))}}if(S.shouldUseWorkspaceBased()&&(!o.workspace.workspaceFolders||0===o.workspace.workspaceFolders.length))return s.end(),s.sendTelemetry(),void await o.commands.executeCommand("vscode.openFolder",o.Uri.file(u),{filesToOpen:c});let h=!1;if(!(0,n.existsSync)(r.fullSolutionPath)){const y=b.parse(r.fullSolutionPath);if(".sln"===y.ext?await(0,l.dotnetCommand)(a.DotnetCommand.newSln,y.dir,["new","sln","-n",y.name]):".slnx"===y.ext&&await(0,l.dotnetCommand)(a.DotnetCommand.newSln,y.dir,["new","sln","-n",y.name,"-f","slnx"]),!r.openFolder){const w=o.workspace.asRelativePath(r.fullSolutionPath);await o.workspace.getConfiguration("dotnet").update("defaultSolution",w),await(0,_.default)(e,r.fullSolutionPath)}}if(f.primaryOutputPaths){const E=S.getExtensionBrokerService(),P=r.inOpenSolution?await E.getProxy(p.default.solutionFileService):null;try{let C=!1;for(const I of f.primaryOutputPaths)k(I)&&(await T(I),C=!0);if(!C){const O=(0,n.readdirSync)(u);for(const x of O)k(x)&&await T(x)}}finally{P?.dispose()}async function T(e){let t;try{const n=b.join(u,e);t=_.vscodeWorkspaceFileWatcher?.onCreateProject(n),await S.addProjectToSolution(r.rootDirectory,r.fullSolutionPath,n,r.solutionFolder),h=!0,await(P?.addProjectToFilter(n)),t?.onComplete()}catch(e){throw t?.onAbort(),e}}}h&&r.inOpenSolution&&await(0,_.reloadSolution)(r.fullSolutionPath);for(const N of c)await o.window.showTextDocument(N,{preview:!1})}),{telemetry:s})}finally{s.end(),s.sendTelemetry()}r.openFolder&&await o.commands.executeCommand("vscode.openFolder",o.Uri.file(r.rootDirectory),{filesToOpen:c})}(e,t,r,s),i instanceof o.TreeItem&&(0,y.expandToNewNode)(i,r.projectName)}function N(e,t){var r=void 0;return t===e.defaultValue&&(r=g.addNewItemUiStrings.default),t===e.selectedValue&&(r=g.addNewItemUiStrings.selected),r}function k(e){return e.length>=7&&0===e.slice(-7).localeCompare(".csproj",void 0,{sensitivity:"base"})}t.addNewProjectFromNewFileMenu=async function(e){await P(e,void 0,f.InvocationSource.newFileMenu)},t.addNewProject=P;class R extends o.Disposable{templateService;static async create(){const e=await(0,h.getTemplateService)();if(!e)throw new Error("Template service is not available");return new R(e)}constructor(e){super((()=>{})),this.templateService=e}getProjectTemplates(e){return this.templateService.getProjectTemplates(e)}getProjectParameters(e,t){return this.templateService.getProjectParameters(e,t)}createProject(e,t,r,n,i){return this.templateService.createProject(e,t,r,n,i)}}class A extends o.Disposable{childProcess;readStdinLine;projectTemplates;static async create(e){const t=await(u.dotnetVersionManager?.getDotnetVersion(void 0,u.logger,void 0)),r=t?[t.format()]:[],n=d.spawn(e,r);n.stderr.on("data",(e=>{u.logger.log(`Error from project template executable: ${e.toString()}`,E.LogImportance.high)})),n.on("exit",(e=>{e&&u.logger.log(`Project template executable exited with code ${e}`,E.LogImportance.high)}));const i=(0,v.createLineReader)(n.stdout),o=await i();if(!o)return u.logger.log("Project template executable did not return any templates",E.LogImportance.high),null;const s=JSON.parse(o);return new A(n,i,s)}constructor(e,t,r){super((()=>e.kill())),this.childProcess=e,this.readStdinLine=t,this.projectTemplates=r}async getProjectTemplates(e){return this.projectTemplates}async getProjectParameters(e,t){this.childProcess.stdin.write(`get-project-parameters:${e}\n`);const r=await this.readStdinLine();if(null===r)throw u.logger.log(`Request to get project template parameters did not return a result (group identity: ${e})`,E.LogImportance.high),new Error(`No parameters returned for group identity: ${e}`);return JSON.parse(r)}async createProject(e,t,r,n,i){let o=`instantiate-project-template:${e}::${t}::${r}`;for(const[e,t]of Object.entries(n))o+=`::${e}=${t}`;o+="\n",this.childProcess.stdin.write(o);const s=await this.readStdinLine();if(null===s)throw u.logger.log(`Request to instantiate project template did not return any result (group identity: ${e})`,E.LogImportance.high),new Error(`No template instantiation result returned for group identity: ${e}`);return this.childProcess.stdin.write("exit\n"),JSON.parse(s)}}},44462:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(68489),o=r(69279),s=r(7195),a=r(65979),c=r(22677),u=r(98986),l=r(79994),d=r(16260),p=r(29047),f=r(75010),h=r(39058);t.default=async function(e){const t=n.extensions.getExtension(o.EXTENSION_ID);if(!t)throw new Error("Unable to find the extension.");const r=t.exports.serviceBroker,g=u.NuGetAction.add,m=new d.TelemetryEvent("nuget/add-nuget-package",s.telemetryService);try{const t=new h.NuGetConfigurationSettings;(0,p.addIncludePrereleaseTelemetry)(m,t.includePrerelease);const d=(0,l.getActiveWorkspaceRoot)(),v=await(0,u.verifyServicePrerequisites)(g,d,r,m);if(!v||!v.isPrerequisiteMet)return void(0,p.cancelAtStepTelemetry)(m,"verify-prerequisites");const y=(0,u.getProjectFromContext)(e);e instanceof n.Uri?(0,p.addEntrypointTelemetry)(m,"file-context-menu"):y?(0,p.addEntrypointTelemetry)(m,"project-context-menu"):(0,p.addEntrypointTelemetry)(m,"command-palette");const _=y??await(0,u.showProjectPicker)(g,m);if(!_)return void(0,p.cancelAtStepTelemetry)(m,"project-picker");const S=await async function(e,{title:t,value:r,prompt:i,placeholder:u},l,d,h){const g=n.extensions.getExtension(o.EXTENSION_ID);if(!g)throw new Error("Unable to find the extension.");const m=[],v=g.exports.serviceBroker,y=await v.getProxy(a.default.nugetCommandsService);y&&m.push(y);try{return await new Promise((o=>{const a=n.window.createInputBox();a.title=t,a.value=r,a.prompt=i,a.placeholder=u;let g=0;m.push(a.onDidAccept((async()=>{a.validationMessage="";const t=a.value;let r;a.enabled=!1,a.busy=!0,g++;const n=new f.TelemetryActivity("nuget/search-nuget-packages",s.telemetryService);try{r=await s.logger.watch("Search NuGet packages",(async function(){return n.start(),r=await(0,p.runWithDurationTelemetry)((async()=>await(y?.packageSearch(e,t,d.includePrerelease))),l,"packageSearch"),n.end(),r}),{telemetry:n,catchUnhandledErrors:!1})}finally{const e=r?.length??0;0===e?a.validationMessage=c.nugetStrings.noPackagesFoundError:o(r),a.busy=!1,a.enabled=!0,l.addOrUpdateMeasurements({numberOfSearches:g}),(0,p.addResultsCountTelemetry)(l,e,"packageSearch"),n.addOrUpdateMeasurements({searchTermLength:t.length}),(0,p.addResultsCountTelemetry)(n,e,"packageSearch"),(0,p.addDotnetSdkTelemetry)(n,h),n.sendTelemetry()}})),a.onDidChangeValue((async()=>{a.validationMessage=""})),a.onDidHide((()=>{o(void 0)})),a),a.show()}))}finally{m.forEach((e=>e.dispose()))}}(_.fullPath,{title:c.nugetStrings.addPackageTitle,value:"",placeholder:(0,u.getPrereleaseStatusPlaceholder)(t.includePrerelease,c.nugetStrings.packageSearchPlacholder)},m,t,v.value);if(void 0===S)return void(0,p.cancelAtStepTelemetry)(m,"package-search");const w=await async function(e,t){let r;const o=await n.window.showQuickPick(e?.map((e=>new i.NuGetPackageSearchQuickPick(e))),{title:c.nugetStrings.addPackageTitle,placeHolder:(0,u.getPrereleaseStatusPlaceholder)(t.includePrerelease,c.nugetStrings.packagePickerPlaceholder)});return o&&(r=o.info),r}(S,t);if(!w)return void(0,p.cancelAtStepTelemetry)(m,"package-picker");const b=await(0,u.showVersionPicker)(g,w,(0,u.retrievePackageVersions)(_.fullPath,w.id,t.includePrerelease,r,m),t);if(!b)return void(0,p.cancelAtStepTelemetry)(m,"version-picker");await s.logger.watch("Add NuGet package",(async function(){const e=await r.getProxy(a.default.nugetCommandsService);try{const t=await(0,p.runWithDurationTelemetry)((async()=>await(e?.addPackage(_.fullPath,w.id,b.version))),m,"addPackage");m.addOrUpdateProperties({succeeded:String(t)})}finally{e?.dispose(),(0,p.addCompletedTelemetry)(m)}}),{telemetry:m,catchUnhandledErrors:!0})}finally{m.sendTelemetry(),e&&(0,s.sendFirstInteractionWithExplorerTelemetry)()}}},76925:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addProjectReferenceByProjectPath=t.addProjectReferenceByProjectGuid=void 0;const n=r(89496),i=r(7195),o=r(22677),s=r(75010),a=r(92181),c=r(71017);async function u(e){const t=await i.projectQueryableSpace.executeQuery({context:"Projects",query:{$properties:["Name","Path","Id"],$filter:{ProjectsByCapabilities:["!SharedAssetsProject"]}}});if(!t.Items?.length)return void n.window.showWarningMessage(o.errorStrings.addProjectReferenceNoProjects,{modal:!0});const r=t.Items.filter((e=>e.Path&&e.Name&&e.Id?.ProjectGuid)).map((e=>({path:e.Path,label:e.Name,guid:e.Id.ProjectGuid})));return r.sort(((e,t)=>e.label.localeCompare(t.label))),e?r.find((t=>t.path.toLocaleUpperCase()===e.toLocaleUpperCase())):await n.window.showQuickPick(r,{placeHolder:o.promptStrings.selectProject})}async function l(e,t){const r={update:{target:{context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[e]]},$properties:["Id"]}},steps:[{AddProjectReferenceByPath:{ReferencedProjectPath:t,ReferenceType:"ProjectReference"}}]}},n=await i.projectQueryableSpace.executeAction(r);n.Errors&&n.Errors.forEach((e=>{i.logger.log(e.Message)}))}t.default=async function(e){let t;if(e instanceof n.Uri){const r=c.normalize(e.fsPath);t=await u(r)}else if(e?.contextValue===a.contextValues.project&&e.node.Path&&e.node.ProjectGuid){if(r=e.node.Path,-1!==c.extname(r).localeCompare(".shproj",void 0,{sensitivity:"base"}))return void n.window.showWarningMessage(o.errorStrings.addProjectReferenceOnSharedProject,{modal:!0});t={path:e.node.Path,label:e.node.Name,guid:e.node.ProjectGuid}}var r;if(!t&&(t=await u(),!t))return;const d=await async function(e,t,r){return await i.logger.watch("Get project to add reference to.",(async()=>{const e={context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[r]]},$properties:["ProjectReferences"],ProjectReferences:{$properties:["ReferencedProjectPath"]}}},s=await i.projectQueryableSpace.executeQuery(e),a=[];s.Items?.[0]?.ProjectReferences&&s.Items[0].ProjectReferences.forEach((e=>{e.ReferencedProjectPath&&a.push(e.ReferencedProjectPath)}));const c={context:"Projects",query:{$filter:{ProjectsByCapabilities:["!SharedAssetsProject"]},$where:{"!=":[{".":"Name"},t]},$properties:["Name","Path"]}},u=await i.projectQueryableSpace.executeQuery(c);if(u.Items){const e=u.Items.filter((e=>e.Path&&!a.includes(e.Path))).map((e=>({path:e.Path,label:e.Name})));return 0===e.length?void n.window.showWarningMessage(o.errorStrings.addProjectReferenceNoProjects,{modal:!0}):(e.sort(((e,t)=>e.label.localeCompare(t.label))),(await n.window.showQuickPick(e,{placeHolder:o.promptStrings.selectReferenceProject}))?.path)}}),{catchUnhandledErrors:!1})}(t.path,t.label,t.guid);if(!d)return;const p=new s.TelemetryActivity("add-project-reference",i.telemetryService);try{await i.logger.watch("Add project reference",(async()=>{await l(t.guid,d)}),{telemetry:p,catchUnhandledErrors:!1})}finally{p.end(),p.sendTelemetry()}(0,i.sendFirstInteractionWithExplorerTelemetry)()},t.addProjectReferenceByProjectGuid=l,t.addProjectReferenceByProjectPath=async function(e,t){const r={update:{target:{context:"Projects",query:{$filter:{ProjectsByPath:[[e]]},$properties:["Id"]}},steps:[{AddProjectReferenceByPath:{ReferencedProjectPath:t,ReferenceType:"ProjectReference"}}]}},n=await i.projectQueryableSpace.executeAction(r);n.Errors&&n.Errors.forEach((e=>{i.logger.log(e.Message)}))}},50031:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyRelativePath=t.copyPath=void 0;const n=r(89496),i=r(65300),o=r(71017),s=r(7195);t.copyPath=async function(e){await n.env.clipboard.writeText(e.node.Path),e&&(0,s.sendFirstInteractionWithExplorerTelemetry)()},t.copyRelativePath=async function(e){const t=await(0,i.getOpenedSolution)();if(t){const r=o.relative(o.dirname(t),e.node.Path);await n.env.clipboard.writeText(r),e&&(0,s.sendFirstInteractionWithExplorerTelemetry)()}}},40799:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectProject=t.getProjectsFromFile=void 0;const n=r(89496),i=r(69279),o=r(22677),s=r(82269),a=r(75010),c=r(7195),u=r(6315),l=r(71017);async function d(e){const t=[],r={context:"Projects",query:{$properties:["Id","Path","Files"],Files:{$properties:["Id","Path"],$filter:{FilesByPath:[[e]]}},$where:{any:{".":"Files"}}}};try{const e=await c.projectQueryableSpace.executeQuery(r);e&&e.Items?.forEach((e=>{e&&e.Path&&t.push(e.Path)}))}catch(t){c.logger.log(`Error querying projects for file '${e}': ${t}`)}return t}async function p(e){let t;if(1===e.length)t=e[0];else{const r=await n.window.showQuickPick(e,{title:o.debugProjectLaunchStrings.selectProject});if(!r)return void n.window.showWarningMessage(o.debugProjectLaunchStrings.warnNoProjectSelected);t=r}return t}t.getProjectsFromFile=d,t.selectProject=p,t.default=async function(e,t){const r=n.extensions.getExtension(i.EXTENSION_ID);if(!r)throw new Error("Unable to find the extension.");if(!n.workspace.workspaceFolders||n.workspace.workspaceFolders.length<1)return void n.window.showErrorMessage(o.debugProjectLaunchStrings.errorNoOpenFolder);const f=n.workspace.workspaceFolders[0];if(!f)return void n.window.showErrorMessage(o.debugProjectLaunchStrings.errorNoOpenFolder);const h=e?.fsPath;if(!h)return void n.window.showErrorMessage(o.debugProjectLaunchStrings.errorNoProjectFound);const g=l.extname(h).toLowerCase();if(".cs"!==g)return void n.window.showErrorMessage(o.debugProjectLaunchStrings.notSupportedFileExtension(h,g));const m=await d(h);if(m&&m.length>0){const e=await p(m);void 0!==e&&await(0,s.debugLaunch)(e,f,t,r.exports.serviceBroker,"debugFileLaunch")}else{const e=new a.TelemetryActivity("debugFileLaunch",c.telemetryService);e.addOrUpdateProperties({succeeded:String(!0)}),e.addOrUpdateMeasurements({telemetryCode:u.DebugTelemetryCode.fileBasedApp}),e.sendTelemetry(),n.debug.startDebugging(f,{name:h,type:"dotnet",request:"launch",projectPath:h,...t})}}},79053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(69279),o=r(22677),s=r(82269),a=r(7195);t.default=async function(e,t){const r=n.extensions.getExtension(i.EXTENSION_ID);if(!r)throw new Error("Unable to find the extension.");if(!n.workspace.workspaceFolders||n.workspace.workspaceFolders.length<1)return void n.window.showErrorMessage(o.debugProjectLaunchStrings.errorNoOpenFolder);const c=n.workspace.workspaceFolders[0];if(!c)return void n.window.showErrorMessage(o.debugProjectLaunchStrings.errorNoOpenFolder);const u=e?.node?.Path;u?(await(0,s.debugLaunch)(u,c,t,r.exports.serviceBroker,"debugProjectLaunch"),e&&(0,a.sendFirstInteractionWithExplorerTelemetry)()):n.window.showErrorMessage(o.debugProjectLaunchStrings.errorNoProjectFound)}},41122:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(22677),o=r(7195),s=r(89781),a=r(65979),c=r(49397);t.default=async function(e){let t;const r=await(0,c.getAllProjects)();if(!r||0===r.length)return void n.window.showErrorMessage(i.debugProjectLaunchStrings.errorNoProjectFound);const u=r.map((e=>({label:e.Name,description:e.Path}))),l=await n.window.showQuickPick(u,{placeHolder:i.debugProjectLaunchStrings.selectProjectToConfigureDebugProperties,matchOnDescription:!0,matchOnDetail:!1});if(!l)return;if(t=l.description,!t)return void n.window.showErrorMessage(i.debugProjectLaunchStrings.errorNoProjectFound);const d=await e.getProxy(a.default.debugTargetFrameworkService);if(!d)throw new Error("Could not get the IDebugTargetFrameworkService proxy to call subscribe.");try{const e=await d.getLaunchSettingsPath(t,void 0);if(o.logger.log(`Launch settings path for ${t} is ${e}`,s.LogImportance.low),e&&e.length>0){try{await n.workspace.fs.stat(n.Uri.file(e))}catch(r){if(!(r instanceof n.FileSystemError&&"FileNotFound"===r.code))throw r;await d.saveLaunchSettingsFile(t,void 0),n.window.showInformationMessage(i.debugProjectLaunchStrings.launchSettingsFileCreated(e))}const r=n.Uri.file(e),o=await n.workspace.openTextDocument(r);await n.window.showTextDocument(o,{preview:!1})}}catch(e){return o.logger.log(`Error getting launch settings path for ${t}: ${e}`,s.LogImportance.low),void n.window.showErrorMessage(i.debugProjectLaunchStrings.errorGettingLaunchSettingsPath(e))}finally{d&&d.dispose()}}},758:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(7195),o=r(65979),s=r(22677),a=r(92181),c=r(2906),u=r(79994);async function l(e){await n.window.showErrorMessage(s.errorStrings.deleteOperationFailed(e))}t.default=async function(e,t){const d=u.getExtensionBrokerService();if((e=e??await(0,c.getSelectedSolutionTreeNodeInExplorer)())&&e.node){if(!t&&!await n.window.showWarningMessage(s.promptStrings.deleteConfirmation(e.node.Name),{modal:!0},s.promptStrings.yes))return;void 0!==e.parentNode&&e.parentNode.node.NodeType===a.nodeTypes.solutionFolder?await async function(e,t){await i.logger.watch("Delete file in a solution folder",(async function(){const n=await t.getProxy(o.default.solutionFileService);try{if(null!==n&&e.parentNode){const t=e.parentNode.node.ProjectGuid;if(t&&e.node.Path){const i=await u.getRelativePathToSolution(e.node.Path);await(n?.removeSolutionItem(t,i)),r(57147).unlinkSync(e.node.Path)}}}finally{n?.dispose()}}),{catchUnhandledErrors:!0})}(e,d):e.node.NodeType===a.nodeTypes.file?await async function(e){const t={update:{target:{context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[e.node.ProjectGuid]]},$properties:["Id"],$get:{Files:{$filter:{FilesByPath:[[e.node.Path]]},$properties:["Id","Path"]}}}},steps:["Delete"]}};await i.logger.watch("Delete file in a project",(async()=>{const r=await i.projectQueryableSpace.executeAction(t);r.Errors&&(await l(e.node.Name),r.Errors.forEach((e=>{i.logger.log(e.Message)})))}),{catchUnhandledErrors:!0})}(e):e.node.NodeType===a.nodeTypes.folder?await async function(e){const t={update:{target:{context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[e.node.ProjectGuid]]},$properties:["Id"],$get:{Folders:{$filter:{FoldersByPath:[[e.node.Path]]},$properties:["Id"]}}}},steps:["Delete"]}};await i.logger.watch("Delete folders in a project",(async()=>{const r=await i.projectQueryableSpace.executeAction(t);r.Errors&&(await l(e.node.Name),r.Errors.forEach((e=>{i.logger.log(e.Message)})))}),{catchUnhandledErrors:!0})}(e):await l(e.node.Name),e&&(0,i.sendFirstInteractionWithExplorerTelemetry)()}}},66716:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHotReloadClientService=t.showHotReloadPanel=t.hotReload=void 0;const n=r(69279),i=r(65979),o=r(28457),s=r(42300),a=r(22677),c=r(89496);t.hotReload=async function(){const e=await(0,t.getHotReloadClientService)();try{if(null===e)return void await s.hotReloadLogger.log(new s.HotReloadLogMessage(s.HotReloadVerbosity.minimal,a.hotReloadStrings.serviceNotFound));const t=await e.applyChanges();if(await s.hotReloadLogger.log(new s.HotReloadLogMessage(s.HotReloadVerbosity.diagnostic,`Hot Reload result: ${JSON.stringify(t)}`)),t.result===o.HotReloadResult.applied||t.result===o.HotReloadResult.noChanges)return;if(t.result===o.HotReloadResult.errorEdits){const e={modal:!0,detail:a.dotnetDebugConfigurationServiceStrings.hotReloadUnableToBuildChangesDetails(t.errorDescriptions)};return void await c.window.showWarningMessage(a.dotnetDebugConfigurationServiceStrings.hotReloadUnableToBuildChangesTitle,e)}{const e=a.dotnetDebugConfigurationServiceStrings.hotReloadChangeNotSupportMessage;await s.hotReloadLogger.log(new s.HotReloadLogMessage(s.HotReloadVerbosity.minimal,e));const t={modal:!0,detail:e};await c.window.showWarningMessage(a.dotnetDebugConfigurationServiceStrings.hotReloadNotSupportedTitle,t)}}catch(e){const t=a.hotReloadStrings.exceptionWhenApplying+e;await s.hotReloadLogger.log(new s.HotReloadLogMessage(s.HotReloadVerbosity.detailed,t))}finally{e?.dispose()}},t.showHotReloadPanel=async function(e){await s.hotReloadLogger.outputChannel().show()},t.getHotReloadClientService=async()=>{const e=c.extensions.getExtension(n.EXTENSION_ID);if(!e)throw new Error("Unable to find the extension: "+n.EXTENSION_ID);const t=e.exports.serviceBroker,r=await t.getProxy(i.default.hotReloadService);if(!r)throw new Error("Hot Reload service not available.");return r}},24138:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n="csdevkit",i=r(22037).platform().toLowerCase().replace(/[0-9]/g,"").replace("darwin","mac").replace("win","windows"),o=new class{openSolution=`${n}.openSolution`;closeSolution=`${n}.closeSolution`;addNewProject=`${n}.addNewProject`;addNewProjectFromNewFileMenu=`${n}.addNewProjectFromNewFileMenu`;addNuGetPackage=`${n}.addNuGetPackage`;updateNuGetPackage=`${n}.updateNuGetPackage`;removeNuGetPackage=`${n}.removeNuGetPackage`;showEntitlementsStatus=`${n}.showEntitlementsStatus`;openInTerminal=`${n}.openInTerminal`;addExistingProject=`${n}.addExistingProject`;buildAndRunTests=`${n}.buildAndRunTests`;buildSolution=`${n}.buildSolution`;rebuildSolution=`${n}.rebuildSolution`;cleanSolution=`${n}.cleanSolution`;removeProject=`${n}.removeProject`;signIntoVsAccount=`${n}.signIntoVsAccount`;searchProjectFromCommandPalette=`${n}.searchProjectFromCommandPalette`;searchOpenFromCommandPalette=`${n}.searchOpenFromCommandPalette`;searchFromCommandPalette=`${n}.searchFromCommandPalette`;deleteItem=`${n}.deleteItem`;addNewFile=`${n}.addNewFile`;addNewFileFromNewFileMenu=`${n}.addNewFileFromNewFileMenu`;addExistingFile=`${n}.addExistingFile`;addProjectReference=`${n}.addProjectReference`;removeProjectReference=`${n}.removeProjectReference`;rename=`${n}.rename`;copyPath=`${n}.copyPath`;copyRelativePath=`${n}.copyRelativePath`;revealFileInOS=`${n}.revealFileInOS.${i}`;newSolutionFolder=`${n}.newSolutionFolder`;renameSolutionFolder=`${n}.renameSolutionFolder`;removeSolutionFolder=`${n}.removeSolutionFolder`;newFolder=`${n}.newFolder`;removeItem=`${n}.removeItem`;openProjectsLogsView=`${n}.openProjectsLogsView`;openDevKitOutputWindow=`${n}.openDevKitOutputWindow`;hotReload=`${n}.debug.hotReload`;showHotReloadPanel=`${n}.debug.showHotReloadPanel`;debugProjectLaunch=`${n}.debug.projectDebugLaunch`;noDebugProjectLaunch=`${n}.debug.noDebugProjectLaunch`;debugProperties=`${n}.debug.debugProperties`;stepIntoProjectLaunch=`${n}.debug.stepIntoProjectLaunch`;debugFileLaunch=`${n}.debug.fileLaunch`;noDebugFileLaunch=`${n}.debug.noDebugFileLaunch`;selectStartupProject=`${n}.debug.selectStartupProject`;selectLaunchConfiguration=`${n}.debug.selectLaunchConfiguration`;selectLaunchTargetFramework=`${n}.debug.selectLaunchTargetFramework`;installDotnetSdk=`${n}.installDotnetSdk`;installDotnetSdkFromWalkthrough=`${n}.installDotnetSdk.fromWalkthrough`;webviewRunCommand=`${n}.webview.runCommand`;helperOpenUrl=`${n}.helper.openUrl`;syncWithActiveItem=`${n}.syncWithActiveItem`;selectActiveConfiguration=`${n}.selectActiveConfiguration`;openCoverageReport=`${n}.openCoverageReport`;saveSolutionFile=`${n}.saveSolutionFile`;manageUserSecrets=`${n}.manageUserSecrets`};t.default=o},97475:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.manageUserSecrets=void 0;const n=r(89496),i=r(71017),o=r(22037),s=r(57147),a=r(32081),c=r(73837),u=r(22677),l=(0,c.promisify)(a.exec);t.manageUserSecrets=async function(e){let t="";if(e)t=e instanceof n.Uri?e.fsPath:e.node.Path||"";else{const e=n.window.activeTextEditor;t=e&&".csproj"===i.extname(e.document.uri.fsPath)?e.document.uri.fsPath:await async function(){const e=await n.workspace.findFiles("**/*.csproj");if(0===e.length)return void n.window.showErrorMessage("No .csproj files found in the workspace");if(1===e.length)return e[0].fsPath;const t=e.map((e=>{const t=n.workspace.getWorkspaceFolder(e);return{label:t?i.relative(t.uri.fsPath,e.fsPath):e.fsPath,description:t?.name||"",fullPath:e.fsPath}})).sort(((e,t)=>e.label.localeCompare(t.label,void 0,{sensitivity:"base"}))),r=await n.window.showQuickPick(t,{placeHolder:u.promptStrings.selectSourceProject,title:u.promptStrings.selectSourceProject});return r?.fullPath}()||""}if(t&&".csproj"===i.extname(t))try{const e=await async function(e){try{const t=(await s.promises.readFile(e,"utf8")).match(/<UserSecretsId>(.*?)<\/UserSecretsId>/);if(t)return t[1];const{stdout:r,stderr:i}=await l(`dotnet user-secrets init --project "${e}"`);if(i)return n.window.showErrorMessage(`Failed to initialize user secrets. Make sure you have the required permissions and .NET SDK installed.\nError: ${i}`),null;const o=(await s.promises.readFile(e,"utf8")).match(/<UserSecretsId>(.*?)<\/UserSecretsId>/);return o?o[1]:null}catch(e){throw new Error(`Failed to get/create user secrets ID: ${e instanceof Error?e.message:String(e)}`)}}(t);if(!e)return void n.window.showErrorMessage("Failed to get or create user secrets ID");const r=function(e){return"win32"===o.platform()?i.join(o.homedir(),"AppData","Roaming","Microsoft","UserSecrets",e,"secrets.json"):i.join(o.homedir(),".microsoft","usersecrets",e,"secrets.json")}(e);await async function(e){try{await s.promises.mkdir(i.dirname(e),{recursive:!0}),s.existsSync(e)||await s.promises.writeFile(e,"{\n\n}","utf8")}catch(e){throw new Error(`Failed to create secrets file: ${e instanceof Error?e.message:String(e)}`)}}(r);const a=await n.workspace.openTextDocument(r);await n.window.showTextDocument(a)}catch(e){n.window.showErrorMessage("Error opening user secrets file")}else n.window.showErrorMessage("Please select a .csproj file")}},90126:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newFolderActionAsync=void 0;const n=r(57147),i=r(71017),o=r(89496),s=r(49397),a=r(79994),c=r(79994),u=r(7195),l=r(22677),d=r(92181),p=r(71017);async function f(e,t,r){await u.logger.watch("Add a new folder in a project",(async function(){if(e.node.ProjectGuid!==a.emptyGuid){const n={update:{target:{context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[e.node.ProjectGuid]]},$properties:["Id"]}},steps:[{CreateFolder:{FolderPath:p.join(t,r)}}]}},i=await u.projectQueryableSpace.executeAction(n);i.Errors&&(await o.window.showErrorMessage(l.errorStrings.newFolderFailed(e.node.Name)),i.Errors.forEach((e=>{u.logger.log(e.Message)})))}}),{catchUnhandledErrors:!0})}t.default=async function(e){if(!(0,c.isWorkingDirectoryInWorkspace)(e.node.Path))return void u.logger.log(`The selected node's path is located outside the workspace. ${e.node.Path} not in ${(0,s.getOpenedWorkspaceHelper)()?.uri.fsPath}`);if(!e.node.Path)return await o.window.showErrorMessage(l.errorStrings.newFolderFailed(e.node.Name)),void u.logger.log(`The selected node doesn't contain a valid path. ${e.node}`);const t=e.node.NodeType===d.nodeTypes.folder?e.node.Path:(0,i.dirname)(e.node.Path),r=function(e){return(0,n.readdirSync)(e,{withFileTypes:!0}).filter((e=>e.isDirectory())).map((e=>e.name))}(p.dirname(e.node.Path)),a=(0,c.calculateDefaultFolderName)(r),h=await o.window.showInputBox({title:l.promptStrings.newFolderName,value:a,validateInput:async function(e){return e&&0!==e.length?(0,n.existsSync)(p.join(t,e))?l.errorStrings.fileOrFolderAlreadyExists:void 0:l.errorStrings.noName}});h&&(await f(e,t,h),e&&(0,u.sendFirstInteractionWithExplorerTelemetry)())},t.newFolderActionAsync=f},71181:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(79994),o=r(79994),s=r(7195),a=r(65979),c=r(22677),u=r(1639);t.default=async function(e){const t=i.getExtensionBrokerService(),r=await(0,u.getExistingChildrenNodesNames)(t,e.node);let l,d=await t.getProxy(a.default.solutionFileService);try{l=await(d?.getSolutionFolders())}finally{d?.dispose()}let p=(0,o.calculateDefaultFolderName)(r);p=(0,o.updateDefaultName)(p,l);const f=(await n.window.showInputBox({title:c.promptStrings.newSolutionFolder,value:p,validateInput:e=>(0,u.validateSolutionFolderName)(e,r,l)}))?.trim();f&&await s.logger.watch("Add a new solution folder",(async function(){try{let r=e.node.ProjectGuid;r&&0!==r.length||(r=i.emptyGuid),d=await t.getProxy(a.default.solutionFileService),await(d?.addSolutionFolder(f,r))}finally{d?.dispose()}e&&(0,s.sendFirstInteractionWithExplorerTelemetry)()}),{catchUnhandledErrors:!0})}},83661:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(83176);t.default=async function(){let e=await(0,n.getReportController)();await e.openCoverageReport()}},9786:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7195);t.default=function(){n.logger.show()}},64424:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(57147),i=r(89496),o=r(7195),s=r(79994),a=r(71017),c=r(92181);t.default=async function(e){let t=e?.resourceUri?.fsPath;e?.node?.NodeType===c.nodeTypes.solution&&o.environmentStateManager?.isSolutionGeneratedOutsideWorkspace()&&(t=(0,s.getActiveWorkspaceRoot)()),t&&!(0,n.existsSync)(t)&&(t=void 0),t&&(0,n.lstatSync)(t).isFile()&&(t=a.dirname(t));const r={cwd:t};i.window.createTerminal(r).show(),e&&(0,o.sendFirstInteractionWithExplorerTelemetry)()}},24593:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(69279),o=r(65979);t.default=async function(){const e=n.extensions.getExtension(i.EXTENSION_ID);if(!e)throw new Error("Unable to find the extension.");const t=e.exports.serviceBroker,r=await t.getProxy(o.default.logOutputChannelService,{activationArguments:{outputChannelName:"Projects"}});r&&r.show()}},65300:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOpenedSolution=t.reloadSolution=t.closeSolution=t.findAnyProjectFiles=t.isSlnxSupportedInWorkspace=t.openDefaultSolution=t.openDefaultSolutionInWorkspace=t.vscodeWorkspaceFileWatcher=void 0;const n=r(57147),i=r(81249),o=r(89496),s=r(69279),a=r(89781),c=r(30077),u=r(7195),l=r(65979),d=r(72639),p=r(22677),f=r(75010),h=r(16260),g=r(73228),m=r(2906),v=r(79994),y=r(49411),_="<CreateNew>",S="open-solution";function w(){const e=P();return function(e){u.solutionExplorerProvider?u.solutionExplorerProvider.prepareOpenSolution():async function(e){try{const t=await e.getProxy(l.default.projectQueryExecutionService);t?.dispose()}catch(e){u.logger.log("Failed to get project service"+e)}}(e).catch((e=>{}))}(e),{serviceBroker:e,telemetryActivity:new f.TelemetryActivity(S,u.telemetryService)}}async function b(e){const{serviceBroker:t,telemetryActivity:r}=w(),n=await T(),i=await(0,v.resolveAutoOpenSolutionPath)();if(i)return u.logger.log(`Opening auto-open solution: ${i}`),await C(e,i,t,r);const s=await async function(e,t=!1){const r=t?"**/*.{sln,slnx}":"**/*.sln";return await o.workspace.findFiles(r,"**/{node_modules,obj,bin}/**",e)}(void 0,n);if(s&&s.length>0)return r.addOrUpdateMeasurements({solutionFilesFound:s.length}),1===s.length?(u.firstExplorerInteractionTelemetry?.addOrUpdateProperties({noSolution:"false"}),await C(e,s[0],t,r)):await async function(e,t){const r=t?p.promptStrings.mentionSolutionsAvailable:p.promptStrings.chooseProjectToOpen,n=await o.window.showInformationMessage(r,p.promptStrings.chooseToOpen,p.promptStrings.doNotOpenSolution);if(n)return n===p.promptStrings.doNotOpenSolution&&n!==p.promptStrings.chooseToOpen?void await e.workspaceState.update("defaultSolution","disable"):await E(e)}(e,(0,v.shouldUseWorkspaceBased)());if((0,v.shouldUseWorkspaceBased)())return u.logger.log("Loading workspace's temporary solution"),await C(e,_,t,r);if(await I()){const n=o.workspace.workspaceFolders;if(n&&n.length>=1)return u.firstExplorerInteractionTelemetry?.addOrUpdateProperties({noSolution:"true"}),await C(e,_,t,r)}u.logger.log("No C# project is found in the workspace.")}async function E(e,t){const{serviceBroker:r,telemetryActivity:n}=w();if(t)return u.firstExplorerInteractionTelemetry?.addOrUpdateProperties({noSolution:"false"}),".slnx"!==y.extname(t.toString())||await T()?await C(e,t,r,n):void await o.window.showErrorMessage(p.errorStrings.errorSlnxNotSupported(t.toString()));const i=await T(),s=await async function(e,t=!1){const r=t?"**/*.{sln,slnx,slnf}":"**/*.{sln,slnf}";return await o.workspace.findFiles(r,"**/{node_modules,obj,bin}/**",e)}(void 0,i);n.addOrUpdateMeasurements({solutionFilesFound:s.length});let a=!1;const c=o.workspace.workspaceFolders;if(!s)throw new Error("No workspace is opened");if(0===s.length){if(!(await I()&&c&&c.length>=1))throw new Error(p.errorStrings.noSolutionInWorkspace);t=_}else if(1===s.length&&".slnf"!==y.extname(s[0].toString()))t=s[0];else{const e=await(0,v.resolveAutoOpenSolutionPath)();if(e){const r=s.find((t=>t.fsPath.toUpperCase()===e.toUpperCase()));r?(u.logger.log(`Using auto-open solution: ${e}`),t=r):u.logger.log(`auto-open solution '${e}' not found in workspace. Available solutions: ${s.map((e=>e.fsPath)).join(", ")}`)}if(!t){let e;if(c&&1===c.length){const t=c[0].uri.fsPath;e=s.map((e=>y.relative(t,e.fsPath)))}else e=s.map((e=>e.fsPath));if(!(t=await o.window.showQuickPick(e.sort(),{placeHolder:p.chooseSolutionToOpen})))return;a=!0}}return n.addOrUpdateProperties({showedSolutionPicker:String(a)}),e&&(u.firstExplorerInteractionTelemetry?.addOrUpdateProperties({noSolution:"true"}),(0,u.sendFirstInteractionWithExplorerTelemetry)()),await C(e,t,r,n)}function P(){const e=o.extensions.getExtension(s.EXTENSION_ID);if(!e)throw new Error("Unable to find the extension.");return e.exports.serviceBroker}async function T(e=void 0){const t=i.parse(`${s.NET_SDK_VERSION_SUPPORTING_SLNX}`);if(!t)return!1;if(e){if(await r(e))return!0}else if(o.workspace.workspaceFolders&&o.workspace.workspaceFolders.length>0)for(const e of o.workspace.workspaceFolders)if(await r(e.uri.fsPath))return!0;return!1;async function r(e){const r=await(u.dotnetVersionManager?.getDotnetVersion(e,u.logger));return(r&&r.compareMain(t)>=0)??!1}}async function C(e,r,i,s,f){if(u.environmentStateManager)return await u.environmentStateManager.runOperation((async()=>u.logger.watch("opening a solution",(()=>async function(e,r,i,s){s.start();try{if(u.environmentStateManager){const c="string"==typeof r?r===_?null:await(0,v.convertToFullPath)(r):r.fsPath,p=u.environmentStateManager.getOpenedSolution();if(p&&p.toLowerCase()===c?.toLowerCase())return void u.logger.log("Solution is already opened.");const S=e.workspaceState.get("configSetting",null),w=await u.logger.watch(null!==c?`processing the solution file "${c}" in Dev Kit server`:"collecting .csproj files in the workspace in Dev Kit Server",(async function(){if(u.environmentStateManager){if(u.environmentStateManager.getLatestEnvironmentState()){if(await(0,v.isAutoOpenSolutionAlreadyOpen)(p,c??void 0))return void u.logger.log(`auto-open solution '${c}' is already open. Skipping re-open to avoid unnecessary close/open cycle.`);await u.logger.watch("closing any previously opened solution",(async()=>await u.environmentStateManager.closeSolution()))}const r=o.workspace.workspaceFolders;let l=[];if(r)for(let e=0;e<r?.length;e++){const t=r[e].uri;"file"===t.scheme&&t.fsPath&&l.push(t.fsPath)}0===l.length&&u.logger.log("Fail to locate workspace root folder.",a.LogImportance.high);let g,m=c??void 0;return c?(s.addOrUpdateProperties({extensionType:y.extname(c),isSolutionless:"false"}),g=await u.environmentStateManager.setSolutionAndFolderWorkspace(c,l,S)):(g=await async function(e,r,i,o,s){const c=(0,v.shouldUseWorkspaceBased)(),l=(0,v.getAutomaticallyCreateSolutionInWorkspaceSetting)(),p=new h.TelemetryEvent("generate-sln",u.telemetryService);p.addOrUpdateProperties({outside:String(!l)}),p.sendTelemetry();let f=null;return u.experimentationService&&u.experimentationService.getTreatmentVariable("vscode","slnlessExperiment")||c||!l?(f=e.storageUri?.fsPath??null,u.logger.log(`Generate solution file outside of the workspace at ${f}`,a.LogImportance.low),s.addOrUpdateProperties({isSolutionless:"true"})):s.addOrUpdateProperties({isSolutionless:"false"}),(u.experimentationService&&u.experimentationService.getTreatmentVariable("vscode","slnlessExperiment")||c)&&(new h.TelemetryEvent("sln-less-experience",u.telemetryService).sendTelemetry(),await async function(e){const t=O((0,v.getActiveWorkspaceRoot)());if(t){u.logger.log(`global.json found at ${t}`);try{const r=y.join(e,"global.json");await n.promises.mkdir(e,{recursive:!0}),await n.promises.copyFile(t,r)}catch(e){u.logger.log(e)}}}(f),t.vscodeWorkspaceFileWatcher=new d.WorkspaceFileWatcher(e),e.subscriptions.push(t.vscodeWorkspaceFileWatcher)),e.workspaceState.update("defaultSolution","TemporarySolution"),await r.openNoSolutionWorkspace(i,f,o)}(e,u.environmentStateManager,l,S,s),f=g.containsTemporarySolutionFile),1===g.solutions.length&&(u.projectInitializationStatus&&(u.projectInitializationStatus.init(i).catch((e=>u.logger.log(e))),u.projectInitializationStatus.onEnvironmentUpdate(g.version,g.solutions.length,g.errors)),m=g.solutions[0],!f&&r&&e&&(c?.endsWith(".slnf")?await e.workspaceState.update("defaultSolution",c):await e.workspaceState.update("defaultSolution",m))),g}return null}),{telemetry:s}),b=1===w?.solutions.length?w.solutions[0]:void 0;if(b){await async function(){await o.commands.executeCommand("setContext","solutionOpened",!0),await o.commands.executeCommand("setContext","solutionExplorerVisible",!0),u.firstExplorerInteractionTelemetry&&await(0,m.autoExpandSolutionExplorerAsync)(),async function(){const e=u.environmentStateManager?.getLatestEnvironmentState();e&&await u.logger.watch("restoring NuGet packages",(async()=>{const t=P(),r=await t.getProxy(l.default.nugetSolutionRestoreService);r&&(r.setState(),e.projects.length>0&&await r.restoreSolution(),r.dispose())}),{catchUnhandledErrors:!0})}().catch()}();var g=u.environmentStateManager?.getLatestEnvironmentState()?.configuration;const e=S??"<Default>";u.logger.log(`Selected configuration: ${e}, active configuration: ${g}`)}return b}}catch(e){if(e instanceof Error&&r.toString().endsWith(".slnf"))return e.message.includes("JSON")?void o.window.showErrorMessage(p.errorStrings.openSolutionFilterFailed):void o.window.showErrorMessage(p.errorStrings.errorNoSolutionDectectedForFilter(r.toString()));throw await o.commands.executeCommand("setContext","solutionOpened",!1),new c.SolutionOpenError(p.errorStrings.errorDuringOpenSolution(e?.toString()))}finally{s.end(),s.sendTelemetry()}}(e,r,i,s)))));u.logger.log("Open solution missing environmentStateManager")}async function I(){const e=await o.workspace.findFiles("**/*.csproj","**/{node_modules,obj,bin}/**",1);return e&&e.length>0&&e[0]}function O(e){let t=e;for(;;){const e=y.join(t,"global.json");if(n.existsSync(e))return e;const r=y.dirname(t);if(r===t)return;t=r}}t.openDefaultSolutionInWorkspace=async function(e,t){const r=await(0,v.resolveAutoOpenSolutionPath)();if(r){u.logger.log(`Opening auto-open solution: ${r}`);const{serviceBroker:t,telemetryActivity:n}=w();return u.firstExplorerInteractionTelemetry?.addOrUpdateProperties({noSolution:"false"}),void await C(e,r,t,n,!0)}if((0,v.shouldUseWorkspaceBased)()){u.logger.log("Opening workspace-based temporary solution");const{serviceBroker:t,telemetryActivity:r}=w();await C(e,_,t,r,!0)}else{if(t){if("disable"===t)return void u.logger.log("Solution opening is disabled by user setting");if(".slnx"===y.extname(t)&&!await T()){const e=O((0,v.getActiveWorkspaceRoot)())?p.errorStrings.errorInstalledSDKNotMet(t):p.errorStrings.errorSlnxNotSupported(t);return void await o.window.showErrorMessage(e)}const{serviceBroker:r,telemetryActivity:n}=w();if(t=await(0,v.convertToFullPath)(t),await(0,g.fileOrDirectoryExists)(t))try{return u.firstExplorerInteractionTelemetry?.addOrUpdateProperties({noSolution:"false"}),void await C(e,t,r,n,!0)}catch(r){u.logger.log(`Failed to open solution '${t}': ${r}`),await e.workspaceState.update("defaultSolution",void 0)}}await b(e)}},t.openDefaultSolution=b,t.default=E,t.isSlnxSupportedInWorkspace=T,t.findAnyProjectFiles=I,t.closeSolution=async function(e){const r=new f.TelemetryActivity("close-solution",u.telemetryService);await u.logger.watch("Close a solution",(async function(){try{if(u.environmentStateManager){await u.logger.watch("Close a solution with environment service",(async function(){await u.environmentStateManager.closeSolution()}),{telemetry:r}),await e.workspaceState.update("defaultSolution","disable");const t=u.environmentStateManager.getLatestEnvironmentState();t&&(u.selectedSolutionFileStatusBarItem?.onEnvironmentUpdate("",!1),u.projectInitializationStatus?.onEnvironmentUpdate(t.version,t.solutions.length,t.errors))}}catch(e){throw new c.SolutionCloseError(p.errorStrings.errorDuringCloseSolution(e?.toString()))}finally{r.end(),r.sendTelemetry(),t.vscodeWorkspaceFileWatcher?.dispose(),(0,u.sendFirstInteractionWithExplorerTelemetry)()}}),{importance:a.LogImportance.low,telemetry:r}),await o.commands.executeCommand("setContext","solutionOpened",!1)},t.reloadSolution=async function(e){u.logger.log("reload solution"),await u.logger.watch("Reload a solution",(async function(){try{u.environmentStateManager&&await u.logger.watch("Reload a solution with environment service",(async function(){const t=await u.environmentStateManager.loadSolution(e);u.projectInitializationStatus?.onEnvironmentUpdate(t.version,t.solutions.length,t.errors)}))}catch(e){throw new c.SolutionReloadError(p.errorStrings.errorDuringReloadSolution(e?.toString()))}}))},t.getOpenedSolution=async function(){return u.environmentStateManager?.getOpenedSolution()}},78305:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectProjects=void 0;const n=r(89496),i=r(49397),o=r(92181),s=r(65300),a=r(22677),c=r(7195),u=r(71017);t.selectProjects=async function(){const e=await(0,i.getAllProjects)(),t=await(0,s.getOpenedSolution)();if(!e||0===e.length)return n.window.showWarningMessage(a.promptStrings.noProjectsFoundInWorkspace),[];const r=await async function(){const e=n.window.activeTextEditor?.document;if(!e?.fileName)return;const t=e.fileName;let r;r=".csproj"===u.extname(t).toLowerCase()||".shproj"===u.extname(t).toLowerCase()?{context:"Projects",query:{$properties:["Id","Path","Guid"],$filter:{ProjectsByPath:[[t]]}}}:{context:"Projects",query:{$properties:["Id","Files"],Files:{$properties:["Id"],$filter:{FilesByPath:[[t]]}},$where:{any:{".":"Files"}}}};try{const e=await c.projectQueryableSpace.executeQuery(r),t=e.Items?.[0];if(t?.Id?.ProjectPath)return{name:u.basename(t.Id.ProjectPath,u.extname(t.Id.ProjectPath)),path:t.Id.ProjectPath}}catch(e){console.log("Failed to get current project:",e)}}();let l,d;const p=[];if(t){const e=c.environmentStateManager?.isSolutionGeneratedOutsideWorkspace()?a.promptStrings.workspaceSeparatorLabel:a.promptStrings.solutionSeparatorLabel;p.push({label:e,kind:n.QuickPickItemKind.Separator,isSolution:!1}),d={label:"All Projects",description:t,isSolution:!0,picked:!r},p.push(d)}l=d,p.push({label:a.promptStrings.projectsSeparatorLabel,kind:n.QuickPickItemKind.Separator,isSolution:!1});const f=e.sort(((e,t)=>e.Name.localeCompare(t.Name))).map((e=>{const t=r&&u.normalize(e.Path)===u.normalize(r.path),n={label:e.Name,description:e.Path||"",project:{name:e.Name,path:e.Path||"",ProjectGuid:e.Guid||""},isSolution:!1,picked:t};return t&&(l=n),n}));p.push(...f);const h=n.window.createQuickPick();h.placeholder=a.promptStrings.multiSelectProjectOrSolution,h.title=a.promptStrings.selectProjectOrSolution,h.items=p,h.canSelectMany=!0,h.ignoreFocusOut=!0,l&&(h.activeItems=[l],h.selectedItems=[l]),h.show();const g=await new Promise((e=>{let t=!1;h.onDidAccept((()=>{if(t)return;t=!0;const r=h.selectedItems.filter((e=>!("kind"in e)));h.dispose(),e(r)})),h.onDidHide((()=>{t||(t=!0,h.dispose(),e([]))}))})),m=[];for(const e of g)e.isSolution?e.description&&m.push({contextValue:o.contextValues.solution,node:{path:e.description,name:e.label,nodeType:o.nodeTypes.solution},label:e.label,resourceUri:n.Uri.file(e.description)}):e.project&&m.push({contextValue:o.contextValues.project,node:{path:e.project.path,name:e.project.name,nodeType:o.nodeTypes.project,ProjectGuid:e.project?.ProjectGuid||""},label:e.project.name,resourceUri:n.Uri.file(e.project.path)});return m}},82070:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(69279),o=r(7195),s=r(92181),a=r(74939),c=r(2906),u=r(22677);async function l(e){await n.window.showErrorMessage(u.errorStrings.removeOperationFailed(e))}t.default=async function(e){if(!n.extensions.getExtension(i.EXTENSION_ID))throw new Error("Unable to find the extension.");(e=e??await(0,c.getSelectedSolutionTreeNodeInExplorer)())&&e.node&&await n.window.showWarningMessage(u.promptStrings.removeItemConfirmation(e.node.Name),{modal:!0},u.promptStrings.ok)&&(e.node.NodeType===s.nodeTypes.file&&e.node.Flags?.includes(a.TreeFlags.linkedItem)?await async function(e){await o.logger.watch("Remove file from a project",(async()=>{const t={update:{target:{context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[e.node.ProjectGuid]]},$properties:["Id"],$get:{Files:{$filter:{FilesByPath:[[e.node.Path]]},$properties:["Id","Path"]}}}},steps:["Exclude"]}},r=await o.projectQueryableSpace.executeAction(t);r.Errors&&(await l(e.node.Name),r.Errors.forEach((e=>{o.logger.log(e.Message)})))}),{catchUnhandledErrors:!0})}(e):await l(e.node.Name),e&&(0,o.sendFirstInteractionWithExplorerTelemetry)())}},10976:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(69279),o=r(7195),s=r(65979),a=r(98986),c=r(79994),u=r(16260),l=r(29047);t.default=async function(e){const t=n.extensions.getExtension(i.EXTENSION_ID);if(!t)throw new Error("Unable to find the extension.");const r=t.exports.serviceBroker,d=a.NuGetAction.remove,p=new u.TelemetryEvent("nuget/remove-nuget-package",o.telemetryService);try{const t=(0,c.getActiveWorkspaceRoot)(),n=await(0,a.verifyServicePrerequisites)(d,t,r,p);if(!n||!n.isPrerequisiteMet)return void(0,l.cancelAtStepTelemetry)(p,"verify-prerequisites");const i=(0,a.getProjectFromContext)(e),u=(0,a.getPackageFromContext)(e);u?(0,l.addEntrypointTelemetry)(p,"package-dependency-context-menu"):(0,l.addEntrypointTelemetry)(p,"command-palette");const f=i??await(0,a.showProjectPicker)(d,p);if(!f)return void(0,l.cancelAtStepTelemetry)(p,"project-picker");const h=u??await(0,a.showPackagePickerFromPromise)(d,(0,a.retrieveInstalledPackages)(f.fullPath,r,p));if(!h)return void(0,l.cancelAtStepTelemetry)(p,"package-picker");await o.logger.watch("Remove NuGet package",(async function(){const e=await r.getProxy(s.default.nugetCommandsService);try{const t=await(0,l.runWithDurationTelemetry)((async()=>await(e?.removePackage(f.fullPath,h.id))),p,"removePackage");p.addOrUpdateProperties({succeeded:String(t)})}finally{e?.dispose(),(0,l.addCompletedTelemetry)(p)}}),{telemetry:p,catchUnhandledErrors:!0})}finally{p.sendTelemetry()}e&&o.sendFirstInteractionWithExplorerTelemetry}},6923:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(69279),o=r(7195),s=r(65979),a=r(22677),c=r(75010),u=r(2906);t.default=async function(e,t,r=!1){if(!(t=t??await(0,u.getSelectedSolutionTreeNodeInExplorer)())||!t.node)return;if(!r&&!await n.window.showWarningMessage(a.promptStrings.removeItemConfirmation(t.node.Name),{modal:!0},a.promptStrings.ok))return;const l=n.extensions.getExtension(i.EXTENSION_ID);if(!l)throw new Error("Unable to find the extension.");const d=l.exports.serviceBroker;await async function(e,t){const r=new c.TelemetryActivity("remove-project",o.telemetryService),n=await t.getProxy(s.default.solutionFileService);try{await o.logger.watch("Remove project",(async()=>{e.node.ProjectGuid&&await(n?.removeProject(e.node.ProjectGuid))}),{telemetry:r})}finally{n?.dispose(),r.end(),r.sendTelemetry()}}(t,d),t&&o.sendFirstInteractionWithExplorerTelemetry}},20481:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeProjectReferenceByProjectPath=t.removeProjectReferenceByProjectGuid=void 0;const n=r(89496),i=r(7195),o=r(22677),s=r(75010),a=r(92181),c=r(71017);async function u(e){const t=await i.projectQueryableSpace.executeQuery({context:"Projects",query:{$properties:["Name","Path","Id"],$filter:{ProjectsByCapabilities:["!SharedAssetsProject"]}}});if(!t.Items?.length)return void n.window.showWarningMessage(o.errorStrings.addProjectReferenceNoProjects,{modal:!0});const r=t.Items.filter((e=>e.Path&&e.Name&&e.Id?.ProjectGuid)).map((e=>({path:e.Path,label:e.Name,guid:e.Id.ProjectGuid})));return r.sort(((e,t)=>e.label.localeCompare(t.label))),e?r.find((t=>t.path.toLocaleUpperCase()===e.toLocaleUpperCase())):await n.window.showQuickPick(r,{placeHolder:o.promptStrings.selectSourceProject})}async function l(e,t){const r={update:{target:{context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[e]]},$get:{ProjectReferences:{$where:{"==":[{".":"ReferencedProjectPath"},t]}}}}},steps:["Delete"]}},n=await i.projectQueryableSpace.executeAction(r);n.Errors&&n.Errors.forEach((e=>{i.logger.log(e.Message)}))}t.default=async function(e){let t;if(e instanceof n.Uri){const r=c.normalize(e.fsPath);t=await u(r)}else e?.contextValue===a.contextValues.project&&e.node.Path&&e.node.ProjectGuid&&(t={path:e.node.Path,label:e.node.Name,guid:e.node.ProjectGuid});if(!t&&(t=await u(),!t))return;const r=await async function(e){return await i.logger.watch("Get project to add reference to.",(async()=>{const t={context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[e]]},$get:{ProjectReferences:{}},$properties:["Name","Path","Id"]}},r=await i.projectQueryableSpace.executeQuery(t);if(r.Items){const e=r.Items.map((e=>({path:e.ReferencedProjectPath,label:e.ReferencedProjectPath})));return 0===e.length?void n.window.showWarningMessage(o.errorStrings.removeProjectReferenceNoProjects,{modal:!0}):(e.sort(((e,t)=>e.label.localeCompare(t.label))),(await n.window.showQuickPick(e,{placeHolder:o.promptStrings.selectReferenceToRemove}))?.path)}}),{catchUnhandledErrors:!1})}(t.guid);if(!r)return;const d=new s.TelemetryActivity("remove-project-reference",i.telemetryService);try{await i.logger.watch("Remove project reference",(async()=>{await l(t.guid,r)}),{telemetry:d,catchUnhandledErrors:!1})}finally{d.end(),d.sendTelemetry()}e&&(0,i.sendFirstInteractionWithExplorerTelemetry)()},t.removeProjectReferenceByProjectGuid=l,t.removeProjectReferenceByProjectPath=async function(e,t){const r={update:{target:{context:"Projects",query:{$filter:{ProjectsByPath:[[e]]},$get:{ProjectReferences:{$where:{"==":[{".":"ReferencedProjectPath"},t]}}}}},steps:["Delete"]}},n=await i.projectQueryableSpace.executeAction(r);n.Errors&&n.Errors.forEach((e=>{i.logger.log(e.Message)}))}},84611:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(69279),o=r(7195),s=r(65979),a=r(2906),c=r(22677);t.default=async function(e){const t=n.extensions.getExtension(i.EXTENSION_ID);if(!t)throw new Error("Unable to find the extension.");if(!(e=e??await(0,a.getSelectedSolutionTreeNodeInExplorer)())||!e.node)return;if(!await n.window.showWarningMessage(c.promptStrings.removeItemConfirmation(e.node.Name),{modal:!0},c.promptStrings.ok))return;const r=t.exports.serviceBroker;await o.logger.watch("Remove a solution folder",(async function(){const t=await r.getProxy(s.default.solutionFileService);try{e.node.ProjectGuid&&await(t?.removeProject(e.node.ProjectGuid))}finally{t?.dispose()}}),{catchUnhandledErrors:!0}),e&&(0,o.sendFirstInteractionWithExplorerTelemetry)()}},61574:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(69279),o=r(7195),s=r(65979),a=r(92181),c=r(2906),u=r(79994),l=r(27619),d=r(71017),p=r(22677),f=r(65300);function h(e){if(e)throw e.forEach((e=>{o.logger.log(e.Message)})),new Error}async function g(e){await n.window.showErrorMessage(p.errorStrings.renameOperationFailed(e))}t.default=async function(e){const t=n.extensions.getExtension(i.EXTENSION_ID);if(!t)throw new Error("Unable to find the extension.");if(!(e=e??await(0,c.getSelectedSolutionTreeNodeInExplorer)())||!e.node)return;const r=t.exports.serviceBroker;var m=void 0;const v=e.node.Name.lastIndexOf(".");v>0&&(m=[0,v]);const y=await n.window.showInputBox({title:p.promptStrings.newName,value:e.node.Name,valueSelection:m,validateInput:async function(e){if(!e||0===e.length)return p.errorStrings.noName}});y&&y!==e.node.Name&&(e.node.NodeType===a.nodeTypes.project?await async function(e,t,r){if(!e.node.Path||!e.node.ProjectGuid)return void await g(e.node.Name);const n=t+d.extname(e.node.Path),i=d.dirname(e.node.Path),a=d.join(i,n);let c=f.vscodeWorkspaceFileWatcher?.onMoveProjectFile(e.node.Path,a);try{await async function(e,t,r){const n={update:{target:{context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[t]]},$properties:["Id"]}},steps:[{RenameProject:{NewName:e}}]}};h((await r.executeAction(n)).Errors)}(t,e.node.ProjectGuid,o.projectQueryableSpace),await async function(e,t,r){await o.logger.watch("Rename Project in Solution File",(async function(){const n=await t.getProxy(s.default.solutionFileService);if(n)try{if(r.node.ProjectGuid&&r.node.Path){const t=await u.getRelativePathToSolution(e);await(n?.moveProject(r.node.ProjectGuid,t))}}catch(e){throw o.logger.log(`Error renaming project in solution file with error: ${e}`),e}finally{n?.dispose()}}))}(a,r,e),await async function(e,t,r){const n={context:"Projects",query:{$properties:["Path"],ProjectReferences:{$properties:["ReferencedProjectPath"],$where:{"==":[{".":"ReferencedProjectPath"},t]}},$where:{any:{".":"ProjectReferences"}}}},i=await r.executeQuery(n);if(i.Items&&i.Items.length>0){const n=i.Items.filter((e=>e.Path)).map((e=>e.Path)),o=d.dirname(t),s={update:{target:{context:"Projects",query:{$properties:["Path"],$filter:{ProjectsByPath:[n]}}},steps:[{AddProjectReferenceByPath:{ReferenceType:"Reference",ReferencedProjectPath:d.join(o,e)}}]}};h((await r.executeAction(s)).Errors),await async function(e,t){const r={update:{target:{context:"Projects",query:{$get:{ProjectReferences:{$where:{"==":[{".":"ReferencedProjectPath"},t]}}}}},steps:["Delete"]}};h((await e.executeAction(r)).Errors)}(r,t)}}(n,e.node.Path,o.projectQueryableSpace),c&&c.onComplete()}catch(t){t instanceof Error&&o.logger.log(t.message),c&&c.onAbort(),await g(e.node.Name)}finally{c&&c.onComplete()}}(e,y,r):e.parentNode&&e.parentNode.node.NodeType===a.nodeTypes.solutionFolder?await async function(e,t,r){const i=e.parentNode;i?await o.logger.watch("Rename a file in a solution folder",(async function(){const a=await r.getProxy(s.default.solutionFileService);if(a)try{const r=i.node.ProjectGuid;if(void 0!==r&&e.node.Path){const i=d.dirname(e.node.Path),o=await u.getRelativePathToSolution(e.node.Path),s=d.join(i,t),c=await u.getRelativePathToSolution(s);await(a?.removeSolutionItem(r,o));const l=new n.WorkspaceEdit;l.renameFile(n.Uri.file(e.node.Path),n.Uri.file(s)),await n.workspace.applyEdit(l),await(a?.addSolutionItem(r,c))}}finally{a?.dispose()}else await g(e.node.Name),o.logger.log("Error renaming item in Solution Folder with error: SolutionFileServiceProxy is null")}),{catchUnhandledErrors:!0}):await g(e.node.Name)}(e,y,r):e.node.NodeType===a.nodeTypes.file?await async function(e,t){await o.logger.watch("Rename file in project",(async()=>{const r=await(0,l.saveAndCloseFile)(e.node.Path),i={update:{target:{context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[e.node.ProjectGuid]]},$properties:["Id"]}},steps:[{RenameFile:{FilePath:e.node.Path,NewName:t}}]}},s=await o.projectQueryableSpace.executeAction(i);if(s.Errors&&(await n.window.showErrorMessage(p.errorStrings.renameOperationFailed(e.node.Name)),s.Errors.forEach((e=>{o.logger.log(e.Message)}))),r){const r=d.join(d.dirname(e.node.Path),t);(0,l.openFileInWorkspace)(r)}}),{catchUnhandledErrors:!0})}(e,y):e.node.NodeType===a.nodeTypes.folder?await async function(e,t){await o.logger.watch("Rename folder in project",(async()=>{const r=await(0,l.saveAndCloseFilesInDirectory)(e.node.Path),n={update:{target:{context:"Projects",query:{$filter:{ProjectsByProjectGuid:[[e.node.ProjectGuid]]},$properties:["Id"]}},steps:[{RenameFolder:{FolderPath:e.node.Path,NewName:t}}]}},i=await o.projectQueryableSpace.executeAction(n);if(i.Errors&&(await g(e.node.Name),i.Errors.forEach((e=>{o.logger.log(e.Message)}))),r){const n=e.node.Path,i=d.join(d.dirname(n),t)+d.sep;for(const e of r){const t=e.replace(n,i);(0,l.openFileInWorkspace)(t)}}}),{catchUnhandledErrors:!0})}(e,y):g(e.node.Name),e&&(0,o.sendFirstInteractionWithExplorerTelemetry)())}},29235:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(69279),o=r(79994),s=r(7195),a=r(65979),c=r(22677),u=r(2906),l=r(1639);t.default=async function(e){const t=n.extensions.getExtension(i.EXTENSION_ID);if(!t)throw new Error("Unable to find the extension.");if(!(e=e??await(0,u.getSelectedSolutionTreeNodeInExplorer)())||!e.node)return;const r=t.exports.serviceBroker,d=e.parentNode?await(0,l.getExistingChildrenNodesNames)(r,e.parentNode.node):[],p=(await n.window.showInputBox({title:c.promptStrings.newSolutionFolder,value:e.node.Name,validateInput:t=>(0,l.validateSolutionFolderName)(t,d,[],e.node.Name)}))?.trim();p&&p!==e.node.Name&&(await s.logger.watch("Rename a solution folder",(async function(){const t=await r.getProxy(a.default.solutionFileService);try{let r=e.node.ProjectGuid;r&&0!==r.length||(r=o.emptyGuid),e.node.ProjectGuid&&await(t?.renameSolutionFolder(e.node.ProjectGuid,p))}finally{t?.dispose()}}),{catchUnhandledErrors:!0}),e&&(0,s.sendFirstInteractionWithExplorerTelemetry)())}},69658:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7195),i=r(92181),o=r(71017);function s(e,t){var s="";const a=r(22037).platform().toLowerCase().replace(/[0-9]/g,"").replace("darwin","macos");switch(a){case"win":s="explorer";break;case"linux":s="xdg-open";break;case"macos":s="open"}const c=r(32081);let u;switch(e){case i.nodeTypes.file:case i.nodeTypes.project:case i.nodeTypes.solution:u="win"===a?c.spawn(s,["/e,/select,",t]):"macos"===a?c.spawn(s,["-R",t]):c.spawn(s,[o.dirname(t)]);break;case i.nodeTypes.folder:"win"===a&&(t=t.substring(0,t.length-1)),u=c.spawn(s,[t]);break;default:u=c.spawn(s,[o.dirname(t)])}u.on("error",(e=>{n.logger.log(`Error executing Reveal In Explorer for ${t} ${e}`),u.kill()}))}t.default=async function(e){const t=e.node.Path;if(t){const o=r(57147);try{if(await o.promises.access(t),void 0!==e.contextValue)if(n.environmentStateManager?.isSolutionGeneratedOutsideWorkspace()&&e.contextValue===i.nodeTypes.solution){const t=n.environmentStateManager?.getActiveWorkspaceRoot();if(!t)return;s(e.contextValue,t)}else s(e.contextValue,t)}catch(e){return}}e&&(0,n.sendFirstInteractionWithExplorerTelemetry)()}},77855:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(57147),i=r(89496),o=r(7195),s=r(65979),a=r(22677),c=r(16260),u=r(65300),l=r(79994),d=r(71017),p=r(79994);t.default=async function(){const e=o.environmentStateManager?.getActiveWorkspace();if(!o.environmentStateManager?.isSolutionGeneratedOutsideWorkspace()||!e)return;const t=e.uri.fsPath,r=await async function(e){const t=[{label:a.addNewItemUiStrings.defaultDirectory,id:"default",description:e},{label:a.addNewItemUiStrings.chooseDirectory,id:"picker"}],r=await i.window.showQuickPick(t,{title:a.addNewItemUiStrings.locationForNewSolutionFile,placeHolder:e});if(!r)return;if("default"===r.id)return e;const n=await i.window.showOpenDialog({canSelectFolders:!0,canSelectFiles:!1,canSelectMany:!1,title:a.addNewItemUiStrings.projectLocation,defaultUri:i.Uri.file(e)});return n?n[0].fsPath:void 0}(t);if(!r)return;const f=await async function(e){const t=await(0,u.getOpenedSolution)(),r=d.parse(t).name;let o=(await i.window.showInputBox({title:a.addNewItemUiStrings.newSolutionFileName,value:r,validateInput:async function(t){return t&&0!==t.length?await async function(e,t){if(!e||0===e.length)return a.errorStrings.noName;for(const t of'"*<>:|?/\\')if(-1!==e.indexOf(t))return a.addNewItemUiStrings.pathInvalidChars;return e.length>50?a.addNewItemUiStrings.pathTooLong:n.existsSync(d.join(t,`${e}.sln`))||n.existsSync(d.join(t,`${e}.slnx`))?a.addNewItemUiStrings.solutionAlreadyExists:null}(t,e):a.addNewItemUiStrings.newSolutionFileName}}))?.trim();return o}(r);if(!f)return;const h=await(0,p.selectSolutionFileFormat)(r);if(!h)return;const g=f+h,m=l.getExtensionBrokerService(),v=await m.getProxy(s.default.solutionFileService);let y;try{y=await(v?.saveSolutionFileInWorkspace(t,r,g))}catch(e){i.window.showErrorMessage(a.errorStrings.errorSaveSolutionFile(e))}finally{v?.dispose()}if(!y||0===y.length)return;const _=o.environmentStateManager.getLatestEnvironmentState();await o.environmentStateManager.setSolutionAndFolderWorkspace(y,_.folders,_.configuration),u.vscodeWorkspaceFileWatcher?.dispose();const S=new c.TelemetryEvent("sln-less-solution-creation",o.telemetryService);S.addOrUpdateProperties({extensionType:h}),S.sendTelemetry()}},92624:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchFromCommandPalette=t.searchOpenFromCommandPalette=t.searchProjectFromCommandPalette=void 0;const n=r(89496);function i(e){n.commands.executeCommand("workbench.action.quickOpen",">"+e)}t.searchProjectFromCommandPalette=function(){i(".NET: Project")},t.searchOpenFromCommandPalette=function(){i(".NET: Open")},t.searchFromCommandPalette=function(){i(".NET:")}},95113:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(69279),o=r(65979),s=r(7195),a=r(22677),c=r(7195);n.extensions.getExtension(i.EXTENSION_ID),t.default=async function(e){const t=c.environmentStateManager?.getLatestEnvironmentState()?.configuration;if(!t)return;const r=await async function(){const e=n.extensions.getExtension(i.EXTENSION_ID);if(!e)throw new Error("Unable to find the extension.");const t=e.exports.serviceBroker,r=await t.getProxy(o.default.solutionFileService);try{return await(r?.getSolutionConfigurations())}catch(e){return void s.logger.log(`Error fetching the solution configurations: ${e}`)}finally{r?.dispose()}}();if(r){const i=function(e){const t=new Set,r=new Set;return e.forEach((e=>{if(e){var n=e.split("|");n.length>=1&&t.add(n[0].trim()),n.length>=2&&r.add(n[1].trim())}})),{configurationNames:t,platformNames:r}}(r);let o=await n.window.showQuickPick(Array.from(i.configurationNames),{placeHolder:a.promptStrings.selectConfiguration});if(o){let r;if(i.platformNames.size>1){const e=await n.window.showQuickPick(Array.from(i.platformNames),{placeHolder:a.promptStrings.selectPlatform});e&&(r=e)}if(r=r||t.split("|")[1],o=`${o}|${r}`,t!==o){e.workspaceState.update("configSetting",o);const t="workbench.action.reloadWindow",r={title:a.promptStrings.reloadWindow,isCloseAffordance:!1};n.window.showInformationMessage(a.promptStrings.reloadOnConfigurationChange,r).then((e=>e===r&&n.commands.executeCommand(t)))}}}}},87211:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(22677),o=r(29758);t.default=async function(){n.workspace.getConfiguration("csharp.preview").get("improvedLaunchExperience",!0)?(0,o.getActiveDebugTargetFrameworkService)().pickDebugTargetFramework():n.window.showErrorMessage(i.debugProjectLaunchStrings.errorImprovedLaunchExperienceNotEnabled)}},35199:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(22677),o=r(58741);t.default=async function(){n.workspace.getConfiguration("csharp.preview").get("improvedLaunchExperience",!0)?(0,o.getActiveLaunchConfigurationService)().pickLaunchConfiguration():n.window.showErrorMessage(i.debugProjectLaunchStrings.errorImprovedLaunchExperienceNotEnabled)}},49546:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(69279),o=r(17407),s=r(22677);t.default=async function(){if(!n.extensions.getExtension(i.EXTENSION_ID))throw new Error("Unable to find the extension.");n.workspace.getConfiguration("csharp.preview").get("improvedLaunchExperience",!0)?o.startupProjectService.pickStartupProject():n.window.showErrorMessage(s.debugProjectLaunchStrings.errorImprovedLaunchExperienceNotEnabled)}},57834:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(22677);t.default=async function(){const e={title:i.promptStrings.manageWorkspaceTrust,isCloseAffordance:!1},t={title:i.promptStrings.learnMore,isCloseAffordance:!1};n.window.showWarningMessage(i.promptStrings.workspaceTrustMessage,{modal:!0,detail:i.promptStrings.workspaceTrustDetail},e,t).then((r=>{r===e?n.commands.executeCommand("workbench.trust.manage"):r===t&&n.commands.executeCommand("vscode.open",n.Uri.parse("https://aka.ms/vscode-workspace-trust"))}))}},20695:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSolutionBuildAction=t.BuildActionOptions=t.SOLUTION_BUILD_AVAILABLE=t.solutionBuildContextVisible=t.NO_SOLUTION_BUILD_FLAG=t.CLEAN=t.BUILD=void 0;const n=r(89496),i=r(69279),o=r(49397),s=r(7195),a=r(65979),c=r(75010),u=r(92181),l=r(65300),d=r(71017);t.BUILD="build",t.CLEAN="clean",t.NO_SOLUTION_BUILD_FLAG="",t.solutionBuildContextVisible="solutionBuildContextVisible",t.SOLUTION_BUILD_AVAILABLE=!0;const p=new class{cachedPromise};async function f(e,t,r,n,i){for(const o of t){if(o.NodeType===u.nodeTypes.project&&(o.ProjectGuid===r||o.Name===n))return i.length>0?`${i.join("\\")}\\${n}`:n;if(o.NodeType===u.nodeTypes.solutionFolder){const t=await e.getChildrenNodes(o),s=await f(e,t,r,n,[...i,o.Name]);if(s)return s}}}t.BuildActionOptions=class{action;flag;noSolution;constructor(e,t){this.action=e,this.flag=t}},t.setSolutionBuildAction=async function(e,r,h){if(!n.extensions.getExtension(i.EXTENSION_ID))throw new Error("Unable to find the extension.");const g=await(0,l.getOpenedSolution)();e.noSolution=void 0===g;let m,v="string"==typeof r?r:r?.resourceUri?.fsPath;if(g&&void 0!==r&&"string"!=typeof r&&r.contextValue===u.contextValues.project&&!s.environmentStateManager?.isSolutionGeneratedOutsideWorkspace()){m=r.label?.toString();let e=r.parentNode;for(;e&&e.contextValue===u.contextValues.solutionFolder;)m=`${e.label}\\${m}`,e=e.parentNode;if(!r.parentNode)try{const e=n.extensions.getExtension(i.EXTENSION_ID);if(e?.exports?.serviceBroker){const t=await async function(e,t,r){if(t&&r)try{const n=await e.getProxy(a.default.solutionExplorerService);if(!n)return;try{const e=await n.getRootNodes();return await f(n,e,t,r,[])}finally{n.dispose()}}catch(e){return void s.logger?.log(`Error getting solution folder path: ${e}`)}}(e.exports.serviceBroker,r.node.ProjectGuid,r.label?.toString());t&&(m=t)}}catch(e){s.logger?.log(`Failed to get solution folder path for project: ${e}`)}m=`/target:${m?.replace(/[%$@;.()']/g,"_")}`}const y=h.workspaceState.get("defaultSolution");if(void 0!==r&&"string"!=typeof r&&r.contextValue===u.contextValues.solution&&v&&y&&".slnf"===d.extname(y)&&(v=y),!v){if(e.noSolution)return!1;v=y&&".slnf"===d.extname(y)?y:r instanceof n.Uri&&r.fsPath.endsWith(".csproj")?d.normalize(r.fsPath):g}return await async function(e,r,i,a){const u=new c.TelemetryActivity("invoke-solution-build",s.telemetryService);return u.start(),await s.logger.watch("Solution Build Action",(async()=>{try{if(void 0!==p.cachedPromise)return!1;t.SOLUTION_BUILD_AVAILABLE=!1,await n.commands.executeCommand("setContext",t.solutionBuildContextVisible,t.SOLUTION_BUILD_AVAILABLE),n.workspace.saveAll(!1);const s=await(0,o.dotnetSolutionBuildActionUsingTask)(e,r,i,a);return p.cachedPromise??=s.success,await p.cachedPromise}catch(e){return!1}finally{p.cachedPromise=void 0,t.SOLUTION_BUILD_AVAILABLE=!0,await n.commands.executeCommand("setContext",t.solutionBuildContextVisible,t.SOLUTION_BUILD_AVAILABLE),u.end(),u.sendTelemetry()}}))}(e.action,v,e.flag,m)}},91058:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rebuildSolution=t.cleanSolution=t.buildSolution=void 0;const n=r(89496),i=r(7195),o=r(20695),s=r(78305),a=r(22677);async function c(e,t,r){let c;if(e)(0,i.sendFirstInteractionWithExplorerTelemetry)(),c=[e];else if(c=await(0,s.selectProjects)(),!c||0===c.length)return!1;return n.window.withProgress({location:n.ProgressLocation.Window,title:`${t.action===o.BUILD?t.noIncremental?a.messageStrings.rebuildMessage:a.messageStrings.buildMessage:a.messageStrings.cleanMessage} ${a.messageStrings.projectsMessage(c.length)}`,cancellable:!1},(async e=>{let i=!0;const s=c.length;for(let n=0;n<c.length;n++){const a=c[n],u="string"==typeof a.label?a.label:a.label?.label||a.node?.Name||"Unknown";e.report({increment:0===n?0:Math.round(100/s),message:s>1?`${u} (${n+1}/${s})`:u});try{await(0,o.setSolutionBuildAction)(new o.BuildActionOptions(t.action,t.noIncremental),a,r)||(i=!1)}catch(e){i=!1}}return i||n.commands.executeCommand("workbench.panel.markers.view.focus"),i}))}t.buildSolution=(e,t)=>c(t,{action:o.BUILD},e),t.cleanSolution=(e,t)=>c(t,{action:o.CLEAN},e),t.rebuildSolution=(e,t)=>c(t,{action:o.BUILD,noIncremental:!0},e)},1639:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateSolutionFolderName=t.getExistingChildrenNodesNames=void 0;const n=r(7195),i=r(65979),o=r(22677),s=r(73228),a=r(92181);t.getExistingChildrenNodesNames=async function(e,t){var r=[];return await n.logger.watch("Get existing items",(async function(){const n=await e.getProxy(i.default.solutionExplorerService);try{const e=t.NodeType===a.nodeTypes.solution?await(n?.getRootNodes()):await(n?.getChildrenNodes(t));e&&(r=e?.map((e=>e.Name)))}finally{n?.dispose()}}),{catchUnhandledErrors:!0}),r},t.validateSolutionFolderName=function(e,t,r,n){if(!e||0===e.length)return o.errorStrings.noName;if(e.length>260)return o.errorStrings.pathTooLong;for(const t of'"*<>:|?\\/')if(-1!==e.indexOf(t))return o.errorStrings.pathInvalidChars;if(r.includes(e))return o.errorStrings.solutionContainsItem(e);if(e=e.trim(),!n||!(0,s.equalsInvariantIgnoreCase)(n,e))for(const r of t)if((0,s.equalsInvariantIgnoreCase)(e,r))return o.errorStrings.folderContainsItem(e)}},79994:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAutoOpenSolutionAlreadyOpen=t.resolveAutoOpenSolutionPath=t.getAutomaticallyCreateSolutionInWorkspaceSetting=t.shouldUseWorkspaceBased=t.getWorkspaceBasedDevelopmentSetting=t.getAutoOpenSolution=t.selectSolutionFileFormat=t.getExtensionBrokerService=t.updateDefaultName=t.calculateDefaultFolderName=t.doesSolutionContainProjectByPath=t.doesSolutionContainProject=t.isWorkingDirectoryInWorkspace=t.getRelativePathToSolution=t.parseSolutionFolderFromContextMenu=t.getActiveWorkspaceRoot=t.addProjectToSolution=t.convertToFullPath=t.emptyGuid=void 0;const n=r(57147),i=r(89496),o=r(69279),s=r(49397),a=r(30077),c=r(7195),u=r(77867),l=r(22677),d=r(73228),p=r(92181),f=r(65300),h=r(71017);async function g(e){if(!h.isAbsolute(e)){const r=i.workspace.workspaceFolders;if(r&&r.length>0){if(1===r.length)return h.join(r[0].uri.fsPath,e);for(var t=0;t<r.length;t++)if(e.startsWith(r[t].name+"/")){const n=h.join(r[t].uri.fsPath,e.substring(r[t].name.length+1));if(await(0,d.fileOrDirectoryExists)(n))return n}for(t=0;t<r.length;t++){const n=h.join(r[t].uri.fsPath,e);if(await(0,d.fileOrDirectoryExists)(n))return n}}}return e}function m(){const e=i.workspace.getConfiguration("dotnet.solution").get("autoOpen");return e&&""!==e.trim()?e.trim():void 0}function v(){const e=i.workspace.getConfiguration("dotnet"),t=e.get("enableWorkspaceBasedDevelopment");return void 0!==t?t:e.get("previewSolution-freeWorkspaceMode",!1)}function y(){return v()}async function _(){const e=m();if(!e)return;const t=await g(e);return await(0,d.fileOrDirectoryExists)(t)?t:void 0}t.emptyGuid="00000000-0000-0000-0000-000000000000",t.convertToFullPath=g,t.addProjectToSolution=async function(e,t,r,n,o){try{n?await(0,u.dotnetCommand)(a.DotnetCommand.slnAddIntoFolder,e,["sln",t,"add",r,"--solution-folder",n]):o?await(0,u.dotnetCommand)(a.DotnetCommand.slnAdd,e,["sln",t,"add",r,"--in-root"]):await(0,u.dotnetCommand)(a.DotnetCommand.slnAdd,e,["sln",t,"add",r])}catch(e){if(!(e instanceof a.DotnetCommandError))throw e;t.endsWith(".slnx")&&i.window.showInformationMessage(l.promptStrings.addProjectIsNotSupportedForSlnx)}},t.getActiveWorkspaceRoot=function(){let e=c.environmentStateManager?.getActiveWorkspaceRoot();if(!e||!(0,n.existsSync)(e))throw new Error(l.errorStrings.noSolution);return e},t.parseSolutionFolderFromContextMenu=function(e){let t;return e?.contextValue===p.contextValues.solutionFolder&&(t=e.path),t},t.getRelativePathToSolution=async function(e){const t=await(0,f.getOpenedSolution)();if(t)return h.relative(h.dirname(t),e);throw new Error(l.errorStrings.noSolution)},t.isWorkingDirectoryInWorkspace=function(e){const t=(0,s.getOpenedWorkspaceHelper)(),r=t?.uri.fsPath,n=(0,d.containsFileOrFolder)(r,e);return n||i.window.showWarningMessage(l.errorStrings.addingOutsideWorkspace(e,r),{modal:!0}),n},t.doesSolutionContainProject=async function(e,t){const r=await(0,s.getAllProjects)(),n=r?.map((e=>e.Name)),o=void 0!==n?.find((t=>(0,d.equalsInvariantIgnoreCase)(t,e)));return o&&!t&&i.window.showWarningMessage(l.errorStrings.solutionContainsItem(e),{modal:!0}),o},t.doesSolutionContainProjectByPath=async function(e){const t=await(0,s.getAllProjects)(),r=h.normalize(e),n=t?.some((e=>{const t=h.normalize(e.Path);return(0,d.equalsInvariantIgnoreCase)(t,r)}))??!1;return n&&c.logger.log(`Project path check for "${e}" found existing project`),n},t.calculateDefaultFolderName=function(e){const t="NewFolder";var r=[];if(e)for(const n of e)if((0,d.startsWithInvariantIgnoreCase)(n,t)){const e=n.substring(9),t=Number.parseInt(e);t&&t>=1&&r.push(t)}const n=r.sort();var i=1;for(const e of n)if(i===e)i++;else if(e>i)break;return`${t}${i}`},t.updateDefaultName=function e(t,r){return r.includes(t)?e("NewFolder"+(parseInt(t.substring(9))+1),r):t},t.getExtensionBrokerService=function(){const e=i.extensions.getExtension(o.EXTENSION_ID);if(!e)throw new Error("Unable to find the extension");return e.exports.serviceBroker},t.selectSolutionFileFormat=async function(e){if(!e)return;let t;return t=await(0,f.isSlnxSupportedInWorkspace)(e)?await i.window.showQuickPick([l.addNewItemUiStrings.slnFileFormat,l.addNewItemUiStrings.slnxFileFormat],{placeHolder:l.addNewItemUiStrings.selectSolutionFileFormat}):".sln",t},t.getAutoOpenSolution=m,t.getWorkspaceBasedDevelopmentSetting=v,t.shouldUseWorkspaceBased=y,t.getAutomaticallyCreateSolutionInWorkspaceSetting=function(){return!y()&&i.workspace.getConfiguration("dotnet").get("automaticallyCreateSolutionInWorkspace",!0)},t.resolveAutoOpenSolutionPath=_,t.isAutoOpenSolutionAlreadyOpen=async function(e,t){if(!e||!t)return!1;const r=await _();return!!r&&r.toUpperCase()===t.toUpperCase()&&r.toUpperCase()===e.toUpperCase()}},34586:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(65979),o=r(2906),s=r(79994),a=r(71017),c=r(7195);t.default=async function(e){const t=function(){const e=n.window.activeTextEditor?.document;return void 0!==e?.fileName?e.fileName:""}();let r;const u=c.environmentStateManager?.getOpenedSolutionExt();if(u&&a.extname(t)===u)r=[];else{const e=await async function(e){let t;t=".csproj"===a.extname(e)||".shproj"===a.extname(e)?{context:"Projects",query:{$properties:["Id","Path","Guid"],$filter:{ProjectsByPath:[[e]]}}}:{context:"Projects",query:{$properties:["Id","Files"],Files:{$properties:["Id"],$filter:{FilesByPath:[[e]]}},$where:{any:{".":"Files"}}}};const r=await c.projectQueryableSpace.executeQuery(t);return r.Items?.[0]}(t);if(!e)return;const n=s.getExtensionBrokerService(),o=await n.getProxy(i.default.solutionFileService);try{r=await(o?.findActiveItemGuidsPath(e.Id.ProjectGuid))}finally{o?.dispose()}}e?.isCancellationRequested||void 0===r||await(0,o.expandToLocation)(t,r,e)}},27619:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openFileInWorkspace=t.saveAndCloseFilesInDirectory=t.saveAndCloseFile=void 0;const n=r(89496),i=r(71017),o=r(7195);async function s(e){try{await e.save()}catch{}let t=!1;for(;await a(e);)t=!0;return t}async function a(e){for(const t of n.window.tabGroups.all)for(const r of t.tabs)if(r.input instanceof n.TabInputText&&r.input.uri.fsPath===e.fileName)try{return await n.window.tabGroups.close(r),!0}catch{}return!1}t.saveAndCloseFile=async function(e){return!(!e||0===e.length)&&await o.logger.watch("Save and close opened files",(async()=>{const t=n.workspace.textDocuments.find((t=>t.fileName===e));return!(!t||!await s(t))}),{catchUnhandledErrors:!0})},t.saveAndCloseFilesInDirectory=async function(e){if(e&&0!==e.length)return await o.logger.watch("Save and close opended files in directory",(async()=>{let t=[];for(const i of n.workspace.textDocuments)r(i.fileName,e)&&await s(i)&&t.push(i.fileName);if(t.length>0)return t;function r(e,t){return e.length>=t.length&&!i.relative(t,e).startsWith("..")}}),{catchUnhandledErrors:!0})},t.openFileInWorkspace=async function(e){await o.logger.watch("Open file in workspace",(async()=>{const t=await n.workspace.openTextDocument(n.Uri.file(e));await n.window.showTextDocument(t)}),{catchUnhandledErrors:!0})}},85970:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(89496),i=r(69279),o=r(7195),s=r(65979),a=r(98986),c=r(79994),u=r(16260),l=r(29047),d=r(39058);t.default=async function(e){const t=n.extensions.getExtension(i.EXTENSION_ID);if(!t)throw new Error("Unable to find the extension.");const r=t.exports.serviceBroker,p=a.NuGetAction.update,f=new u.TelemetryEvent("nuget/update-nuget-package",o.telemetryService);try{const t=new d.NuGetConfigurationSettings;(0,l.addIncludePrereleaseTelemetry)(f,t.includePrerelease);const n=(0,c.getActiveWorkspaceRoot)(),i=await(0,a.verifyServicePrerequisites)(p,n,r,f);if(!i||!i.isPrerequisiteMet)return void(0,l.cancelAtStepTelemetry)(f,"verify-prerequisites");const u=(0,a.getProjectFromContext)(e),h=(0,a.getPackageFromContext)(e);h?(0,l.addEntrypointTelemetry)(f,"package-dependency-context-menu"):(0,l.addEntrypointTelemetry)(f,"command-palette");const g=u??await(0,a.showProjectPicker)(p,f);if(!g)return void(0,l.cancelAtStepTelemetry)(f,"project-picker");const m=h??await(0,a.showPackagePickerFromPromise)(p,(0,a.retrieveOutdatedPackages)(g.fullPath,t.includePrerelease,r,f),t);if(!m)return void(0,l.cancelAtStepTelemetry)(f,"package-picker");const v=await(0,a.showVersionPicker)(p,m,(0,a.retrievePackageVersions)(g.fullPath,m.id,t.includePrerelease,r,f),t);if(!v||v.version===m.version)return void(0,l.cancelAtStepTelemetry)(f,"version-picker");await o.logger.watch("Update NuGet package",(async function(){const e=await r.getProxy(s.default.nugetCommandsService);try{const t=await(0,l.runWithDurationTelemetry)((async()=>await(e?.updatePackage(g.fullPath,m.id,v.version))),f,"updatePackage");f.addOrUpdateProperties({succeeded:String(t)})}finally{e?.dispose(),(0,l.addCompletedTelemetry)(f)}}),{telemetry:f,catchUnhandledErrors:!0})}finally{f.sendTelemetry()}e&&(0,o.sendFirstInteractionWithExplorerTelemetry)()}},98349:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parsePackageInfo=t.getPackageInfo=void 0;const n=r(71017),i=r(73292);t.getPackageInfo=async function(e){let t=null;try{t=await(0,i.readFile)(n.join(e,"package.json"),"utf-8")}catch{}let r=[];if(t){const e=JSON.parse(t);if(e.dependencies)for(const t in e.dependencies)r.push(s(t))}return r};const o=/^(?<name>.*?)(?:\.(?<target>\w+-\w+))?$/;function s(e){const t=o.exec(e);if(!t?.groups)throw new Error("Unrecognized package id pattern: "+e);return{fullName:e,name:t.groups.name,target:t.groups.target}}t.parsePackageInfo=s},93197:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllComponentsMap=void 0;const n=r(73292),i=r(71017),o=r(98349);t.getAllComponentsMap=async function(e){const t=await async function(e){const t={},r=await(0,n.readdir)(e,{withFileTypes:!0});for(const s of r)if(s.isDirectory()){const a=i.join(e,s.name);if(await c(a),(await(0,n.readdir)(a)).indexOf("platforms")>=0){const u=i.join(a,"platforms"),l=await(0,n.readdir)(u,{withFileTypes:!0});for(const d of l)if(d.isDirectory()){const p=i.join(u,d.name);(await(0,n.readdir)(i.join(p))).indexOf("node_modules")>=0&&await c(i.join(u,d.name))}}async function c(e){const r=await(0,o.getPackageInfo)(e);for(const n of r)t[n.name]=i.resolve(e,"node_modules",n.fullName)}}return t}(e),r=await async function(e){try{const t=await(0,n.readFile)(i.join(e,"package.dev.json"),"utf-8"),r=JSON.parse(t),s={};if(r.dependencies)for(const t in r.dependencies)s[(0,o.parsePackageInfo)(t).name]=i.resolve(e,r.dependencies[t]);return s}catch{return{}}}(e);return Object.freeze({...t,...r})}},29758:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveDebugTargetFrameworkService=t.setupActiveDebugTargetFrameworkService=t.ActiveDebugTargetFrameworkService=void 0;const n=r(89496),i=r(48182),o=r(22677),s=r(17407),a=r(88764);class c{debugTargetFrameworkInfoObserver;startupProjectLaunchInfo;targetFrameworkInfos;currentStartupProjectDebugTargetFrameworkInfo;observers;unsubscribeFromStartupProjectObservable;unsubscribeFromDebugTargetFrameworkInfoObserver;constructor(e,t){this.debugTargetFrameworkInfoObserver=t,this.startupProjectLaunchInfo=void 0,this.targetFrameworkInfos=[],this.observers=[],this.unsubscribeFromStartupProjectObservable=e.subscribe(this.startupProjectObserver),this.unsubscribeFromDebugTargetFrameworkInfoObserver=t.subscribe(this.targetFrameworkInfoObserver)}dispose(){this.unsubscribeFromStartupProjectObservable(),this.unsubscribeFromDebugTargetFrameworkInfoObserver()}subscribe(e){return this.observers.push(e),e.onNext(this.currentStartupProjectDebugTargetFrameworkInfo),()=>{this.observers=this.observers.filter((t=>t!==e))}}async pickDebugTargetFramework(){if(!this.startupProjectLaunchInfo)return void n.window.showErrorMessage(o.debugProjectLaunchStrings.errorNoStartupProjectSelected);if(!this.currentStartupProjectDebugTargetFrameworkInfo)return void n.window.showErrorMessage(o.debugProjectLaunchStrings.errorNoTargetFrameworksAvailable);const e=this.currentStartupProjectDebugTargetFrameworkInfo.availableTargetFrameworks.map((e=>new l(e))),t=await(0,a.showQuickPickWithActiveItem)(o.debugProjectLaunchStrings.selectLaunchTargetFramework,e,e.find((e=>e.info.framework===this.currentStartupProjectDebugTargetFrameworkInfo?.debugTargetFramework)));if(t){this.debugTargetFrameworkInfoObserver.setDebugTargetFrameworkInfo(this.startupProjectLaunchInfo.fullPath,t.info.framework),this.currentStartupProjectDebugTargetFrameworkInfo.debugTargetFramework=t.info.framework;for(const e of this.observers)e.onNext(this.currentStartupProjectDebugTargetFrameworkInfo)}}getCurrentProjectTargetFrameworkInfo(){return this.currentStartupProjectDebugTargetFrameworkInfo}onNextStartupProject(e){this.startupProjectLaunchInfo=e,this.handleNewState()}onNextDebugTargetFrameworkInfos(e){this.targetFrameworkInfos=e,this.handleNewState()}handleNewState(){let e;if(e=this.startupProjectLaunchInfo?this.targetFrameworkInfos.find((e=>e.fullPath===this.startupProjectLaunchInfo.fullPath)):void 0,e!==this.currentStartupProjectDebugTargetFrameworkInfo){this.currentStartupProjectDebugTargetFrameworkInfo=e;for(const e of this.observers)e.onNext(this.currentStartupProjectDebugTargetFrameworkInfo)}}handleObservableCompletion(){for(const e of this.observers)e.onCompleted();this.observers=[]}handleObservableError(e){for(const t of this.observers)t.onError(e);this.observers=[]}startupProjectObserver=new class{service;constructor(e){this.service=e}onNext(e){this.service.onNextStartupProject(e)}onCompleted(){this.service.handleObservableCompletion()}onError(e){this.service.handleObservableError(e)}}(this);targetFrameworkInfoObserver=new class{service;constructor(e){this.service=e}onNext(e){this.service.onNextDebugTargetFrameworkInfos(e)}onCompleted(){this.service.handleObservableCompletion()}onError(e){this.service.handleObservableError(e)}}(this)}let u;t.ActiveDebugTargetFrameworkService=c,t.setupActiveDebugTargetFrameworkService=function(e){if(!u){const t=s.startupProjectService,r=(0,i.getDebugTargetFrameworkInfoObserver)(),n=new c(t,r);e.subscriptions.push(n),u=n}},t.getActiveDebugTargetFrameworkService=function(){if(!u)throw new Error("ActiveDebugTargetFrameworkService has not been initialized");return u};class l{info;label;constructor(e){this.info=e,this.label=e.displayName}}},58741:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveLaunchConfigurationService=t.setupActiveLaunchConfigurationService=t.LaunchConfigurationQuickPick=t.ActiveLaunchConfigurationService=void 0;const n=r(89496),i=r(49230),o=r(22677),s=r(17407),a=r(98455),c=r(88764);class u{name;items;constructor(e,t){this.name=e,this.items=t}}class l{projectStateObserver;startupProjectService;constructor(e,t){this.projectStateObserver=e,this.startupProjectService=t}dispose(){this.startupProjectService?.dispose(),this.projectStateObserver?.dispose()}async pickLaunchConfiguration(){const e=await this.startupProjectService.getOrPickCurrentStartupProject();if(!e)return;const t=this.projectStateObserver.getCurrentProjects().find((t=>t.fullPath===e.fullPath));if(!t)return void n.window.showErrorMessage(o.debugProjectLaunchStrings.errorStartupProjectNotFound);const r=this.createQuickPickItems(t),i=await(0,c.showQuickPickWithActiveItem)(o.debugProjectLaunchStrings.selectLaunchConfiguration,r,r.find((e=>e instanceof d&&e.info.id===t.activeLaunchConfigurationId)));return i?(await this.projectStateObserver.setActiveLaunchConfiguration(e.fullPath,i.info.id),i.info.id):void 0}createQuickPickItems(e){const t=[new u("",[])];return e.launchConfigurations.reduce(((e,t)=>{const r=t.groupDisplayName||"";let n=e.find((e=>e.name===r));return n||(n=new u(r,[]),e.push(n)),n.items.push(t),e}),t).flatMap((e=>{let t=[];return""!==e.name&&t.push({label:e.name,kind:n.QuickPickItemKind.Separator}),e.items.forEach((e=>{t.push(new d(e))})),t}))}async getLaunchConfiguration(){const e=await this.startupProjectService.getCurrentStartupProject();if(!e)return;const t=this.projectStateObserver.getCurrentProjects().find((t=>t.fullPath===e.fullPath));return t?t.activeLaunchConfigurationId:void 0}}t.ActiveLaunchConfigurationService=l;class d{info;label;description;detail;iconPath;constructor(e){this.info=e,this.label=e.displayName,this.description=e.description,this.detail=e.details,this.iconPath=(0,a.getIconPath)(e.icon)}}let p;t.LaunchConfigurationQuickPick=d,t.setupActiveLaunchConfigurationService=function(e){if(!p){const t=(0,i.getLaunchableProjectInfoObserver)(),r=new l(t,s.startupProjectService);e.subscriptions.push(r),p=r}},t.getActiveLaunchConfigurationService=function(){if(!p)throw new Error("ActiveLaunchConfigurationService has not been initialized");return p}},48182:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupDebugTargetFrameworkInfoObserver=t.getDebugTargetFrameworkInfoObserver=t.DebugTargetFrameworkInfoObserver=void 0;const n=r(65979),i=r(3187),o=r(7195);class s extends i.Observer{projects;isSubscribed;debugTargetFrameworkService;observers;constructor(){super((()=>this.onNext)),this.projects=[],this.isSubscribed=!1,this.observers=[]}dispose(){this.debugTargetFrameworkService?.dispose()}subscribe(e){return this.observers.push(e),e.onNext(this.projects),()=>{this.observers=this.observers.filter((t=>t!==e))}}async subscribeToTargetFrameworkService(e){let t;try{const r=await e.serviceBroker.getProxy(n.default.debugTargetFrameworkService);if(!r)throw new Error("Could not get the IDebugTargetFrameworkService proxy to call subscribe.");t=await r.subscribe(this),this.isSubscribed=!0,this.debugTargetFrameworkService=r}catch(e){this.isSubscribed=!1}return t}async setDebugTargetFrameworkInfo(e,t,r){if(!this.isSubscribed)throw new Error("DebugTargetFrameworkInfoObserver has not been subscribed to an IDebugTargetFrameworkService");return await this.debugTargetFrameworkService.setDebugTargetFramework(e,t)}getCurrentProjects(){if(!this.isSubscribed)throw new Error("DebugTargetFrameworkInfoObserver has not been subscribed to an IDebugTargetFrameworkService");return this.projects}onNext(e){this.projects=e;for(const t of this.observers)t.onNext(e)}onCompleted(){this.debugTargetFrameworkService?.dispose();for(const e of this.observers)e.onCompleted();this.observers=[]}}let a,c,u;async function l(e,t,r){c=await t.serviceBroker.getProxy(n.default.projectInitializationStatusService),c?(u=new i.Observer((n=>{!async function(e,t,r){const n=await r.subscribeToTargetFrameworkService(t);n&&e.subscriptions.push(n)}(e,t,r)}),(e=>{e&&o.logger.log(e)})),await c.subscribeInitializationCompletion(u)):o.logger.log("Failed to obtain IProjectInitializationStatusService proxy")}t.DebugTargetFrameworkInfoObserver=s,t.getDebugTargetFrameworkInfoObserver=function(){if(!a)throw new Error("DebugTargetFrameworkInfoObserver has not been initialized");return a},t.setupDebugTargetFrameworkInfoObserver=function(e,t){if(!a){let r=new s;t.hasServerProcessLoaded()?l(e,t,r):t.serverProcessLoaded((async()=>l(e,t,r))),a=r}}},66862:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DotnetDynamicConfigurationProvider=void 0;const n=r(89496),i=r(7195),o=r(65979),s=r(22677),a=r(75010),c=r(73228),u=r(81433),l=r(71017),d=r(66463);class p{brokeredServiceHost;projectStateObserver;static type="dotnet";launchConfigurationService;constructor(e,t){this.brokeredServiceHost=e,this.projectStateObserver=t,this.launchConfigurationService=(0,c.lazyPromiseLambda)((()=>this.initLaunchConfigurationServiceProxy()))}async dispose(){(await this.launchConfigurationService)?.dispose(),this.projectStateObserver?.dispose()}async provideDebugConfigurations(e,t){const r=new a.TelemetryActivity("DotnetDynamicConfigurationProvider/provideDebugConfigurations",i.telemetryService);try{const t=await this.launchConfigurationService;if(e&&t){if(!await(0,d.waitForProjectsToLoad)(this.brokeredServiceHost))throw r.addOrUpdateProperties({succeeded:"false",waitForProjectInitializationTimeout:"true"}),r.sendTelemetry(),new Error(s.debugProjectLaunchStrings.projectInitializing);let t=[];if(n.workspace.getConfiguration("csharp.preview").get("improvedLaunchExperience",!0)&&(await this.projectStateObserver.subscribedSignal,this.projectStateObserver.getCurrentProjects().length>0)){let e={name:s.debugProjectLaunchStrings.startupProjectLaunchConfigName,type:p.type,request:"launch"};t.push(e)}let i=0;if(e.uri?.fsPath&&this.projectStateObserver){const n=e.uri.fsPath.replace(/[\\/]+/g,"/");await this.projectStateObserver.subscribedSignal;const o=this.projectStateObserver.getCurrentProjects();for(let e of o){let r=e.fullPath;const o=r.replace(/[\\/]+/g,"/"),s=r.includes("/")?"/":"\\";if(o.startsWith(n+"/"))r="${workspaceFolder}"+r.substring(n.length);else{let e=l.relative(n,r);e?r="${workspaceFolder}"+s+e:i++}t=t.concat(this.createDebugConfigurations(e.displayName,r,e.launchConfigurations))}0===t.length&&0===i||(r.addOrUpdateMeasurements({generatedConfigurationCount:t.length,ignoredProjectCount:i}),r.sendTelemetry())}return t.push(this.createDebugConfiguration(s.debugProjectLaunchStrings.debugActiveFile,"${file}",void 0)),t}}catch(e){let t="";"string"==typeof e?t=e.toUpperCase():e instanceof Error&&(t=e.message),r.addOrUpdateProperties({succeeded:"false"}),r.sendTelemetry(),n.window.showErrorMessage(`${u.errorStrings.failProvideDebugConfigurations}${t}`)}return[]}async resolveDebugConfiguration(e,t,r){return void 0===t.type?this.runAndDebug(t,r):t}static configurationPrefix="C#: ";static createDebugConfigurationName(e){return`${p.configurationPrefix}${e}`}createDebugConfigurations(e,t,r){let n=[];r.length>1&&n.push(this.createDebugConfiguration(p.createDebugConfigurationName(`${e} [Default Configuration]`),t,void 0));for(let i of r){const o=p.createDebugConfigurationName(`${e}${r.length>1?` [${i.displayName}]`:""}`);n.push(this.createDebugConfiguration(o,t,i.id))}return n}createDebugConfiguration(e,t,r){let n={name:e,type:p.type,request:"launch",projectPath:t};return r&&(n.launchConfigurationId=r),n}async runAndDebug(e,t){const r=new a.TelemetryActivity("runAndDebug",i.telemetryService),c=await this.brokeredServiceHost.serviceBroker.getProxy(o.default.dotnetDebugConfigurationService);try{if(c)return void await n.commands.executeCommand("workbench.action.debug.selectandstart",p.type,{noDebug:e.noDebug});throw r.addOrUpdateProperties({succeeded:String(!1)}),r.sendTelemetry(),new Error}catch(e){const t={title:s.promptStrings.moreInformation};n.window.showErrorMessage(s.debugProjectLaunchStrings.errorNoProjectFound,t).then((async e=>{if(e===t){const e="https://aka.ms/vscode/dotnet/debug";n.env.openExternal(n.Uri.parse(e))}}))}finally{c?.dispose()}}async initLaunchConfigurationServiceProxy(){const e=await this.brokeredServiceHost.serviceBroker.getProxy(o.default.launchConfigurationService);if(!e)throw new Error("Could not get the ILaunchConfigurationService proxy.");return e}}t.DotnetDynamicConfigurationProvider=p},37224:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHotReloadTracker=t.prepareHotReload=t.HotReloadTracker=void 0;const n=r(69279),i=r(65979),o=r(57787),s=r(42300),a=r(66716),c=r(50979),u=r(28457),l=r(22677),d=r(89496),p=r(24138);class f{context;constructor(e){this.context=e,this.context=e}hotReloadIcon;initialized=!1;enabled=!1;hasPossibleChange=!1;onChangeListener;onSaveListener;async startHotReload(e,t){await this.onHotReloadAvailabilityChanged(e,t)}async onHotReloadAvailabilityChanged(e,t){let r;switch(e.status){case o.ManagedHotReloadAvailabilityStatus.available:return void this.enable();case o.ManagedHotReloadAvailabilityStatus.disabled:r=l.hotReloadStrings.disabledInSettingsStatus;break;default:r=l.hotReloadStrings.notSupportedForSessionStatus}this.disable(r);let n=l.hotReloadStrings.disabledResult;null!==e.localizedMessage&&(n+=" "+e.localizedMessage),await s.hotReloadLogger.log(new s.HotReloadLogMessage(s.HotReloadVerbosity.minimal,n))}async endHotReload(e){await d.commands.executeCommand("setContext","hotReloadEnabled",!1),this.hotReloadIcon?.hide(),this.enabled=!1,this.onChangeListener?.dispose(),this.onSaveListener?.dispose(),this.onChangeListener=void 0,this.onSaveListener=void 0}async reportHotReloadResult(e){let t=null,r=!1;switch(e){case u.HotReloadResult.applyUpdatesFailure:t=l.hotReloadStrings.applyUpdatesFailureResult,r=!0;break;case u.HotReloadResult.errorEdits:case u.HotReloadResult.restartRequired:r=!0;break;case u.HotReloadResult.noChanges:case u.HotReloadResult.applied:case u.HotReloadResult.partiallyApplied:this.hasPossibleChange=!1}null!==t&&await s.hotReloadLogger.log(new s.HotReloadLogMessage(s.HotReloadVerbosity.minimal,t)),r&&(0,a.showHotReloadPanel)()}hasPossibleChanges(){return this.hasPossibleChange}initialize(){this.initialized||(this.hotReloadIcon=function(){const e=d.window.createStatusBarItem("csdevkit.hotreload",d.StatusBarAlignment.Right,1);return e.text="$(flame)",e.command=p.default.showHotReloadPanel,e}(),this.initialized=!0)}async enable(){this.enabled||(await d.commands.executeCommand("setContext","hotReloadEnabled",!0),this.enabled=!0),this.initialize(),this.onChangeListener||(this.onChangeListener=d.workspace.onDidChangeTextDocument((e=>this.onPossibleChange(e))),this.onSaveListener=d.workspace.onWillSaveTextDocument((e=>this.applyOnSave(e)))),this.hotReloadIcon.show(),this.hotReloadIcon.tooltip=l.hotReloadStrings.availableStatus}async disable(e){this.enabled&&(await d.commands.executeCommand("setContext","hotReloadEnabled",!1),this.enabled=!1),this.hotReloadIcon.tooltip=e}async applyOnSave(e){if(this.enabled&&c.hotReloadOptionService.getIsHotReloadOnSave()&&e.reason===d.TextDocumentSaveReason.Manual)return(0,a.hotReload)()}async onPossibleChange(e){if(!this.enabled||this.hasPossibleChange)return;if("csharp"!==e.document.languageId)return;if(0===e.contentChanges.length)return;const t=d.extensions.getExtension(n.EXTENSION_ID);if(!t)throw new Error("Unable to find the extension.");const r=t.exports.serviceBroker,o=await r.getProxy(i.default.hotReloadService);null!==o&&(this.hasPossibleChange=!0,await o.onChanges()),await s.hotReloadLogger.log(new s.HotReloadLogMessage(s.HotReloadVerbosity.minimal,l.hotReloadStrings.changesDetected))}}let h;t.HotReloadTracker=f,t.prepareHotReload=async function(e){e.subscriptions.push(d.commands.registerCommand(p.default.hotReload,a.hotReload)),e.subscriptions.push(d.commands.registerCommand(p.default.showHotReloadPanel,a.showHotReloadPanel)),h=new f(e),(0,c.listenToHotReloadConfigUpdates)()},t.getHotReloadTracker=function(){if(!h)throw new Error("HotReloadTracker is not initialized. Call prepareHotReload first.");return h}},98455:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIconPath=void 0;const n=r(89496),i=r(26199),o=/^catalog:\/\/(.+):(.+)/,s=/^icon:\/\/(.+)/;t.getIconPath=function(e){if(!e)return;const t=o.exec(e);if(t){let e=(0,i.getImageCatalog)();if(e){let r=t[1],i=parseInt(t[2]),o=e.getIcon(r,i);if(o)return{light:n.Uri.file(o.light),dark:n.Uri.file(o.dark)}}return}const r=s.exec(e);return r?new n.ThemeIcon(r[1]):void 0}},21232:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupLanguageStatusItems=void 0;const n=r(89496),i=r(17407),o=r(22677),s=r(24138),a=r(29758);class c{id;name;commandId;title;tooltip;initialText;documentSelectors=[];languageStatusItems=[];constructor(e,t,r,n,i,o){this.id=e,this.name=t,this.commandId=r,this.title=n,this.tooltip=i,this.initialText=o,this.documentSelectors=this.getDefaultDocumentSelectors()}getDefaultDocumentSelectors(){let e=[];return e.push({language:"csharp",pattern:"**/*.cs"}),e.push({language:"xaml",pattern:"**/*.xaml"}),e.push({language:"xml",pattern:"**/*.{csproj,xml,plist}"}),e.push({language:"plaintext",pattern:"**/*.{sln, slnx}"}),e.push({language:"css",pattern:"**/*.css"}),e.push({language:"aspnetcorerazor",pattern:"**/*.{razor,cshtml}"}),e}deactivate(){this.languageStatusItems.forEach((e=>{e.dispose()})),this.languageStatusItems=[]}activate(){this.deactivate();const e={title:this.title,tooltip:this.tooltip,command:this.commandId};let t=0;this.documentSelectors.forEach((r=>{const n=`${this.id}.${t}}`,i=this.createLanguageStatusItem(n,this.name,r,e,this.initialText);this.languageStatusItems.push(i),t++}))}updateStatus(e){this.initialText=e,this.languageStatusItems.forEach((t=>{t.text=e??this.initialText}))}createLanguageStatusItem(e,t,r,i,o){let s=n.languages.createLanguageStatusItem(e,r);return s.name=t,s.command=i,s.text=o,s}setBusy(e){this.languageStatusItems.forEach((t=>{t.busy=e}))}setSeverity(e){this.languageStatusItems.forEach((t=>{t.severity=e}))}setCommand(e,t,r=void 0){this.commandId=e,this.tooltip=t,r&&(this.title=r);const n={title:this.title,tooltip:this.tooltip,command:this.commandId};this.languageStatusItems.forEach((e=>{e.command=n}))}}class u{languageStatusItem;unsubscribe;constructor(e){this.languageStatusItem=new c("csdevkit.debug.selectStartupProjectLanguageStatusItem",o.debugProjectLaunchStrings.selectStartupProject,s.default.selectStartupProject,o.debugProjectLaunchStrings.startupProjectTitle,o.debugProjectLaunchStrings.startupProjectTooltip,o.debugProjectLaunchStrings.noProjectPlaceholder),this.unsubscribe=e.subscribe(this),this.languageStatusItem.activate()}dispose(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=void 0),this.languageStatusItem?.deactivate(),this.languageStatusItem=void 0}onNext(e){e?this.languageStatusItem?.updateStatus(e.displayName):this.languageStatusItem?.updateStatus(o.debugProjectLaunchStrings.noProjectPlaceholder)}onCompleted(){}onError(e){}}class l{languageStatusItem;unsubscribe;constructor(e){this.languageStatusItem=new c("csdevkit.debug.selectTargetFrameworkLanguageStatusItem",o.debugProjectLaunchStrings.selectLaunchTargetFramework,s.default.selectLaunchTargetFramework,o.debugProjectLaunchStrings.debugTargetFrameworkTitle,o.debugProjectLaunchStrings.debugTargetFrameworkTooltip,o.debugProjectLaunchStrings.noProjectPlaceholder),this.unsubscribe=e.subscribe(this),this.languageStatusItem.activate()}dispose(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=void 0),this.languageStatusItem?.deactivate(),this.languageStatusItem=void 0}onNext(e){e?this.languageStatusItem?.updateStatus(e.debugTargetFramework??o.debugProjectLaunchStrings.noProjectPlaceholder):this.languageStatusItem?.updateStatus(o.debugProjectLaunchStrings.noProjectPlaceholder)}onCompleted(){}onError(e){}}class d{languageStatusItem;unsubscribe;constructor(e){this.languageStatusItem=new c("csdevkit.debug.selectLaunchConfigurationLanguageStatusItem",o.debugProjectLaunchStrings.selectLaunchConfiguration,s.default.selectLaunchConfiguration,o.debugProjectLaunchStrings.launchConfigurationTitle,o.debugProjectLaunchStrings.launchConfigurationTooltip,o.debugProjectLaunchStrings.noProjectPlaceholder),this.unsubscribe=e.subscribe(this),this.languageStatusItem.activate()}dispose(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=void 0),this.languageStatusItem?.deactivate(),this.languageStatusItem=void 0}onNext(e){if(e){let t=e.launchConfigurations.find((t=>t.id===e.activeLaunchConfigurationId));t?this.languageStatusItem?.updateStatus(t.displayName):this.languageStatusItem?.updateStatus(o.debugProjectLaunchStrings.noProjectPlaceholder)}else this.languageStatusItem?.updateStatus(o.debugProjectLaunchStrings.noProjectPlaceholder)}onCompleted(){}onError(e){}}t.setupLanguageStatusItems=function(e){let t=(0,a.getActiveDebugTargetFrameworkService)(),r=new u(i.startupProjectService);e.subscriptions.push(r);let n=new l(t);e.subscriptions.push(n);let o=new d(i.startupProjectService);e.subscriptions.push(o)}},49230:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupLaunchableProjectInfoObserver=t.getLaunchableProjectInfoObserver=t.LaunchableProjectInfoObserver=void 0;const n=r(65979),i=r(3187);class o extends i.Observer{projects;isSubscribed;launchConfigurationService;observers;onSubscribed=()=>{};subscribedSignal;constructor(){super((()=>this.onNext)),this.projects=[],this.isSubscribed=!1,this.observers=[],this.subscribedSignal=new Promise((e=>{this.onSubscribed=e}))}dispose(){this.launchConfigurationService?.dispose()}subscribe(e){return this.observers.push(e),e.onNext(this.projects),()=>{this.observers=this.observers.filter((t=>t!==e))}}async subscribeToLaunchConfigurationService(e){let t;try{const r=await e.serviceBroker.getProxy(n.default.launchConfigurationService);if(!r)throw new Error("Could not get the ILaunchConfigurationService proxy to call subscribe.");t=await r.subscribe(this),this.isSubscribed=!0,this.launchConfigurationService=r,this.onSubscribed()}catch(e){this.isSubscribed=!1}return t}async setActiveLaunchConfiguration(e,t,r){if(!this.isSubscribed)throw new Error("LaunchableProjectInfoObserver has not been subscribed to an ILaunchConfigurationService");return await this.launchConfigurationService.setActiveLaunchConfiguration(e,t,r)}getCurrentProjects(){if(!this.isSubscribed)throw new Error("LaunchableProjectInfoObserver has not been subscribed to an ILaunchConfigurationService");return this.projects}onNext(e){this.projects=e;for(const t of this.observers)t.onNext(e)}onCompleted(){this.launchConfigurationService?.dispose();for(const e of this.observers)e.onCompleted();this.observers=[]}}let s;async function a(e,t,r){const n=await r.subscribeToLaunchConfigurationService(t);n&&e.subscriptions.push(n)}t.LaunchableProjectInfoObserver=o,t.getLaunchableProjectInfoObserver=function(){if(!s)throw new Error("LaunchableProjectInfoObserver has not been initialized");return s},t.setupLaunchableProjectInfoObserver=function(e,t){if(!s){let r=new o;t.hasServerProcessLoaded()?a(e,t,r):t.serverProcessLoaded((async()=>a(e,t,r))),s=r}}},17407:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeStartupProjectService=t.startupProjectService=t.StartupProjectService=void 0;const n=r(89496),i=r(49230),o=r(22677),s=r(98455),a=r(88764);class c{projectStateObserver;storage;unsubscribeFromProjectStateObserver;constructor(e,t,r){this.projectStateObserver=e,this.storage=t,this.unsubscribeFromProjectStateObserver=r}}class u{state;startupProject;observers;startupProjectStorageKey="csdevkit.debug.startupProject";constructor(){this.observers=[]}initialize(e,t){if(this.state)throw new Error("StartupProjectService is already initialized");this.state=new c(e,t,void 0),this.state.unsubscribeFromProjectStateObserver=e.subscribe(this)}subscribe(e){return this.observers.push(e),e.onNext(this.startupProject),()=>{this.observers=this.observers.filter((t=>t!==e))}}onNext(e){if(!this.state)throw new Error("StartupProjectService has not been initialized");let t;if(this.startupProject&&(t=e.find((e=>e.fullPath===this.startupProject?.fullPath))),!t){let r=this.state.storage.get(this.startupProjectStorageKey);r&&(t=e.find((e=>e.fullPath===r)))}this.startupProject=t;for(const e of this.observers)e.onNext(this.startupProject)}onCompleted(){if(!this.state)throw new Error("StartupProjectService has not been initialized");for(const e of this.observers)e.onCompleted();this.observers=[]}onError(e){if(!this.state)throw new Error("StartupProjectService has not been initialized");for(const t of this.observers)t.onError(e);this.observers=[]}dispose(){this.state&&(this.state.unsubscribeFromProjectStateObserver&&this.state.unsubscribeFromProjectStateObserver(),this.state.projectStateObserver.dispose(),this.state=void 0)}async pickStartupProject(){if(!this.state)throw new Error("StartupProjectService has not been initialized");let e=this.state.projectStateObserver.getCurrentProjects();if(0===e.length)return void n.window.showErrorMessage(o.debugProjectLaunchStrings.errorNoLaunchableProjects);const t=e.map((e=>new l(e))),r=await(0,a.showQuickPickWithActiveItem)(o.debugProjectLaunchStrings.selectStartupProject,t,this.startupProject?t.find((e=>e.info.fullPath===this.startupProject?.fullPath)):void 0);if(r){this.startupProject=r.info,this.state.storage.update(this.startupProjectStorageKey,this.startupProject.fullPath);for(const e of this.observers)e.onNext(this.startupProject)}return r?.info}getCurrentStartupProject(){return this.startupProject}async getOrPickCurrentStartupProject(){return this.startupProject||(this.startupProject=await this.pickStartupProject()),this.startupProject}isInitialized(){return void 0!==this.state}}t.StartupProjectService=u,t.startupProjectService=new u,t.initializeStartupProjectService=function(e){if(!t.startupProjectService.isInitialized()){const r=(0,i.getLaunchableProjectInfoObserver)();t.startupProjectService.initialize(r,e.workspaceState),e.subscriptions.push(t.startupProjectService)}};class l{info;label;description;detail;iconPath;constructor(e){this.info=e,this.label=e.displayName,this.description=e.description,this.detail=e.details,this.iconPath=(0,s.getIconPath)(e.icon)}}},46342:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerDynamicDotnetConfigurationProvider=void 0;const n=r(89496),i=r(49230),o=r(66862);t.registerDynamicDotnetConfigurationProvider=function(e,t){const r=(0,i.getLaunchableProjectInfoObserver)(),s=new o.DotnetDynamicConfigurationProvider(t,r);return e.subscriptions.push(s),e.subscriptions.push(n.debug.registerDebugConfigurationProvider(o.DotnetDynamicConfigurationProvider.type,s,n.DebugConfigurationProviderTriggerKind.Dynamic)),{configurationProvider:s,launchableProjectInfoObserver:r}}},82269:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debugLaunch=void 0;const n=r(57147),i=r(71017),o=r(89496),s=r(69279),a=r(89781),c=r(30077),u=r(7195),l=r(77867),d=r(65979),p=r(6315),f=r(22677),h=r(75010),g=r(66862);t.debugLaunch=async function(e,t,r,m,v){const y=new h.TelemetryActivity(v,u.telemetryService);r.noDebug&&y.addOrUpdateProperties({noDebug:String(!0)}),r.stopAtEntry&&y.addOrUpdateProperties({stopAtEntry:String(!0)});let _=!1,S=!1;if(n.readFileSync(e).includes("<UseMaui>true</UseMaui>")){if(!o.extensions.getExtension(s.MAUI_EXTENSION_ID)){_=!0;const e="Install the .NET MAUI extension";o.window.showErrorMessage(f.errorStrings.mauiExtensionNotFound,e).then((t=>{t===e&&o.env.openExternal(o.Uri.parse(s.MAUI_EXTENSION_URL))}))}let e=new a.OutputMonitor;if(await(0,l.dotnetCommand)(c.DotnetCommand.checkMauiWorkloads,void 0,["workload","list"],e),0===e.getOutput().match(/maui.\*/g)?.length){S=!0;const e="Install the .NET MAUI workloads";o.window.showErrorMessage(f.errorStrings.mauiWorkloadNotFound,e).then((t=>{t===e&&o.env.openExternal(o.Uri.parse(s.MAUI_WORKLOAD_URL))}))}if(_||S)return!1}const w=await m.getProxy(d.default.dotnetDebugConfigurationService);if(!w)throw new Error("Unable to obtain IDotnetDebugConfigurationService");try{const n=i.basename(e,".csproj"),s=await w.resolveDebugConfigurationWithLaunchConfigurationService(e,{name:g.DotnetDynamicConfigurationProvider.createDebugConfigurationName(n),type:"dotnet",request:"launch",...r},void 0),a=p.IDotnetDebugConfigurationServiceResultResolver.resolve(s);a?(y.addOrUpdateProperties({succeeded:String(!0)}),y.sendTelemetry(),o.debug.startDebugging(t,a,void 0)):null===a&&(y.addOrUpdateProperties({succeeded:String(!1)}),y.sendTelemetry())}finally{w?.dispose()}}},81433:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorStrings=void 0;const n=r(89496),i=r(18472);i.config({bundleFormat:i.BundleFormat.standalone,locale:n.env.language,messageFormat:i.MessageFormat.both});const o=i.loadMessageBundle(r(71017).join(__dirname,"debugger\\strings.ts"));t.errorStrings={failProvideDebugConfigurations:o(0,null)}},66463:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitForProjectsToLoad=void 0;const n=r(19679),i=r(7195),o=r(65979),s=r(22677),a=r(65300),c=r(89496);let u=!1;t.waitForProjectsToLoad=async function(e){return!!u||c.window.withProgress({location:c.ProgressLocation.Notification,title:s.debugProjectLaunchStrings.debugProjectLoading,cancellable:!1},(async()=>(await e.ensureInitialized(),u=await async function(e){if(!await(0,a.findAnyProjectFiles)())return i.logger.log("No project files found in workspace, skipping wait for project initialization."),!0;const t=await e.serviceBroker.getProxy(o.default.projectInitializationStatusService);if(t)return await new Promise(((e,r)=>{const o=setTimeout((()=>{e(!1)}),3e4);t.subscribeInitializationCompletion(new n.Observer((r=>{const n=i.environmentStateManager?.getLatestEnvironmentState()?.version;n&&!n||(clearTimeout(o),e(!0),t.dispose())}),(e=>{clearTimeout(o),r(e),t.dispose()})))}));throw new Error("Could not get the IProjectInitializationStatusService proxy.")}(e),u)))}},26674:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DotnetVersionManager=void 0;const n=r(81249),i=r(89496),o=r(89781),s=r(84832),a=r(7195),c=r(69279),u=r(16260);t.DotnetVersionManager=class{context;cacheTimeoutInMilliSecs=3e4;versionCache={};hasShownOutOfSupportSdkMessage=!1;constructor(e){this.context=e}async getDotnetVersion(e=process.cwd(),t,r=o.LogImportance.low){const n=this.versionCache[e];if(n&&Date.now()-n.timestamp<this.cacheTimeoutInMilliSecs)return n.version;const i=await this.getDotnetVersionImpl(e,t,r);return i&&(this.versionCache[e]={version:i,timestamp:Date.now()},!this.hasShownOutOfSupportSdkMessage&&i.major<8&&await this.showOutOfSupportDocument(t,i)),i}async showOutOfSupportDocument(e,t){if(this.hasShownOutOfSupportSdkMessage=!0,!this.context.workspaceState.get("dotnet67_message_shown")){const r=this.context.asAbsolutePath(c.DOTNET67_OUT_OF_SUPPORT_MD_PATH);try{await i.commands.executeCommand("markdown.showPreview",i.Uri.file(r)),this.context.workspaceState.update("dotnet67_message_shown",!0),this.context.globalState.update("dotnet67_check",!0);const e=new u.TelemetryEvent("show-out-of-support-sdk",a.telemetryService);e.addOrUpdateProperties({sdk:t.format()}),e.sendTelemetry()}catch(t){e.log(`Failed to execute markdown.showPreview command: ${t}`,o.LogImportance.normal)}}}async checkOutOfSupportedSdkInstallationAndShowWarningMessage(e){if(!this.hasShownOutOfSupportSdkMessage&&!this.context.workspaceState.get("dotnet67_message_shown")&&!this.context.globalState.get("dotnet67_check"))try{const t=await this.getDotnetSdkVersionStrings(e);if(t){for(const r of t)if(r){const t=n.parse(r);if(t&&t.major<8){await this.showOutOfSupportDocument(e,t);break}}this.context.globalState.update("dotnet67_check",!0)}}catch(t){e.log(`Failed to scan SDKs: ${t}`,o.LogImportance.low)}}async getDotnetSdkVersionStrings(e){try{e.log("dotnet --list-sdks",o.LogImportance.low);return(await(0,s.execChildProcess)(a.dotnetSdkPath??"dotnet",["--list-sdks"],void 0,{...process.env})).split(/\r?\n/).map((e=>e.replace(/^([^ ]+) \[[^\]]+\]$/,"$1")))}catch(t){e.log(`dotnet --list-sdks failed:\t${t}`,o.LogImportance.low)}}async getDotnetVersionImpl(e,t,r){try{const r=await(0,s.execChildProcess)(a.dotnetSdkPath??"dotnet",["--version"],e,{...process.env});return t.log(`dotnet --version\n${r}`,o.LogImportance.low),n.parse(r.replace(/[\r\n]/gm,""))}catch(n){return t.log(`dotnet --version failed on ${e}:\n\t${n}`,r),null}}}},46429:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentStateManager=void 0;const n=r(19679),i=r(82361),o=r(89496),s=r(89496),a=r(24138),c=r(7195),u=r(65979),l=r(22677),d=r(75010),p=r(73228),f=r(71017);class h extends i.EventEmitter{brokeredServiceHost;environmentService;environmentServiceSubscriber;operationInProgress;isDisposing=!1;environmentStateObserver;openedSolutionPath;openedSolutionExtension;constructor(e){super(),this.brokeredServiceHost=e,this.environmentService=(0,p.lazyPromiseLambda)((()=>this.initEnvironmentServiceProxy()))}async dispose(){this.isDisposing=!0;try{if(this.environmentServiceSubscriber){const e=await this.environmentService;this.environmentServiceSubscriber?.dispose(),e.dispose()}}catch(e){}}getLatestEnvironmentState(){return this.environmentStateObserver?.getLatestEnvironmentState()}getOpenedSolution(){const e=this.environmentStateObserver?.getLatestEnvironmentState();return e?.solutions[0]}getOpenedSolutionExt(){const e=this.getOpenedSolution();return e!==this.openedSolutionPath&&(this.openedSolutionPath=e,e&&(this.openedSolutionExtension=f.extname(e))),this.openedSolutionExtension}getActiveWorkspace(){const e=s.workspace.workspaceFolders;if(e&&e.length>0){if(1===e.length)return e[0];{const t=this.environmentStateObserver?.getLatestEnvironmentState();if(t){const r=t.solutions[0];if(t.containsTemporarySolutionFile)return e[0];if(r){const e=s.workspace.getWorkspaceFolder(s.Uri.file(r));if(e)return e}for(let e=0;e<t.projects.length;e++){const r=t.projects[e].projectId.fullPath;if(r){const e=s.workspace.getWorkspaceFolder(s.Uri.file(r));if(e)return e}}}return e[0]}}}getActiveWorkspaceRoot(){const e=this.getActiveWorkspace();if(e)return e.uri.fsPath;const t=this.getOpenedSolution();return t?f.dirname(t):void 0}isSolutionGeneratedOutsideWorkspace(){return this.environmentStateObserver?.getLatestEnvironmentState()?.containsTemporarySolutionFile??!1}async closeSolution(){const e=await this.environmentService,t=await e.clear();return this.environmentStateObserver.updateEnvironmentStateIfNeeded(t)}async setSolutionAndFolderWorkspace(e,t,r){const n=await this.environmentService,i=await n.setSolutionWorkspace(e,r,t);return this.environmentStateObserver.updateEnvironmentStateIfNeeded(i)}async openNoSolutionWorkspace(e,t,r){const n=await this.environmentService,i=await n.openNoSolutionWorkspace(e,t,r);return this.environmentStateObserver.updateEnvironmentStateIfNeeded(i)}async loadSolution(e){const t=await this.environmentService,r=await t.refreshSolutionContent(e);return this.environmentStateObserver.updateEnvironmentStateIfNeeded(r)}async runOperation(e){for(;this.operationInProgress;)await this.operationInProgress.catch((()=>{}));const t=e();this.operationInProgress=t.then((()=>this.operationInProgress=void 0));try{return await t}finally{this.operationInProgress=void 0}}async initEnvironmentServiceProxy(){const e=new d.TelemetryActivity("environment-service-initialization",c.telemetryService);let t=performance.now();const r=await this.brokeredServiceHost.serviceBroker.getProxy(u.default.environmentService);let n=performance.now();if(e.addOrUpdateMeasurements({getProxy:n-t}),!r)throw new Error("Could not get the IEnvironmentService proxy.");return t=performance.now(),this.environmentStateObserver=new g((e=>this.emit("environmentStateChanged",e))),r&&(this.environmentServiceSubscriber=await r.subscribe(this.environmentStateObserver)),n=performance.now(),e.addOrUpdateMeasurements({registerObserver:n-t}),this.isDisposing&&this.environmentServiceSubscriber?.dispose(),e.sendTelemetry(),r}}t.EnvironmentStateManager=h;class g extends n.Observer{onUpdateEnvironmentStateCallback;latestEnvironmentState;configurationStatusBarItem;latestConfiguration;isEnvironmentPreviouslyValid;getLatestEnvironmentState(){return this.latestEnvironmentState}constructor(e){super((()=>this.onNext)),this.onUpdateEnvironmentStateCallback=e}onNext(e){this.updateEnvironmentStateIfNeeded(e)}updateEnvironmentStateIfNeeded(e){if(!this.latestEnvironmentState||e.version>this.latestEnvironmentState.version){this.latestEnvironmentState=e,0===this.latestEnvironmentState.solutions.length?o.commands.executeCommand("setContext","solutionOpened",!1):o.commands.executeCommand("setContext","solutionOpened",!0),this.latestEnvironmentState.containsTemporarySolutionFile?o.commands.executeCommand("setContext","generatedSlnOutsideWorkspace",!0):o.commands.executeCommand("setContext","generatedSlnOutsideWorkspace",!1),this.onUpdateEnvironmentStateCallback(this.latestEnvironmentState),c.projectInitializationStatus?.onEnvironmentUpdate(this.latestEnvironmentState.version,this.latestEnvironmentState.solutions.length,this.latestEnvironmentState.errors),c.selectedSolutionFileStatusBarItem?.onEnvironmentUpdate(this.latestEnvironmentState.solutions.length>0?f.basename(this.latestEnvironmentState.solutions[0]):"",this.latestEnvironmentState.containsTemporarySolutionFile);const t=!(this.latestEnvironmentState.errors&&this.latestEnvironmentState.errors.length>0);if(this.isEnvironmentPreviouslyValid!==t&&(this.isEnvironmentPreviouslyValid=t,o.commands.executeCommand("setContext","isValidSolution",t)),t){this.configurationStatusBarItem||(this.configurationStatusBarItem=s.window.createStatusBarItem("csdevkit.configuration",s.StatusBarAlignment.Left,11),this.configurationStatusBarItem.name=l.messageStrings.configurationStatusName,this.configurationStatusBarItem.command=a.default.selectActiveConfiguration,this.configurationStatusBarItem.tooltip=l.messageStrings.configurationTooltip);const e=this.latestEnvironmentState.configuration;e?(e!==this.latestConfiguration&&(this.configurationStatusBarItem.text=e.replace(/\|/g," "),this.latestConfiguration=e),this.configurationStatusBarItem.show()):this.configurationStatusBarItem.hide()}else this.configurationStatusBarItem?.hide();this.latestEnvironmentState.containsTemporarySolutionFile=e.containsTemporarySolutionFile}return this.latestEnvironmentState}}},30077:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DotnetCommandError=t.DotnetCommand=t.SolutionCloseError=t.SolutionOpenError=t.SolutionReloadError=t.ExitCodeError=t.ErrorCodeError=void 0;class r extends Error{errorCode;constructor(e,t){super(t),this.errorCode=e,this.name="ErrorCodeError",this.errorCode=e}}t.ErrorCodeError=r;class n extends r{constructor(e,t){super(e,t),this.name="ExitCodeError"}}t.ExitCodeError=n;class i extends Error{constructor(e){super(e),this.name="SolutionReloadError"}}t.SolutionReloadError=i;class o extends Error{constructor(e){super(e),this.name="SolutionOpenError"}}t.SolutionOpenError=o;class s extends Error{constructor(e){super(e),this.name="SolutionCloseError"}}var a;t.SolutionCloseError=s,function(e){e[e.checkMauiWorkloads=0]="checkMauiWorkloads",e[e.newSln=1]="newSln",e[e.newProject=2]="newProject",e[e.slnAddIntoFolder=3]="slnAddIntoFolder",e[e.slnAdd=4]="slnAdd",e[e.slnRemoveProject=5]="slnRemoveProject",e[e.restore=6]="restore",e[e.updateReference=7]="updateReference",e[e.info=8]="info",e[e.sdkCheck=9]="sdkCheck",e[e.dotnetVersion=10]="dotnetVersion",e[e.nugetAddPackage=11]="nugetAddPackage",e[e.nugetUpdatePackage=12]="nugetUpdatePackage",e[e.nugetRemovePackage=13]="nugetRemovePackage",e[e.nugetPackageSearch=14]="nugetPackageSearch",e[e.nugetGetVersions=15]="nugetGetVersions",e[e.nugetListInstalledPackages=16]="nugetListInstalledPackages",e[e.nugetListOutdatedPackages=17]="nugetListOutdatedPackages"}(a||(t.DotnetCommand=a={}));class c extends n{constructor(e,t,r){super(t,r);const n=c.getCommandName(e);this.name="DotnetCommand"+n+"Error"}static getCommandName(e){switch(e){case a.checkMauiWorkloads:return"CheckMauiWorkloads";case a.newSln:return"NewSln";case a.newProject:return"NewProject";case a.slnAddIntoFolder:return"SlnAddIntoFolder";case a.slnAdd:return"SlnAdd";case a.slnRemoveProject:return"SlnRemoveProject";case a.restore:return"Restore";case a.updateReference:return"UpdateReference";case a.info:return"Info";case a.sdkCheck:return"SdkCheck";case a.dotnetVersion:return"DotnetVersion";case a.nugetAddPackage:return"NuGetAddPackage";case a.nugetUpdatePackage:return"NuGetUpdatePackage";case a.nugetRemovePackage:return"NuGetRemovePackage";case a.nugetPackageSearch:return"NuGetPackageSearch";case a.nugetGetVersions:return"NuGetGetVersions";case a.nugetListInstalledPackages:return"NuGetListInstalledPackages";case a.nugetListOutdatedPackages:return"NuGetListOutdatedPackages";default:return""}}}t.DotnetCommandError=c},90965:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IPackageJsonWithCsDevKitExports=t.idsOfExtensionsAllowedToExtendCsDevKit=void 0;const n=r(69279);var i;t.idsOfExtensionsAllowedToExtendCsDevKit=[n.EXTENSION_ID,n.CSHARP_EXTENSION_ID,"ms-dotnettools.dotnet-maui","ms-dotnettools.vscodeintellicode-csharp","ms-dotnettools.vscode-diagnosticshub"],function(e){e.is=function(e){return e&&!!e.csdevkitExports}}(i||(t.IPackageJsonWithCsDevKitExports=i={}))},7195:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setDotNetSdkPath=t.sendFirstInteractionWithExplorerTelemetry=t.deactivate=t.activate=t.dotnetSdkPath=t.dotnetVersionManager=t.firstExplorerInteractionTelemetry=t.dotnetTaskProvider=t.selectedSolutionFileStatusBarItem=t.projectInitializationStatus=t.projectQueryableSpace=t.environmentStateManager=t.solutionExplorerTreeView=t.solutionExplorerProvider=t.experimentationService=t.telemetryService=t.logger=void 0;const n=r(83176),i=r(89244),o=r(89496),s=r(86800),a=r(59035),c=r(78343),u=r(7631),l=r(24138),d=r(2155),p=r(92614),f=r(81106),h=r(17702),g=r(44462),m=r(76925),v=r(20481),y=r(91058),_=r(50031),S=r(40799),w=r(79053),b=r(758),E=r(90126),P=r(71181),T=r(64424),C=r(24593),I=r(65300),O=r(82070),x=r(10976),N=r(6923),k=r(84611),R=r(61574),A=r(29235),D=r(69658),j=r(92624),M=r(35199),L=r(49546),F=r(34586),U=r(85970),B=r(93197),V=r(69279),$=r(46342),q=r(58741),H=r(37224),W=r(21232),z=r(49230),G=r(17407),K=r(49397),X=r(46429),J=r(14918),Q=r(14145),Y=r(54062),Z=r(89781),ee=r(6460),te=r(49998),re=r(22677),ne=r(75010),ie=r(36661),oe=r(92181),se=r(2906),ae=r(57147),ce=r(22037),ue=r(71017),le=r(83661),de=r(9786),pe=r(77855),fe=r(95113),he=r(87211),ge=r(29758),me=r(48182),ve=r(42300),ye=r(60519),_e=r(45723),Se=r(26674),we=r(97475),be=r(11144),Ee=r(35092),Pe=r(41122),Te=r(57834),Ce=r(8514);let Ie,Oe,xe;function Ne(e,t){e.subscriptions.push(o.commands.registerCommand(l.default.openSolution,(t=>(0,I.default)(e,t)))),e.subscriptions.push(o.commands.registerCommand(l.default.closeSolution,(()=>(0,I.closeSolution)(e)))),e.subscriptions.push(o.commands.registerCommand(l.default.addNewProject,(t=>(0,h.addNewProject)(e,t)))),e.subscriptions.push(o.commands.registerCommand(l.default.addNewProjectFromNewFileMenu,(()=>(0,h.addNewProjectFromNewFileMenu)(e)))),e.subscriptions.push(o.commands.registerCommand(l.default.addExistingProject,(e=>(0,p.default)(e)))),e.subscriptions.push(o.commands.registerCommand(l.default.removeProject,(t=>(0,N.default)(e,t)))),e.subscriptions.push(o.commands.registerCommand(l.default.buildAndRunTests,i.buildAndRunTests)),e.subscriptions.push(o.commands.registerCommand(l.default.buildSolution,(t=>(0,y.buildSolution)(e,t)))),e.subscriptions.push(o.commands.registerCommand(l.default.rebuildSolution,(t=>(0,y.rebuildSolution)(e,t)))),e.subscriptions.push(o.commands.registerCommand(l.default.cleanSolution,(t=>(0,y.cleanSolution)(e,t)))),e.subscriptions.push(o.commands.registerCommand(l.default.showEntitlementsStatus,te.showEntitlementsStatusCommand)),e.subscriptions.push(o.commands.registerCommand(l.default.openInTerminal,T.default)),e.subscriptions.push(o.commands.registerCommand(l.default.signIntoVsAccount,te.signInCommand)),e.subscriptions.push(o.commands.registerCommand(l.default.searchProjectFromCommandPalette,j.searchProjectFromCommandPalette)),e.subscriptions.push(o.commands.registerCommand(l.default.searchOpenFromCommandPalette,j.searchOpenFromCommandPalette)),e.subscriptions.push(o.commands.registerCommand(l.default.searchFromCommandPalette,j.searchFromCommandPalette)),e.subscriptions.push(o.commands.registerCommand(l.default.revealFileInOS,D.default)),e.subscriptions.push(o.commands.registerCommand(l.default.deleteItem,b.default)),e.subscriptions.push(o.commands.registerCommand(l.default.addNewFile,f.addNewFile)),e.subscriptions.push(o.commands.registerCommand(l.default.addNewFileFromNewFileMenu,f.addNewFileFromNewFileMenu)),e.subscriptions.push(o.commands.registerCommand(l.default.addExistingFile,d.default)),e.subscriptions.push(o.commands.registerCommand(l.default.addProjectReference,m.default)),e.subscriptions.push(o.commands.registerCommand(l.default.removeProjectReference,v.default)),e.subscriptions.push(o.commands.registerCommand(l.default.rename,R.default)),e.subscriptions.push(o.commands.registerCommand(l.default.copyPath,_.copyPath)),e.subscriptions.push(o.commands.registerCommand(l.default.copyRelativePath,_.copyRelativePath)),e.subscriptions.push(o.commands.registerCommand(l.default.newSolutionFolder,P.default)),e.subscriptions.push(o.commands.registerCommand(l.default.renameSolutionFolder,A.default)),e.subscriptions.push(o.commands.registerCommand(l.default.removeSolutionFolder,k.default)),e.subscriptions.push(o.commands.registerCommand(l.default.newFolder,E.default)),e.subscriptions.push(o.commands.registerCommand(l.default.removeItem,O.default)),e.subscriptions.push(o.commands.registerCommand(l.default.openProjectsLogsView,C.default)),e.subscriptions.push(o.commands.registerCommand(l.default.openDevKitOutputWindow,de.default)),e.subscriptions.push(o.commands.registerCommand(l.default.debugProjectLaunch,(e=>(0,w.default)(e,{})))),e.subscriptions.push(o.commands.registerCommand(l.default.noDebugProjectLaunch,(e=>(0,w.default)(e,{noDebug:!0})))),e.subscriptions.push(o.commands.registerCommand(l.default.debugProperties,(()=>(0,Pe.default)(t)))),e.subscriptions.push(o.commands.registerCommand(l.default.stepIntoProjectLaunch,(e=>(0,w.default)(e,{stopAtEntry:!0})))),e.subscriptions.push(o.commands.registerCommand(l.default.debugFileLaunch,(e=>(0,S.default)(e,{})))),e.subscriptions.push(o.commands.registerCommand(l.default.noDebugFileLaunch,(e=>(0,S.default)(e,{noDebug:!0})))),e.subscriptions.push(o.commands.registerCommand(l.default.selectStartupProject,L.default)),e.subscriptions.push(o.commands.registerCommand(l.default.selectLaunchConfiguration,M.default)),e.subscriptions.push(o.commands.registerCommand(l.default.selectLaunchTargetFramework,he.default)),e.subscriptions.push(o.commands.registerCommand(l.default.installDotnetSdk,(()=>(0,Q.showInstallDotnetSdkWebview)(e)))),e.subscriptions.push(o.commands.registerCommand(l.default.installDotnetSdkFromWalkthrough,(()=>function(e){(0,Q.showInstallDotnetSdkWebviewBeside)(e)}(e)))),e.subscriptions.push(o.commands.registerCommand(l.default.helperOpenUrl,(t=>(0,Q.openUrlCmdHandler)(e,"OpenUrl",t)))),e.subscriptions.push(o.commands.registerCommand(l.default.syncWithActiveItem,F.default)),e.subscriptions.push(o.commands.registerCommand(l.default.selectActiveConfiguration,(()=>(0,fe.default)(e)))),e.subscriptions.push(o.commands.registerCommand(l.default.saveSolutionFile,pe.default)),e.subscriptions.push(o.commands.registerCommand(l.default.manageUserSecrets,we.manageUserSecrets)),e.subscriptions.push((0,s.instrumentOperationAsVsCodeCommand)(l.default.webviewRunCommand,Y.webviewCmdLinkHandler)),e.subscriptions.push(o.commands.registerCommand(l.default.addNuGetPackage,g.default)),e.subscriptions.push(o.commands.registerCommand(l.default.updateNuGetPackage,U.default)),e.subscriptions.push(o.commands.registerCommand(l.default.removeNuGetPackage,x.default)),e.subscriptions.push(o.commands.registerCommand(l.default.openCoverageReport,le.default))}function ke(e,r,s=!1){if(e.subscriptions.push(o.window.registerWebviewPanelSerializer(l.default.installDotnetSdk,new Q.InstallDotnetSdkViewSerializer(e))),s)return;t.environmentStateManager=new X.EnvironmentStateManager(r),t.solutionExplorerProvider=new oe.SolutionExplorerProvider(e,r,t.environmentStateManager),t.projectInitializationStatus=new _e.ProjectInitializationStatus,t.selectedSolutionFileStatusBarItem=new Ce.SelectedSolutionFileStatus;const a=o.window.registerTreeDataProvider("solutionExplorer",t.solutionExplorerProvider);return t.solutionExplorerTreeView=o.window.createTreeView("solutionExplorer",{treeDataProvider:t.solutionExplorerProvider,dragAndDropController:t.solutionExplorerProvider}),(0,se.subscribeToSolutionTreeEvents)(),e.subscriptions.push(a,t.solutionExplorerProvider,t.solutionExplorerTreeView,t.projectInitializationStatus,t.selectedSolutionFileStatusBarItem),Re(r,(()=>(0,n.createCoverageControllers)(e,r.serviceBroker,re.codeCoverageStrings))),Re(r,(()=>(0,i.createAndRegisterTestController)(e,r.serviceBroker,(0,n.getCollectionController)(),re.testExplorerStrings))),{solutionExplorerProvider:t.solutionExplorerProvider,environmentStateManager:t.environmentStateManager}}async function Re(e,r){e.hasServerProcessLoaded()?await r():e.serverProcessLoaded((async function(){try{await r()}catch(e){t.logger.log("Server process spawn handler failed: "+e,Z.LogImportance.high)}}))}function Ae(e,t){return(0,ee.addDotNetDumpCreationEnvironmentValues)(t),(0,ie.writeCommonPropsToFileAsync)(e)}t.activate=async function(e){const r=Date.now();let n=null;async function s(e,t){n=e;try{const e=await t();return n+=" (succeeded)",e}catch(e){throw n+=" (failed)",e}}t.logger=new Z.Logger(e.extension.packageJSON.displayName);const d=e.logUri.fsPath;try{await s("initializeTelemetryAsync",(()=>async function(e){t.telemetryService=new ie.TelemetryService(e);try{await t.telemetryService.saveVSCodePropsAsync(e)}catch(e){t.logger.log("Saving VSCode common properties failed: "+e,Z.LogImportance.high)}}(e))),await s("initializeExperimentationServiceAsync",(()=>async function(e){const r=V.EXTENSION_ID,n=e.extension.packageJSON.version;let i;switch(o.env.uriScheme){case"vscode":default:i=a.TargetPopulation.Public;break;case"vscode-insiders":i=a.TargetPopulation.Insiders;break;case"vscode-exploration":i=a.TargetPopulation.Internal;break;case"code-oss":i=a.TargetPopulation.Team}try{const o=t.telemetryService?.getExperimentationTelemetryReporter();o&&(t.experimentationService=await(0,a.getExperimentationServiceAsync)(r,n,i,o,e.globalState),await t.experimentationService.initializePromise,await t.experimentationService.initialFetch)}catch(e){t.logger.log("Experimentation service initialization failed: "+e)}}(e)));const n=new ne.TelemetryActivity("extension-activation",t.telemetryService,r);if(t.firstExplorerInteractionTelemetry=new ne.TelemetryActivity("first-interaction-with-explorer",t.telemetryService),(0,be.checkHostApp)()||(0,Ee.showLicenseViolationToastAndThrow)(),!o.workspace.isTrusted)return function(e){for(const t of Object.values(l.default))e.subscriptions.push(o.commands.registerCommand(t,Te.default))}(e),{isLimitedActivation:!0};const p=!o.workspace.workspaceFolders;p||await s("activateCSharpExtension",(async()=>{const e=o.extensions.getExtension(V.CSHARP_EXTENSION_ID);if(!e)throw new Error(`C# extension (${V.CSHARP_EXTENSION_ID}) is not installed or not activated.`);e.isActive||await t.logger.watch(`Activating C# extension (version ${e.packageJSON.version})`,(async()=>{await e.activate()}))})),await o.commands.executeCommand("setContext","solutionExplorerVisible",!1);const f=await s("loadOrCreateCachedValue->getAllComponentsMap",(()=>(0,u.loadOrCreateCachedValue)(e,"components",(()=>(0,B.getAllComponentsMap)(e.asAbsolutePath("components")))))),h=await s("prepareBrokeredServices",(()=>(0,c.prepareBrokeredServices)(e,f,t.logger)));let g;t.dotnetVersionManager=new Se.DotnetVersionManager(e);let m=null;const v=!p&&o.workspace.getConfiguration("dotnet").get("preferCSharpExtension");p?(Ne(e,h.serviceBroker),g=ke(e,h,!0)):v&&(0,J.doesCSharpExtensionSupportDeferral)()?(t.logger.log("C# Dev Kit extension is disabled because the setting 'dotnet.preferCSharpExtension' is set to 'true'"),n.addOrUpdateProperties({disabled:String(!0)})):await(0,J.checkCSharpExtensionVersionCompatibility)(e)&&(Ne(e,h.serviceBroker),g=ke(e,h),t.projectQueryableSpace=new ye.ProjectQueryableSpace(h.serviceBroker),(o.workspace.workspaceFolders&&o.workspace.workspaceFolders.length>0?o.workspace.workspaceFolders[0].uri.fsPath:null)&&(t.dotnetTaskProvider=new K.DotnetTaskProvider,Ie=o.tasks.registerTaskProvider(K.DotnetTaskProvider.dotnetType,t.dotnetTaskProvider),(0,se.showSolutionExplorer)(e)),(0,z.setupLaunchableProjectInfoObserver)(e,h),o.workspace.getConfiguration("csharp.preview").get("improvedLaunchExperience",!0)&&((0,G.initializeStartupProjectService)(e),(0,q.setupActiveLaunchConfigurationService)(e),(0,me.setupDebugTargetFrameworkInfoObserver)(e,h),(0,ge.setupActiveDebugTargetFrameworkService)(e),(0,W.setupLanguageStatusItems)(e)),m=await s("registerDynamicDotnetConfigurationProvider",(()=>(0,$.registerDynamicDotnetConfigurationProvider)(e,h))),(0,H.prepareHotReload)(e)),p||o.window.onDidChangeActiveTextEditor((e=>{let r=o.workspace.getConfiguration("dotnet").get("automaticallySyncWithActiveItem");if(e&&r&&t.solutionExplorerTreeView.visible)try{xe&&xe.cancel(),xe=new o.CancellationTokenSource,(0,F.default)(xe.token)}catch(e){}}));const[y,_]=await s("registerIdentityService",(()=>(0,te.registerIdentityService)(e)));t.telemetryService?.registerForTelLevelChangeEvent(h,e),t.telemetryService?.registerUpdateIsMicrosoftInternal(y,e),n.end(),n.sendTelemetry(),Oe=ie.TelemetryService.getSessionId(o.env.sessionId),t.telemetryService?.sendTelemetryEvent("CSDevKit/Extension/Start");const S={outputChannel:ve.hotReloadLogger.outputChannel};return{isLimitedActivation:!1,serviceBroker:h.serviceBroker,getBrokeredServiceServerPipeName:h.getBrokeredServiceServerPipeName,components:f,hasServerProcessLoaded:h.hasServerProcessLoaded,serverProcessLoaded:h.serverProcessLoaded,writeCommonPropsAsync:ie.writeCommonPropsToFileAsync,setupTelemetryAsync:Ae,setupTelemetryEnvironmentAsync:t=>(0,ie.writeCommonPropsToFileAsync)(e,t),launchChildProcessAsync:(e,t,r,n)=>async function(e,t,r,n,i){return(0,ee.launchChildProcess)(e,t,r,n,i)}(f,e,t,r,n),testHooks:g?{views:g,telemetryService:t.telemetryService,identityTestHooks:_,getTestController:i.getTestController,logDirectory:d,debuggerTestExports:m,hotReloadTestExports:S,environmentStateManager:t.environmentStateManager}:void 0}}catch(e){throw t.logger.reportExceptionTelemetryAndLog("activate",n,"",e,t.telemetryService),e}},t.deactivate=function(){let e="CsDevKit/Extension/Exit",r="deactivate: start";t.telemetryService?.sendTelemetryEvent(e+"/Begin");try{t.logger.log("C# Dev Kit deactivate() is now executing..."),r="deactivate: write session deactivated file",ae.writeFile(ue.join(function(){let e=ue.join(ce.tmpdir(),"csdevkit","sessions","deactivated");try{ae.existsSync(e)||ae.mkdirSync(e,{recursive:!0})}catch(r){t.logger.log(`Failed to create deactivated sessions folder path ${e} due to ${r}`),e=ce.tmpdir()}return e}(),Oe?.toLowerCase()+".txt"),"",(e=>{})),r="deactivate: dispose environmentStateManager",t.environmentStateManager?.dispose(),r="deactivate: dispose dotnetTaskProvider",r=Ie?.dispose(),r="deactivate: dispose projectQueryableSpace",t.projectQueryableSpace?.dispose(),t.telemetryService?.sendTelemetryEvent(e,{shutdownReason:"Normal"})}catch(e){throw t.logger.reportExceptionTelemetryAndLog("deactivate",r,"",e,t.telemetryService,{shutdownReason:"Abnormal"}),e}finally{t.telemetryService?.dispose(),t.telemetryService=null}},t.sendFirstInteractionWithExplorerTelemetry=function(){t.firstExplorerInteractionTelemetry&&(t.firstExplorerInteractionTelemetry.end(),t.firstExplorerInteractionTelemetry.sendTelemetry(),t.firstExplorerInteractionTelemetry=void 0)},t.setDotNetSdkPath=function(e){t.dotnetSdkPath=e}},14918:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.doesCSharpExtensionSupportDeferral=t.checkCSharpExtensionVersionCompatibility=void 0;const n=r(69279),i=r(7195),o=r(81249),s=r(89496),a=r(18472),c=r(16260);a.config({bundleFormat:a.BundleFormat.standalone,locale:s.env.language,messageFormat:a.MessageFormat.both});const u=a.loadMessageBundle(r(71017).join(__dirname,"extensionDependenciesChecks.ts"));t.checkCSharpExtensionVersionCompatibility=async function(e){const t=s.extensions.getExtension(n.CSHARP_EXTENSION_ID),r=t?.packageJSON.version;let a=!0;if(r?o.lt(r,n.CSHARP_EXTENSION_REQUIRED_VERSION)&&(i.logger.log(`The C# extension is installed, but has version ${r} which is incompatible with C# Dev Kit.`),async function(){const t=e.extension.packageJSON.displayName,r=u(0,null,t,n.CSHARP_EXTENSION_REQUIRED_VERSION,n.CSHARP_EXTENSION_ID),i=u(1,null);if(await s.window.showWarningMessage(r,i)===i){const e=s.extensions.getExtension(n.EXTENSION_ID)?.packageJSON.preview;e||s.extensions.getExtension(n.CSHARP_EXTENSION_ID)?.packageJSON.preview?await s.commands.executeCommand("workbench.extensions.action.switchToPreReleaseVersion",n.CSHARP_EXTENSION_ID):await s.commands.executeCommand("workbench.extensions.action.switchToReleaseVersion",n.CSHARP_EXTENSION_ID),await s.commands.executeCommand("workbench.action.reloadWindow")}}().catch((()=>{})),a=!1):(i.logger.log("The C# extension is missing."),a=!1),!a){let e=new c.TelemetryEvent("dependency-update-needed",i.telemetryService);e.addOrUpdateProperties({csharpExtensionCurrentVersion:r,csharpExtensionRequiredVersion:n.CSHARP_EXTENSION_REQUIRED_VERSION}),e.sendTelemetry()}return a},t.doesCSharpExtensionSupportDeferral=function(){const e=s.extensions.getExtension(n.CSHARP_EXTENSION_ID),t=e?.packageJSON.version;return!!t&&o.gte(t,n.CSHARP_EXTENSION_SUPPORTS_DEFERRAL_VERSION)}},70336:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EXTENSION_ID=t.RECOMMENDED_VERSION_API_OLD=t.DOTNET_INSTALL_TOOL_EXTENSION_ID=t.OPTION_TO_CHECK_AND_ACQUIRE_ASPNETCORE=t.FIND_PATH_API=t.ACQUIRE_SDK_GLOBAL_API=t.AVAILABLE_VERSIONS_API=t.RECOMMENDED_VERSION_API=t.WEBVIEW_ID=void 0,t.WEBVIEW_ID="csdevkit.installDotnetSdk",t.RECOMMENDED_VERSION_API="dotnet.recommendedVersion",t.AVAILABLE_VERSIONS_API="dotnet.listVersions",t.ACQUIRE_SDK_GLOBAL_API="dotnet.acquireGlobalSDK",t.FIND_PATH_API="dotnet.findPath",t.OPTION_TO_CHECK_AND_ACQUIRE_ASPNETCORE="dotnet.acquireStatus/options",t.DOTNET_INSTALL_TOOL_EXTENSION_ID="ms-dotnettools.vscode-dotnet-runtime",t.RECOMMENDED_VERSION_API_OLD="placeholder.dotnet.oldApiCallWhichNoLongerExists",t.EXTENSION_ID="ms-dotnettools.csdevkit"},54249:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllSuggestedSDKVersions=t.acquireSDK=t.getAlternativeRecommendedVersions=t.getRecommendedVersion=t.apiIsAvailable=void 0;const n=r(70336),i=r(89496);function o(e){const t=i.extensions?.getExtension(n.DOTNET_INSTALL_TOOL_EXTENSION_ID),r=t?.packageJSON.version;if(!r)return!1;switch(e){case n.RECOMMENDED_VERSION_API:return r>="2.0.3";case n.AVAILABLE_VERSIONS_API:return r>="2.0.2";case n.ACQUIRE_SDK_GLOBAL_API:return r>="2.2.8";case n.RECOMMENDED_VERSION_API_OLD:return r>="2.0.2";case n.OPTION_TO_CHECK_AND_ACQUIRE_ASPNETCORE:return r>="2.0.9";case n.FIND_PATH_API:return r>="2.2.9";default:return!1}}t.apiIsAvailable=o;const s={version:"8.0.100",channelVersion:"8.0",supportStatus:"lts",supportPhase:"active"};async function a(){const e={listRuntimes:!1};if(o(n.RECOMMENDED_VERSION_API)){const t=await i.commands.executeCommand(n.RECOMMENDED_VERSION_API,e);if(t&&t.at(0))return t.at(0)}else if(o(n.RECOMMENDED_VERSION_API_OLD)){const t=await i.commands.executeCommand(n.RECOMMENDED_VERSION_API,e);if(t)return{version:t,channelVersion:`${t.split(".").at(0)}.${t.split(".").at(1)}`,supportStatus:Number(t.charAt(0))%2==0?"lts":"sts",supportPhase:"eol"}}return i.window.showWarningMessage("Unable to get latest .NET Installation Data: Please update the .NET Install Tool to version 2.0.2 or later."),s}async function c(){const e={listRuntimes:!1};if(o(n.AVAILABLE_VERSIONS_API)){const t=(await i.commands.executeCommand(n.AVAILABLE_VERSIONS_API,e)).filter((e=>"maintenance"===e.supportPhase||"active"===e.supportPhase)).slice(1,3);if(t)return t}return i.window.showWarningMessage("Unable to get latest .NET Installation Data: Please update the .NET Install Tool to version 2.0.2 or later."),[s,s]}function u(e){return i.window.showErrorMessage(e.message),null}t.getRecommendedVersion=a,t.getAlternativeRecommendedVersions=c,t.acquireSDK=async function(e){const t={version:e.version,requestingExtensionId:n.EXTENSION_ID,installType:"global",architecture:void 0};if(o(n.ACQUIRE_SDK_GLOBAL_API))try{i.window.showInformationMessage("The .NET Install Tool began installing the .NET SDK. You may be asked for permission to complete the installation.");const e=await i.commands.executeCommand(n.ACQUIRE_SDK_GLOBAL_API,t);return e&&e.dotnetPath?(i.window.showInformationMessage(`Installation of the .NET SDK version ${t.version} succeeded.`),e):u(new Error("The .NET Install Tool returned an unexpected result. Please view the 'Output' -> '.NET Install Tool' window for more info."))}catch(e){return u(e instanceof Error?e:new Error("The .NET Install Tool failed to install the .NET SDK. Please view the 'Output' -> '.NET Install Tool' window for more info."))}else i.window.showErrorMessage("Unable to install the .NET SDK: The .NET Install Tool must be updated to version 2.2.8 or later.");return null},t.getAllSuggestedSDKVersions=async function(){return{recommended:await a(),alternatives:await c()}}},14145:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstallDotnetSdkViewSerializer=t.openUrlCmdHandler=t.showInstallDotnetSdkWebviewBeside=t.showInstallDotnetSdkWebview=void 0;const n=r(71017),i=r(89496),o=r(54062),s=r(54249),a=r(70336),c=r(86800);t.showInstallDotnetSdkWebview=function(e){u.createOrShow(e.extensionPath)},t.showInstallDotnetSdkWebviewBeside=function(e){u.createOrShow(e.extensionPath,{beside:!0})},t.openUrlCmdHandler=async function(e,t,r){(0,c.sendInfo)(t,{url:r}),i.commands.executeCommand("vscode.open",i.Uri.parse(r))},t.InstallDotnetSdkViewSerializer=class{context;constructor(e){this.context=e}async deserializeWebviewPanel(e,t){u.createOrShow(this.context.extensionPath,{webviewPanel:e})}};class u{static instance;static viewType=a.WEBVIEW_ID;_panel;_extensionPath;_disposables=[];static createOrShow(e,t){let r=i.ViewColumn.Active;if(t?.beside){const e=i.window.activeTextEditor;r=void 0===e||e.viewColumn===i.ViewColumn.One?i.ViewColumn.Two:i.ViewColumn.One}u.instance?u.instance._panel?.reveal():u.instance=new u(e,t?.webviewPanel?t.webviewPanel:r)}constructor(e,t){this._extensionPath=e,t.viewType?this._panel=t:this._panel=i.window.createWebviewPanel(u.viewType,"Install New .NET SDK",t,{enableScripts:!0,localResourceRoots:[i.Uri.file(n.join(this._extensionPath,"out"))],enableCommandUris:!0,retainContextWhenHidden:!0}),this._panel.webview.html=this._getHtmlForWebview(),this._panel.onDidDispose((()=>this.dispose()),null,this._disposables),this._panel.webview.onDidReceiveMessage((e=>{switch(e.command){case"onWillFetchAvailableReleases":return void this.doFetchAvailableReleases();case"onWillFetchAsset":return void this.doFetchAsset(e.primaryAsset,e.payload);case"onWillDownloadDotnetSdk":return void this.doDownloadDotnetSdk(e.payload);case"onWillReloadWindow":this.doReloadWindow()}}),null,this._disposables)}async doFetchAvailableReleases(){const e=await(0,s.getAllSuggestedSDKVersions)();this._panel?.webview.postMessage({command:"onDidFetchAvailableReleases",payload:e})}async doFetchAsset(e,t){this._panel?.webview.postMessage({command:"onDidFetchAsset",primaryAsset:e,payload:t})}async doDownloadDotnetSdk(e){(0,s.acquireSDK)(e)}async doReloadWindow(){await(0,o.webviewCmdLinkHandler)({webview:u.viewType,identifier:"Reload Window",command:"workbench.action.reloadWindow"})}dispose(){for(u.instance=void 0,this._panel?.dispose(),this._panel=void 0;this._disposables.length;){const e=this._disposables.pop();e&&e.dispose()}}_getHtmlForWebview(){const e=i.Uri.file(n.join(this._extensionPath,"out","assets","install-sdk","index.js")),t=this._panel?.webview.asWebviewUri(e);return`<!DOCTYPE html>\n\t\t\t<html lang="en">\n\t\t\t<head>\n\t\t\t\t<meta charset="utf-8">\n\t\t\t\t<meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">\n\t\t\t\t<meta name="theme-color" content="#000000">\n\t\t\t\t<title>React App</title>\n\t\t\t</head>\n\t\t\t<body>\n\t\t\t\t<noscript>You need to enable JavaScript to run this app.</noscript>\n\t\t\t\t<div id="root"></div>\n\n\t\t\t\t<script nonce="${(0,o.getNonce)()}" src="${t}" type="module"><\/script>\n\t\t\t</body>\n\t\t\t</html>`}}},54062:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNonce=t.openExternalLinkFromWebview=t.webviewCmdLinkHandler=t.encodeExternalLinkWithTelemetry=t.encodeCommandUriWithTelemetry=void 0;const n=r(89496),i=r(86800),o=r(6113);function s(e,t,r,n){const i={webview:e,identifier:t,command:r,args:n};return`command:csdevkit.webview.runCommand?${encodeURIComponent(JSON.stringify(i))}`}async function a(e){const{webview:t,identifier:r,command:o,args:s}=e;(0,i.sendInfo)("",{name:"openWebviewUrl",webview:t,identifier:r}),void 0!==s?await n.commands.executeCommand(o,...s):await n.commands.executeCommand(o)}t.encodeCommandUriWithTelemetry=s,t.encodeExternalLinkWithTelemetry=function(e,t,r){return s(e,t,"csdevkit.helper.openUrl",[r])},t.webviewCmdLinkHandler=a,t.openExternalLinkFromWebview=async function(e,t,r){await a({webview:e,identifier:t,command:"csdevkit.helper.openUrl",args:[r]})},t.getNonce=function(){const e=new Uint8Array(16),t=o.getRandomValues(e),r=String.fromCharCode(...t);return btoa(r)}},35092:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showLicenseViolationToastAndThrow=void 0;const n=r(89496),i=r(22677),o=r(69279);t.showLicenseViolationToastAndThrow=function(){throw n.window.showErrorMessage(`${i.licenseViolationMessage}.`,i.promptStrings.moreInformation).then((e=>{e===i.promptStrings.moreInformation&&n.env.openExternal(n.Uri.parse(o.LICENSE_URL))})),new Error(i.licenseViolationMessage)}},77867:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dotnetCommand=t.findAspNetRuntime=t.acquireRuntime=t.dotnetRuntimeResolved=void 0;const n=r(32081),i=r(71017),o=r(89496),s=r(69279),a=r(89781),c=r(30077),u=r(7195),l=r(84832),d=r(73228),p=r(22677);var f;async function h(e){let t={version:s.NET_RUNTIME_VERSION,requestingExtensionId:s.EXTENSION_ID,mode:"aspnetcore"},r="true"===process.env.AUTOMATED_TESTING?void 0:await o.commands.executeCommand("dotnet.acquireStatus",t);return void 0===r&&(await o.commands.executeCommand("dotnet.showAcquisitionLog"),r=await o.commands.executeCommand("dotnet.acquire",t)),r?.dotnetPath?(await async function(e,t){const r=[e];await o.commands.executeCommand("dotnet.ensureDotnetDependencies",{command:e,arguments:r})}(r.dotnetPath),r.dotnetPath):null}!function(e){e[e.DisplayAllErrorPopups=0]="DisplayAllErrorPopups",e[e.DisableErrorPopups=1]="DisableErrorPopups"}(f||(f={})),t.acquireRuntime=async function(e,r){if(t.dotnetRuntimeResolved)return t.dotnetRuntimeResolved;if(void 0===t.dotnetRuntimeResolved)if(e){const e=await(0,l.getDotnetInfoLegacy)(u.logger);let n;if(!e){const e=await(0,l.findInstalledDotnetFromPathLegacy)(null,u.logger);n=e?p.errorStrings.corruptedDotnetInstallation(e):p.errorStrings.cannotFindDotnetInstallation,u.logger.log(n,a.LogImportance.high),u.logger.show(),o.window.showErrorMessage(n);const t=process.env.PATH;t?u.logger.log(`PATH=${t}`,a.LogImportance.high):u.logger.log("PATH environment variable cannot be found.",a.LogImportance.high)}const i=await(0,l.findMatchedDotnetFromPathLegacy)(r,u.logger,e);let s="string"==typeof i?i:null,c=!1;if(s?u.logger.log(`Using preinstalled .NET runtime at "${s}" to load Dev Kit processes.`):(s=await h())&&(u.logger.log(`Using local .NET runtime at "${s}"`),c=!0),s){const r=e?await(0,l.findInstalledDotnetFromPathLegacy)(e,u.logger):null;t.dotnetRuntimeResolved=c?{path:s,isAcquired:c,globalRuntimeMismatchingReason:i,globalPath:r,dotnetInfo:e,dotnetFailureMessage:n}:{path:s,isAcquired:c,globalPath:r,dotnetInfo:e,dotnetFailureMessage:n}}else t.dotnetRuntimeResolved=null}else{const e=await(0,l.getArchitectureFromTargetPlatform)(r,u.logger);var n=null,i=null;if("true"===process.env.CSDEVKIT_FORCE_OWN_RUNTIME||"darwin"===process.platform&&o.workspace?.getConfiguration("dotnet")?.get("workingWithTestSignedSdk"))"true"===process.env.CSDEVKIT_FORCE_OWN_RUNTIME?u.logger.log('Finding existing .NET runtime is disabled because environment variable "CSDEVKIT_FORCE_OWN_RUNTIME" is set to true.'):u.logger.log('Finding existing .NET runtime is disabled because the setting "dotnet.workingWithTestSignedSdk" is enabled.');else{const t={acquireContext:{version:`${s.NET_RUNTIME_VERSION}.${s.NET_RUNTIME_VERSION_PATCH}`,requestingExtensionId:s.EXTENSION_ID,architecture:e,mode:"runtime"},versionSpecRequirement:"latestFeature",rejectPreviews:!0},r=await o.commands.executeCommand("dotnet.findPath",t);r&&r.dotnetPath?u.logger.log(`.NET Runtime found at: "${r.dotnetPath}".`,a.LogImportance.low):u.logger.log("No suitable .NET runtime was found.",a.LogImportance.low);const c=r?.dotnetPath;n="string"==typeof c?c:null;const l={acquireContext:{version:`${s.NET_RUNTIME_VERSION}.${s.NET_RUNTIME_VERSION_PATCH}`,requestingExtensionId:s.EXTENSION_ID,architecture:e,mode:"aspnetcore"},versionSpecRequirement:"latestFeature",rejectPreviews:!0},d=await o.commands.executeCommand("dotnet.findPath",l);d&&d.dotnetPath?u.logger.log(`ASP.NET Runtime found at: "${d.dotnetPath}".`,a.LogImportance.low):u.logger.log("No suitable ASP.NET runtime was found.",a.LogImportance.low);const p=d?.dotnetPath;i="string"==typeof p?p:null}let c=!1;if(n&&i&&n===i?u.logger.log(`Using existing .NET runtime at "${n}" to load Dev Kit processes.`):(n=await h())&&(u.logger.log(`Using acquired .NET runtime at "${n}"`),c=!0),n){const r={acquireContext:{version:s.NET_SDK_MIMIMUM_SUPPORTED_VERSION,requestingExtensionId:s.EXTENSION_ID,installType:"global",architecture:e,mode:"sdk"},versionSpecRequirement:"greater_than_or_equal"},i=await o.commands.executeCommand("dotnet.findPath",r);i?u.logger.log(`.NET Sdk found: "${i.dotnetPath}".`):u.logger.log("Could not find installed SDK.");const a=i?.dotnetPath;t.dotnetRuntimeResolved={path:n,isAcquired:c,globalPath:a,dotnetInfo:null,dotnetFailureMessage:void 0}}else t.dotnetRuntimeResolved=null}if(null===t.dotnetRuntimeResolved)throw new Error("Could not resolve the dotnet path!");return t.dotnetRuntimeResolved},t.findAspNetRuntime=async function(e,t,r){if(!e)return r.log("Skipping ASP.NET runtime lookup because no dotnet root was provided.",a.LogImportance.low),!1;const n=await(0,l.getArchitectureFromTargetPlatform)(void 0,r),c={acquireContext:{version:`${t.major}.${t.minor}.0`,requestingExtensionId:s.EXTENSION_ID,architecture:n,mode:"aspnetcore"},versionSpecRequirement:"latestMajor",rejectPreviews:!1};r.log(`Searching for ASP.NET runtime matching ${t.toString()} for dotnet root "${e}" (architecture: ${n}).`,a.LogImportance.low);const u=await o.commands.executeCommand("dotnet.findPath",c),d=u?.dotnetPath;if(!d)return r.log(`No ASP.NET runtime was found for dotnet root "${e}".`,a.LogImportance.low),!1;const p=i.dirname(d),f=e=>i.normalize(e),h=f(e),g=f(p);return("win32"===process.platform?h.toLowerCase()===g.toLowerCase():h===g)?(r.log(`ASP.NET runtime found at "${d}".`,a.LogImportance.low),!0):(r.log(`ASP.NET runtime located at "${d}", but it does not match expected dotnet root "${e}".`,a.LogImportance.low),!1)},t.dotnetCommand=async function(e,t,r,i,s,a){try{const e=u.dotnetSdkPath??("win32"===process.platform?"dotnet.exe":"dotnet"),c=s?u.logger:i??u.logger;await c.watch(`command: "${e}" ${r.join(" ")}`,(async()=>{const s={windowsHide:!0,cwd:t,env:{DOTNET_CLI_UI_LANGUAGE:o.env.language,...process.env}},c=n.execFile(e,r,s);a&&c.pid&&a(c.pid),await(0,d.waitForProcess)(c,i)}))}catch(t){throw t instanceof c.ExitCodeError?new c.DotnetCommandError(e,t.errorCode,t.message):t instanceof Error?new c.DotnetCommandError(e,0,t.message):new c.DotnetCommandError(e,0,t?.toString()??"")}}},84832:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getArchitectureFromTargetPlatform=t.execChildProcess=t.getDotnetInfoLegacy=t.findInstalledDotnetFromPathLegacy=t.findMatchedDotnetFromPathLegacy=t.CompatibleDotnetSearchFailedReason=void 0;const n=r(89496),i=r(32081),o=r(81249),s=r(69279),a=r(73228),c=r(89781),u=r(73292),l=r(71017),d=r(54249),p=r(70336),f=r(57147);var h;async function g(e,t,r){const n=await(0,u.realpath)(e),i="win32"===process.platform?"dotnet.exe":"dotnet";if(n.toLowerCase().endsWith(i)){const e=l.dirname(n),t=l.join(e,"host");if((0,f.existsSync)(t))return r.log(`Found installed dotnet location "${n}" to load projects.`,c.LogImportance.high),n}t||(t=await v(r));const o=t?.runtimeVersions["Microsoft.NETCore.App"];if(o)for(const e of o){const t=l.dirname(l.dirname(e.path));if(t){const e=l.join(t,i);if(await(0,a.exists)(e))return r.log(`Found installed dotnet location "${e}" by using dotnet runtime location.`,c.LogImportance.high),e}}return r.log(`Found installed dotnet location "${n}" as final fallback after fail to find runtime. This is unexpected and the extension might not work.`,c.LogImportance.high),n}async function m(e,t){const r=(0,a.isWindows)()?"where.exe":"which";try{const n=await y(r,["dotnet"]);if(!n)return t.log(`Unable to find dotnet from ${r}.`,c.LogImportance.high),null;const i=n.trim().replace(/\r/gm,"").split("\n")[0];return await(0,a.exists)(i)?(t.log(`dotnet found at ${i}`,c.LogImportance.low),await g(i,e,t)):(t.log(`dotnet path does not exist: "${i}"`,c.LogImportance.high),null)}catch(n){t.log(`Failed to find dotnet from path with "${r} dotnet".\n${n}`,c.LogImportance.high);const i=process.env.PATH?.split(l.delimiter);if(i){const r="win32"===process.platform?"dotnet.exe":"dotnet";for(let n=0;n<i.length;n++){const o=l.resolve(i[n],r);if(await(0,a.exists)(o))return t.log(`dotnet found at ${o} from PATH`,c.LogImportance.low),await g(o,e,t)}}}return null}async function v(e){try{let t;const r=n.workspace?.workspaceFolders;r&&r.length>0&&(t=r[0].uri.fsPath);const i=await y("dotnet",["--info"],t,{...process.env,DOTNET_CLI_UI_LANGUAGE:"en-US"});let s,a;e.log(`dotnet --info\n${i}`,c.LogImportance.low);let u=i.replace(/\r/gm,"").split("\n");for(const e of u){let t;(t=/^\s*Version:\s*([^\s].*)$/.exec(e))?s=o.parse(t[1]):(t=/^\s*Architecture:\s*(.*)/.exec(e))&&(a=t[1])}const l={},d=await y("dotnet",["--list-runtimes"]);e.log(`dotnet --list-runtimes\n${d}`,c.LogImportance.low),u=d.split(/\r?\n/);for(const e of u){let t;if(t=/^([\w\.]+) ([^ ]+) \[([^\]]+)\]$/.exec(e)){const e=t[1],r=t[2],n=t[3];e in l?l[e].push({version:o.parse(r),path:n}):l[e]=[{version:o.parse(r),path:n}]}}if(s){const t={version:s,architecture:a,runtimeVersions:l};return e.log(`Returning dotnet info: ${JSON.stringify(t)}`,c.LogImportance.low),t}return e.log("Failed to parse dotnet version information",c.LogImportance.high),null}catch(t){return e.log(`Error running "dotnet --info". Either the dotnet installation cannot be found from PATH, or it might be corrupted.\n${t}`,c.LogImportance.high),null}}async function y(e,t=[],r=process.cwd(),n=process.env){return new Promise(((o,s)=>{i.execFile(e,t,{windowsHide:!0,maxBuffer:512e3,cwd:r,env:n},((e,t,r)=>{e?s(new Error(`${e}\nSTDOUT:\n${t}\nSTDERR:\n${r}`)):r&&!r.includes("screen size is bogus")?s(new Error(r)):o(t)}))}))}async function _(e,t){let r=process.arch;if(e){const n=e.asAbsolutePath("extension.vsixmanifest");if(await(0,a.exists)(n)){const e=await(0,u.readFile)(n,"utf-8"),i=/TargetPlatform="[^"-]+-(.*)"/.exec(e);i?(r=i[1],t.log(`Found extension target platform: ${r}`,c.LogImportance.low)):t.log(`Could not find extension target platform in "${n}. Falling back to ${r}."`,c.LogImportance.high)}else t.log(`Unable to find extension target platform - no vsix manifest file exists at "${n}". Falling back to ${r}.`,c.LogImportance.low)}return r}!function(e){e[e.noCandidateFound=0]="noCandidateFound",e[e.mismatchedArchitectureFound=1]="mismatchedArchitectureFound",e[e.mismatchedHigherVersionRuntimeFound=2]="mismatchedHigherVersionRuntimeFound",e[e.mismatchedVersionRuntimeFound=3]="mismatchedVersionRuntimeFound",e[e.disabled=4]="disabled"}(h||(t.CompatibleDotnetSearchFailedReason=h={})),t.findMatchedDotnetFromPathLegacy=async function(e,t,r){try{if(void 0===r&&(r=await v(t)),!r)return h.noCandidateFound;const i=await _(e,t);if(i!==r.architecture)return t.log(`The architecture of the .NET runtime (${r.architecture}) does not match the architecture of the extension (${i}).`,c.LogImportance.low),h.mismatchedArchitectureFound;const u=o.parse(`${s.NET_RUNTIME_VERSION}.${s.NET_RUNTIME_VERSION_PATCH}`),f=r.runtimeVersions["Microsoft.NETCore.App"],g=r.runtimeVersions["Microsoft.AspNetCore.App"],y=(0,d.apiIsAvailable)(p.OPTION_TO_CHECK_AND_ACQUIRE_ASPNETCORE);let S=!1,w=!1,b="";for(const e of f){const t=e.version;if(!(t.prerelease?.length>0))if(t.major===u.major){if(t.compare(u)>=0&&(!y||g?.find((e=>0===e.version.compare(t))))){S=!0,b=e.path;break}}else 1!==t.compare(u)||y&&!g?.find((e=>0===e.version.compare(t)))||(w=!0,b=e.path)}if(!S)return t.log("No extension compatible .NET runtime found from installed SDKs.",c.LogImportance.low),w?h.mismatchedHigherVersionRuntimeFound:h.mismatchedVersionRuntimeFound;if("true"===process.env.CSDEVKIT_FORCE_OWN_RUNTIME||"darwin"===process.platform&&n.workspace?.getConfiguration("dotnet")?.get("workingWithTestSignedSdk"))return h.disabled;if(b&&(b=l.dirname(l.dirname(b)),b)){const e=l.join(b,(0,a.isWindows)()?"dotnet.exe":"dotnet");if(await(0,a.exists)(e))return e}const E=await m(r,t);if(E)return E}catch(e){t.log(`Failed to find dotnet info from path: ${e}`,c.LogImportance.high)}return h.noCandidateFound},t.findInstalledDotnetFromPathLegacy=m,t.getDotnetInfoLegacy=v,t.execChildProcess=y,t.getArchitectureFromTargetPlatform=_},39058:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NuGetConfigurationSettings=void 0;const n=r(89496);class i{_config=void 0;constructor(e){this._config=this.getConfiguration(e)}getConfiguration(e){const t=n.workspace.getConfiguration(e);if(!t)throw new Error(`Configuration ${t} not found`);return t}getValue(e,t){return this._config?.get(e,t)??t}}class o extends i{static configurationName="nuget";static includePrereleaseKey="includePrereleasePackageVersions";constructor(){super(o.configurationName)}get includePrerelease(){return this.getValue(o.includePrereleaseKey,!1)}}t.NuGetConfigurationSettings=o},98986:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPrereleaseStatusPlaceholder=t.getPackageFromContext=t.getProjectFromContext=t.retrieveOutdatedPackages=t.retrieveInstalledPackages=t.retrievePackageVersions=t.showVersionPicker=t.showPackagePickerFromPromise=t.showProjectPicker=t.verifyServicePrerequisites=t.NuGetAction=void 0;const n=r(89496),i=r(68489),o=r(81249),s=r(49397),a=r(7195),c=r(22677),u=r(65979),l=r(277),d=r(29047),p=r(92181),f=r(71017);var h;function g(e,t=void 0){return e===h.add?t?c.nugetStrings.addPackageNameTitle(t):c.nugetStrings.addPackageTitle:e===h.update?t?c.nugetStrings.updatePackageNameTitle(t):c.nugetStrings.updatePackageTitle:e===h.remove?c.nugetStrings.removePackageTitle:""}function m(e,t){return e?c.nugetStrings.prereleaseIncludedSuffix(t):c.nugetStrings.prereleaseNotIncludedSuffix(t)}function v(e){return e===h.update?c.nugetStrings.noPackagesToUpdateResult:e===h.remove?c.nugetStrings.noPackagesToRemoveResult:""}!function(e){e[e.add=0]="add",e[e.update=1]="update",e[e.remove=2]="remove"}(h||(t.NuGetAction=h={})),t.verifyServicePrerequisites=async function(e,t,r,i){return await a.logger.watch("Check NuGet service prerequisites",(async function(){const o=await r.getProxy(u.default.nugetCommandsService);try{const r=await(0,d.runWithDurationTelemetry)((async()=>await(o?.checkPrerequisites(t))),i,"verifyPrerequisites");let s;return r&&!r.isPrerequisiteMet&&r.message&&r.actionText&&o instanceof l.NuGetDotnetCommandsService&&(s=await n.window.showQuickPick([r.actionText,c.promptStrings.cancel],{title:g(e),placeHolder:r.message}),s&&s!==c.promptStrings.cancel&&n.commands.executeCommand("vscode.open",n.Uri.parse("https://go.microsoft.com/fwlink/?linkid=2263657"))),(0,d.addDotnetSdkTelemetry)(i,r?.value??"unknown",s?s===c.promptStrings.cancel?"cancel":"install":void 0),r}finally{o?.dispose()}}),{telemetry:i,catchUnhandledErrors:!0})},t.showProjectPicker=async function(e,t){const r=await(0,d.runWithDurationTelemetry)((async()=>await(0,s.getAllProjects)()),t,"getAllProjects");if((0,d.addResultsCountTelemetry)(t,r?.length??0,"getAllProjects"),r&&r.length>0){const t=r.map((e=>({name:e.Name,fullPath:e.Path}))).sort(((e,t)=>e.name.localeCompare(t.name)));let o;if(1===t.length)o=t[0];else{const r=await n.window.showQuickPick(t.map((e=>new i.ProjectInfoQuickPick(e))),{title:g(e),placeHolder:c.nugetStrings.projectPickerPlaceholder});o=r?.info}return o}},t.showPackagePickerFromPromise=async function(e,t,r){let o;const s=await n.window.showQuickPick(new Promise((async r=>{const n=await t;n&&n.length>0?r(n?.map((e=>new i.NuGetPackageUpdateQuickPick(e)))):r([{label:v(e)}])})),{title:g(e),placeHolder:r?m(r.includePrerelease,c.nugetStrings.packagePickerPlaceholder):c.nugetStrings.packagePickerPlaceholder});return s&&s instanceof i.NuGetPackageUpdateQuickPick&&(o=s.info),o},t.showVersionPicker=async function(e,t,r,s){let a;const u=await n.window.showQuickPick(new Promise((async e=>{const n=await r;let s=!1;const a=[];n&&n.length>0?(n.sort(((e,t)=>{const r=o.parse(e.version,{loose:!0}),n=o.parse(t.version,{loose:!0});return n&&r?o.compare(n,r,{loose:!0}):0})).map((e=>{if(e.version){s||(e.isLatest=s=!0),e.version===t.version&&(e.isCurrent=!0);const r=new i.NuGetPackageVersionQuickPick(e);a.push(r)}})),e(a)):e([{label:c.nugetStrings.noVersionsFoundError}])})),{title:g(e,t.id),placeHolder:m(s.includePrerelease,c.nugetStrings.selectVersionPlaceholder)});return u&&u instanceof i.NuGetPackageVersionQuickPick&&(a=u.info),a},t.retrievePackageVersions=async function(e,t,r,n,i){return await a.logger.watch("Get NuGet package versions",(async function(){const o=await n.getProxy(u.default.nugetCommandsService);try{const n=await(0,d.runWithDurationTelemetry)((async()=>await(o?.getVersions(e,t,r))),i,"getPackageVersions")??[];return(0,d.addResultsCountTelemetry)(i,n.length,"getPackageVersions"),n}finally{o?.dispose()}}),{telemetry:i,catchUnhandledErrors:!0})},t.retrieveInstalledPackages=async function(e,t,r){return await a.logger.watch("Get installed NuGet packages",(async function(){const n=await t.getProxy(u.default.nugetCommandsService);try{const t=await(0,d.runWithDurationTelemetry)((async()=>await(n?.getInstalledPackages(e))),r,"listInstalledPackages")??[];return(0,d.addResultsCountTelemetry)(r,t.length,"listInstalledPackages"),t}finally{n?.dispose()}}),{telemetry:r,catchUnhandledErrors:!0})},t.retrieveOutdatedPackages=async function(e,t,r,n){return await a.logger.watch("Get outdated NuGet packages",(async function(){const i=await r.getProxy(u.default.nugetCommandsService);try{const r=await(0,d.runWithDurationTelemetry)((async()=>await(i?.getOutdatedPackages(e,t))),n,"listOutdatedPackages")??[];return(0,d.addResultsCountTelemetry)(n,r.length,"listOutdatedPackages"),r}finally{i?.dispose()}}),{telemetry:n,catchUnhandledErrors:!0})},t.getProjectFromContext=function(e){if(e instanceof n.Uri){const t=f.normalize(e.fsPath);return{name:f.basename(t,".csproj"),fullPath:t}}let t;if(e?.node?.NodeType===p.nodeTypes.project)t=e.node;else if(e?.node?.NodeType===p.nodeTypes.packageDependency){let r=e;for(;r?.node&&r.node.NodeType!==p.nodeTypes.project;)r=r.parentNode;t=r?.node}if(t&&t.Path)return{name:t.Name,fullPath:t.Path}},t.getPackageFromContext=function(e){const t=e?.node;if(t&&t.NodeType===p.nodeTypes.packageDependency&&t.Description&&t.Description.length>2)return{id:t.Name,version:t.Description.substring(1,t.Description.length-1)}},t.getPrereleaseStatusPlaceholder=m},68489:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NuGetPackageUpdateQuickPick=t.NuGetPackageVersionQuickPick=t.NuGetPackageSearchQuickPick=t.ProjectInfoQuickPick=void 0;const n=r(22677);t.ProjectInfoQuickPick=class{info;label;description;constructor(e){this.info=e,this.label=e.name,this.description=e.fullPath}},t.NuGetPackageSearchQuickPick=class{info;label;description;detail;constructor(e){this.info=e,this.label=e.id}},t.NuGetPackageVersionQuickPick=class{info;label;description;detail;constructor(e){this.info=e,this.label=e.version;const t=[];e.isLatest&&t.push(n.nugetStrings.versionLatestLabel),e.isCurrent&&t.push(n.nugetStrings.versionCurrentLabel),t.length>0&&(this.description=`(${t.join(", ")})`)}},t.NuGetPackageUpdateQuickPick=class{info;label;description;detail;constructor(e){this.info=e,this.label=e.id,this.description=e.version}}},29047:(e,t)=>{"use strict";async function r(e){const t=Date.now();return{result:await e(),durationMilliseconds:Date.now()-t}}Object.defineProperty(t,"__esModule",{value:!0}),t.measureExecutionTime=t.runWithDurationTelemetry=t.addResultsCountTelemetry=t.addDotnetSdkTelemetry=t.addIncludePrereleaseTelemetry=t.addCompletedTelemetry=t.cancelAtStepTelemetry=t.addEntrypointTelemetry=void 0,t.addEntrypointTelemetry=function(e,t){e.addOrUpdateProperties({entrypoint:t})},t.cancelAtStepTelemetry=function(e,t){e.addOrUpdateProperties({wasCompleted:String(!1),canceledAtStep:t})},t.addCompletedTelemetry=function(e){e.addOrUpdateProperties({wasCompleted:String(!0)})},t.addIncludePrereleaseTelemetry=function(e,t){e.addOrUpdateProperties({includePrerelease:String(t)})},t.addDotnetSdkTelemetry=function(e,t,r){e.addOrUpdateProperties({dotnetSdkVersion:t,minDotnetSdkPromptSelected:r})},t.addResultsCountTelemetry=function(e,t,r){e.addOrUpdateMeasurements({[r+"ResultsCount"]:t})},t.runWithDurationTelemetry=async function(e,t,n){if(!t)return e();const{result:i,durationMilliseconds:o}=await r(e);return t.addOrUpdateMeasurements({[n+"Duration"]:o}),i},t.measureExecutionTime=r},30114:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r={};process.env.VSSERVER_DOTNET_EventPipeOutputPath&&(r={DOTNET_EnableEventPipe:1,DOTNET_EventPipeConfig:"Microsoft-Windows-DotNETRuntime:0x1F000080018:5",DOTNET_EventPipeOutputPath:process.env.VSSERVER_DOTNET_EventPipeOutputPath,DOTNET_ReadyToRun:0,DOTNET_TieredCompilation:1,DOTNET_TC_CallCounting:0,DOTNET_TC_QuickJitForLoops:1,DOTNET_JitCollect64BitCounts:1}),t.default=r},88764:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showQuickPickWithActiveItem=void 0;const n=r(89496);t.showQuickPickWithActiveItem=async function(e,t,r){const i=n.window.createQuickPick();return i.title=e,i.items=t,r&&(i.activeItems=[r]),i.show(),new Promise((e=>{i.onDidAccept((()=>{const r=i.selectedItems[0];t.dispose(),i.dispose(),e(r)}));const t=i.onDidHide((()=>{i.dispose(),e(void 0)}))}))}},94594:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReliabilityMonitorPath=t.scheduleLaunchReliabilityMonitor=void 0;const n=r(71017),i=r(30114),o=r(89496),s=r(7195),a=r(36661),c=r(6460),u=r(89781);function l(e){return n.join(e["@microsoft/visualstudio-reliability-monitor"],"Microsoft.VisualStudio.Reliability.Monitor")}t.scheduleLaunchReliabilityMonitor=function(e,t,r){!async function(e,t,r){await Promise.resolve();try{const n=l(t),d=a.TelemetryService.getSessionId(o.env.sessionId),p=s.telemetryService?.getTelemetryLevel()??"off",f={...process.env,...i.default};f.DOTNET_MULTILEVEL_LOOKUP="0",f.DOTNET_ROOT=r,(0,c.addDotNetDumpCreationEnvironmentValues)(f),(0,c.setComponentPathsInEnvironment)(f,t,c.VSSERVER_SHARED_COMPONENT_NAME);const h=[];h.push("--vscodeSessionId",d),h.push("--vscodeTelemetryLevel",p),(0,c.launchChildProcess)(t,n,h,e.extensionPath,f),s.logger.log("Reliability monitor launched.",u.LogImportance.low)}catch(e){s.logger.reportExceptionTelemetryAndLog("launchReliabilityMonitor",null,"CsDevKit.Reliability.Monitor.Launch.Error",e,s.telemetryService)}}(e,t,r)},t.getReliabilityMonitorPath=l},61925:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getServerPath=t.getServiceHubHostEntrypointName=t.launchDotNetServer=t.SERVICEHUB_HOST_COMPONENT_NAME=t.SERVICEHUB_CONTROLLER_COMPONENT_NAME=void 0;const n=r(19679),i=r(33543),o=r(41808),s=r(42600),a=r(89496),c=r(7631),u=r(7195),l=r(77867),d=r(30114),p=r(94594),f=r(6460),h=r(75010),g=r(36661),m=r(71017),v=r(35369),y=r(73228),_=r(69279),S=r(84832),w=r(81249),b=r(54249),E=r(70336),P=r(35092),T="serviceBroker";function C(){return m.join("win32"===process.platform?"\\\\.\\pipe":"/tmp",(0,s.v4)())}function I(){return"Microsoft.VisualStudio.Code.ServiceHost"+("win32"===process.platform?".exe":"")}function O(e){return m.join(e["@microsoft/visualstudio-server"],"Microsoft.VisualStudio.Code.Server")}t.SERVICEHUB_CONTROLLER_COMPONENT_NAME="@microsoft/visualstudio-controller",t.SERVICEHUB_HOST_COMPONENT_NAME="@microsoft/visualstudio-code-servicehost",t.launchDotNetServer=async function(e,r,s){let x=null;const N=new h.TelemetryActivity("launch-server",u.telemetryService);async function k(e,t){x=e;try{const e=performance.now(),r=await t(),n=performance.now();return x+=" (succeeded)",{result:r,duration:n-e}}catch(e){throw x+=" (failed)",e}}const R="CsDevKit/Server/Start",A=C(),D=O(r),j=I(),M=a.workspace?.getConfiguration("dotnet")?.get("useLegacyDotnetResolution")||!(0,b.apiIsAvailable)(E.FIND_PATH_API);let L,F;u.telemetryService?.sendTelemetryEvent("CsDevKit/Server/DotnetResolution",{legacy:M.toString()}),M?u.logger.log("Using legacy dotnet resolution."):u.logger.log('Using dotnet resolution provided by ".NET Install Tool".');try{await k("setExecuteBit",(()=>(0,f.setExecuteBit)(r)));const t=await k("acquireRuntime",(()=>(0,l.acquireRuntime)(M,e)));L=t.result,F=m.dirname(L.path),N.addOrUpdateMeasurements({acquireDotNetProcessDependencies:t.duration})}catch(e){throw u.telemetryService?.sendTelemetryErrorEvent(R,{fault:x??"(missing)"}),e}try{const p={...process.env,...d.default};a.workspace.workspaceFolders||(p.EmptyCodeWorkspace="1"),p.DOTNET_MULTILEVEL_LOOKUP="0",p.DOTNET_ROOT=F,p.DOTNET_PROJECTSYSTEM_HOST_EXECCOMMAND="",p.PRJHOST_DOTNET_ROOT=F,p.PRJHOST_ROLL_FORWARD_TO_PRERELEASE="0",p.PRJHOST_ROLL_FORWARD="Major",p.PRJ_BUILD_DOTNET_HOST=L.globalPath??"",p.DOTNET_ROOT_USER=process.env.DOTNET_ROOT??"EMPTY";let h=!1,I=!1;const O=w.parse(`${_.NET_RUNTIME_VERSION}.${_.NET_RUNTIME_VERSION_PATCH}`);let x=O;if(L.globalPath){if((0,u.setDotNetSdkPath)(L.globalPath),M){if(L.dotnetInfo){const e=L.dotnetInfo.runtimeVersions["Microsoft.NETCore.App"];let t=L.globalRuntimeMismatchingReason===S.CompatibleDotnetSearchFailedReason.mismatchedHigherVersionRuntimeFound,r=!1,n=!1;for(const i of e){const e=i.version;if(e.major>O.major?t=!0:e.compare(O)>=0&&(e.prerelease?.length>0&&(n=!0),r=!0),t&&r&&n)break}if((t||n)&&(h=!r,!h))if(a.workspace.workspaceFolders&&a.workspace.workspaceFolders.length>0)for(let e=0;e<a.workspace.workspaceFolders.length;e++){const t=await(u.dotnetVersionManager?.getDotnetVersion(a.workspace.workspaceFolders[e].uri.fsPath,u.logger));if(t){if(t.major>O.major){h=!0,x=t;break}n&&t.major===O.major&&t.prerelease?.length>0&&(x=x>t?x:t,I=!0)}}else t?h=!0:I=!0}h||I||L.globalRuntimeMismatchingReason!==S.CompatibleDotnetSearchFailedReason.mismatchedArchitectureFound||u.telemetryService?.sendTelemetryEvent("CsDevKit/Server/mismatchingArchitectureSDK")}else if(a.workspace.workspaceFolders&&a.workspace.workspaceFolders.length>0){const e=w.parse(_.NET_SDK_SUPPORTED_PREVIEW_RUNTIME_MIN_VERSION);for(let t=0;t<a.workspace.workspaceFolders.length;t++){const r=await(u.dotnetVersionManager?.getDotnetVersion(a.workspace.workspaceFolders[t].uri.fsPath,u.logger));if(u.logger.log(`Workspace folder: ${a.workspace.workspaceFolders[t].uri.fsPath}, requires SDK version: ${r?.toString()??"unknown"}`),r){if(r.major>O.major){h=!0,x=r;break}r.major===O.major&&r.prerelease?.length>0&&r.compare(e)>=0&&(I=!0,x=x>r?x:r)}}}else h=!0;(h||I)&&(p.PRJHOST_DOTNET_ROOT=m.dirname(L.globalPath),p.DEV_KIT_ON_SDK_RUNTIME="1",p.PRJHOST_ROLL_FORWARD_TO_PRERELEASE="1",u.telemetryService?.sendTelemetryEvent("CsDevKit/Server/UseSDKRuntime"),u.logger.log("Project system hosting process will use runtime installed in SDK."),u.logger.log(`Project Host Dotnet Root: ${p.PRJHOST_DOTNET_ROOT}`),u.logger.log(`Project system required runtime version: ${x.toString()}`),h&&(p.PRJHOST_ROLL_FORWARD="LatestMajor"))}p.CSDEVKIT_LOG_DIRECTORY=e.logUri.fsPath,await k("addDotNetDumpCreationEnvironmentValues",(()=>(0,f.addDotNetDumpCreationEnvironmentValues)(p))),(0,f.setComponentPathsInEnvironment)(p,r,t.SERVICEHUB_CONTROLLER_COMPONENT_NAME,t.SERVICEHUB_HOST_COMPONENT_NAME,f.VSSERVER_SHARED_COMPONENT_NAME),p.SERVICEHUB_HOST_ENTRYPOINT=j,h&&"darwin"===process.platform&&L.globalPath&&a.workspace.getConfiguration("dotnet").get("workingWithTestSignedSdk")?(p.DOTNET_PROJECTSYSTEM_HOST_ENTRYPOINT=L.globalPath,p.DOTNET_PROJECTSYSTEM_HOST_EXECCOMMAND="exec",p.DOTNET_PROJECTSYSTEM_HOST_INPUT=m.join(r[t.SERVICEHUB_HOST_COMPONENT_NAME],"Microsoft.VisualStudio.Code.ServiceHost.dll")):(p.DOTNET_PROJECTSYSTEM_HOST_ENTRYPOINT=m.join(r[t.SERVICEHUB_HOST_COMPONENT_NAME],j),p.DOTNET_PROJECTSYSTEM_HOST_INPUT="");const U=(0,b.apiIsAvailable)(E.OPTION_TO_CHECK_AND_ACQUIRE_ASPNETCORE);if(h||I){const e=await k("findAspnetcoreRuntimePath",(async()=>(0,l.findAspNetRuntime)(p.PRJHOST_DOTNET_ROOT,x,u.logger)));e.result?(u.logger.log(`Asp.Net runtime found for PS dotnet host ${p.PRJHOST_DOTNET_ROOT}, using Asp.Net runtimeconfig for project system host.`),p.DOTNET_PROJECTSYSTEM_HOST_RUNTIMECONFIGFILE=m.join(r[t.SERVICEHUB_HOST_COMPONENT_NAME],"Microsoft.VisualStudio.Code.ServiceHost.MultipleHeap.runtimeconfig.json")):(u.logger.log(`Asp.Net runtime not found for PS dotnet host ${p.PRJHOST_DOTNET_ROOT}, using default runtimeconfig for project system host.`),p.DOTNET_PROJECTSYSTEM_HOST_RUNTIMECONFIGFILE=m.join(r[t.SERVICEHUB_HOST_COMPONENT_NAME],"Microsoft.VisualStudio.Code.ServiceHost.runtimeconfig.json")),u.telemetryService?.sendTelemetryEvent("CsDevKit/Server/SDKAspNetRuntimeAvailability",{found:(!!e.result).toString(),prereleaseRuntime:I.toString(),requestedRuntimeVersion:x.toString()})}else U?(u.logger.log("Asp.Net runtime found, using Asp.Net runtimeconfig for project system host."),p.DOTNET_PROJECTSYSTEM_HOST_RUNTIMECONFIGFILE=m.join(r[t.SERVICEHUB_HOST_COMPONENT_NAME],"Microsoft.VisualStudio.Code.ServiceHost.MultipleHeap.runtimeconfig.json")):(u.logger.log("Asp.Net runtime not found, using default runtimeconfig for project system host."),p.DOTNET_PROJECTSYSTEM_HOST_RUNTIMECONFIGFILE=m.join(r[t.SERVICEHUB_HOST_COMPONENT_NAME],"Microsoft.VisualStudio.Code.ServiceHost.runtimeconfig.json"));u.telemetryService?.sendTelemetryEvent("CsDevKit/Server/ProjectSystemHostRuntimeConfig",{runtimeConfig:m.basename(p.DOTNET_PROJECTSYSTEM_HOST_RUNTIMECONFIGFILE)}),p.DOTNET_ASPIRESERVER_HOST_ENTRYPOINT=U?L.path:L.globalPath??L.path,p.DOTNET_ASPIRESERVER_HOST_RUNTIMECONFIGFILE=m.join(r[t.SERVICEHUB_HOST_COMPONENT_NAME],"Microsoft.VisualStudio.Code.ServiceHost.AspNet.runtimeconfig.json"),p.DOTNET_ASPIRESERVER_HOST_INPUT=m.join(r[t.SERVICEHUB_HOST_COMPONENT_NAME],"Microsoft.VisualStudio.Code.ServiceHost.dll"),p.ASPIRE_HOST_DOTNET_ROOT=U?p.DOTNET_ROOT:p.PRJHOST_DOTNET_ROOT,p.ASPIRE_HOST_ROLL_FORWARD_TO_PRERELEASE=U?"0":p.PRJHOST_ROLL_FORWARD_TO_PRERELEASE,p.ASPIRE_HOST_ROLL_FORWARD=U?"Major":p.PRJHOST_ROLL_FORWARD,a.workspace.getConfiguration("dotnet").get("preferVisualStudioCodeFileSystemWatcher",void 0)&&(p.ENABLE_VSCODE_FILEWATCHER="true");let B=m.join(e.extensionPath,"components/servicehub");const V=await k("createSocket",(()=>function(e){const t=C(),r=new Promise((async(e,r)=>{try{const n=(0,o.createServer)((t=>{try{n.close(),e(t)}catch(e){r(e)}}));n.listen(t)}catch(e){r(e)}}));return{pipeName:t,socket:r}}()));N.addOrUpdateMeasurements({createSocket:V.duration});const $=g.TelemetryService.getSessionId(a.env.sessionId),q=u.telemetryService?.getTelemetryLevel()??"off",H=process.env.CSDEVKIT_CODE_COVERAGE_OUTPUT,W=!!H,z=[],G=W?u.dotnetSdkPath??"dotnet":D;W&&(await u.logger.watch("Installing dotnet-coverage tool...",(async()=>{const t=(0,f.launchChildProcess)(r,u.dotnetSdkPath??"dotnet",["tool","install","dotnet-coverage"],e.extensionPath,p);await(0,y.waitForProcess)(t)})),u.logger.log(`Launching .NET server with code coverage to ${H}`),z.push("tool","run","dotnet-coverage"),z.push("collect",D),z.push("--output",H)),z.push("--serviceHubConfigPath",m.join(B,"servicehub.config.json")),z.push("--pipe",V.result.pipeName),z.push("--pipe-server",A),z.push("--log-directory",e.logUri.fsPath),z.push("--log-verbosity",process.env.CSDEVKIT_VERBOSITY??"Information"),z.push("--vscodeSessionId",$),z.push("--vscodeTelemetryLevel",q),(0,c.isCacheEnabled)(e)&&z.push("--cache-directory",(0,c.getCacheDirectory)(e)),z.push("--component",...Object.values(r));const K=performance.now(),X=await k("launchChildProcess",(()=>(0,f.launchChildProcess)(r,G,z,e.extensionPath,p)));N.addOrUpdateMeasurements({launchChildProcess:X.duration}),X.result.stdout.on("data",(e=>{u.logger.log(`.NET server STDOUT: ${e}`)})),X.result.stderr.on("data",(e=>{u.logger.log(`.NET server STDERR: ${e}`)})),X.result.on("exit",(e=>{18===e&&(0,P.showLicenseViolationToastAndThrow)(),u.logger.log(`.NET server exited with ${e}`),u.telemetryService?.sendTelemetryEvent("CsDevKit/Server/Exit",{shutdownReason:"Abnormal"},{exitCode:e??1})}));const J=await V.result.socket,Q=await k("mxstream.create",(()=>i.MultiplexingStream.CreateAsync(J)));N.addOrUpdateMeasurements({mxstreamcreate:Q.duration});const Y=s.getLimitedAccessServiceBroker(n.ServiceAudience.local,v.Map(),n.ClientCredentialsPolicy.requestOverridesDefault);(async function(e,t){const r=await e.offerChannelAsync(T);try{const i=new n.MultiplexingRelayServiceBroker(t,e,!1);n.FrameworkServices.remoteServiceBroker.constructRpc(i,r),await i.completion}finally{r.stream.end()}})(Q.result,Y).catch((e=>console.log(`Proffer of a service broker failed: ${e}`)));const Z=await async function(e){const t=await e.acceptChannelAsync(T);return n.FrameworkServices.remoteServiceBroker.constructRpc(t)}(Q.result);s.profferRemoteServiceBroker(Z,Q.result,n.ServiceSource.otherProcessOnSameMachine,null);const ee=performance.now();u.logger.log(`.NET server started and IPC established in ${(ee-K).toFixed()}ms`),u.telemetryService?.sendTelemetryEvent(R),N.sendTelemetry(),L.globalPath&&await(u.dotnetVersionManager?.checkOutOfSupportedSdkInstallationAndShowWarningMessage(u.logger))}catch(e){throw u.logger.reportExceptionTelemetryAndLog("launchDotNetServer",x,"",e,u.telemetryService),e}finally{u.telemetryService?.sendTelemetryEvent("CsDevKit/Reliability/Monitor/Launch"),(0,p.scheduleLaunchReliabilityMonitor)(e,r,F)}return{brokeredServiceServerPipeName:A}},t.getServiceHubHostEntrypointName=I,t.getServerPath=O},6460:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.launchChildProcess=t.addDotNetDumpCreationEnvironmentValues=t.setComponentPathsInEnvironment=t.setExecuteBit=t.VSSERVER_SHARED_COMPONENT_NAME=void 0;const n=r(32081),i=r(71017),o=r(73292),s=r(7195),a=r(61925),c=r(94594);t.VSSERVER_SHARED_COMPONENT_NAME="@microsoft/visualstudio-server-shared";t.setExecuteBit=async function(e){if("win32"!==process.platform){const t=i.join(e[a.SERVICEHUB_CONTROLLER_COMPONENT_NAME],"Microsoft.VisualStudio.Code.ServiceController"),r=i.join(e[a.SERVICEHUB_HOST_COMPONENT_NAME],(0,a.getServiceHubHostEntrypointName)()),n=[(0,a.getServerPath)(e),t,r,(0,c.getReliabilityMonitorPath)(e)];await Promise.all(n.map((e=>(0,o.chmod)(e,"0755"))))}};const u=/[\-/]/g;t.setComponentPathsInEnvironment=function(e,t,...r){for(const n of r)e["COMPONENT_"+n.replace("@","").replace(u,"_").toUpperCase()]=t[n]},t.addDotNetDumpCreationEnvironmentValues=function(e){"win32"!==process.platform&&(e.DOTNET_DbgEnableMiniDump="1",e.DOTNET_DbgMiniDumpType="2",e.DOTNET_DbgMiniDumpName=i.join(function(){const e=r(22037),t=r(57147);let n="";n="linux"===process.platform?i.join(e.homedir(),".cache","Microsoft","csdevkit","dumps"):i.join(e.tmpdir(),"csdevkit","dumps");try{t.existsSync(n)||t.mkdirSync(n,{recursive:!0})}catch(t){s.logger.log(`Failed to create crash dump path ${n} due to ${t}`),n=e.tmpdir()}return n}(),"%e.%d.dmp"),e.DOTNET_EnableCrashReport="1")},t.launchChildProcess=function(e,t,r,o,s){if("win32"===process.platform){const a=function(e){return i.join(e["@microsoft/visualstudio-code-launcher"],"escape-node-job")}(e),c=[];return c.push(t),c.push(...r),n.spawn(a,c,{windowsHide:!0,cwd:o,env:s})}return n.spawn(t,r,{windowsHide:!0,cwd:o,env:s})}},75056:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActiveDocumentsInformationService=t.ActiveDocumentsChangesEventArgs=void 0;const n=r(82361),i=r(89496);class o{newActiveDocument;newDocuments;closedDocuments;constructor(e,t,r){e&&(this.newActiveDocument=e),t&&(this.newDocuments=t),r&&(this.closedDocuments=r)}}t.ActiveDocumentsChangesEventArgs=o;class s extends n.EventEmitter{isInitialized;constructor(){super()}rpcEventNames=["activeDocumentsChanged"];getActiveDocuments(){this.isInitialized||(i.window.onDidChangeActiveTextEditor((e=>{if(e){const t=e.document.fileName;this.emit("activeDocumentsChanged",new o(t))}})),i.workspace.onDidOpenTextDocument((e=>{const t=e.fileName;this.shouldIgnoreDocument(t)||this.emit("activeDocumentsChanged",new o(void 0,[t]))})),i.workspace.onDidCloseTextDocument((e=>{const t=e.fileName;this.shouldIgnoreDocument(t)||this.emit("activeDocumentsChanged",new o(void 0,[],[t]))})));const e=[],t=i.window.activeTextEditor?.document?.fileName;t&&e.push(t);const r=i.workspace.textDocuments;for(var n=0;n<r.length;n++){const i=r[n].fileName;this.shouldIgnoreDocument(i)||i===t||e.push(i)}return e}shouldIgnoreDocument(e){return e.endsWith(".git")}getDirtyDocuments(){return i.workspace.textDocuments.filter((e=>e.isDirty)).map((e=>e.fileName))}async saveDocument(e){try{const t=i.workspace.textDocuments.find((t=>t.fileName===e&&t.isDirty));return!t||await t.save()}catch(e){return!1}}}t.ActiveDocumentsInformationService=s},98387:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenAIChatCompletionEventArgs=t.AspireCopilotService=void 0;const n=r(89496),i=r(82361),o=r(81297),s=r(89781);class a extends i.EventEmitter{rpcEventNames=["responseGenerated"];outputChannel;logger;constructor(e){super(),e.activationArguments?.needEvents&&this.on("responseGenerated",(e=>this.emit("responseGenerated",e))),this.outputChannel=(0,o.lazyLoad)((()=>n.window.createOutputChannel("Aspire",{log:!0}))),this.logger=(0,o.lazyLoad)((()=>new s.Logger(this.outputChannel())))}async getGhcpInfo(e){var t=await n.lm.selectChatModels({vendor:"copilot"});return 0===t.length?{state:"Disabled",models:[],launcher:"vscode"}:(this.logger().log(`Models: ${JSON.stringify(t)}`),{state:"Enabled",launcher:"vscode",models:t.filter((e=>{if(e.family.startsWith("claude-3.7"))return!1;const t=e.capabilities;return void 0===t||void 0===t.supportsToolCalling||!0===t.supportsToolCalling})).map((e=>({name:e.id,display_name:e.name,family:e.family,input_tokens:e.maxInputTokens})))})}dispose(){this.logger().log("Disposing AspireCopilotService",s.LogImportance.low),this.off("responseGenerated",(e=>this.emit("responseGenerated",e)))}async log(e,t){!0!==t?.isCancellationRequested&&this.logger().log(e)}async generateResponse(e,t){const r=JSON.stringify(e,null,2);await this.logTrace(`Generating response with message: ${r}`,t);var i=await n.lm.selectChatModels({vendor:"copilot",family:e.model??"gpt-4o"});if(0===i.length)throw new Error("403 - No model available, have you logged into your github account?");i.length>1&&this.logTrace(`Multiple models selected: ${JSON.stringify(i)}`);const o=i[0],s=e.messages??[];let a=[];for(let e of s)if("assistant"===e.role){let t=e;void 0!==t.tool_calls&&t.tool_calls.length>0&&(a=a.concat(t.tool_calls))}const u=s.map((e=>{if("user"===e.role){let t=e;return n.LanguageModelChatMessage.User(t.content,t.name)}if("system"===e.role){let t=e;return n.LanguageModelChatMessage.Assistant(t.content)}if("tool"===e.role){let t=e,r=a.find((e=>e.id===t.tool_call_id));if(void 0===r)throw new Error("Tool call object not found");let i=`\n${r.function.name}\n- tool call id: ${t.tool_call_id}\n- tool call arguments: ${r.function.arguments}\n- tool call result: ${t.content}\n`;return n.LanguageModelChatMessage.User(i)}if("assistant"===e.role){let t=e;if(void 0!==t.tool_calls&&t.tool_calls.length>0)return null;if(void 0!==t.content)return n.LanguageModelChatMessage.Assistant(t.content,t.name);throw new Error("Unrecognized assistant message")}throw new Error("Unrecognized message role")})),l=(e.tools??[]).map((e=>({name:e.function.name,description:e.function.description,inputSchema:e.function.parameters})));await this.logTrace(`Using tools: ${JSON.stringify(l)}`),await this.logTrace(`Using messages: ${JSON.stringify(u)}`);const d=[];try{const e=await o.sendRequest(u.filter((e=>null!==e)),{tools:l});for await(const t of e.stream)if(t instanceof n.LanguageModelTextPart){await this.logTrace(t.value);const e=new c({created:Date.now()/1e3,choices:[{index:0,message:{role:"assistant",content:t.value},delta:{role:"assistant",content:t.value}}],object:"chat.completion",model:o.family});d.push(t),this.emit("responseGenerated",e)}else{if(!(t instanceof n.LanguageModelToolCallPart))throw new Error("Unrecognized chunk type");await this.logTrace(`Tool call: ${t.name}`),await this.logTrace(`Arguments: ${JSON.stringify(t.input)}`),d.push(t)}if(await this.logTrace("Response generated"),await this.logTrace("Response chunks: "+d.length),d.length>0){const e=d.filter((e=>e instanceof n.LanguageModelToolCallPart)).map(((e,t)=>{if(e instanceof n.LanguageModelToolCallPart)return{id:e.callId,type:"function",function:{name:e.name,arguments:JSON.stringify(e.input)},index:t}})),t=e.length>0?"tool_calls":"stop",r={created:Date.now()/1e3,choices:[{index:0,delta:{role:"assistant",content:"",tool_calls:e},message:{role:"assistant",content:"",tool_calls:e},finish_reason:t}],object:"chat.completion",model:o.family};this.logTrace(`Final response: ${JSON.stringify(r)}`);const i=new c(r);return this.emit("responseGenerated",i),r}throw new Error("No response generated")}catch(t){if(await this.log(`Error: ${t}`),t instanceof Error){if(t.message.includes("model_not_supported")){await this.log("Not authorized to use this model");const t=`\n## Enable the model in GitHub Copilot settings\n\nEnable access to \`${e.model}\` in GitHub Copilot settings. After enabling, please restart the vscode and try again.\n\n[Copilot setting page](https://github.com/settings/copilot)`;await this.logTrace(t);const r={created:Date.now()/1e3,choices:[{index:0,delta:{role:"assistant",content:t},message:{role:"assistant",content:t},finish_reason:"stop"}],object:"chat.completion",model:e.model},n=new c(r);return this.emit("responseGenerated",n),r}}else if(t instanceof n.LanguageModelError){if(await this.log(`Error message: ${t.message}`),await this.log(`Error code: ${t.code}`),t.code===n.LanguageModelError.NoPermissions.name)throw await this.log("user consent not given"),new Error("403 - Not authorized to use this model");if(t.code===n.LanguageModelError.Blocked.name)throw await this.log("quota limits exceeded"),new Error("429 - Quota limits exceeded");if(t.code===n.LanguageModelError.NotFound.name)throw await this.log("model does not exist anymore"),new Error("500 - model does not exist anymore")}throw t}}async logTrace(e,t){!0!==t?.isCancellationRequested&&await this.logger().log(e,s.LogImportance.low)}}t.AspireCopilotService=a;class c{chunk;constructor(e){this.chunk=e}}t.OpenAIChatCompletionEventArgs=c},41062:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rejoinAspireSessionsAsync=t.rejoinAspireSessionAsync=t.stopAspireSessionAsync=t.stopAspireSessionsAsync=t.queryActiveAspireSessionsAsync=t.getAspireService=void 0;const n=r(89496),i=r(65979),o=r(69279),s=r(7195),a=r(89781);async function c(e,r,n){const i=await(0,t.getAspireService)();return await i.StartProjectAsync(r,{...n,sessionId:e})}t.getAspireService=async()=>{const e=n.extensions.getExtension(o.EXTENSION_ID);if(!e)throw new Error("Unable to find the extension: "+o.EXTENSION_ID);const t=e.exports.serviceBroker,r=await t.getProxy(i.default.aspireService);if(!r)throw new Error("Aspire service not available.");return r},t.queryActiveAspireSessionsAsync=async function(){const e=await(0,t.getAspireService)(),r=await e.QuerySessionsAsync(null);if(!r)throw new Error("No Aspire session found");return r},t.stopAspireSessionsAsync=async function(e){const r=await(0,t.getAspireService)();for(const t of e)s.logger.log(`Stopping session ${t.sessionId} Process ID: ${t.processId} for project ${t.projectInfo?.projectPath}...`,a.LogImportance.low),await r.StopSessionAsync(t.dcpId,t.sessionId,!1)},t.stopAspireSessionAsync=async function(e,r){const n=await(0,t.getAspireService)();return await n.StopSessionAsync(r,e,!1)},t.rejoinAspireSessionAsync=c,t.rejoinAspireSessionsAsync=async function(e){for(const t of e)s.logger.log(`Rejoining session ${t.sessionId} for project ${t.projectInfo?.projectPath}...`,a.LogImportance.low),await c(t.sessionId,t.dcpId,{disableLaunchProfile:!1,...t.projectInfo,sessionId:t.sessionId})}},31467:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrokeredServiceExportsRegistrar=t.BrokeredServiceExportsRegistrarState=void 0,t.BrokeredServiceExportsRegistrarState=class{registeredServices={}},t.BrokeredServiceExportsRegistrar=class{state;constructor(e){this.state=e}async registerExports(e,t){let r=this.state.registeredServices[e];void 0===r&&(r=[],this.state.registeredServices[e]=r),Array.isArray(t)?r.push(...t):r.push(t)}async getExports(e){const t=this.state.registeredServices[e];return t?[...t]:[]}}},84182:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBuildResult=void 0,t.parseBuildResult=function(e){let t,r=[];const n=/^(?:\s*\d+>)?(\S.*)\((\d+|\d+,\d+|\d+,\d+,\d+,\d+)\)\s*:\s+((?:fatal +)?error|warning|info)\s+(\w+\d+)\s*:\s*(.*)$/gm;do{t=n.exec(e),t&&r.push(t)}while(t);return r}},88242:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertBuildResultsToDiagnostics=t.reportBuildResultsToCSharpExtension=t.startBuildResultServiceAsync=t.isCSharpExtensionBuildResultServiceAvailable=void 0;const n=r(89496),i=r(65979),o=r(69279),s=r(39491),a=r(7195),c=r(84182);async function u(){const e=n.extensions.getExtension(o.EXTENSION_ID);if(!e)throw new Error("Unable to find the extension: "+o.EXTENSION_ID);const t=e.exports.serviceBroker;return await t.getProxy(i.default.csharpExtensionBuildResultService)}function l(e){const t={};return e.forEach((e=>{const[r,i]=function(e){const t=e[1],r=e[2],i=e[3],o=e[4],a=e[5],c=r.split(","),u=parseInt(c[0])-1,l=parseInt(c[1])-1,d=new n.Range(u,l,u,l);let p;switch(s(d,"Build diagnostic range could not be calculated. Attempted to parse value: "+r),i){case"error":default:p=n.DiagnosticSeverity.Error;break;case"warning":p=n.DiagnosticSeverity.Warning;break;case"info":p=n.DiagnosticSeverity.Information}const f=new n.Diagnostic(d,a,p);return f.code=o,[t,f]}(e),o=t[r];o?o.push(i):t[r]=[i]})),t}t.isCSharpExtensionBuildResultServiceAvailable=async function(){return null!==await u()},t.startBuildResultServiceAsync=async function(){const e=await u();try{s(e),e?.buildStarted()}finally{e?.dispose()}},t.reportBuildResultsToCSharpExtension=async function(e){a.logger.log("Reporting build results to C# extension.");const t=(0,c.parseBuildResult)(e);if(0===t.length)return void a.logger.log("No problems found in the build");const r=l(t),n=await u();try{s(n),n?.reportBuildResult(r)}finally{n?.dispose()}},t.convertBuildResultsToDiagnostics=l},81855:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BuildService=void 0;const n=r(20695);t.BuildService=class{context;constructor(e){this.context=e}build(e,t){var r=new n.BuildActionOptions(n.BUILD);return(0,n.setSolutionBuildAction)(r,e,this.context)}rebuild(e,t){var r=new n.BuildActionOptions(n.BUILD,!0);return(0,n.setSolutionBuildAction)(r,e,this.context)}}},11694:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentExportsState=t.ComponentExportsService=void 0;const n=r(7631),i=r(7195),o=r(89781),s=r(73228),a=r(71017),c=r(89496),u=r(90965);t.ComponentExportsService=class{state;constructor(e){this.state=e}getExports(e){return this.state.componentExports[e]??null}};class l{componentExports;constructor(e){this.componentExports=e}static async create(e,t){let r={};return r=await(0,n.loadOrCreateCachedValue)(e,"component-exports",(async()=>await l.gatherComponentExports(t,r))),await l.gatherExtensionExports(r),new l(r)}static async gatherComponentExports(e,t){for(const r in e){const n=e[r];await l.tryGetExportsJson(r,n,t)}return t}static async gatherExtensionExports(e){const t=u.idsOfExtensionsAllowedToExtendCsDevKit.map((e=>c.extensions.getExtension(e)));for(const r of t){if(!r)continue;const t=r.packageJSON;t.csdevkitExports&&(this.gatherExports(e,t.csdevkitExports,(e=>a.join(r.extensionPath,e))),i.logger.log(`Read exports from ${r.id} in ${a}.`,o.LogImportance.low))}}static async tryGetExportsJson(e,t,r){try{const n=a.join(t,"exports.json"),c=await(0,s.readJsonFile)(n);this.gatherExports(r,c,(e=>e.replace("$(ComponentPath)",t))),i.logger.log(`Read exports from ${e} in ${a}.`,o.LogImportance.low)}catch(t){i.logger.log(`No exports read from ${e}.`,o.LogImportance.low)}}static gatherExports(e,t,r){for(const n in t){let i=e[n];void 0===i&&(i=[],e[n]=i);let o=t[n];for(let e=0;e<o.length;e++)i.push(r(o[e]))}}}t.ComponentExportsState=l},65979:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(19679);class i{static helloWorld=Object.freeze({extensionHost:new n.ServiceJsonRpcDescriptor(n.ServiceMoniker.create("helloVSCodeExtensionHost","1.0"),n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders),serviceHub:new n.ServiceJsonRpcDescriptor(n.ServiceMoniker.create("helloServiceHubDotNetHost","0.1"),n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders),create:function(e){return new n.ServiceJsonRpcDescriptor(e,n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders)}});static environmentService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.NoDelay.EnvironmentService","0.1"));static solutionFileService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.SolutionFileService","0.1"));static buildService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.BuildService","0.1"));static telemetrySessionUpdateService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.Telemetry.TelemetrySessionUpdateService","0.1"));static diagnosticsService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.DiagnosticsService","0.1"));static outOfProcServiceRegistration=Object.freeze(new n.ServiceJsonRpcDescriptor(n.ServiceMoniker.create("Microsoft.VisualStudio.OutOfProcServiceRegistration","0.1"),n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders));static solutionExplorerService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.NoDelay.SolutionViewService","0.1"));static projectTreeProvider=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.ProjectSystem.ProjectTreeProvider","0.1"));static projectIconSourceService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.CpsProjectIconSourceService","0.1"));static componentExportsService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.ComponentExportsService","0.1"));static brokeredServiceExportsRegistrar=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.BrokeredServiceExportsRegistrar","0.1"));static errorReportingService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.ErrorReportingService","0.1"));static activeDocumentsInformationService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.ActiveDocumentsInformationService","0.1"));static logOutputChannelService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.LogOutputChannelService","0.1"));static outputChannelService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.OutputChannelService","0.1"));static tokenAcquisitionService=Object.freeze(new n.ServiceJsonRpcDescriptor(n.ServiceMoniker.create("Microsoft.VisualStudio.TokenAcquisitionService","0.1"),n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders));static projectQueryExecutionService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.ProjectSystem.Query.Remoting.QueryExecutionService","0.3"));static projectInitializationStatusService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.ProjectSystem.ProjectInitializationStatusService","0.1"));static nugetCommandsService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.NuGetCommandsService","0.1"));static nugetSolutionRestoreService=Object.freeze(new n.ServiceJsonRpcDescriptor(n.ServiceMoniker.create("Microsoft.VisualStudio.NuGetSolutionRestoreService","0.1"),n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders));static aspireService=Object.freeze(new n.ServiceJsonRpcDescriptor(n.ServiceMoniker.create("Microsoft.VisualStudio.AspireService","0.1"),n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders,{protocolMajorVersion:3}));static aspireCopilotService=Object.freeze(new n.ServiceJsonRpcDescriptor(n.ServiceMoniker.create("Microsoft.VisualStudio.Aspire.CobraService","0.1"),n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders,{protocolMajorVersion:3}));static hotReloadLogger=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.Debugger.HotReloadLogger","0.1"));static hotReloadClientListener=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.Debugger.HotReloadClientListener","0.1"));static hotReloadOptionService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.Debugger.HotReloadOptionService","0.1"));static hotReloadService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.Debugger.HotReloadClientService","0.1"));static launchConfigurationService=Object.freeze(new n.ServiceJsonRpcDescriptor(n.ServiceMoniker.create("Microsoft.VisualStudio.LaunchConfigurationService",void 0),n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders,{protocolMajorVersion:3}));static debugTargetFrameworkService=Object.freeze(new n.ServiceJsonRpcDescriptor(n.ServiceMoniker.create("Microsoft.VisualStudio.ProjectSystem.DebugTargetFrameworkService","0.1"),n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders,{protocolMajorVersion:3}));static dotnetDebugConfigurationService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.Debugger.DotnetDebugConfigurationService","0.1"));static vsCodeFileWatcherService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.VsCodeFileWatcherService","0.1"));static templateService=this.create(n.ServiceMoniker.create("Microsoft.TemplateEngine.VSCode.TemplateService","0.1"));static csharpExtensionBuildResultService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.CSharpExtension.BuildResultService","0.1"));static dotnetDebugLaunchService=Object.freeze(new n.ServiceJsonRpcDescriptor(n.ServiceMoniker.create("Microsoft.VisualStudio.DotnetDebugLaunchService","0.1"),n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders,{protocolMajorVersion:3}));static workspaceConfigurationOptionsService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.OptionService","0.1"));static startupProjectService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.StartupProjectService","0.1"));static vscodeAzureFunctionExtensionService=Object.freeze(new n.ServiceJsonRpcDescriptor(n.ServiceMoniker.create("Microsoft.VisualStudio.Debugger.VSCodeAzureFunctionExtensionService","0.1"),n.Formatters.Utf8,n.MessageDelimiters.HttpLikeHeaders,{protocolMajorVersion:3}));static aspireDebugSessionManagerService=this.create(n.ServiceMoniker.create("Microsoft.VisualStudio.Debugger.AspireDebugSessionManagerService","0.1"));static create(e){return Object.freeze(new n.ServiceJsonRpcDescriptor(e,n.Formatters.MessagePack,n.MessageDelimiters.BigEndianInt32LengthHeader,{protocolMajorVersion:3}))}}t.default=i},6315:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IDotnetDebugConfigurationServiceResultResolver=t.LaunchTargetToDebugConfigurationConverter=t.DotnetDebugConfigurationService=t.DEBUGGER_START_DEBUG_TELEMETRY_PROPERTY=t.DotnetDebugConfigurationServiceError=t.DebugTelemetryCode=t.DotnetDebugConfigurationServiceErrorKind=void 0;const n=r(89496),i=r(65979),o=r(98727),s=r(22677),a=r(75010),c=r(7195),u=r(69279),l=r(81249),d=r(49397),p=r(20695),f=r(49230),h=r(17407),g=r(66862),m=r(22037),v=r(51747),y=r(71017),_=r(28510),S=r(66463),w=r(73228),b=r(69279),E=r(40799),P="2.22.8";var T,C,I;!function(e){e.internalError="internalError",e.launchCancelled="launchCancelled",e.userError="userError"}(T||(t.DotnetDebugConfigurationServiceErrorKind=T={})),function(e){e[e.unknown=0]="unknown",e[e.launchCancelled=1]="launchCancelled",e[e.fileBasedApp=2]="fileBasedApp",e[e.invalidActivationId=32769]="invalidActivationId",e[e.noLaunchTargets=32770]="noLaunchTargets",e[e.invalidAzureFunctionExtension=32771]="invalidAzureFunctionExtension",e[e.invalidAzureFunctionExtensionVersion=32772]="invalidAzureFunctionExtensionVersion",e[e.invalidAzureFunctionExportAPI=32773]="invalidAzureFunctionExportAPI",e[e.azureFunctionStartFuncProcessFailed=32774]="azureFunctionStartFuncProcessFailed",e[e.projectInitializing=32775]="projectInitializing",e[e.noProjectsFound=32776]="noProjectsFound",e[e.noBrokeredService=36608]="noBrokeredService",e[e.missingExeBeforeBrowserTarget=36609]="missingExeBeforeBrowserTarget",e[e.failedToConvertLaunchTargetToConfig=36610]="failedToConvertLaunchTargetToConfig",e[e.noImplCustomLaunchTarget=36611]="noImplCustomLaunchTarget",e[e.noImplMultipleDebugEngines=36612]="noImplMultipleDebugEngines",e[e.noImplMultipleDebugLaunch=36613]="noImplMultipleDebugLaunch",e[e.noDebugConfig=36614]="noDebugConfig",e[e.failedToFindProjectForFile=36615]="failedToFindProjectForFile",e[e.noValidBrowser=36616]="noValidBrowser",e[e.missingCSharpExtensionExport=36617]="missingCSharpExtensionExport",e[e.unknownLaunchTarget=36618]="unknownLaunchTarget",e[e.csFileSDKNotSupported=36619]="csFileSDKNotSupported",e[e.noTaskProvider=36624]="noTaskProvider",e[e.missingExeBeforeBrowserInspectUriTarget=36625]="missingExeBeforeBrowserInspectUriTarget",e[e.invalidCSharpExtVersionAspire=36626]="invalidCSharpExtVersionAspire",e[e.invalidCSharpExtVersionAzFunc=36627]="invalidCSharpExtVersionAzFunc",e[e.noDebugEnginesProvided=36628]="noDebugEnginesProvided"}(C||(t.DebugTelemetryCode=C={})),function(e){e[e.dismissed=0]="dismissed",e[e.yes=1]="yes",e[e.no=2]="no",e[e.doNotShowAgain=3]="doNotShowAgain"}(I||(I={}));class O{kind;message;telemetryCode;constructor(e,t,r){this.kind=e,this.message=t,this.telemetryCode=r}}t.DotnetDebugConfigurationServiceError=O,t.DEBUGGER_START_DEBUG_TELEMETRY_PROPERTY="debuggerStartDebugTelemetry",t.DotnetDebugConfigurationService=class{serviceBroker;brokeredServiceHost;constructor(e,t){this.serviceBroker=e,this.brokeredServiceHost=t}async resolveDebugConfigurationWithLaunchConfigurationService(e,t,r){const o=await this.serviceBroker.getProxy(i.default.launchConfigurationService);if(o)try{e&&(e=y.normalize(e));let i=!1;if(e&&(0,w.endsWithInvariantIgnoreCase)(e,".cs")){const t=await(0,E.getProjectsFromFile)(e);if(t&&t.length>0){const r=await(0,E.selectProject)(t);if(void 0===r)return{configurations:[],error:new O(T.launchCancelled,s.debugProjectLaunchStrings.warnNoProjectSelected,C.launchCancelled)};e=y.normalize(r)}else i=!0}if(e&&i){const t=y.dirname(e);if(!await this.checkDotnetForDebugFileSupport(t))return{configurations:[],error:new O(T.userError,s.debugProjectLaunchStrings.errorDebugCSFileSupport,C.csFileSDKNotSupported)}}if(!i&&!await(0,S.waitForProjectsToLoad)(this.brokeredServiceHost))return{configurations:[],error:new O(T.userError,s.debugProjectLaunchStrings.projectInitializing,C.projectInitializing)};const a=n.workspace.getConfiguration("csharp.preview").get("improvedLaunchExperience",!0)&&!e;if(!i&&a){const r=(0,f.getLaunchableProjectInfoObserver)().getCurrentProjects();if(0===r.length)return{configurations:[],error:new O(T.userError,s.debugProjectLaunchStrings.errorNoLaunchableProjects,C.noProjectsFound)};const n=await h.startupProjectService.getOrPickCurrentStartupProject();if(!n)return{configurations:[],error:new O(T.launchCancelled,s.debugProjectLaunchStrings.errorNoStartupProjectSelected,C.launchCancelled)};const i=r.find((e=>e.fullPath===n.fullPath));if(!i)return{configurations:[],error:new O(T.internalError,s.debugProjectLaunchStrings.errorStartupProjectNotFound,C.failedToFindProjectForFile)};t.name=g.DotnetDynamicConfigurationProvider.createDebugConfigurationName(i.displayName),e=y.normalize(i.fullPath)}if(!e)return{configurations:[],error:new O(T.userError,s.debugProjectLaunchStrings.errorNoProjectFound,C.failedToFindProjectForFile)};let u={};const l=Date.now();if(i||!await this.isMAUIProject(e)){let r=await this.buildProject(e);const i=Date.now();if(u.buildCompletedTimestamp=`0x${i.toString(16)}`,u.totalBuildTime=i-l,t.preLaunchTask||t.preRestartTask||(r||n.window.showWarningMessage(s.dotnetDebugConfigurationServiceStrings.warningMissingBuildTask),t.preRestartTask=r),!n.workspace.getConfiguration("dotnet.debug").get("suppressInvalidDebugTypeWarning")){const[t,r]=await this.getDebugType(e);if(!t)return{configurations:[],error:new O(T.userError,s.dotnetDebugConfigurationServiceStrings.warningInvalidDebugTypeDetails(r),C.launchCancelled)}}}if(!a){const n=t.launchConfigurationId;if(n&&!await o.setActiveLaunchConfiguration(e,n,r))return{configurations:[],error:new O(T.userError,s.dotnetDebugConfigurationServiceStrings.invalidLaunchConfigurationId(n),C.invalidActivationId)}}const d=t.noDebug??!1,p="linux"!==m.platform().toLowerCase()&&!n.env.remoteName&&n.env.uiKind!==n.UIKind.Web,_=[];if(i){const t=n.extensions.getExtension(b.EXTENSION_ID);if(!t)throw new Error("Unable to find the extension: "+b.EXTENSION_ID);const r=await new Promise((async(r,n)=>{try{let i;const o=setTimeout((()=>{i?.kill(),n(new Error("Timeout while waiting for dotnet run-api response"))}),1e4),s=y.dirname(e);c.logger.log(`dotnet run-api - starting process in: ${s}`),i=await t.exports.launchChildProcessAsync("dotnet",["run-api"],s,process.env),i.on("error",n),i.on("exit",((e,t)=>{clearTimeout(o),n(new Error(`dotnet run-api exited with ${e??t}`))})),v.createInterface(i.stdout).on("line",(e=>{clearTimeout(o),c.logger.log(`dotnet run-api - received: ${e}`),r(e)}));const a=JSON.stringify({$type:"GetRunCommand",EntryPointFileFullPath:e});c.logger.log(`dotnet run-api - sending: ${a}`),i.stdin.write(a+m.EOL),i.stdin.end()}catch(e){n(e)}})),i=JSON.parse(r);if("Error"===i.$type)throw new Error(`dotnet run-api failed: ${i.Message}`);if("RunCommand"!==i.$type)throw new Error(`dotnet run-api failed: Unexpected response type '${i.$type}'`);const o={executable:i.ExecutablePath,directory:i.WorkingDirectory,commandLineArguments:i.CommandLineArguments,environmentVariables:i.EnvironmentVariables,isConsoleApp:!0,isUsingSSL:!1,launchOptions:{noDebug:d,preferSSL:p},debugEngines:["coreclr"]};_.push(o)}else if(_.push(...await o.queryLaunchTargets(e,{noDebug:d,preferSSL:p},r)),0===_.length)return{configurations:[],error:new O(T.userError,s.debugProjectLaunchStrings.errorNoLaunchTargets(e),C.noLaunchTargets)};t.brokeredServicePipeName=await this.brokeredServiceHost.getBrokeredServiceServerPipeName();const P=await x.convert(t,_,u);return 0!==P.length?{configurations:P}:{configurations:[],error:new O(T.internalError,"Unable to convert launch target to a vscode debug configuration.",C.failedToConvertLaunchTargetToConfig)}}catch(e){if(e instanceof O)return{configurations:[],error:e};{let t;return"string"==typeof e?t=e:e instanceof Error&&(t=e.message),{configurations:[],error:new O(T.internalError,t,C.unknown)}}}finally{o?.dispose()}return{configurations:[],error:new O(T.internalError,"Unable to obtain services to resolve dotnet debug configurations.",C.noBrokeredService)}}async buildProject(e){if(!c.dotnetTaskProvider)throw new O(T.internalError,void 0,C.noTaskProvider);const t=await(0,d.dotnetSolutionBuildActionUsingTask)(p.BUILD,e,void 0,void 0,!0);if(t.taskName&&!await t.success){const t={title:s.promptStrings.yes},r={title:s.promptStrings.no,isCloseAffordance:!0},i={modal:!0,detail:s.dotnetDebugConfigurationServiceStrings.errorBuildDetails(e)};if(await n.window.showErrorMessage(s.dotnetDebugConfigurationServiceStrings.errorBuildTitle,i,t,r)!==t)throw new O(T.launchCancelled,void 0,C.launchCancelled)}return t.taskName}async isMAUIProject(e){let t=!1;if(n.extensions.getExtension(u.MAUI_EXTENSION_ID)){const r={context:"Projects",query:{$properties:["Path","Capabilities"],$filter:{ProjectsByCapabilities:["Android | Apple | Maui | UseMaui | UseMauiCore"]}}},n=await c.projectQueryableSpace.executeQuery(r);if(n&&n.Items){let r=e.replace(/[\\/]+/g,"/");t=n.Items.some((e=>{if(e&&e.Path){let t=e.Path.replace(/[\\/]+/g,"/");return"win32"!==m.platform()&&"darwin"!==m.platform()||(t=t.toLowerCase(),r=r.toLowerCase()),t===r}return!1}))}}return t}async getDebugType(e){const t={context:"Projects",query:{$properties:["Id","Path","ActiveConfigurations"],ActiveConfigurations:{$properties:["Name","Properties"],Properties:{$properties:["Name","Value"],$filter:{PropertiesByName:[["DebugInfo"]]}}},$filter:{ProjectsByPath:[[e]]}}};try{const e=await c.projectQueryableSpace.executeQuery(t);if(e&&1===e.Items?.length){const t=e.Items[0];if(1===t.ActiveConfigurations?.length){const e=t.ActiveConfigurations[0];if(e.Properties?.length){const t=e.Properties.find((e=>"debuginfo"===e.Name?.toLowerCase())),r=t?.Value;if("full"===r?.toLocaleLowerCase()||"pdbonly"===r?.toLocaleLowerCase()){const e=new a.TelemetryActivity("DotnetDebugConfigurationService/getDebugType",c.telemetryService),t=await n.window.showWarningMessage(s.dotnetDebugConfigurationServiceStrings.warningInvalidDebugTypeTitle,{modal:!0,detail:s.dotnetDebugConfigurationServiceStrings.warningInvalidDebugTypeDetails(r)},{title:s.promptStrings.yes,isCloseAffordance:!0},{title:s.promptStrings.no,isCloseAffordance:!1},{title:s.promptStrings.doNotShowAgain,isCloseAffordance:!1});let i=I.dismissed;return t?.title===s.promptStrings.no?i=I.no:t?.title===s.promptStrings.doNotShowAgain?i=I.doNotShowAgain:t?.title===s.promptStrings.yes&&(i=I.yes),e.addOrUpdateMeasurements({dialogResponse:i}),e.sendTelemetry(),i===I.no?[!1,r]:(i===I.doNotShowAgain&&await n.workspace.getConfiguration("dotnet.debug").update("suppressInvalidDebugTypeWarning",!0),[!0,r])}}}}}catch(t){c.logger.log(`Error querying 'DebugType' for '${e}': ${t}`)}return[!0,""]}async checkDotnetForDebugFileSupport(e){const t=await(c.dotnetVersionManager?.getDotnetVersion(e,c.logger));return(t&&t.compareMain(u.NET_SDK_CSFILE_DEBUG_SUPPORT)>=0)??!1}};class x{static async convert(e,r,i){let a=[];for(let u of r){if(u.debugEngines.length>1)throw new O(T.internalError,s.dotnetDebugConfigurationServiceStrings.errorMultipleDebugEngines(u.debugEngines.join(",")),C.noImplMultipleDebugEngines);if(o.ExeLaunchTarget.is(u)){u.isConsoleApp&&(i.projectType="Console");const r=x.convertExeLaunchTarget(e,u);if(r.env&&r.env.DEBUG_SESSION_PORT&&r.env.DEBUG_SESSION_TOKEN&&(i.projectType="Aspire",r.isAspire=!0,!x.doesCSharpExtensionSupportAspire()))throw new O(T.userError,s.dotnetDebugConfigurationServiceStrings.errorAspireLaunchMinimumVersion(P),C.invalidCSharpExtVersionAspire);r[t.DEBUGGER_START_DEBUG_TELEMETRY_PROPERTY]=i,a.push(r)}else if(o.BrowserInspectUriTarget.is(u)){if(!(u.debugEngines&&u.debugEngines.length>0))throw new O(T.internalError,"Missing 'type' on WASMLaunchTarget.",C.failedToConvertLaunchTargetToConfig);{const r=u.debugEngines[0];if("blazorwasm"!==r)throw new O(T.internalError,`Unknown an WASMLaunchTarget type: ${r}.`,C.failedToConvertLaunchTargetToConfig);{const r=a.pop();if(!r)throw new O(T.internalError,"Expected an ExeLaunchTarget type before seeing a BrowserInspectUriTarget for resolving targets.",C.missingExeBeforeBrowserInspectUriTarget);{r[t.DEBUGGER_START_DEBUG_TELEMETRY_PROPERTY].projectType="Blazorwasm";const i=await x.getBrowserType();if(!i)throw new O(T.internalError,"A valid browser is not installed.",C.noValidBrowser);if(l.gte(n.version,"1.85.0")){const t=x.convertBrowserInspectUriLaunchTarget(e,i,u);a.push({...r,serverReadyAction:{action:"startDebugging",config:t,pattern:"\\bNow listening on:\\s+https?://\\S+",killOnServerStop:!0}})}else a.push(x.convertBrowserInspectUriLaunchTarget(e,i,u))}}}}else if(o.BrowserLaunchTarget.is(u)){const e=a.pop();if(!e)throw new O(T.internalError,"Expected an ExeLaunchTarget type before seeing a BrowserLaunchTarget for resolving targets.",C.missingExeBeforeBrowserTarget);{const r=x.convertNoDebugBrowserLaunchTarget(u);e[t.DEBUGGER_START_DEBUG_TELEMETRY_PROPERTY].projectType="Web",a.push({...e,...r})}}else{if(!o.AzureFunctionsLaunchTarget.is(u)){if(o.CustomLaunchTarget.is(u)){for(var c in e.type=u.debugEngines[0],u.launchOptions&&(e.noDebug=u.launchOptions.noDebug),u.options)e[c]=u.options[c];return[e]}throw o.ErrorLaunchTarget.is(u)?new O(T.userError,u.userMessage):new O(T.internalError,"Unknown Launch Target type",C.unknownLaunchTarget)}{i.projectType="AzureFunctions",(0,_.validateCSharpExtensionVersionForAzFunctions)();const r=(0,_.getAzureFunctionAPIExports)();if(await r.isFuncCoreToolsInstalled(s.vsCodeAzureFunctionExtensionServiceStrings.errorFuncCoreToolsMissing)){const r=x.convertAzureFunctionsLaunchTarget(e,u);r[t.DEBUGGER_START_DEBUG_TELEMETRY_PROPERTY]=i,a.push(r)}}}}return a}static convertAzureFunctionsLaunchTarget(e,t){if(t.debugEngines.length<1)throw new O(T.internalError,s.dotnetDebugConfigurationServiceStrings.errorNoDebugEngine,C.noDebugEnginesProvided);const r=y.dirname(t.functionsApp);let n=["--no-build"];t.isUsingSSL&&!n.includes("--useHttps")&&n.push("--useHttps"),t.commandLineArguments&&(n=n.concat(t.commandLineArguments.split(" ")));const o=x.convertEnvironmentVariablesToObj(t.environmentVariables);return{...e,type:t.debugEngines[0],program:t.functionsApp,cwd:t.directory,checkForDevCert:t.isUsingSSL,launchService:{name:i.default.vscodeAzureFunctionExtensionService.moniker.name,version:i.default.vscodeAzureFunctionExtensionService.moniker.version},launchServiceData:{[_.VSCodeAzureFunctionExtensionLaunchDataKeys.buildPath]:r,[_.VSCodeAzureFunctionExtensionLaunchDataKeys.args]:n,[_.VSCodeAzureFunctionExtensionLaunchDataKeys.env]:o}}}static convertExeLaunchTarget(e,t){if(t.debugEngines.length<1)throw new O(T.internalError,s.dotnetDebugConfigurationServiceStrings.errorNoDebugEngine,C.noDebugEnginesProvided);let r="internalConsole";return t.isConsoleApp&&(r=this.getDebugOption("console","internalConsole"),"internalConsole"===r&&e.noDebug&&(r="integratedTerminal")),{...e,type:t.debugEngines[0],program:t.executable,args:t.commandLineArguments,cwd:t.directory,env:x.convertEnvironmentVariablesToObj(t.environmentVariables),console:r,checkForDevCert:t.isUsingSSL,launchSettingsProfile:null,debugConsoleVerbosity:this.getDebugOption("debugConsoleVerbosity","minimal")}}static convertBrowserInspectUriLaunchTarget(e,t,r){let n={name:e.name+" Browser",type:t,request:"launch",timeout:3e4,webRoot:"${workspaceFolder}",url:r.url,inspectUri:r.inspectUri,noDebug:e.noDebug,cascadeTerminateToConfigurations:[e.name]};return r.userDataDir&&(n.userDataDir=r.userDataDir),n}static convertNoDebugBrowserLaunchTarget(e){return{serverReadyAction:{action:"openExternally",pattern:e.pattern??"\\bNow listening on:\\s+https?://\\S+",uriFormat:e.url}}}static getDebugOption(e,t){const r=n.workspace.getConfiguration("csharp.debug");if(r){const t=r.get(e);if(t)return t}return t}static async getBrowserType(){const e=await n.extensions.getExtension(u.CSHARP_EXTENSION_ID),t=e?.packageJSON.version;if(!e||!t)throw new O(T.internalError,"Could not obtain exports from C# Extension ",C.missingCSharpExtensionExport);if(l.lt(t,u.CSHARP_EXTENSION_BLAZORWASM_REQUIRED_VERSION))throw new O(T.internalError,`The C# extension is installed, but has version ${t} which is incompatible with blazorwasm Debug Launch. Please update your C# Extension.`,C.missingCSharpExtensionExport);return await e.exports.determineBrowserType()}static convertEnvironmentVariablesToObj(e){let t={};if(Array.isArray(e)){for(let r=0;r<e.length;r++){const n=e[r];t[n.Key]=n.Value}return t}if(e instanceof Map){for(const r in e){const n=e.get(r);t[r]=n??""}return t}return e}static doesCSharpExtensionSupportAspire(){const e=n.extensions.getExtension(u.CSHARP_EXTENSION_ID),t=e?.packageJSON.version;return!!t&&l.gte(t,P)}}t.LaunchTargetToDebugConfigurationConverter=x,t.IDotnetDebugConfigurationServiceResultResolver=class{static resolve(e){const t=new a.TelemetryActivity("DotnetDebugConfigurationService/resolve",c.telemetryService);try{if(e.error){t.addOrUpdateProperties({succeeded:String(!1)});const r=e.error;switch(r.kind){case T.launchCancelled:return void t.addOrUpdateMeasurements({telemetryCode:C.launchCancelled});case T.internalError:case T.userError:t.addOrUpdateMeasurements({telemetryCode:r.telemetryCode??C.unknown});const e=r.message??s.debugProjectLaunchStrings.errorGenericFailedToGetConfigurations;return n.window.showErrorMessage(e),null;default:throw new Error(`Unexpected error kind: '${r.kind}'`)}}const r=e.configurations;if(0===r.length)return t.addOrUpdateProperties({succeeded:String(!1)}),t.addOrUpdateMeasurements({telemetryCode:C.noDebugConfig}),n.window.showErrorMessage(s.debugProjectLaunchStrings.errorNoConfigurations),null;if(1===r.length)return t.addOrUpdateProperties({succeeded:String(!0)}),r[0];if(2===r.length){const e=n.debug.onDidStartDebugSession((t=>{t.name===r[0].name&&(e.dispose(),n.debug.startDebugging(t.workspaceFolder,r[1],t))}));return r[0]}if(r.length>2)return t.addOrUpdateProperties({succeeded:String(!1)}),t.addOrUpdateMeasurements({telemetryCode:C.noImplMultipleDebugLaunch}),n.window.showErrorMessage(s.debugProjectLaunchStrings.errorDebugMultipleConfigurations),null;throw new Error("Unexpected configuration array from IDotnetDebugConfigurationServiceResult.")}finally{t.sendTelemetry()}}}},27307:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DotnetDebugLaunchCallback=void 0;const n=r(89496),i=r(65979),o=r(7195),s=r(69279),a=r(81249);t.DotnetDebugLaunchCallback=class{brokeredServiceHost;launchTargetOptions;debugSession;constructor(e,t,r){this.brokeredServiceHost=e,this.launchTargetOptions=r,this.debugSession=t}async stopDebugging(){if(this.debugSession)try{let e=null;if(await async function(e){const t=n.extensions.getExtension(s.CSHARP_EXTENSION_ID),r=t?.packageJSON.version;return!!r&&(!!a.gte(r,s.CSHARP_EXTENSION_TERMINATE_ASPIRE_REQUIRED_VERSION)||(e&&o.logger.log(`Unable to terminate individual Aspire sessions. Please ensure you have a version C# extension greater than or equal to ${s.CSHARP_EXTENSION_TERMINATE_ASPIRE_REQUIRED_VERSION}.`),!1))}(!!this.launchTargetOptions?.aspireSession)&&(e=await this.brokeredServiceHost.serviceBroker.getProxy(i.default.aspireDebugSessionManagerService)),e&&this.launchTargetOptions?.aspireSession){const t=await e.terminateStandaloneSession(this.launchTargetOptions.aspireSession);return t&&(this.debugSession=void 0),t}return await n.debug.stopDebugging(this.debugSession),this.debugSession=void 0,!0}catch(e){o.logger.log(`DotnetDebugLaunchCallback.stopDebugging: ${e}`)}return!1}}},60700:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DotnetDebugLaunchService=void 0;const n=r(89496),i=r(6315),o=r(27307),s=r(66862),a=r(7195),c="DotnetDebugLaunchService_LaunchTargetId";t.DotnetDebugLaunchService=class{brokeredServiceHost;constructor(e){this.brokeredServiceHost=e}async launchTargets(e,t,r){return null!==await this.launchTargets2(e,t,r)}async launchTargets2(e,t,r){let u={name:e,type:"dotnet",request:"launch",brokeredServicePipeName:await this.brokeredServiceHost.getBrokeredServiceServerPipeName()};const l=await i.LaunchTargetToDebugConfigurationConverter.convert(u,t,{});if(l&&l.length>0){const u={configurations:l},d=i.IDotnetDebugConfigurationServiceResultResolver.resolve(u);if(d){const u=crypto.randomUUID();d[c]=u,r.aspireSession&&(d[i.DEBUGGER_START_DEBUG_TELEMETRY_PROPERTY].isAspireLaunch=!0,d.aspireSession=r.aspireSession);const l=new n.CancellationTokenSource,p=new Promise(((e,t)=>{let r,i;const o=()=>{clearTimeout(r),i?.dispose(),i=void 0};l.token.onCancellationRequested((()=>{o(),t(new n.CancellationError)})),r=setTimeout((()=>{o(),t(new Error("Timed out waiting for debug session to start."))}),6e4),i=n.debug.onDidStartDebugSession((t=>{"coreclr"!==t.type&&t.type!==s.DotnetDynamicConfigurationProvider.type||!(c in t.configuration)||t.configuration[c]!==u||(o(),e(t))}))})),f=await n.debug.startDebugging(void 0,d);try{if(f){const e=await p;return new o.DotnetDebugLaunchCallback(this.brokeredServiceHost,e,r)}l.cancel(),a.logger.log(`[ERROR] vscode.debug.startDebugging failed for:\n${JSON.stringify(d,null,2)}`)}catch(r){a.logger.log(`[ERROR] Failed to start debugging session "${e}" for targets:\n${JSON.stringify(t,null,2)}\nError: ${r}`)}finally{l.dispose()}}}return null}}},22485:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorReportingService=void 0;const n=r(89496),i=r(22677),o=r(69279),s=r(65979),a=r(7195),c=r(16260),u=r(14918);t.ErrorReportingService=class{context;constructor(e){this.context=e}async reportError(e,t){var r=void 0;const l=[];if(t?.additionalLogFile&&l.push(i.promptStrings.openLog),t?.openSettingPage&&l.push(i.promptStrings.openSettings),t?.promptToDisableExtension){if(r=new c.TelemetryEvent("prompt-project-unsupported",a.telemetryService),!(0,u.doesCSharpExtensionSupportDeferral)())return r?.addOrUpdateProperties({deferralnotsupported:String(!0)}),void r?.sendTelemetry();l.push(i.promptStrings.disableExtensionButton)}if(t?.doNotShowInWorkspace){t?.promptToDisableExtension?l.push(i.promptStrings.doNotShowAgain):l.push(i.promptStrings.doNotShowInWorkspaceAgain);const e="suppressMessage."+t.doNotShowInWorkspace;if(this.context.workspaceState.get(e))return r?.addOrUpdateProperties({skipped:String(!0)}),void r?.sendTelemetry();r?.addOrUpdateProperties({skipped:String(!1)})}t?.openOutputChannel&&l.push(i.promptStrings.openLogChannel),r?.sendTelemetry();const d=await n.window.showInformationMessage(e,...l);if(t?.additionalLogFile&&d===i.promptStrings.openLog){const e=await n.workspace.openTextDocument(t?.additionalLogFile);e&&await n.window.showTextDocument(e)}else if(!t?.doNotShowInWorkspace||d!==i.promptStrings.doNotShowInWorkspaceAgain&&d!==i.promptStrings.doNotShowAgain){if(t?.openSettingPage&&d===i.promptStrings.openSettings)await n.commands.executeCommand("workbench.action.openSettings",t?.openSettingPage);else if(t?.openOutputChannel&&d===i.promptStrings.openLogChannel){const e=n.extensions.getExtension(o.EXTENSION_ID);if(!e)throw new Error("Unable to find the extension.");const r=await e.exports.serviceBroker.getProxy(s.default.logOutputChannelService,{activationArguments:{outputChannelName:t?.openOutputChannel}});r?.show()}else if(t?.promptToDisableExtension&&d===i.promptStrings.disableExtensionButton){const e=new c.TelemetryEvent("prompt-project-unsupported-action",a.telemetryService);e.addOrUpdateProperties({disableExtension:String(!0)}),e.sendTelemetry(),n.workspace.getConfiguration().update("dotnet.preferCSharpExtension",!0,n.ConfigurationTarget.Workspace)}}else{if(t?.promptToDisableExtension){const e=new c.TelemetryEvent("prompt-project-unsupported-action",a.telemetryService);e.addOrUpdateProperties({donotshowagain:String(!0)}),e.sendTelemetry()}const e="suppressMessage."+t.doNotShowInWorkspace;this.context.workspaceState.update(e,"0")}}async reportAndWaitResume(e){await n.window.showInformationMessage(e,"Resume")}}},15158:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HelloWorld=void 0;const n=r(19679),i=r(65979);t.HelloWorld=class{serviceBroker;constructor(e){this.serviceBroker=e}sayHello(e){return`Hello, ${e}! - with love from VS Code Extension Host`}async callMe(e,t){const r=await this.serviceBroker.getProxy(i.default.helloWorld.create(e));try{if(!r)throw new Error(`No service known by ${n.ServiceMoniker.toString(e)}.`);return await r.sayHello(i.default.helloWorld.extensionHost.moniker.name)}finally{r?.dispose()}}}},57787:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HotReloadClientListener=t.ManagedHotReloadAvailabilityStatus=void 0;const n=r(37224);var i;!function(e){e[e.available=0]="available",e[e.interop=1]="interop",e[e.sqlClr=2]="sqlClr",e[e.minidump=3]="minidump",e[e.attach=4]="attach",e[e.moduleNotLoaded=5]="moduleNotLoaded",e[e.moduleReloaded=6]="moduleReloaded",e[e.notBuilt=8]="notBuilt",e[e.unsupportedEngine=9]="unsupportedEngine",e[e.notSupportedForClr64Version=10]="notSupportedForClr64Version",e[e.notAllowedForModule=11]="notAllowedForModule",e[e.optimized=12]="optimized",e[e.domainNeutralAssembly=13]="domainNeutralAssembly",e[e.reflectionAssembly=14]="reflectionAssembly",e[e.intelliTrace=15]="intelliTrace",e[e.notAllowedForRuntime=16]="notAllowedForRuntime",e[e.internalError=17]="internalError",e[e.unavailable=18]="unavailable",e[e.disabled=19]="disabled",e[e.notAllowedXPlat=20]="notAllowedXPlat"}(i||(t.ManagedHotReloadAvailabilityStatus=i={})),t.HotReloadClientListener=class{onSessionStarted(e,t){return(0,n.getHotReloadTracker)().startHotReload(e,t)}onHotReloadAvailabilityChanged(e,t){return(0,n.getHotReloadTracker)().onHotReloadAvailabilityChanged(e,t)}onSessionEnded(e){return(0,n.getHotReloadTracker)().endHotReload(e)}async onApplyChangesStarted(e){}reportHotReloadResult(e,t){return(0,n.getHotReloadTracker)().reportHotReloadResult(e)}}},42300:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hotReloadLogger=t.HotReloadLogger=t.HotReloadLogMessage=t.HotReloadDiagnosticErrorLevel=t.HotReloadVerbosity=void 0;const n=r(89496),i=r(89781),o=r(81297),s=r(50979);var a,c;!function(e){e[e.minimal=0]="minimal",e[e.detailed=1]="detailed",e[e.diagnostic=2]="diagnostic"}(a||(t.HotReloadVerbosity=a={})),function(e){e[e.info=0]="info",e[e.warning=1]="warning",e[e.error=2]="error"}(c||(t.HotReloadDiagnosticErrorLevel=c={})),t.HotReloadLogMessage=class{verbosity;instanceId;message;errorLevel;projectName;variant;constructor(e,t,r,n){this.verbosity=e,this.message=t,this.instanceId=r??0,this.errorLevel=n??c.info}};class u{outputChannel;logger;constructor(){this.outputChannel=(0,o.lazyLoad)((()=>n.window.createOutputChannel(".NET Hot Reload",{log:!0}))),this.logger=(0,o.lazyLoad)((()=>new i.Logger(this.outputChannel())))}shouldLogMessage(e){switch(s.hotReloadOptionService.getVerbosity()){case"minimal":return e===a.minimal;case"detailed":return e===a.minimal||e===a.detailed;default:return!0}}async log(e,t){if(!this.shouldLogMessage(e.verbosity))return;let r="";e.projectName&&(r+=` ${e.projectName}`,e.variant&&(r+=` (${e.variant})`),r+=":"),0!==e.instanceId&&(r+=`${e.instanceId}:`),r+=` ${e.message}`;let n=!1;switch(e.errorLevel){case c.info:this.outputChannel().info(r);break;case c.warning:this.outputChannel().warn(r);break;case c.error:this.outputChannel().error(r),n=!0}n&&this.outputChannel().show()}}t.HotReloadLogger=u,t.hotReloadLogger=new u},50979:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listenToHotReloadConfigUpdates=t.hotReloadOptionService=t.HotReloadOptionService=void 0;const n=r(89496),i=r(22677),o=r(42300);class s{enabled=!1;verbosity="minimal";hotReloadOnSave=!0;async isHotReloadEnabled(e,t){return this.enabled}updateConfig(e){this.enabled=n.workspace.getConfiguration("csharp.experimental.debug").get("hotReload")??!1,this.verbosity=e.get("hotReloadVerbosity")??"minimal",this.hotReloadOnSave=e.get("hotReloadOnSave")??!0}getIsHotReloadEnabled(){return this.enabled}getIsHotReloadOnSave(){return this.hotReloadOnSave}getVerbosity(){return this.verbosity}isSettingsEnabled(){return this.enabled}async getRudeEditSettingsAsync(e){return{automaticRestartEnabled:!1,agentRestartEnabled:!0}}async beforeRestartProjectsAsync(e,t,r,o){const s={title:i.promptStrings.rebuildAndApplyChanges},a={title:i.promptStrings.continueEditing,isCloseAffordance:!0},c=i.dotnetDebugConfigurationServiceStrings.hotReloadChangeNotSupportDetails(t,e,r),u=await n.window.showWarningMessage(i.dotnetDebugConfigurationServiceStrings.hotReloadNotSupportedTitle,{modal:!0,detail:c},s,a);return void 0!==u&&u===s}async notifyRudeEditRebuildInProgressAsync(e,t){const r=new o.HotReloadLogMessage(o.HotReloadVerbosity.minimal,e?i.dotnetDebugConfigurationServiceStrings.hotReloadRebuildInProgress:i.dotnetDebugConfigurationServiceStrings.hotReloadRebuildCompleted);await o.hotReloadLogger.log(r)}}function a(){const e=n.workspace.getConfiguration("csharp.debug");t.hotReloadOptionService.updateConfig(e)}t.HotReloadOptionService=s,t.hotReloadOptionService=new s,t.listenToHotReloadConfigUpdates=function(){n.workspace.onDidChangeConfiguration(a),a()}},28457:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.HotReloadResult=void 0,function(e){e[e.applied=0]="applied",e[e.noChanges=1]="noChanges",e[e.restartRequired=2]="restartRequired",e[e.errorEdits=3]="errorEdits",e[e.applyUpdatesFailure=4]="applyUpdatesFailure",e[e.partiallyApplied=5]="partiallyApplied"}(r||(t.HotReloadResult=r={}))},98727:(e,t)=>{"use strict";var r,n,i,o,s,a;Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorLaunchTarget=t.CustomLaunchTarget=t.AzureFunctionsLaunchTarget=t.BrowserInspectUriTarget=t.BrowserLaunchTarget=t.ExeLaunchTarget=void 0,function(e){e.is=function(e){return"executable"in e&&"directory"in e&&"commandLineArguments"in e&&"environmentVariables"in e&&"isConsoleApp"in e&&"isUsingSSL"in e}}(r||(t.ExeLaunchTarget=r={})),function(e){e.is=function(e){return"url"in e}}(n||(t.BrowserLaunchTarget=n={})),function(e){e.is=function(e){return"url"in e&&"inspectUri"in e}}(i||(t.BrowserInspectUriTarget=i={})),function(e){e.is=function(e){return"functionsApp"in e&&"directory"in e&&"environmentVariables"in e&&"isUsingSSL"in e}}(o||(t.AzureFunctionsLaunchTarget=o={})),function(e){e.is=function(e){return"options"in e}}(s||(t.CustomLaunchTarget=s={})),function(e){e.is=function(e){return"userMessage"in e&&"details"in e}}(a||(t.ErrorLaunchTarget=a={}))},57923:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SolutionRestoreCompletedEventArgs=t.SolutionRestoreStartedEventArgs=void 0,t.SolutionRestoreStartedEventArgs=class{solutionFilePath;pid;constructor(e,t){this.solutionFilePath=e,this.pid=t}},t.SolutionRestoreCompletedEventArgs=class{result;solutionFilePath;constructor(e,t){this.solutionFilePath=e,this.result=t}}},55825:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workspaceConfigurationOptionsService=void 0;const n=r(89496);t.workspaceConfigurationOptionsService=new class{getOption(e,t){return n.workspace.getConfiguration(e).get(t)}getStringOption(e,t){const r=this.getOption(e,t);if(void 0!==r&&"string"==typeof r)return r;throw new Error(`Unable to find a string from ${t} in ${e}`)}getNumberOption(e,t){const r=this.getOption(e,t);if(void 0!==r&&"number"==typeof r)return r;throw new Error(`Unable to find a number from ${t} in ${e}`)}getBooleanOption(e,t){const r=this.getOption(e,t);if(void 0!==r&&"boolean"==typeof r)return r;throw new Error(`Unable to find a boolean from ${t} in ${e}`)}getJSONStringSection(e,t){const r=this.getOption(e,t);if(void 0!==r)return JSON.stringify(r);throw new Error(`Unable to find anything from ${t} in ${e}`)}}},60519:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectQueryableSpace=void 0;const n=r(19679),i=r(7195),o=r(65979),s=r(73228),a=r(89781);t.ProjectQueryableSpace=class{serviceBroker;queryExecutionServiceProxy;constructor(e){this.serviceBroker=e,this.queryExecutionServiceProxy=(0,s.lazyPromiseLambda)((()=>this.initializeProxy()))}async dispose(){if(this.queryExecutionServiceProxy){const e=await this.queryExecutionServiceProxy;e?.dispose()}}async initializeProxy(){return await this.serviceBroker.getProxy(o.default.projectQueryExecutionService)}async executeQuery(e,t){return await i.logger.watch("ExecuteQuery with project query execution service",(async()=>{const r=JSON.stringify(e),n=await this.queryExecutionServiceProxy;try{if(n){const e=await n.ExecuteQueryAsync(r,t);return JSON.parse(e)}}catch(e){throw new Error("Exception while talking to proxy: "+e)}}),{importance:a.LogImportance.low})}async executeAction(e,t){return await i.logger.watch("ExecuteQuery action with project query execution service",(async()=>{const r=JSON.stringify(e),n=await this.queryExecutionServiceProxy;try{if(n){const e=await n.ExecuteRemoteExecutableAsync(r,t);return JSON.parse(e)}}catch(e){throw new Error("Exception while talking to proxy: "+e)}}),{importance:a.LogImportance.low})}async subscribeQuery(e,t){return await i.logger.watch("Subscribe with project query",(async()=>{const r=new c(t),n=JSON.stringify(e),i=await this.queryExecutionServiceProxy;try{if(i)return await i.SubscribeQueryResultsAsync(n,r)}catch(e){throw new Error("Exception while talking to proxy: "+e)}}),{importance:a.LogImportance.low})}};class c extends n.Observer{resultsReceiver;constructor(e){super((t=>{e.onNext(JSON.parse(t))}),(t=>{t?(i.logger.log("queryCompleted Failed",a.LogImportance.low),i.logger.log(t,a.LogImportance.low),e.onError(t)):(i.logger.log("queryCompleted",a.LogImportance.low),e.onCompleted())})),this.resultsReceiver=e}}},58305:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilteredStartupProjectService=void 0,t.FilteredStartupProjectService=class{service;observers;currentStartupProjectPath;unsubscribe;constructor(e){this.service=e,this.observers=[]}onNext(e){let t=e?.fullPath;if(t!==this.currentStartupProjectPath){this.currentStartupProjectPath=t;for(const e of this.observers)e.onNext(t)}}onCompleted(){for(const e of this.observers)e.onCompleted()}onError(e){for(const t of this.observers)t.onError(e)}subscribe(e){return this.observers.push(e),1===this.observers.length?this.unsubscribe=this.service.subscribe(this):e.onNext(this.currentStartupProjectPath),()=>{this.observers=this.observers.filter((t=>t!==e)),0===this.observers.length&&(this.unsubscribe?.(),this.unsubscribe=void 0)}}async pickStartupProject(){let e=await this.service.pickStartupProject();return e?.fullPath}getCurrentStartupProject(){return this.service.getCurrentStartupProject()?.fullPath}async getOrPickCurrentStartupProject(){let e=await this.service.getOrPickCurrentStartupProject();return e?.fullPath}}},55471:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.InvocationSource=void 0,function(e){e[e.solutionExplorer=0]="solutionExplorer",e[e.commandPalette=1]="commandPalette",e[e.newFileMenu=2]="newFileMenu"}(r||(t.InvocationSource=r={}))},44730:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.VsCodeFileWatcherEventArgs=t.FileSystemWatcherChangeTypes=void 0,function(e){e[e.created=1]="created",e[e.deleted=2]="deleted",e[e.changed=4]="changed"}(r||(t.FileSystemWatcherChangeTypes=r={})),t.VsCodeFileWatcherEventArgs=class{watcherChangeType;fsPath;constructor(e,t){this.watcherChangeType=e,this.fsPath=t}}},22743:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogOutputChannelState=void 0;const n=r(89496),i=r(7195),o=r(89781);class s{outputChannel;constructor(e){this.outputChannel=e}appendError(e){this.outputChannel?this.outputChannel.error(e):i.logger.log(e,o.LogImportance.high)}appendWarning(e){this.outputChannel?this.outputChannel.warn(e):i.logger.log(e,o.LogImportance.normal)}appendLine(e){this.outputChannel?this.outputChannel.appendLine(e):i.logger.log(e)}show(){this.outputChannel?.show(!0)}}class a{outputChannels=new Map;constructor(){}static create(){return new a}createOutputChannel(e){const t=e.activationArguments?.outputChannelName;if(t){let e=this.outputChannels.get(t);return e||(e=n.window.createOutputChannel(t,{log:!0}),this.outputChannels.set(t,e)),new s(e)}return new s}}t.LogOutputChannelState=a},277:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NuGetDotnetCommandsService=void 0;const n=r(81249),i=r(71017),o=r(89781),s=r(77867),a=r(30077),c=r(22677),u=r(73228);class l{outputChannel;static interactiveSwitch="--interactive";static includePrereleaseSwitch="--include-prerelease";static prereleaseSwitch="--prerelease";static minRequiredDotnetVersion="8.0.200";outputLogger;constructor(e){this.outputChannel=e,this.outputLogger=(0,u.lazyPromiseLambda)((async()=>new o.NuGetLogger(await this.outputChannel)))}async checkPrerequisites(e){const t=e?(0,i.dirname)(e):void 0,r=new o.OutputMonitor;await(0,s.dotnetCommand)(a.DotnetCommand.dotnetVersion,t,["--version"],r,!0);const u=r.getOutput();if(!u)return{isPrerequisiteMet:!1};const d=n.clean(u);return d?n.gte(d,l.minRequiredDotnetVersion)?{isPrerequisiteMet:!0,value:d}:{isPrerequisiteMet:!1,value:d,message:c.nugetStrings.missingDotnetSdkError,actionText:c.nugetStrings.missingDotnetSdkActionMessage}:{isPrerequisiteMet:!1,message:c.nugetStrings.missingDotnetSdkError,actionText:c.nugetStrings.missingDotnetSdkActionMessage}}async addPackage(e,t,r){return this.executeAddPackage(e,t,r,a.DotnetCommand.nugetAddPackage)}async updatePackage(e,t,r){return this.executeAddPackage(e,t,r,a.DotnetCommand.nugetUpdatePackage)}async executeAddPackage(e,t,r,n){if(!e||!t||!r)return!1;const o=e?(0,i.dirname)(e):void 0,c=["add",e,"package",t,"-v",r,l.interactiveSwitch];return await(0,s.dotnetCommand)(a.DotnetCommand.nugetAddPackage,o,c,await this.outputLogger),!0}async removePackage(e,t){if(!e||!t)return!1;const r=e?(0,i.dirname)(e):void 0,n=["remove",e,"package",t];return await(0,s.dotnetCommand)(a.DotnetCommand.nugetRemovePackage,r,n,await this.outputLogger),!0}async packageSearch(e,t,r){const c=["package","search",t,"--format","json",l.interactiveSwitch];r&&c.push(l.prereleaseSwitch);const u=e?(0,i.dirname)(e):void 0,d=new o.JsonOutputMonitor(await this.outputLogger);await(0,s.dotnetCommand)(a.DotnetCommand.nugetPackageSearch,u,c,d,!0);const p=await this.parseJsonFromOutput(d,"packageSearch");if(p){const e=new Map;return p.searchResult?.forEach((t=>{t.packages.map((e=>({id:e.id,latestVersion:e.latestVersion}))).forEach((t=>{const r=e.get(t.id),i=n.coerce(t.latestVersion),o=n.coerce(r?.version);(!r||i&&o&&n.gt(i,o))&&e.set(t.id,t)}))})),Array.from(e.values())}return[]}async getVersions(e,t,r){const n=["package","search",t,"--exact-match","--format","json",l.interactiveSwitch];r&&n.push(l.prereleaseSwitch);const c=e?(0,i.dirname)(e):void 0,u=new o.JsonOutputMonitor(await this.outputLogger);await(0,s.dotnetCommand)(a.DotnetCommand.nugetGetVersions,c,n,u,!0);const d=await this.parseJsonFromOutput(u,"getVersions");if(d){const e=d.version??0;return d.searchResult.reduce(((t,r)=>t.concat(r.packages.map((t=>this.mapVersionOutput(t,e))))),[])}return[]}async getInstalledPackages(e){return this.listInstalledPackages(e,!1)}async getOutdatedPackages(e,t){return this.listInstalledPackages(e,!0,t)}async listInstalledPackages(e,t,r=!1){let c=a.DotnetCommand.nugetListInstalledPackages;const u=["list",e,"package","--format","json",l.interactiveSwitch];t&&(u.push("--outdated"),c=a.DotnetCommand.nugetListOutdatedPackages,r&&u.push(l.includePrereleaseSwitch));const d=e?(0,i.dirname)(e):void 0,p=new o.JsonOutputMonitor(await this.outputLogger);await(0,s.dotnetCommand)(c,d,u,p,!0);const f=await this.parseJsonFromOutput(p,t?"getOutdatedPackages":"getInstalledPackages");if(f){const e=new Map;return f.projects?.forEach((r=>{r.frameworks?.forEach((r=>{r.topLevelPackages?.filter((e=>!t||this.isVersion(e.latestVersion))).map((e=>({id:e.id,version:e.requestedVersion}))).forEach((t=>{const r=e.get(t.id);r&&!n.gt(t.version,r.version)||e.set(t.id,t)}))}))})),Array.from(e.values())}return[]}async parseJsonFromOutput(e,t){try{const t=e.getOutput();return JSON.parse(t)}catch{const e=await this.outputLogger;return void e?.log(c.nugetStrings.invalidJsonError(t))}}mapVersionOutput(e,t){let r;return r=1===t?{id:e.id,version:e.latestVersion}:2===t?{id:e.id,version:e.version}:{id:e.id,version:e.latestVersion},r}isVersion(e){const t=e?.trim();return t&&!isNaN(t.charAt(0))}}t.NuGetDotnetCommandsService=l},8240:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NuGetSolutionRestoreState=t.NuGetSolutionRestoreService=void 0;const n=r(82361),i=r(89496),o=r(89781),s=r(79994),a=r(30077),c=r(7195),u=r(77867),l=r(22677),d=r(57923);class p extends n.EventEmitter{state;rpcEventNames=["solutionRestoreStarted","solutionRestoreCompleted"];startedHandler;completedHandler;constructor(e,t){super(),this.state=e,t.activationArguments?.needEvents&&(this.startedHandler=e=>this.emit("solutionRestoreStarted",e),this.completedHandler=e=>this.emit("solutionRestoreCompleted",e),this.state.on("solutionRestoreStarted",this.startedHandler),this.state.on("solutionRestoreCompleted",this.completedHandler))}dispose(){this.startedHandler&&this.state.off("solutionRestoreStarted",this.startedHandler),this.completedHandler&&this.state.off("solutionRestoreCompleted",this.completedHandler)}async setState(){const e=c.environmentStateManager?.getLatestEnvironmentState();if(!e)throw new Error("Environment state is undefined");this.state.setState(e)}async restoreSolution(){return await this.state.restoreSolution()}async nominateProject(e){return await this.state.nominateProject(e)}isNominationOnGoing(){return this.state.isNominationOnGoing()}}t.NuGetSolutionRestoreService=p;class f extends n.EventEmitter{rootDirectory;solutionFile;totalProjects;projectsNominatedSoFar;cachedRestoreResult;outputChannel;outputLogger;constructor(e){super(),this.outputChannel=e,this.outputLogger=new o.NuGetLogger(this.outputChannel)}static create(e){return new f(e)}setState(e){this.projectsNominatedSoFar=new Set,this.solutionFile=e.solutions[0],this.rootDirectory=(0,s.getActiveWorkspaceRoot)(),this.totalProjects=e.projects.filter((e=>e.projectId.fullPath.endsWith(".csproj"))).length,this.cachedRestoreResult=void 0}async restoreSolution(){if(this.cachedRestoreResult)try{return await this.cachedRestoreResult,!0}catch(e){return!1}try{c.logger.log("Starting NuGet restore for the solution.",o.LogImportance.low);var e=!1;return this.cachedRestoreResult=(0,u.dotnetCommand)(a.DotnetCommand.restore,this.rootDirectory,["restore",this.solutionFile,"--interactive"],this.outputLogger,!0,(t=>{this.emit("solutionRestoreStarted",new d.SolutionRestoreStartedEventArgs(this.solutionFile,t)),e=!0})),await this.cachedRestoreResult,e&&this.emit("solutionRestoreCompleted",new d.SolutionRestoreCompletedEventArgs(this.solutionFile,!0)),c.logger.log("Completed NuGet restore.",o.LogImportance.low),!0}catch(e){return this.emit("solutionRestoreCompleted",new d.SolutionRestoreCompletedEventArgs(this.solutionFile,!1)),this.displayFailureNotification(),c.logger.log(`Completed NuGet restore with error: ${e}`),!1}finally{this.cachedRestoreResult=void 0}}async nominateProject(e){return this.projectsNominatedSoFar&&!this.areAllProjectsNominated()?(this.projectsNominatedSoFar.add(e),!0):await this.restoreSolution()}isNominationOnGoing(){return!!this.cachedRestoreResult}areAllProjectsNominated(){return this.projectsNominatedSoFar?.size===this.totalProjects}displayFailureNotification(){i.window.showErrorMessage(l.NuGet.restoreFailure,l.showError).then((e=>{e===l.showError&&this.outputChannel.show()}))}}t.NuGetSolutionRestoreState=f},69751:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutputChannelState=void 0;const n=r(89496);class i{outputChannel;constructor(e){this.outputChannel=e}append(e){this.outputChannel.append(e)}appendLine(e){this.outputChannel.appendLine(e)}show(e){this.outputChannel.show(e)}clear(){this.outputChannel?.clear()}}class o{outputChannels=new Map;constructor(){}static create(){return new o}createOutputChannel(e){const t=e.activationArguments?.outputChannelName;if(!t)throw new Error("Missing ServiceActivationOptions.activationArguments.outputChannelName");let r=this.outputChannels.get(t);return r||(r=n.window.createOutputChannel(t),this.outputChannels.set(t,r)),new i(r)}}t.OutputChannelState=o},60279:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTemplateService=t.isTemplateServiceInitialized=void 0;const n=r(89496),i=r(22037),o=r(69279),s=r(65979),a=r(84832),c=r(7195),u=r(79994),l=r(22677),d=r(75010),p=r(89781);let f;t.isTemplateServiceInitialized=!1,t.getTemplateService=async function(){if(f)return f;const e=n.extensions.getExtension(o.EXTENSION_ID);if(!e)throw new Error("Unable to find the extension");const r=e.exports.serviceBroker,h=await r.getProxy(s.default.templateService);if(!h)throw new Error("Unable to get template service from brokered services");const g=new d.TelemetryActivity("TemplateService/initialization",c.telemetryService);let m=!1;try{await c.logger.watch("Initialize template service",(async()=>{const e=n.workspace.workspaceFolders,t=e&&0!==e.length?u.getActiveWorkspaceRoot():(0,i.homedir)(),r=await(c.dotnetVersionManager?.getDotnetVersion(t,c.logger,p.LogImportance.normal)),o=c.dotnetSdkPath??(r?await(0,a.findInstalledDotnetFromPathLegacy)(null,c.logger):null);if(r&&o){if(g.addOrUpdateProperties({version:r.version}),m=await h.initialize(o,r.version),!m)throw new Error("Unable to initialize template engine host using version: "+r.version+" and path: "+o)}else await n.window.showErrorMessage(l.addNewItemUiStrings.noSdkFound)}),{telemetry:g})}finally{g.end(),g.sendTelemetry()}return m?(f=h,t.isTemplateServiceInitialized=!0,f):null}},28510:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateCSharpExtensionVersionForAzFunctions=t.getAzureFunctionAPIExports=t.vsCodeAzureFunctionExtensionService=t.VSCodeAzureFunctionExtensionLaunchDataKeys=void 0;const n=r(69279),i=r(22677),o=r(6315),s=r(89496),a=r(81249);var c;function u(){const e=s.extensions.getExtension(n.AZUREFUNCTION_EXTENSION_ID);if(!e)throw new o.DotnetDebugConfigurationServiceError(o.DotnetDebugConfigurationServiceErrorKind.userError,i.vsCodeAzureFunctionExtensionServiceStrings.errorAzureFunctionsExtensionMissing,o.DebugTelemetryCode.invalidAzureFunctionExtension);const t=e.packageJSON.version;if(a.lt(t,n.AZUREFUNCTION_EXTENSION_REQUIRED_VERSION))throw new o.DotnetDebugConfigurationServiceError(o.DotnetDebugConfigurationServiceErrorKind.userError,i.vsCodeAzureFunctionExtensionServiceStrings.errorAzureFunctionMinimumVersion(n.AZUREFUNCTION_EXTENSION_REQUIRED_VERSION),o.DebugTelemetryCode.invalidAzureFunctionExtensionVersion);try{return e.exports.getApi(n.AZUREFUNCTION_EXTENSION_API_REQUIRED_VERSION)}catch{throw new o.DotnetDebugConfigurationServiceError(o.DotnetDebugConfigurationServiceErrorKind.internalError,i.vsCodeAzureFunctionExtensionServiceStrings.errorAzureFunctionExportsMissing,o.DebugTelemetryCode.invalidAzureFunctionExportAPI)}}!function(e){e.buildPath="buildPath",e.args="args",e.env="env"}(c||(t.VSCodeAzureFunctionExtensionLaunchDataKeys=c={})),t.vsCodeAzureFunctionExtensionService=new class{async startProcess(e){try{const t=e[c.buildPath];if(!t)throw new Error(i.vsCodeAzureFunctionExtensionServiceStrings.errorAzureFunctionStartFunc(c.buildPath));let r=e[c.args];r||(r=[]);let n=o.LaunchTargetToDebugConfigurationConverter.convertEnvironmentVariablesToObj(e[c.env]);return await u().startFuncProcess(t,r,n)}catch(e){let t="";return"string"==typeof e?t=e:e instanceof Error&&(t=e.message),{processId:-1,success:!1,error:t}}}},t.getAzureFunctionAPIExports=u,t.validateCSharpExtensionVersionForAzFunctions=async function(){const e=await s.extensions.getExtension(n.CSHARP_EXTENSION_ID),t=e?.packageJSON.version;if(!e||!t)throw new o.DotnetDebugConfigurationServiceError(o.DotnetDebugConfigurationServiceErrorKind.internalError,"Could not obtain exports from C# Extension ",o.DebugTelemetryCode.missingCSharpExtensionExport);if(a.lt(t,n.CSHARP_EXTENSION_AZ_FUNCTIONS_REQUIRED_VERSION))throw new o.DotnetDebugConfigurationServiceError(o.DotnetDebugConfigurationServiceErrorKind.internalError,`The C# extension is installed, but has version ${t} which is incompatible with Azure Functions Debug Launch. Please update your C# Extension.`,o.DebugTelemetryCode.invalidCSharpExtVersionAzFunc)}},22188:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VsCodeFileWatcherService=void 0;const n=r(89496),i=r(44730),o=r(82361);class s extends o.EventEmitter{fileSystemWatcher;constructor(e){super();let t=e.activationArguments?.globPattern??"**";const r=e.activationArguments?.basePath,o=!!e.activationArguments?.ignoreCreateEvents&&JSON.parse(e.activationArguments.ignoreCreateEvents.toLowerCase()),s=!!e.activationArguments?.ignoreChangeEvents&&JSON.parse(e.activationArguments.ignoreChangeEvents.toLowerCase()),a=!!e.activationArguments?.ignoreDeleteEvents&&JSON.parse(e.activationArguments.ignoreDeleteEvents.toLowerCase());r&&(t=new n.RelativePattern(r,t)),this.fileSystemWatcher=n.workspace.createFileSystemWatcher(t,o,s,a),this.fileSystemWatcher.onDidCreate((e=>{this.emit("onFileSystemChange",new i.VsCodeFileWatcherEventArgs(i.FileSystemWatcherChangeTypes.created,e.fsPath))})),this.fileSystemWatcher.onDidChange((e=>{this.emit("onFileSystemChange",new i.VsCodeFileWatcherEventArgs(i.FileSystemWatcherChangeTypes.changed,e.fsPath))})),this.fileSystemWatcher.onDidDelete((e=>{this.emit("onFileSystemChange",new i.VsCodeFileWatcherEventArgs(i.FileSystemWatcherChangeTypes.deleted,e.fsPath))}))}rpcEventNames=["onDidChange","onDidCreate","onDidDelete","onFileSystemChange"];dispose(){this.fileSystemWatcher.dispose()}}t.VsCodeFileWatcherService=s},72639:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFileWatcher=void 0;const n=r(92614),i=r(79994),o=r(7195),s=r(65979),a=r(44730),c=r(22188),u=r(71017);t.WorkspaceFileWatcher=class{fileWatcherService;serviceBroker=(0,i.getExtensionBrokerService)();changeManager=new l;constructor(e){const t={activationArguments:{globPattern:"**/*.csproj",basePath:(0,i.getActiveWorkspaceRoot)(),ignoreCreateEvents:"false",ignoreChangeEvents:"true",ignoreDeleteEvents:"false"}};this.fileWatcherService=new c.VsCodeFileWatcherService(t),this.fileWatcherService.on("onFileSystemChange",(async e=>{if(!this.changeManager.isChangePending(e.fsPath))switch(e.watcherChangeType){case a.FileSystemWatcherChangeTypes.created:void 0!==o.environmentStateManager&&o.environmentStateManager.isSolutionGeneratedOutsideWorkspace()&&await(0,n.addProjectFromWorkspace)(e.fsPath);break;case a.FileSystemWatcherChangeTypes.deleted:if(void 0!==o.environmentStateManager&&o.environmentStateManager.isSolutionGeneratedOutsideWorkspace()){const t=await this.serviceBroker.getProxy(s.default.solutionFileService);try{await(t?.removeProjectViaPath(e.fsPath))}catch(e){o.logger.log(`Error removing a project via vscode file explorer: ${e}`)}finally{t?.dispose()}}}}))}onCreateProject(e){return this.changeManager.startChange(e),{onComplete:()=>this.changeManager.onCompleted(e),onAbort:()=>this.changeManager.onAborted(e)}}onDeleteProject(e){return this.changeManager.startChange(e.toLocaleUpperCase()),{onComplete:()=>this.changeManager.onCompleted(e),onAbort:()=>this.changeManager.onAborted(e)}}onMoveProjectFile(e,t){return this.changeManager.startChange(e),this.changeManager.startChange(t),{onComplete:()=>{this.changeManager.onCompleted(e),this.changeManager.onCompleted(t)},onAbort:()=>{this.changeManager.onAborted(e),this.changeManager.onAborted(t)}}}onCompleted(e){this.changeManager.onCompleted(e)}onAborted(e){this.changeManager.onAborted(e)}dispose(){this.fileWatcherService.dispose()}};class l{_pendingChanges=new Map;startChange(e){const t=u.normalize(e).toLocaleUpperCase(),r=new d(e);this._pendingChanges.set(t,r)}onCompleted(e){const t=u.normalize(e).toLocaleUpperCase(),r=this._pendingChanges.get(t);r&&(r.complete(),this._pendingChanges.delete(t))}onAborted(e){const t=u.normalize(e).toLocaleUpperCase(),r=this._pendingChanges.get(t);r&&(r.abort(),this._pendingChanges.delete(t))}isChangePending(e){const t=u.normalize(e).toLocaleUpperCase();return this._pendingChanges.has(t)}}class d{_filePath;_isCompleted=!1;_isAborted=!1;constructor(e){this._filePath=e}complete(){this._isCompleted=!0}abort(){this._isAborted=!0}get filePath(){return this._filePath}get isCompleted(){return this._isCompleted}get isAborted(){return this._isAborted}}},18058:function(e,t,r){"use strict";var n=this&&this.__runInitializers||function(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0},i=this&&this.__esDecorate||function(e,t,r,n,i,o){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=n.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),p=!1,f=r.length-1;f>=0;f--){var h={};for(var g in n)h[g]="access"===g?{}:n[g];for(var g in n.access)h.access[g]=n.access[g];h.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");o.push(s(e||null))};var m=(0,r[f])("accessor"===c?{get:d.get,set:d.set}:d[u],h);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=s(m.get))&&(d.get=a),(a=s(m.set))&&(d.set=a),(a=s(m.init))&&i.unshift(a)}else(a=s(m))&&("field"===c?i.unshift(a):d[u]=a)}l&&Object.defineProperty(l,n.name,d),p=!0},o=this&&this.__setFunctionName||function(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})};Object.defineProperty(t,"__esModule",{value:!0}),t.EntitlementsService=void 0;const s=r(89496),a=r(52196),c=r(78394),u=r(68701),l=r(57359),d=r(33077),p="csdevkit_entitlementCode",f=new Date((new Date).setFullYear((new Date).getFullYear()+1));t.EntitlementsService=(()=>{let e,t,r=[];return class{static{e=[(0,l.catchErrors)(c.EntitlementError.requestFailure),l.addGetEntitlementTelemetry],i(this,t={value:o((async function(e,t){let r=await this.#e(e,t);const n=this.#t();return c.Entitlement.isActive(n)&&!c.Entitlement.isActive(r)&&(r=n),!t||r===this.#r||r instanceof c.Entitlement&&this.#r instanceof c.Entitlement&&r.equals(this.#r)||(this.#r=r,this.#n.fire(r)),r}),"#getEntitlementsInternal")},e,{kind:"method",name:"#getEntitlementsInternal",static:!1,private:!0,access:{has:e=>#i in e,get:e=>e.#i}},null,r)}#o=void n(this,r);#s;#n=new s.EventEmitter;#a;entitlementsChanged=this.#n.event;#c=new Map;#r=c.EntitlementError.noEntitlement;constructor(e,t,r){this.#o=e,this.#s=t,this.#o.msSessionChanged((()=>this.#u())),this.#a=r??h.create()}async getEntitlements(e){return this.#i(e,!1)}getRequiredScopes(){return this.#a.getRequiredScopes()}#t(){return(0,d.isInDevBox)()?new c.Entitlement("DevBoxAccontIdStub","DevBoxSubscriptionId",c.EntitlementType.devbox,c.EntitlementSourceType.environment,u.identityStrings.devBoxSubscription,c.Entitlement.activeSubscriptionStatus,f,"DevBox programCode","DevBox channel"):(0,d.isInCodeSpaces)()?new c.Entitlement("CodeSpacesAccountIdStub","CodeSpacesSubscriptionId",c.EntitlementType.codespaces,c.EntitlementSourceType.environment,u.identityStrings.codeSpacesSubscription,c.Entitlement.activeSubscriptionStatus,f,"CodeSpaces programCode","CodeSpaces channel"):null}#u(){this.#i({silent:!0},!0).catch((e=>{(0,l.sendErrorEvent)("EntitlementsService","sessionChanged",e)}))}get#i(){return t.value}async#e(e,t){const r=JSON.stringify([e,t]);if(this.#c.has(r))return this.#c.get(r);const n=this.#l(e,t).finally((()=>this.#c.delete(r)));return this.#c.set(r,n),n}async#l(e,t){let r=c.EntitlementError.requestFailure;if(a.useEntitlementsCache()){const e=await this.#s.get(p),i=e?c.Entitlement.deserialize(e):c.EntitlementError.noEntitlement;if(c.Entitlement.isActive(i))if(t){var n=await this.#o.getMsAccessToken(this.#a.getRequiredScopes(),{silent:!0,callerId:"EntitlementService",requestReason:"Entitlement Cache Check"});n&&n.accountId===i.accountId||await this.#s.delete(p)}else if(r=i,i.isFresh())return i}try{const t=await this.#a.fetch(this.#o,e);if(t===c.EntitlementError.noSession)return r=c.EntitlementError.noSession,this.#s.delete(p),c.EntitlementError.noSession;c.Entitlement.isActive(r)||(r=t),c.Entitlement.isActive(t)&&(r=t,await this.#s.store(p,t.serialize()))}catch(e){(0,l.sendErrorEvent)("EntitlementsService","requestEntitlementWithCaching",e)}return r}dispose(){this.#o.dispose(),this.#n.dispose()}}})();class h{sources;name="AggregatedEntitlementSource";constructor(e){this.sources=e}async fetch(e,t){let r=c.EntitlementError.requestFailure;for(let n of this.sources){try{r=await n.fetch(e,t)}catch(e){(0,l.sendErrorEvent)(n.name,"fetch entitlements",e)}if(r!==c.EntitlementError.requestFailure)return r}return r}getRequiredScopes(){return this.sources.find((e=>e!==m.instance))?.getRequiredScopes()??[]}static create(){let e=[v.ideBenefitsSource,m.instance];switch(a.entitlementsApiType()){case"Entitlements":e=[v.entitlementsSource,m.instance];break;case"IdeBenefitsOnly":e=[v.ideBenefitsSource]}return new h(e)}}class g{name;url;scopes;constructor(e,t,r){this.name=e,this.url=t,this.scopes=r}async fetch(e,t){const r=await e.getMsAccessToken(this.scopes,{...t,callerId:"EntitlementsService",requestReason:u.identityStrings.entitlementsSignInReason});if(!r)return c.EntitlementError.noSession;const n=await(0,d.httpsGet)(this.url,r.accessToken);return n?this.parseResponse(n,r.accountId):c.EntitlementError.requestFailure}getRequiredScopes(){return this.scopes}}class m extends g{static instance=new m("LicensingWebSource",m.#d(),["499b84ac-1321-427f-aa17-267ca6975798/.default"]);static#d(){return"https://app.vssps.visualstudio.com/_apis/Licensing/ClientRights/VisualStudio?productVersion=17.0.0.0%20CSDEVKIT&edition=Professional&relType=release&machineId=00000000-0000-0000-0000-00000000000"}fetch(e,t){return super.fetch(e,{silent:!0})}parseResponse(e,t){const r=m.#p(e);if(!r||!Array.isArray(r))return c.EntitlementError.noEntitlement;const n=r.map((e=>({obj:e,type:m.#f(e?.Attributes?.SubscriptionLevel)}))).sort(((e,t)=>t.type-e.type))[0];if(!n||!n.obj)return c.EntitlementError.noEntitlement;const i=n.obj.LicenseFallbackDescription??n.obj?.Attributes?.SubscriptionLevel;return i?new c.Entitlement(t,"LicensingApiSubscriptionId",n.type,c.EntitlementSourceType.licensingApi,i,c.Entitlement.activeSubscriptionStatus,f,"programCode unavailable","channel unavailable"):c.EntitlementError.noEntitlement}static#f(e){switch(e?.toLowerCase()){case"enterprise":return c.EntitlementType.enterprise;case"ultimate":return c.EntitlementType.ultimate;case"premium":return c.EntitlementType.premium;case"professional":return c.EntitlementType.pro;case"testprofessional":return c.EntitlementType.testPro;default:return c.EntitlementType.none}}static#p(e){const t=e.split(".")[1];if(!t)return;const r=Buffer.from(t,"base64").toString("binary"),n=JSON.parse(r);return n.Rights?JSON.parse(n.Rights):void 0}}class v extends g{static#h="IdeBenefitsSource";static entitlementsSource=new v("EntitlementsSource","https://api.subscriptions.visualstudio.microsoft.com/api/GetMyEntitlements",["https://graph.microsoft.com/.default"]);static ideBenefitsSource=new v(v.#h,a.getIdeBenefitsEndpoint(),["6f1cc985-85e8-487e-b0dd-aa633302a731/.default"]);static#g="LicensingIde";parseResponse(e,t){const r=JSON.parse(e);if(!r||0===r.length)return c.EntitlementError.noEntitlement;const n=r.filter((e=>e.entitlementType===v.#g)).map((e=>this.#m(e,t)));if(0===n.length)return c.EntitlementError.noEntitlement;(0,l.sendReceivedEntitlementsTelemetry)(n);const i=n.filter((e=>e.isActive())).sort(((e,t)=>t.type-e.type));return i.length>0?i[0]:c.EntitlementError.inactiveEntitlement}#m(e,t){return new c.Entitlement(t,e.benefitDetailGuid,v.#f(e.entitlementCode),this.name===v.#h?c.EntitlementSourceType.ideBenefitsApi:c.EntitlementSourceType.entitlementApi,e.subscriptionLevelName,e.subscriptionStatus?.toLocaleLowerCase(),new Date(e.subscriptionExpirationDate),e.subscriptionProgramCode,e.subscriptionChannel)}static#f(e){switch(e){case"IDE-ENTERPRISE":return c.EntitlementType.enterprise;case"IDE-ULTIMATE":return c.EntitlementType.ultimate;case"IDE-PREMIUM":return c.EntitlementType.premium;case"IDE-PRO":return c.EntitlementType.pro;case"IDE-TESTPRO":return c.EntitlementType.testPro;default:return c.EntitlementType.none}}}},72902:function(e,t,r){"use strict";var n=this&&this.__runInitializers||function(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0},i=this&&this.__esDecorate||function(e,t,r,n,i,o){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=n.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),p=!1,f=r.length-1;f>=0;f--){var h={};for(var g in n)h[g]="access"===g?{}:n[g];for(var g in n.access)h.access[g]=n.access[g];h.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");o.push(s(e||null))};var m=(0,r[f])("accessor"===c?{get:d.get,set:d.set}:d[u],h);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=s(m.get))&&(d.get=a),(a=s(m.set))&&(d.set=a),(a=s(m.init))&&i.unshift(a)}else(a=s(m))&&("field"===c?i.unshift(a):d[u]=a)}l&&Object.defineProperty(l,n.name,d),p=!0},o=this&&this.__setFunctionName||function(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenInfo=t.TokenAcquisitionService=void 0;const s=r(89496),a=r(57359),c="microsoft",u="github",l=["VSCODE_TENANT:organizations"];t.TokenAcquisitionService=(()=>{let e,t,r=[];return class{static{e=[(0,a.catchErrors)(void 0),a.addGetSessionTelemetry],i(this,t={value:o((async function(e,t,r){if(!r||!r.callerId?.trim()||!r.requestReason?.trim())throw new Error("Please provide callerId and requestReason in TokenRequestOptions");if(r.createIfNone&&!r.forceNewSession){const n=await this.#v.getSession(e,t,{silent:!0});if(n)return n;r.createIfNone=!1,r.forceNewSession=!0}return!0===r.forceNewSession&&(r.forceNewSession={detail:r.requestReason}),await this.#v.getSession(e,t,r)}),"#getSession")},e,{kind:"method",name:"#getSession",static:!1,private:!0,access:{has:e=>#y in e,get:e=>e.#y}},null,r)}#v=void n(this,r);#_;#S=new s.EventEmitter;#w=new s.EventEmitter;msSessionChanged=this.#S.event;gitHubSessionChanged=this.#w.event;constructor(e){this.#v=e??new d,this.#_=this.#v.onDidChangeSessions((e=>this.#b(e.provider.id)))}async getSessionInfo(e,t){const r=[...e,...l];return await this.#y(c,r,t)??null}getMsAccessToken(e,t){const r=[...e,...l];return this.#E(c,r,t)}getGitHubAccessToken(e,t){return this.#E(u,e,t)}async#E(e,t,r){const n=await this.#y(e,t,r);return n?.accessToken?new p(n.accessToken,n.account?.id??"no-account-id"):null}get#y(){return t.value}#b(e){switch(e){case c:this.#S.fire();break;case u:this.#w.fire()}}dispose(){this.#S.dispose(),this.#w.dispose(),this.#_.dispose()}}})();class d{getSession(e,t,r){return s.authentication.getSession(e,t,r)}onDidChangeSessions=s.authentication.onDidChangeSessions}class p{accessToken;accountId;constructor(e,t){this.accessToken=e,this.accountId=t}}t.AccessTokenInfo=p},52196:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.integrationTestMode=t.getIdeBenefitsEndpoint=t.daysEntitlementIsFresh=t.daysEntitlementIsValid=t.daysBetweenSignInPrompts=t.entitlementsApiType=t.showEntitlementExpiryDate=t.useEntitlementsCache=void 0;const n=r(89496);function i(e,t){return n.workspace.getConfiguration("dotnet").get(e,t)}t.useEntitlementsCache=function(){return i("useEntitlementsCache",!0)},t.showEntitlementExpiryDate=function(){return i("showEntitlementExpiryDate",!1)},t.entitlementsApiType=function(){return i("EntitlementsApiType","IdeBenefits")},t.daysBetweenSignInPrompts=function(){return i("daysBetweenSignInPrompts",15)},t.daysEntitlementIsValid=function(){return i("daysEntitlementIsValid",30)},t.daysEntitlementIsFresh=function(){return i("daysEntitlementIsFresh",2)},t.getIdeBenefitsEndpoint=function(){return i("ideBenefitsEndpoint","https://api.subscriptions.visualstudio.microsoft.com/Me/Entitlements/IDEBenefits?api-version=2023-03-26&caller=vscode")},t.integrationTestMode=function(){return!!process.env.AUTOMATED_INTEGRATION_TEST}},78394:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntitlementSourceType=t.EntitlementError=t.EntitlementType=t.Entitlement=void 0;const n=r(33077),i=r(52196);class o{accountId;benefitDetailGuid;type;sourceType;subscriptionLevelName;subscriptionStatus;expirationDate;programCode;channel;acquisitionDate;fromCache;static activeSubscriptionStatus="active";constructor(e,t,r,n,i,o,s,a,c,u=new Date,l=!1){this.accountId=e,this.benefitDetailGuid=t,this.type=r,this.sourceType=n,this.subscriptionLevelName=i,this.subscriptionStatus=o,this.expirationDate=s,this.programCode=a,this.channel=c,this.acquisitionDate=u,this.fromCache=l}equals(e){return this===e||e&&this.subscriptionLevelName===e.subscriptionLevelName&&this.type===e.type}isActive(){return this.type>s.testPro&&this.subscriptionStatus===o.activeSubscriptionStatus&&(0,n.daysPassedSince)(this.acquisitionDate)<i.daysEntitlementIsValid()}isFresh(){return this.isActive()&&(0,n.daysPassedSince)(this.acquisitionDate)<i.daysEntitlementIsFresh()}serialize(){return JSON.stringify(this)}static deserialize(e){const t=JSON.parse(e);return t&&t.accountId&&t.benefitDetailGuid&&t.type&&t.sourceType&&t.subscriptionLevelName&&t.subscriptionStatus&&t.programCode&&t.channel&&t.expirationDate&&t.acquisitionDate?new o(t.accountId,t.benefitDetailGuid,t.type,t.sourceType,t.subscriptionLevelName,t.subscriptionStatus,new Date(t.expirationDate),t.programCode,t.channel,new Date(t.acquisitionDate),!0):null}static isActive(e){return e instanceof o&&e.isActive()}}var s,a,c;t.Entitlement=o,function(e){e[e.devbox=8]="devbox",e[e.codespaces=7]="codespaces",e[e.enterprise=6]="enterprise",e[e.ultimate=5]="ultimate",e[e.premium=4]="premium",e[e.pro=3]="pro",e[e.testPro=2]="testPro",e[e.none=1]="none"}(s||(t.EntitlementType=s={})),function(e){e[e.noSession=1]="noSession",e[e.requestFailure=2]="requestFailure",e[e.noEntitlement=3]="noEntitlement",e[e.inactiveEntitlement=4]="inactiveEntitlement"}(a||(t.EntitlementError=a={})),function(e){e[e.ideBenefitsApi=1]="ideBenefitsApi",e[e.environment=2]="environment",e[e.entitlementApi=3]="entitlementApi",e[e.licensingApi=4]="licensingApi"}(c||(t.EntitlementSourceType=c={}))},25462:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTestHooks=void 0;const n=r(89496),i=r(52196),o=r(78394),s=r(57359);t.getTestHooks=function(){return i.integrationTestMode()?{secretStorage:u.instance,vsCodeAuthentication:a.instance,entlementSource:c.instance,notificationService:l.instance}:null};class a{static instance=new a;didChangeSessionsEmitter=new n.EventEmitter;lastRequestProviderId=void 0;lastRequestScopes=[];lastRequestOptions=void 0;responseToProvide=void 0;onDidChangeSessions=this.didChangeSessionsEmitter.event;getSession(e,t,r){return this.lastRequestProviderId=e,this.lastRequestScopes=t,this.lastRequestOptions=r,Promise.resolve(this.responseToProvide)}}class c{static instance=new c;name="MockEntlementSource";lastRequestOptions=void 0;responseScopesToProvide=[];#P=o.EntitlementError.noSession;getRequiredScopes(){return this.responseScopesToProvide}fetch(e,t){return this.lastRequestOptions=t,Promise.resolve(this.#P)}setResponseEntitlementToProvide(e){this.#P="string"==typeof e?o.Entitlement.deserialize(e)??o.EntitlementError.requestFailure:e}}class u{static instance=new u;typeMap=new Map;didChangeEmitter=new n.EventEmitter;onDidChange=this.didChangeEmitter.event;get(e){return Promise.resolve(this.typeMap.get(e))}store(e,t){return this.typeMap.set(e,t),Promise.resolve(!0)}delete(e){return this.typeMap.delete(e),Promise.resolve(!0)}clear(){this.typeMap.clear()}}class l extends s.NotificationService{static instance=new l;lastRequestMessage;lastRequestOptions=[];responseToProvide;async showNotification(e,t,...r){return this.lastRequestMessage=t,this.lastRequestOptions=r,this.responseToProvide}}},49998:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showEntitlementsStatusCommand=t.signInCommand=t.registerIdentityService=void 0;const n=r(89496),i=r(24138),o=r(52196),s=r(18058),a=r(72902),c=r(33077),u=r(75010),l=r(57359),d=r(78394),p=r(25462),f=r(68701),h=r(7195),g=r(78394),m="lastPromptDate";let v,y=new c.EventBouncer;async function _(e){const t=new u.TelemetryActivity("show-entitlement-command",h.telemetryService);if(!v)return void(0,l.sendErrorEvent)("showEntitlementsStatusCommand","get dependencies");y.stop();const r=await E(v.entitlementsService),n=await P(v.entitlementsService,v.tokenAcquisitionService);if(d.Entitlement.isActive(r)||n)await w(v.notificationService,r,n,"showEntitlementCommand"),t.addOrUpdateProperties({signInRequested:String(!1)});else{const e=await S(v,{messageReason:"showEntitlementCommand"});e&&y.raiseNext(),t.addOrUpdateProperties({signInRequested:String(!0),signInSucceded:String(e)})}t.end(),t.addOrUpdateProperties({caller:e}),(0,l.addAccountInfoToEvent)(t,n),(0,l.addEntitlementInfoToEvent)(t,r),t.sendTelemetry()}async function S(e,t){return await e.secrets.store(m,(new Date).toISOString()),"signInBtn"===await e.notificationService.showNotification({messageReason:`promptToSignIn+${t.messageReason}`,telemetryUpdate:t.telemetryUpdate},f.identityStrings.signInRequest,"signInBtn","dismissBtn")&&await T(e.entitlementsService,e.tokenAcquisitionService)}async function w(e,t,r,n){const i=b(t,r);await e.showNotification({messageReason:`showStatusPopUp+${n}`,telemetryUpdate:e=>{(0,l.addAccountInfoToEvent)(e,r),(0,l.addEntitlementInfoToEvent)(e,t)}},i,"dismissBtn")}function b(e,t){const r=d.Entitlement.isActive(e),n=t?.label?.split(" - ").pop()?.trim();let i=n?`${f.identityStrings.softwareIsLicensedTo} ${n}`:f.identityStrings.softwareIsLicensed;switch(i+=" ",r?e.type:g.EntitlementType.none){case g.EntitlementType.enterprise:case g.EntitlementType.ultimate:i+=f.identityStrings.underVsEnterpriseSubscription;break;case g.EntitlementType.pro:case g.EntitlementType.premium:i+=f.identityStrings.underVsProSubscription;break;case g.EntitlementType.devbox:i+=f.identityStrings.underDevBoxSubscription;break;case g.EntitlementType.codespaces:i+=f.identityStrings.underCodeSpacesSubscription;break;case g.EntitlementType.testPro:case g.EntitlementType.none:default:i+=f.identityStrings.underIndividualLicense}return i+=".",r&&o.showEntitlementExpiryDate()&&(i+=` ${f.identityStrings.expirationDateHeader} ${e.expirationDate.toLocaleDateString()}.`),i}function E(e){return e.getEntitlements({silent:!0})}async function P(e,t,r=!1){const n=await t.getSessionInfo(e.getRequiredScopes(),{callerId:"showEntitlementsStatus",requestReason:f.identityStrings.entitlementsSignInReason,silent:!r,createIfNone:r});return n?.account??null}async function T(e,t){return!!await P(e,t,!0)}t.registerIdentityService=function(e){const t=(0,p.getTestHooks)();v=function(e,t){const r=t?.secretStorage??new l.SecretStorageWithErrorHandling(e.secrets),n=t?.notificationService??l.NotificationService.instance,i=new a.TokenAcquisitionService(t?.vsCodeAuthentication);return{secrets:r,notificationService:n,tokenAcquisitionService:i,entitlementsService:new s.EntitlementsService(i,r,t?.entlementSource)}}(e,t),e.subscriptions.push(v.entitlementsService);const r=async function(e,t){(0,c.setVersionForUserAgent)(t.extension.packageJSON.version);const r=await e.entitlementsService.getEntitlements({createIfNone:!1});!function(e,t,r){const o=n.window.createStatusBarItem("csdevkit.status",n.StatusBarAlignment.Right,0);function s(e){o.text=d.Entitlement.isActive(e)?"$(statusbar-entitlement)":"$(statusbar-no-entitlement)",o.tooltip=b(e,null),o.show()}o.command=i.default.showEntitlementsStatus,s(r),e.subscriptions.push(o,t(s))}(t,e.entitlementsService.entitlementsChanged,r);const s=y.createEventHandler((e=>{d.Entitlement.isActive(e)&&_("entitlementsChangedEvent")}));t.subscriptions.push(e.entitlementsService.entitlementsChanged(s)),r!==d.EntitlementError.noSession||await async function(e,t){return!!await P(e,t,!1)}(e.entitlementsService,e.tokenAcquisitionService)||await async function(e){const t=await e.secrets.get(m);(t?(0,c.daysPassedSince)(new Date(t))>o.daysBetweenSignInPrompts():await e.secrets.store(m,(new Date).toISOString()))&&await S(e,{messageReason:"periodicalReminder",telemetryUpdate:e=>{e.addOrUpdateProperties({previousReminderDate:t})}})}(e)}(v,e).catch((e=>{(0,l.sendErrorEvent)("registerIdentityService","initialization",e)}));return t&&(t.initPromise=r),[v.tokenAcquisitionService,t]},t.signInCommand=async function(){const e=new u.TelemetryActivity("sign-in-command",h.telemetryService);if(!v)return void(0,l.sendErrorEvent)("signInCommand","get dependencies");let t=d.EntitlementError.noEntitlement;const r=await P(v.entitlementsService,v.tokenAcquisitionService);r?(t=await E(v.entitlementsService),await w(v.notificationService,t,r,"signInCommand")):await T(v.entitlementsService,v.tokenAcquisitionService),e.end(),(0,l.addAccountInfoToEvent)(e,r),(0,l.addEntitlementInfoToEvent)(e,t),e.sendTelemetry()},t.showEntitlementsStatusCommand=async function(){await _("command")}},68701:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.identityStrings=void 0;const n=r(89496),i=r(18472);i.config({bundleFormat:i.BundleFormat.standalone,locale:n.env.language,messageFormat:i.MessageFormat.both});const o=i.loadMessageBundle(r(71017).join(__dirname,"services\\identity\\strings.ts"));t.identityStrings={devBoxSubscription:o(0,null),codeSpacesSubscription:o(1,null),softwareIsLicensed:o(2,null),softwareIsLicensedTo:o(3,null),underVsEnterpriseSubscription:o(4,null),underVsProSubscription:o(5,null),underDevBoxSubscription:o(6,null),underCodeSpacesSubscription:o(7,null),underIndividualLicense:o(8,null),expirationDateHeader:o(9,null),signInRequest:o(10,null),signInBtn:o(11,null),dismissBtn:o(12,null),entitlementsSignInReason:o(13,null)}},57359:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addGetEntitlementTelemetry=t.addGetSessionTelemetry=t.catchErrors=t.SecretStorageWithErrorHandling=t.addSignInRequestInfoToActivity=t.sendErrorEvent=t.addEnvironmentInfoToEvent=t.addAccountInfoToEvent=t.addEntitlementInfoToEvent=t.sendReceivedEntitlementsTelemetry=t.NotificationService=void 0;const n=r(89496),i=r(75010),o=r(33077),s=r(7195),a=r(16260),c=r(78394),u=r(68701),l=r(89781);class d{static instance=new d;async showNotification(e,t,...r){const o=new i.TelemetryActivity("show-notification",s.telemetryService),a=await n.window.showInformationMessage(t,...r.map((e=>u.identityStrings[e]))),c=a?r.find((e=>a===u.identityStrings[e]